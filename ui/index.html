<!doctype html>
<html class="no-js" lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<title>Swim - Plant Monitor</title>
	<meta name="description" content="">
	<link rel="icon" type="image/png" href="assets/swim-icon-192px.png">
	<link rel="manifest" href="/manifest.webmanifest">
	
	<!-- styles -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,500,600,700|Orbitron:400,500|Material+Icons" rel="stylesheet">
	<!-- <link rel="stylesheet" href="assets/css/main.css" type="text/css"> -->
	<style>
* {
  padding: 0px;
  margin: 0px;
}

html, body {
  background-color: #1a1a1a;
  color: white;
  font-size: 16pt;
  font-family: "Open Sans", sans-serif;
  height: 100%;
}

h3 {
  background-color: #00a6ed;
  padding: 5px 10px;
  font-size: 20px;
  margin-bottom: 0px; 
  border-radius: 5px 5px 0px 0px;
  font-family: Orbitron;
  border-top: solid 1px rgb(175,225,255);
  border-bottom: solid 1px rgb(0,54,86);  
}

.cellBottom {
  border-radius: 0px 0px 5px 5px;
  padding: 0px;
  margin-top: 10px;
}

h4 {
  background-color: #00a6ed;
  padding: 5px 10px;
  font-size: 18px;
  margin-bottom: 0px; 
}

h5 {
  font-size: 18px;
  color: #000000;
  margin: 10px auto 0px 0px;
}

h6 {
  margin: 0px;
  padding: 0px;
  font-size: 12px;  
}

.main {
  max-width: 1024px;
  min-width: 620px;
  margin: 0px auto 50px auto;
  display: grid;
  grid-template-columns: 45% 55%;
  grid-template-rows: 50% 50%;
  grid-gap: 5px;
}

.chartsSection { 
  grid-area: 1 / 2 / 3 / 5; 
}

.gauge { 
  grid-area: 1 / 1 / 2 / 2; 
}

.plantListColumn { 
  grid-area: 2 / 1 / 3 / 2; 
  display: grid;
  grid-template-rows: 32px 20px auto;
}

.chartHeader {
  display: grid;
  grid-template-columns: 70% 30%;
}

.chartHeader div:nth-child(even) {
  text-align: right;
  cursor: pointer;
}

.chartHeader div:hover:nth-child(even) {
  text-align: right;
  cursor: pointer;
  background-color: rgba(255,255,255,0.2);
}


.sim {
  width: 600px;
  grid-template-columns: 200px auto;
  grid-template-rows: 1fr;
}

.sim input {
  background-color: white;
}

.chartsSection {
  display: grid;
  grid-template-columns: auto;  
  grid-gap: 5px;
}

canvas {
  pointer-events: none;  
}

input,
select {
  background-color: rgba(255,255,255,0.4);
  color: #000000;
  border: 0px;
  padding: 3px 10px;
  margin: 0px;
  border-radius: 5px;
  box-shadow: 0px 0px 3px inset rgba(0,0,0,0.4);
  transition: 100ms linear;
  font-size: 14px;
}

select:focus {
  outline: none;
}

input[type="button"]:hover {
  background-color: rgba(255,255,255,0.9);
}

.statusHeader {
  padding: 8px;
  display: flex;
  line-height: 62px;  
}

.chartRow {
  width: 100%; 
  height: 150px;
  margin-bottom: 10px;
}

.plantList {
  grid-row: 1 /span 2;
}

.plantHeader {
  padding: 0px;
  height: 31px;
}

#plantNameHeader {
  padding: 4px;
  text-align: center;
}

.plantListColumns {
  display: grid;
  grid-template-columns: 1fr 0.2fr;
  height: 20px;
  color: black;
  font-size: 12px;
  grid-gap: 2px;
}

.plantListColumns div {
  background-color: rgba(255,255,255,0.8);
  padding: 0px 5px;
}

#plantListingDiv span, #alertListingDiv span {
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;  
}

#plantListingDiv b, #alertListingDiv b {
  text-align: center;
}

#plantListingDiv div:hover {
  background-color: rgba(255,255,255,0.5);
  cursor: pointer;
}

.plantControls, .plantInputs {
  display: grid;
  grid-template-columns: 30% 70%;
}

.plantSvg {
  width: 256px;
  margin: 0px auto;
  left: calc(50% - 128px);
  position: relative;  
}

#plantListingDiv, #alertListingDiv {
  font-size: 14px;
}

#plantListingDiv div, #alertListingDiv div {
  display: grid;
  grid-template-columns: 1fr 0.2fr;
}

#plantListingDiv div:nth-child(even) {
  background-color: rgba(255,255,255,0.1);

}

.selectedRow {
  background-color:rgba(100,100,255,0.2) !important;
}

.plantButtons {
  margin: -45px auto;
  text-align: center;
  z-index: 1;
}
	</style>

	<!-- javascript -->
	<script src="assets/js/lib/libgif.js"></script>
	<script>
		// swim-system-3.10.2; copyright 2015-2020 SWIM.AI inc.
		!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("mapbox-gl")):"function"==typeof define&&define.amd?define(["exports","mapbox-gl"],e):e((t=t||self).swim=t.swim||{},t.mapboxgl)}(this,(function(t,e){"use strict";var r;String.prototype.codePointAt||Object.defineProperty(String.prototype,"codePointAt",{value:function(t){var e=this.length;if((t=t?Number(t):0)!=t&&(t=0),t>=0&&t<e){var r=this.charCodeAt(t);if(r<=55295||r>=57344)return r;if(r<=56319&&t+1<e){var i=this.charCodeAt(t+1);if(i>=56320&&i<=57343)return 65536+((1023&r)<<10+i&1023)}}},configurable:!0,writable:!0}),String.prototype.offsetByCodePoints||Object.defineProperty(String.prototype,"offsetByCodePoints",{value:function(t,e){if(e>0)for(var r=this.length;e>0&&t<r;){if((n=this.charCodeAt(t))<=55295||n>=57344)t+=1;else if(n<=56319&&t+1<r){t+=(i=this.charCodeAt(t+1))>=56320&&i<=57343?2:1}else t+=1;e-=1}else if(e<0)for(;e<0&&t>0;){var i;if((i=this.charCodeAt(t-1))<=55295||i>=57344)t-=1;else if(i>=56320&&i<=57343&&t-1>0){var n;t-=(n=this.charCodeAt(t-2))>=55296&&n<=57343?2:1}else t-=1;e-=1}return t},configurable:!0,writable:!0}),(r=t.ByteOrder||(t.ByteOrder={})).BigEndian="BE",r.LittleEndian="LE";var i=function(){var t=new ArrayBuffer(2);new Uint16Array(t)[0]=65279;var e=new Uint8Array(t);if(254===e[0]&&255===e[1])return"BE";if(255===e[0]&&254===e[1])return"LE";throw new Error}(),n="undefined"!=typeof window&&(window.crypto||window.msCrypto);function o(t){n.getRandomValues(t)}function s(t){if(t instanceof Int8Array)for(var e=0;e<t.length;e+=1)t[e]=128-Math.round(256*Math.random());else if(t instanceof Uint8Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(256*Math.random());else if(t instanceof Int16Array)for(e=0;e<t.length;e+=1)t[e]=32768-Math.round(65536*Math.random());else if(t instanceof Uint16Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(65536*Math.random());else if(t instanceof Int32Array)for(e=0;e<t.length;e+=1)t[e]=2147483648-Math.round(4294967296*Math.random());else{if(!(t instanceof Uint32Array))throw new TypeError(""+t);for(e=0;e<t.length;e+=1)t[e]=Math.round(4294967296*Math.random())}}var u=function(){function t(){}return t.fillBytes=n?o:s,t}(),a=new ArrayBuffer(8),h=new Float64Array(a),p=new Int32Array(a);function l(t,e){return t<<e|t>>>32-e}var c=function(){function t(){}return t.seed=function(e){return"object"==typeof e&&e&&(e=e.constructor&&"string"==typeof e.constructor.name?e.constructor.name:e.toString()),t.hash(e)},t.hash=function(e){if(e instanceof Uint8Array||"string"==typeof e)return t.mash(t.mix(0,e));if("number"==typeof e)return~~e===e?~~e:(h[0]=e,p[0]^p[1]);if("boolean"==typeof e)return e?3:2;if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)},t.mixUint8ArrayBE=function(e,r){for(var i=0,n=r.length;i+3<n;){var o=(255&r[i])<<24|(255&r[i+1])<<16|(255&r[i+2])<<8|255&r[i+3];e=t.mix(e,o),i+=4}if(i<n){o=(255&r[i])<<24;i+1<n&&(o|=(255&r[i+1])<<16,i+2<n&&(o|=(255&r[i+2])<<8)),e^=o=461845907*(65535&(o=l(o=3432918353*(65535&o)+((3432918353*(o>>>16)&65535)<<16)&4294967295,15)))+((461845907*(o>>>16)&65535)<<16)&4294967295}return e^n},t.mixUInt8ArrayLE=function(e,r){for(var i=0,n=r.length;i+3<n;){var o=255&r[i]|(255&r[i+1])<<8|(255&r[i+2])<<16|(255&r[i+3])<<24;e=t.mix(e,o),i+=4}if(i<n){o=255&r[i];i+1<n&&(o|=(255&r[i+1])<<8,i+2<n&&(o|=(255&r[i+2])<<16)),e^=o=461845907*(65535&(o=l(o=3432918353*(65535&o)+((3432918353*(o>>>16)&65535)<<16)&4294967295,15)))+((461845907*(o>>>16)&65535)<<16)&4294967295}return e^n},t.mixStringBE=function(e,r){for(var i=0,n=32,o=0,s=r.length,u=0;o<s;){var a=r.codePointAt(o);void 0===a&&(a=r.charCodeAt(o)),a>=0&&a<=127?(i|=a<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),u+=1):a>=128&&a<=2047?(i|=(192|a>>>6)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|63&a)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),u+=2):a>=2048&&a<=65535||a>=57344&&a<=65535?(i|=(224|a>>>12)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|a>>>6&63)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|63&a)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),u+=3):a>=65536&&a<=1114111?(i|=(240|a>>>18)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|a>>>12&63)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|a>>>6&63)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=(128|63&a)<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),u+=4):(i|=239<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=191<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),i|=189<<(n-=8),0===n&&(e=t.mix(e,i),i=0,n=32),u+=3),o=r.offsetByCodePoints(o,1)}return 32!==n&&(e^=i=461845907*(65535&(i=l(i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295),e^u},t.mixStringLE=function(e,r){for(var i=0,n=0,o=0,s=r.length,u=0;o<s;){var a=r.codePointAt(o);void 0===a&&(a=r.charCodeAt(o)),a>=0&&a<=127?(i|=a<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),u+=1):a>=128&&a<=2047?(i|=(192|a>>>6)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|63&a)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),u+=2):a>=2048&&a<=65535||a>=57344&&a<=65535?(i|=(224|a>>>12)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|a>>>6&63)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|63&a)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),u+=3):a>=65536&&a<=1114111?(i|=(240|a>>>18)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|a>>>12&63)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|a>>>6&63)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=(128|63&a)<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),u+=4):(i|=239<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=191<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),i|=189<<n,32===(n+=8)&&(e=t.mix(e,i),i=0,n=0),u+=3),o=r.offsetByCodePoints(o,1)}return 32!==n&&(e^=i=461845907*(65535&(i=l(i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295),e^u},t.mix=function(e,r){if("number"==typeof r)return r=l(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,15),e=27492+(65535&(e=5*(65535&(e=l(e^=r=461845907*(65535&r)+((461845907*(r>>>16)&65535)<<16)&4294967295,13)))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(e>>>16)&65535)<<16);if("string"==typeof r){if("BE"===i)return t.mixStringBE(e,r);if("LE"===i)return t.mixStringLE(e,r)}else if(r instanceof Uint8Array){if("BE"===i)return t.mixUint8ArrayBE(e,r);if("LE"===i)return t.mixUInt8ArrayLE(e,r)}throw new TypeError(""+r)},t.mash=function(t){return t=2246822507*(65535&(t^=t>>>16))+((2246822507*(t>>>16)&65535)<<16)&4294967295,t=3266489909*(65535&(t^=t>>>13))+((3266489909*(t>>>16)&65535)<<16)&4294967295,(t^=t>>>16)>>>0},t}(),f=function(){function t(){}return t.compare=function(e,r){if(e instanceof Date&&(e=e.getTime()),r instanceof Date&&(r=r.getTime()),void 0===e)return void 0===r?0:1;if(null===e)return void 0===r?-1:null===r?0:1;if("number"==typeof e)return null==r?-1:"number"==typeof r?e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0:1;if("string"==typeof e)return null==r||"number"==typeof r?-1:"string"==typeof r?e<r?-1:e>r?1:0:1;if("object"==typeof e&&"function"==typeof e.compareTo){var i=e.compareTo(r);return i<0?-1:i>0?1:0}return Array.isArray(e)?null==r||"number"==typeof r||"string"==typeof r?-1:Array.isArray(r)?t.compareArray(e,r):1:null==r||"number"==typeof r||"string"==typeof r||Array.isArray(r)?-1:t.compareObject(e,r)},t.compareArray=function(e,r){for(var i=e.length,n=r.length,o=0,s=0,u=Math.min(i,n);s<u&&0===o;s+=1)o=t.compare(e[s],r[s]);return 0!==o?o:i>n?1:i<n?-1:0},t.compareObject=function(e,r){for(var i=Object.keys(e),n=Object.keys(r),o=i.length,s=n.length,u=Math.min(o,s),a=0,h=0;h<u&&0===a;h+=1){var p=i[h],l=n[h];0===(a=t.compare(p,l))&&(a=t.compare(e[p],r[l]))}return 0!==a?a:o>s?1:o<s?-1:0},t.equal=function(e,r){if(e instanceof Date&&(e=e.getTime()),r instanceof Date&&(r=r.getTime()),e===r)return!0;if("number"==typeof e){if("number"==typeof r)return isNaN(e)&&isNaN(r)}else{if("object"==typeof e&&e&&"function"==typeof e.equals)return e.equals(r);if(Array.isArray(e)){if(Array.isArray(r))return t.equalArray(e,r)}else if("object"==typeof e&&e&&"object"==typeof r&&r)return t.equalObject(e,r)}return!1},t.equalArray=function(e,r){var i=e.length;if(i!==r.length)return!1;for(var n=0;n<i;n+=1)if(!t.equal(e[n],r[n]))return!1;return!0},t.equalObject=function(e,r){var i=Object.keys(e),n=Object.keys(r),o=i.length;if(o!==n.length)return!1;for(var s=0;s<o;s+=1){var u=i[s];if(u!==n[s]||!t.equal(e[u],r[u]))return!1}return!0},t.hash=function(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e)return c.hash(e);if("object"==typeof e&&"function"==typeof e.hashCode)return e.hashCode();if(Array.isArray(e))return t.hashArray(e);if("object"==typeof e)return t.hashObject(e);throw new TypeError(""+e)},t.hashArray=function(e){for(var r=0,i=e.length,n=0;n<i;n+=1)r=c.mix(r,t.hash(e[n]));return c.mash(r)},t.hashObject=function(t){for(var e=0,r=Object.keys(t),i=r.length,n=0;n<i;n+=1){var o=r[n];e=c.mix(c.mix(e,c.hash(o)),t[o])}return c.mash(e)},t}(),d={is:function(t){return!!("object"==typeof t&&t||"function"==typeof t)&&"function"==typeof t.fromAny}},y=function(){function t(){}return t.prototype.set=function(t){throw new Error("immutable")},t.prototype.delete=function(){throw new Error("immutable")},t.empty=function(){return t._empty||(t._empty=new t.Empty),t._empty},t.unary=function(e){return new t.Unary(e)},t.array=function(e,r,i){return void 0===r&&(r=0),void 0===i&&(i=e.length),new t.Array(e,r,i)},t}(),v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function _(t,e){function r(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function m(t,e,r,i){var n,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(n=t[u])&&(s=(o<3?n(s):o>3?n(e,r,s):n(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s}function w(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,n++)i[n]=o[s];return i}var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("empty")},e.prototype.step=function(){throw new Error("empty")},e.prototype.skip=function(t){},e.prototype.hasNext=function(){return!1},e.prototype.nextIndex=function(){return 0},e.prototype.next=function(){return{done:!0}},e.prototype.hasPrevious=function(){return!1},e.prototype.previousIndex=function(){return-1},e.prototype.previous=function(){return{done:!0}},e}(y);y.Empty=g;var b=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r._index=0,r}return _(e,t),e.prototype.isEmpty=function(){return 0!==this._index},e.prototype.head=function(){if(0===this._index)return this._value;throw new Error("empty")},e.prototype.step=function(){if(0!==this._index)throw new Error("empty");this._index=1},e.prototype.skip=function(t){this._index=Math.min(Math.max(0,this._index+t),1)},e.prototype.hasNext=function(){return 0===this._index},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){return 0===this._index?(this._index=1,{value:this._value,done:!0}):{done:!0}},e.prototype.hasPrevious=function(){return 1===this._index},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){return 1===this._index?(this._index=0,{value:this._value,done:!0}):{done:!0}},e}(y);y.Unary=b;var x=function(t){function e(e,r,i){var n=t.call(this)||this;return n._array=e,n._index=r,n._limit=i,n}return _(e,t),e.prototype.isEmpty=function(){return this._index>=this._limit},e.prototype.head=function(){if(this._index<this._limit)return this._array[this._index];throw new Error("empty")},e.prototype.step=function(){if(!(this._index<this._limit))throw new Error("empty");this._index=1},e.prototype.skip=function(t){this._index=Math.min(this._index+t,this._limit)},e.prototype.hasNext=function(){return this._index<this._limit},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){var t=this._index;return t<this._limit?(this._index=t+1,{value:this._array[t],done:this._index===this._limit}):(this._index=this._limit,{done:!0})},e.prototype.hasPrevious=function(){return this._index>0},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){var t=this._index-1;return t>=0?(this._index=t,{value:this._array[t],done:0===t}):(this._index=0,{done:!0})},e}(y);y.Array=x;var C=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),S=function(t,e){if(!t)throw new C(e)};S.ok=function(t,e){if(!t)throw new C(e)},S.notOk=function(t,e){if(t)throw new C(e)},S.equal=function(t,e,r){if(!f.equal(t,e))throw new C(r)},S.notEqual=function(t,e,r){if(f.equal(t,e))throw new C(r)},S.identity=function(t,e,r){if(t!==e)throw new C(r)},S.notIdentity=function(t,e,r){if(t===e)throw new C(r)},S.compareLessThan=function(t,e,r){if(!(f.compare(t,e)<0))throw new C(r)},S.compareNotLessThan=function(t,e,r){if(f.compare(t,e)<0)throw new C(r)},S.compareLessThanOrEqual=function(t,e,r){if(!(f.compare(t,e)<=0))throw new C(r)},S.compareNotLessThanOrEqual=function(t,e,r){if(f.compare(t,e)<=0)throw new C(r)},S.compareEqual=function(t,e,r){if(0!==f.compare(t,e))throw new C(r)},S.compareNotEqual=function(t,e,r){if(0===f.compare(t,e))throw new C(r)},S.compareGreaterThanOrEqual=function(t,e,r){if(!(f.compare(t,e)>=0))throw new C(r)},S.compareNotGreaterThanOrEqual=function(t,e,r){if(f.compare(t,e)>=0)throw new C(r)},S.compareGreaterThan=function(t,e,r){if(!(f.compare(t,e)>0))throw new C(r)},S.compareNotGreaterThan=function(t,e,r){if(f.compare(t,e)>0)throw new C(r)};var A=function(){function t(t,e){this._level=t,this._label=e}return t.prototype.level=function(){return this._level},t.prototype.label=function(e){return void 0===e?this._label:t.create(this._level,e)},t.prototype.isTrace=function(){return this._level===t.TRACE_LEVEL},t.prototype.isDebug=function(){return this._level===t.DEBUG_LEVEL},t.prototype.isInfo=function(){return this._level===t.INFO_LEVEL},t.prototype.isNote=function(){return this._level===t.NOTE_LEVEL},t.prototype.isWarning=function(){return this._level===t.WARNING_LEVEL},t.prototype.isError=function(){return this._level===t.ERROR_LEVEL},t.prototype.isAlert=function(){return this._level===t.ALERT_LEVEL},t.prototype.isFatal=function(){return this._level===t.FATAL_LEVEL},t.prototype.compareTo=function(t){return this===t?0:this._level<t._level?-1:this._level>t._level?1:this._label.localeCompare(t._label)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._level===e._level&&this._label===e._label)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(c.mix(t._hashSeed,this._level),c.hash(this._label)))},t.prototype.toString=function(){return this._label},t.create=function(e,r){switch(e){case t.TRACE_LEVEL:return t.trace(r);case t.DEBUG_LEVEL:return t.debug(r);case t.INFO_LEVEL:return t.info(r);case t.NOTE_LEVEL:return t.note(r);case t.WARNING_LEVEL:return t.warning(r);case t.ERROR_LEVEL:return t.error(r);case t.ALERT_LEVEL:return t.alert(r);case t.FATAL_LEVEL:return t.fatal(r);default:throw new Error(""+e)}},t.trace=function(e){return void 0===e&&(e="trace"),"trace"===e?(t._trace||(t._trace=new t(t.TRACE_LEVEL,e)),t._trace):new t(t.TRACE_LEVEL,e)},t.debug=function(e){return void 0===e&&(e="debug"),"debug"===e?(t._debug||(t._debug=new t(t.DEBUG_LEVEL,e)),t._debug):new t(t.DEBUG_LEVEL,e)},t.info=function(e){return void 0===e&&(e="info"),"info"===e?(t._info||(t._info=new t(t.INFO_LEVEL,e)),t._info):new t(t.INFO_LEVEL,e)},t.note=function(e){return void 0===e&&(e="note"),"note"===e?(t._note||(t._note=new t(t.NOTE_LEVEL,e)),t._note):new t(t.NOTE_LEVEL,e)},t.warning=function(e){return void 0===e&&(e="warning"),"warning"===e?(t._warning||(t._warning=new t(t.WARNING_LEVEL,e)),t._warning):new t(t.WARNING_LEVEL,e)},t.error=function(e){return void 0===e&&(e="error"),"error"===e?(t._error||(t._error=new t(t.ERROR_LEVEL,e)),t._error):new t(t.ERROR_LEVEL,e)},t.alert=function(e){return void 0===e&&(e="alert"),"alert"===e?(t._alert||(t._alert=new t(t.ALERT_LEVEL,e)),t._alert):new t(t.ALERT_LEVEL,e)},t.fatal=function(e){return void 0===e&&(e="fatal"),"fatal"===e?(t._fatal||(t._fatal=new t(t.FATAL_LEVEL,e)),t._fatal):new t(t.FATAL_LEVEL,e)},t.TRACE_LEVEL=0,t.DEBUG_LEVEL=1,t.INFO_LEVEL=2,t.NOTE_LEVEL=3,t.WARNING_LEVEL=4,t.ERROR_LEVEL=5,t.ALERT_LEVEL=6,t.FATAL_LEVEL=7,t}(),k=function(){function t(t){this._buckets=new Array(t),this._gen4Hits=0,this._gen3Hits=0,this._gen2Hits=0,this._gen1Hits=0,this._misses=0}return t.prototype.get=function(t){if(0!==this._buckets.length){var e=Math.abs(f.hash(t))%this._buckets.length,r=this._buckets[e];if(r){var i=r._gen4Key;if(void 0!==i&&f.equal(t,i)){var n=r._gen4Val;if(void 0!==n)return this._gen4Hits+=1,r._gen4Weight++,n;r._gen4Key=void 0}var o=r._gen3Key;if(void 0!==o&&f.equal(t,o)){var s=r._gen3Val;if(void 0!==s)return this._gen3Hits+=1,r._gen3Weight++>r._gen4Weight&&(this._buckets[e]=new E(r._gen3Key,r._gen3Val,r._gen3Weight,r._gen4Key,r._gen4Val,r._gen4Weight,r._gen2Key,r._gen2Val,r._gen2Weight,r._gen1Key,r._gen1Val,r._gen1Weight)),s;r._gen3Key=void 0}var u=r._gen2Key;if(void 0!==u&&f.equal(t,u)){var a=r._gen2Val;if(void 0!==a)return this._gen2Hits+=1,r._gen2Weight++>r._gen3Weight&&(this._buckets[e]=new E(r._gen4Key,r._gen4Val,r._gen4Weight,r._gen2Key,r._gen2Val,r._gen2Weight,r._gen3Key,r._gen3Val,r._gen3Weight,r._gen1Key,r._gen1Val,r._gen1Weight)),a;r._gen2Key=void 0}var h=r._gen1Key;if(void 0!==h&&f.equal(t,h)){var p=r._gen1Val;if(void 0!==p)return this._gen1Hits+=1,r._gen1Weight++>r._gen2Weight&&(this._buckets[e]=new E(r._gen4Key,r._gen4Val,r._gen4Weight,r._gen3Key,r._gen3Val,r._gen3Weight,r._gen1Key,r._gen1Val,r._gen1Weight,r._gen2Key,r._gen2Val,r._gen2Weight)),p;r._gen1Key=void 0}this._misses+=1}}},t.prototype.put=function(t,e){if(0===this._buckets.length)return e;var r=Math.abs(f.hash(t))%this._buckets.length,i=this._buckets[r]||new E,n=i._gen4Key;if(void 0!==n&&f.equal(t,n)){var o=i._gen4Val;if(void 0!==o)return this._gen4Hits+=1,i._gen4Weight++,o;i._gen4Key=void 0,n=void 0}var s=i._gen3Key;if(void 0!==s&&f.equal(t,s)){var u=i._gen3Val;if(void 0!==u)return this._gen3Hits+=1,i._gen3Weight++>i._gen4Weight&&(this._buckets[r]=new E(i._gen3Key,i._gen3Val,i._gen3Weight,i._gen4Key,i._gen4Val,i._gen4Weight,i._gen2Key,i._gen2Val,i._gen2Weight,i._gen1Key,i._gen1Val,i._gen1Weight)),u;i._gen3Key=void 0,s=void 0}var a=i._gen2Key;if(void 0!==a&&f.equal(t,a)){var h=i._gen2Val;if(void 0!==h)return this._gen2Hits+=1,i._gen2Weight++>i._gen3Weight&&(this._buckets[r]=new E(i._gen4Key,i._gen4Val,i._gen4Weight,i._gen2Key,i._gen2Val,i._gen2Weight,i._gen3Key,i._gen3Val,i._gen3Weight,i._gen1Key,i._gen1Val,i._gen1Weight)),h;i._gen2Key=void 0,a=void 0}var p=i._gen1Key;if(void 0!==p&&f.equal(t,p)){var l=i._gen1Val;if(void 0!==l)return this._gen1Hits+=1,i._gen1Weight++>i._gen2Weight&&(this._buckets[r]=new E(i._gen4Key,i._gen4Val,i._gen4Weight,i._gen3Key,i._gen3Val,i._gen3Weight,i._gen1Key,i._gen1Val,i._gen1Weight,i._gen2Key,i._gen2Val,i._gen2Weight)),l;i._gen1Key=void 0,p=void 0}return this._misses+=1,this._buckets[r]=void 0===n?new E(i._gen3Key,i._gen3Val,i._gen3Weight,i._gen2Key,i._gen2Val,i._gen2Weight,i._gen1Key,i._gen1Val,i._gen1Weight,t,e,1):void 0===s?new E(i._gen4Key,i._gen4Val,i._gen4Weight,i._gen2Key,i._gen2Val,i._gen2Weight,i._gen1Key,i._gen1Val,i._gen1Weight,t,e,1):void 0===a?new E(i._gen4Key,i._gen4Val,i._gen4Weight,i._gen3Key,i._gen3Val,i._gen3Weight,i._gen1Key,i._gen1Val,i._gen1Weight,t,e,1):void 0===p?new E(i._gen4Key,i._gen4Val,i._gen4Weight,i._gen3Key,i._gen3Val,i._gen3Weight,i._gen2Key,i._gen2Val,i._gen2Weight,t,e,1):new E(i._gen4Key,i._gen4Val,i._gen4Weight-1,i._gen3Key,i._gen3Val,i._gen3Weight-1,i._gen1Key,i._gen1Val,i._gen1Weight,t,e,1),e},t.prototype.remove=function(t){if(0!==this._buckets.length){var e=Math.abs(f.hash(t))%this._buckets.length,r=this._buckets[e];if(r){var i=r._gen4Key;if(void 0!==i&&f.equal(t,i)){var n=r._gen4Val;return this._buckets[e]=new E(r._gen3Key,r._gen3Val,r._gen3Weight,r._gen2Key,r._gen2Val,r._gen2Weight,r._gen1Key,r._gen1Val,r._gen1Weight,void 0,void 0,0),n}var o=r._gen3Key;if(void 0!==o&&f.equal(t,o)){var s=r._gen3Val;return this._buckets[e]=new E(r._gen4Key,r._gen4Val,r._gen4Weight,r._gen2Key,r._gen2Val,r._gen2Weight,r._gen1Key,r._gen1Val,r._gen1Weight,void 0,void 0,0),s}var u=r._gen2Key;if(void 0!==u&&f.equal(t,u)){var a=r._gen2Val;return this._buckets[e]=new E(r._gen4Key,r._gen4Val,r._gen4Weight,r._gen3Key,r._gen3Val,r._gen3Weight,r._gen1Key,r._gen1Val,r._gen1Weight,void 0,void 0,0),a}var h=r._gen1Key;if(void 0!==h&&f.equal(t,h)){var p=r._gen1Val;return this._buckets[e]=new E(r._gen4Key,r._gen4Val,r._gen4Weight,r._gen3Key,r._gen3Val,r._gen3Weight,r._gen2Key,r._gen2Val,r._gen2Weight,void 0,void 0,0),p}}}},t.prototype.clear=function(){for(var t=0;t<this._buckets.length;t+=1)this._buckets[t]=void 0},t.prototype.hits=function(){return this._gen4Hits+this._gen3Hits+this._gen2Hits+this._gen1Hits},t.prototype.hitRatio=function(){var t=this.hits();return t/(t+this._misses)},t}(),E=function(t,e,r,i,n,o,s,u,a,h,p,l){void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===l&&(l=0),this._gen4Key=t,this._gen4Val=e,this._gen4Weight=r,this._gen3Key=i,this._gen3Val=n,this._gen3Weight=o,this._gen2Key=s,this._gen2Val=u,this._gen2Weight=a,this._gen1Key=h,this._gen1Val=p,this._gen1Weight=l},O=function(){function t(t){this._buckets=new Array(t),this._gen4Hits=0,this._gen3Hits=0,this._gen2Hits=0,this._gen1Hits=0,this._misses=0}return t.prototype.put=function(t){if(0===this._buckets.length)return t;var e=Math.abs(f.hash(t))%this._buckets.length,r=this._buckets[e]||new V,i=r._gen4Val;if(void 0!==i&&f.equal(t,i))return this._gen4Hits+=1,r._gen4Weight++,i;var n=r._gen3Val;if(void 0!==n&&f.equal(t,n))return this._gen3Hits+=1,r._gen3Weight++>r._gen4Weight&&(this._buckets[e]=new V(r._gen3Val,r._gen3Weight,r._gen4Val,r._gen4Weight,r._gen2Val,r._gen2Weight,r._gen1Val,r._gen1Weight)),n;var o=r._gen2Val;if(void 0!==o&&f.equal(t,o))return this._gen2Hits+=1,r._gen2Weight++>r._gen3Weight&&(this._buckets[e]=new V(r._gen4Val,r._gen4Weight,r._gen2Val,r._gen2Weight,r._gen3Val,r._gen3Weight,r._gen1Val,r._gen1Weight)),o;var s=r._gen1Val;return void 0!==s&&f.equal(t,s)?(this._gen1Hits+=1,r._gen1Weight++>r._gen2Weight&&(this._buckets[e]=new V(r._gen4Val,r._gen4Weight,r._gen3Val,r._gen3Weight,r._gen1Val,r._gen1Weight,r._gen2Val,r._gen2Weight)),s):(this._misses+=1,this._buckets[e]=void 0===i?new V(r._gen3Val,r._gen3Weight,r._gen2Val,r._gen2Weight,r._gen1Val,r._gen1Weight,t,1):void 0===n?new V(r._gen4Val,r._gen4Weight,r._gen2Val,r._gen2Weight,r._gen1Val,r._gen1Weight,t,1):void 0===o?new V(r._gen4Val,r._gen4Weight,r._gen3Val,r._gen3Weight,r._gen1Val,r._gen1Weight,t,1):void 0===s?new V(r._gen4Val,r._gen4Weight,r._gen3Val,r._gen3Weight,r._gen2Val,r._gen2Weight,t,1):new V(r._gen4Val,r._gen4Weight-1,r._gen3Val,r._gen3Weight-1,r._gen1Val,r._gen1Weight,t,1),t)},t.prototype.remove=function(t){if(0===this._buckets.length)return!1;var e=Math.abs(f.hash(t))%this._buckets.length,r=this._buckets[e];if(!r)return!1;var i=r._gen4Val;if(void 0!==i&&f.equal(t,i))return this._buckets[e]=new V(r._gen3Val,r._gen3Weight,r._gen2Val,r._gen2Weight,r._gen1Val,r._gen1Weight,void 0,0),!0;var n=r._gen3Val;if(void 0!==n&&f.equal(t,n))return this._buckets[e]=new V(r._gen4Val,r._gen4Weight,r._gen2Val,r._gen2Weight,r._gen1Val,r._gen1Weight,void 0,0),!0;var o=r._gen2Val;if(void 0!==o&&f.equal(t,o))return this._buckets[e]=new V(r._gen4Val,r._gen4Weight,r._gen3Val,r._gen3Weight,r._gen1Val,r._gen1Weight,void 0,0),!0;var s=r._gen1Val;return!(void 0===s||!f.equal(t,s))&&(this._buckets[e]=new V(r._gen4Val,r._gen4Weight,r._gen3Val,r._gen3Weight,r._gen2Val,r._gen2Weight,void 0,0),!0)},t.prototype.clear=function(){for(var t=0;t<this._buckets.length;t+=1)this._buckets[t]=void 0},t.prototype.hits=function(){return this._gen4Hits+this._gen3Hits+this._gen2Hits+this._gen1Hits},t.prototype.hitRatio=function(){var t=this.hits();return t/(t+this._misses)},t}(),V=function(t,e,r,i,n,o,s,u){void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=0),this._gen4Val=t,this._gen4Weight=e,this._gen3Val=r,this._gen3Weight=i,this._gen2Val=n,this._gen2Weight=o,this._gen1Val=s,this._gen1Weight=u},P=function(){},D=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._offset=e,o._line=r,o._column=i,o._note=n,o}return _(e,t),e.prototype.offset=function(){return this._offset},e.prototype.line=function(){return this._line},e.prototype.column=function(){return this._column},e.prototype.note=function(){return this._note},e.prototype.min=function(t){return this._offset<=t._offset?this:t},e.prototype.max=function(t){return this._offset>=t._offset?this:t},e.prototype.start=function(){return this},e.prototype.end=function(){return this},e.prototype.union=function(t){if(t instanceof e)return this._offset===t._offset&&this._line===t._line&&this._column===t._column?this:P.Span.from(this,t);if(t instanceof P.Span){var r=this.min(t._start),i=this.max(t._end);return r===t._start&&i===t._end?t:P.Span.from(r,i)}throw new Error(t.toString())},e.prototype.shift=function(t){var r=this._offset+(this._offset-t._offset),i=this._line+(this._line-t._line),n=this._column;return 1===i&&(n+=this._column-t._column),r===this._offset&&i===this._line&&n===this._column?this:e.at(r,i,n,this._note)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._offset===t._offset&&this._line===t._line&&this._column===t._column&&this._note===t._note)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(e._hashSeed,this._offset),this._line),this._column),c.hash(this._note)))},e.prototype.display=function(t){P.Format.displayNumber(this._line,t),t=t.write(58),P.Format.displayNumber(this._column,t),null!==this._note&&(t=t.write(58).write(32).write(this._note))},e.prototype.debug=function(t){t=t.write("Mark").write(".").write("at").write("("),P.Format.debugNumber(this._offset,t),t=t.write(", "),P.Format.debugNumber(this._line,t),t=t.write(", "),P.Format.debugNumber(this._column,t),null!==this._note&&(t=t.write(", "),P.Format.debugString(this._note,t)),t=t.write(")")},e.prototype.toString=function(){return P.Format.display(this)},e.zero=function(){return e._zero||(e._zero=new e(0,1,1,null)),e._zero},e.at=function(t,r,i,n){return void 0===n&&(n=null),new e(t,r,i,n)},e}(P);P.Mark=D;var M=function(t){function e(e,r){var i=t.call(this)||this;return i._start=e,i._end=r,i}return _(e,t),e.prototype.start=function(){return this._start},e.prototype.end=function(){return this._end},e.prototype.union=function(t){if(t instanceof P.Mark){var r=this._start.min(t),i=this._end.max(t);return r===this._start&&i===this._end?this:e.from(r,i)}if(t instanceof e){r=this._start.min(t._start),i=this._end.max(t._end);return r===this._start&&i===this._end?this:e.from(r,i)}throw new Error(t.toString())},e.prototype.shift=function(t){var r=this._start.shift(t),i=this._end.shift(t);return r===this._start&&i===this._end?this:e.from(r,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._start.equals(t._start)&&this._end.equals(t._end))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._start.hashCode()),this._end.hashCode()))},e.prototype.display=function(t){null!==this._start._note&&(t=t.write(this._start._note).write(58).write(32)),P.Format.displayNumber(this._start._line,t),t=t.write(58),P.Format.displayNumber(this._start._column,t),t=t.write(45),P.Format.displayNumber(this._end._line,t),t=t.write(58),P.Format.displayNumber(this._end._column,t),null!==this._end._note&&(t=t.write(58).write(32).write(this._end._note))},e.prototype.debug=function(t){t=t.write("Span").write(".").write("from").write("("),this._start.debug(t),t=t.write(", "),this._end.debug(t),t=t.write(")")},e.prototype.toString=function(){return P.Format.display(this)},e.from=function(t,r){if(t._offset>r._offset){var i=t;t=r,r=i}return new e(t,r)},e}(P);P.Span=M;var T=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),R=function(){function t(t,e,r){this._lineSeparator=t,this._isPretty=e,this._isStyled=r}return t.prototype.lineSeparator=function(t){return void 0===t?this._lineSeparator:this.copy(t,this._isPretty,this._isStyled)},t.prototype.isPretty=function(t){return void 0===t?this._isPretty:this.copy(this._lineSeparator,t,this._isStyled)},t.prototype.isStyled=function(t){return void 0===t?this._isStyled:this.copy(this._lineSeparator,this._isPretty,t)},t.prototype.copy=function(e,r,i){return t.create(e,r,i)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this._lineSeparator===e._lineSeparator&&this._isPretty===e._isPretty&&this._isStyled===e._isStyled)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(c.mix(c.mix(t._hashSeed,c.hash(this._lineSeparator)),c.hash(this._isPretty)),c.hash(this._isStyled)))},t.prototype.debug=function(t){t=t.write("OutputSettings").write(46),t=(t=this._isPretty||this._isStyled?this._isPretty&&!this._isStyled?t.write("pretty"):!this._isPretty&&this._isStyled?t.write("styled"):t.write("prettyStyled"):t.write("standard")).write(40).write(41),J.lineSeparator()!==this._lineSeparator&&(t=t.write(46).write("lineSeparator").write(40).display(this._lineSeparator).write(41))},t.prototype.toString=function(){return J.debug(this)},t.standard=function(){return t._standard||(t._standard=new t(J.lineSeparator(),!1,!1)),t._standard},t.pretty=function(){return t._pretty||(t._pretty=new t(J.lineSeparator(),!0,!1)),t._pretty},t.styled=function(){return t._styled||(t._styled=new t(J.lineSeparator(),!1,!0)),t._styled},t.prettyStyled=function(){return t._prettyStyled||(t._prettyStyled=new t(J.lineSeparator(),!0,!0)),t._prettyStyled},t.create=function(e,r,i){return"string"!=typeof e&&(e=J.lineSeparator()),"boolean"!=typeof r&&(r=!1),"boolean"!=typeof i&&(i=!1),J.lineSeparator()===e?r||i?r&&!i?t.pretty():!r&&i?t.styled():t.prettyStyled():t.standard():new t(e,r,i)},t.fromAny=function(e){return e instanceof t?e:"object"==typeof e&&e?t.create(e.lineSeparator,e.isPretty,e.isStyled):t.standard()},t}(),I=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),F=function(){function t(){}return t.prototype.writeln=function(t){return"string"==typeof t&&this.write(t),this.write(this.settings().lineSeparator())},t.prototype.display=function(t){return J.display(t,this),this},t.prototype.debug=function(t){return J.debug(t,this),this},t.prototype.flush=function(){return this},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length,i=0;i<r;i+=1)this.write(t[i])},t.prototype.trap=function(){throw new I},t.prototype.clone=function(){throw new Error},t.full=function(e,r){return void 0===e&&(e=null),void 0===r&&(r=R.standard()),null===e&&r===R.standard()?(t._full||(t._full=new L(e,R.standard())),t._full):new L(e,r)},t.done=function(e,r){return void 0===e&&(e=null),void 0===r&&(r=R.standard()),null===e&&r===R.standard()?(t._done||(t._done=new U(e,R.standard())),t._done):new U(e,r)},t.error=function(t,e){return void 0===e&&(e=R.standard()),new N(t,e)},t}(),L=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t||(t?F.done(this._value,this._settings):this)},e.prototype.write=function(t){return F.error(new I("full"),this._settings)},e.prototype.writeln=function(t){return F.error(new I("full"),this._settings)},e.prototype.bind=function(){return this._value},e.prototype.settings=function(t){return void 0===t?this._settings:F.full(this._value,t)},e.prototype.clone=function(){return this},e}(F),U=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&(t?this:F.full(this._value,this._settings))},e.prototype.write=function(t){return F.error(new I("done"),this._settings)},e.prototype.writeln=function(t){return F.error(new I("done"),this._settings)},e.prototype.bind=function(){return this._value},e.prototype.settings=function(t){return void 0===t?this._settings:F.done(this._value,t)},e.prototype.clone=function(){return this},e}(F),N=function(t){function e(e,r){var i=t.call(this)||this;return i._error=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.write=function(t){return this},e.prototype.writeln=function(t){return this},e.prototype.bind=function(){throw new I},e.prototype.trap=function(){return this._error},e.prototype.settings=function(t){return void 0===t?this._settings:F.error(this._error,t)},e.prototype.clone=function(){return this},e}(F),z=function(){function t(){}return t.prototype.trap=function(){throw new T},t.prototype.offset=function(){return this.mark()._offset},t.prototype.line=function(){return this.mark()._line},t.prototype.column=function(){return this.mark()._column},t.empty=function(e,r,i){return void 0===e&&(e=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),null===e&&r===D.zero()&&i===tt.standard()?(t._empty||(t._empty=new j(null,D.zero(),tt.standard())),t._empty):new j(e,r,i)},t.done=function(e,r,i){return void 0===e&&(e=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),null===e&&r===D.zero()&&i===tt.standard()?(t._done||(t._done=new W(null,D.zero(),tt.standard())),t._done):new W(e,r,i)},t.error=function(t,e,r,i){return void 0===e&&(e=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),new q(t,e,r,i)},t}(),j=function(t){function e(e,r,i){var n=t.call(this)||this;return n._id=e,n._mark=r,n._settings=i,n}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t||(t?this:z.done(this._id,this._mark,this._settings))},e.prototype.head=function(){throw new T},e.prototype.step=function(){var t=new T("empty step");return z.error(t,this._id,this._mark,this._settings)},e.prototype.seek=function(t){var e=new T("empty seek");return z.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:z.empty(t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:z.empty(this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:z.empty(this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(z),W=function(t){function e(e,r,i){var n=t.call(this)||this;return n._id=e,n._mark=r,n._settings=i,n}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&(t?z.empty(this._id,this._mark,this._settings):this)},e.prototype.head=function(){throw new T},e.prototype.step=function(){var t=new T("done step");return z.error(t,this._id,this._mark,this._settings)},e.prototype.seek=function(t){var e=new T("empty seek");return z.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:z.done(t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:z.done(this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:z.done(this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(z),q=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._error=e,o._id=r,o._mark=i,o._settings=n,o}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.head=function(){throw new T},e.prototype.step=function(){var t=new T("error step");return z.error(t,this._id,this._mark,this._settings)},e.prototype.trap=function(){return this._error},e.prototype.seek=function(t){var e=new T("error seek");return z.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:z.error(this._error,t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:z.error(this._error,this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:z.error(this._error,this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(z),B=function(t){function e(e,r,i,n,o,s,u,a){void 0===r&&(r=null),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=1),void 0===s&&(s=tt.standard()),void 0===u&&(u=0),void 0===a&&(a=!1);var h=t.call(this)||this;return h._string=e,h._id=r,h._offset=i,h._line=n,h._column=o,h._settings=s,h._index=u,h._isPart=a,h}return _(e,t),e.prototype.isCont=function(){return this._index<this._string.length},e.prototype.isEmpty=function(){return this._isPart&&this._index>=this._string.length},e.prototype.isDone=function(){return!this._isPart&&this._index>=this._string.length},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t?this._isPart:(this._isPart=t,this)},e.prototype.head=function(){if(this._index<this._string.length){var t=this._string.codePointAt(this._index);return void 0!==t?t:this._string.charCodeAt(this._index)}throw new T},e.prototype.step=function(){var t=this._index;if(t<this._string.length){var e=this._string.codePointAt(t);return this._index=this._string.offsetByCodePoints(t,1),this._offset+=this._index-t,10===e?(this._line+=1,this._column=1):this._column+=1,this}var r=new T("invalid step");return z.error(r,this._id,this.mark(),this._settings)},e.prototype.seek=function(t){if(void 0!==t){var e=this._index+(t._offset-this._offset);if(0<=e&&e<=this._string.length)return this._offset=t._offset,this._line=t._line,this._column=t._column,this._index=e,this;var r=new T("invalid seek to "+t);return z.error(r,this._id,this.mark(),this._settings)}return this._offset=0,this._line=1,this._column=1,this._index=0,this},e.prototype.id=function(t){return void 0===t?this._id:(this._id=t,this)},e.prototype.mark=function(t){return void 0===t?D.at(this._offset,this._line,this._column):(this._offset=t._offset,this._line=t._line,this._column=t._column,this)},e.prototype.offset=function(){return this._offset},e.prototype.line=function(){return this._line},e.prototype.column=function(){return this._column},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=tt.fromAny(t),this)},e.prototype.clone=function(){return new e(this._string,this._id,this._offset,this._line,this._column,this._settings,this._index,this._isPart)},e}(z),K=function(t){function e(e,r){var i=t.call(this)||this;return i._string=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.write=function(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){var e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="ï¿½";return this._string+=t,this},e.prototype.writeln=function(t){return void 0===t?(this._string=this._string.concat(this._settings._lineSeparator),this):(this._string=this._string.concat(t).concat(this._settings._lineSeparator),this)},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=R.fromAny(t),this)},e.prototype.bind=function(){return this._string},e.prototype.clone=function(){return new e(this._string,this._settings)},e.prototype.toString=function(){return this._string},e}(F),H=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),G=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.feed=function(t){throw new Error},t.prototype.fork=function(t){return this},t.prototype.bind=function(){throw new Error},t.prototype.trap=function(){throw new Error},t.prototype.asDone=function(){throw new Error},t.prototype.asError=function(){throw new Error},t.prototype.andThen=function(t){return new Z(this,t)},t.done=function(e){return void 0===e?(t._done||(t._done=new X(void 0)),t._done):new X(e)},t.error=function(t){return new Y(t)},t}(),X=function(t){function e(e){var r=t.call(this)||this;return r._output=e,r}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.pull=function(t){return this},e.prototype.bind=function(){return this._output},e.prototype.asDone=function(){return this},e.prototype.andThen=function(t){return t},e}(G),Y=function(t){function e(e){var r=t.call(this)||this;return r._error=e,r}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.pull=function(t){return this},e.prototype.bind=function(){throw this._error},e.prototype.trap=function(){return this._error},e.prototype.asError=function(){return this},e.prototype.andThen=function(t){return this},e}(G),Z=function(t){function e(e,r){var i=t.call(this)||this;return i._head=e,i._tail=r,i}return _(e,t),e.prototype.pull=function(t){var r=this._head;return r.isCont()&&(r=r.pull(t)),r.isError()?r.asError():r.isDone()?this._tail.pull(t):new e(r,this._tail)},e}(G),Q=function(t){function e(e,r,i){void 0===i&&(i=0);var n=t.call(this)||this;return n._value=e,n._input=r,n._index=i,n}return _(e,t),e.prototype.feed=function(t){return new e(t,""+t)},e.prototype.pull=function(t){return e.write(t,this._value,this._input,this._index)},e.write=function(t,r,i,n){void 0===n&&(n=0);for(var o=i.length;n<o&&t.isCont();){var s=i.codePointAt(n);void 0===s&&(s=i.charCodeAt(n)),t=t.write(s),n=i.offsetByCodePoints(n,1)}return n===o?G.done(r):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e}(G),$=function(){function t(){}return t.stringInput=function(t){return new B(t)},t.stringOutput=function(t,e){return void 0===e&&"string"!=typeof t?(e=t,t=""):"string"!=typeof t&&(t=""),e=R.fromAny(e),new K(t,e)},t.stringWriter=function(t){return void 0===t?new Q(void 0,""):new Q(t,""+t)},t.writeString=function(t,e){return Q.write(e,void 0,""+t)},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.isSpace=function(t){return 32===t||9===t},t.isNewline=function(t){return 10===t||13===t},t.isWhitespace=function(e){return t.isSpace(e)||t.isNewline(e)},t}(),J=function(){function e(){}return e.display=function(t,r){var i=!(r instanceof F);if(void 0===t){if(void 0===r)return"undefined";r instanceof F||(r=$.stringOutput(r)),r=r.write("undefined")}else if(null===t){if(void 0===r)return"null";r instanceof F||(r=$.stringOutput(r)),r=r.write("null")}else if("number"==typeof t){if(void 0===r)return""+t;r instanceof F||(r=$.stringOutput(r)),e.displayNumber(t,r)}else if("string"==typeof t){if(void 0===r)return t;r instanceof F||(r=$.stringOutput(r)),r=r.write(t)}else if(t&&"function"==typeof t.display)r instanceof F||(r=$.stringOutput(r)),t.display(r);else{if(void 0===r)return""+t;r instanceof F||(r=$.stringOutput(r)),r=r.write(""+t)}if(i)return r.toString()},e.debug=function(t,r){var i=!(r instanceof F);if(void 0===t){if(void 0===r)return"undefined";r instanceof F||(r=$.stringOutput(r)),r=r.write("undefined")}else if(null===t){if(void 0===r)return"null";r instanceof F||(r=$.stringOutput(r)),r=r.write("null")}else if("number"==typeof t){if(void 0===r)return""+t;r instanceof F||(r=$.stringOutput(r)),e.debugNumber(t,r)}else if("string"==typeof t)r instanceof F||(r=$.stringOutput(r)),e.debugString(t,r);else if("function"==typeof t.debug)r instanceof F||(r=$.stringOutput(r)),t.debug(r);else{if(void 0===r)return""+t;r instanceof F||(r=$.stringOutput(r)),r=r.write(""+t)}if(i)return r.toString()},e.displayNumber=function(t,e){if(isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648)if(t<0&&(e=e.write(45)),t>-10&&t<10)e=e.write(48+Math.abs(t));else{for(var r=new Array(19),i=t,n=18;i;)r[n]=Math.abs(i%10|0),i=i/10|0,n-=1;for(n+=1;n<19;)e=e.write(48+r[n]),n+=1}else e=e.write(""+t)},e.debugNumber=function(t,r){e.displayNumber(t,r)},e.debugChar=function(t,r){switch(r=r.write(39),t){case 8:r.write(92).write(98);break;case 9:r.write(92).write(116);break;case 10:r.write(92).write(110);break;case 12:r.write(92).write(102);break;case 13:r.write(92).write(114);break;case 34:r.write(92).write(34);break;case 39:r.write(92).write(39);break;case 92:r.write(92).write(92);break;default:r=t>=0&&t<=31||t>=127&&t<=159?r.write(92).write(117).write(e.encodeHex(t>>>12&15)).write(e.encodeHex(t>>>8&15)).write(e.encodeHex(t>>>4&15)).write(e.encodeHex(15&t)):r.write(t)}r=r.write(39)},e.debugString=function(t,r){r=r.write(34);for(var i=$.stringInput(t);i.isCont();){var n=i.head();switch(n){case 8:r.write(92).write(98);break;case 9:r.write(92).write(116);break;case 10:r.write(92).write(110);break;case 12:r.write(92).write(102);break;case 13:r.write(92).write(114);break;case 34:r.write(92).write(34);break;case 92:r.write(92).write(92);break;default:r=n>=0&&n<=31||n>=127&&n<=159?r.write(92).write(117).write(e.encodeHex(n>>>12&15)).write(e.encodeHex(n>>>8&15)).write(e.encodeHex(n>>>4&15)).write(e.encodeHex(15&n)):r.write(n)}i=i.step()}r=r.write(34)},e.encodeHex=function(t){return t<10?48+t:t-10+65},e.lineSeparator=function(){if(!e._lineSeparator){if("object"==typeof t&&"undefined"!=typeof module&&"function"==typeof require){var r=require("os");r&&(e._lineSeparator=r.EOL)}e._lineSeparator||(e._lineSeparator="\n")}return e._lineSeparator},e.prefix=function(t,r){if(void 0===r&&(r=1),isFinite(t)){var i=Math.abs(t).toExponential(),n=i.indexOf("e"),o=n>=0?+i.slice(n+1):NaN,s=3*Math.min(Math.max(-8,Math.floor(o/3)),8),u=Math.pow(10,-s)*t,a=e.trimTrailingZeros(Math.abs(u).toFixed(r));return u<0&&0!=+a&&(a="-"+a),a+=e.Prefixes[8+s/3]}return""+t},e.trimTrailingZeros=function(t){for(var e,r=-1,i=1,n=t.length;i<n;i+=1){var o=t.charCodeAt(i);if(46===o)r=i,e=i;else if(48===o)0===r&&(r=i),e=i;else if(o>=49&&o<=57)r>0&&(r=0);else if(r>0)break}return r>0&&(t=t.slice(0,r)+t.slice(e+1)),t},e.duration=function(t,e){if(void 0===e&&(e=" "),isFinite(t)){var r=864e5,i=void 0;t>6048e5&&(i=Math.floor(t/6048e5),t%=6048e5);var n=void 0;t>r&&(n=Math.floor(t/r),t%=r);var o=void 0;t>36e5&&(o=Math.floor(t/36e5),t%=36e5);var s=void 0;t>6e4&&(s=Math.floor(t/6e4),t%=6e4);var u=void 0;t>1e3&&(u=Math.floor(t/1e3),t%=1e3);var a="";return void 0!==i&&(a+=i+"w"),void 0!==n&&(a+=(a?e:"")+n+"d"),void 0!==o&&(a+=(a?e:"")+o+"h"),void 0!==s&&(a+=(a?e:"")+s+"m"),void 0===u&&t||(a+=(a?e:"")+(u||0)+"s"),t&&!a&&(a+=t+"ms"),a}return""+t},e.Prefixes=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E"," Z","Y"],e}();P.Format=J;var tt=function(){function t(t){this._isStrict=t}return t.prototype.isStripped=function(t){return void 0===t?this._isStrict:this.copy(t)},t.prototype.copy=function(e){return t.create(e)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this._isStrict===e._isStrict)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(t._hashSeed,c.hash(this._isStrict)))},t.prototype.debug=function(t){t=t.write("InputSettings").write(46),t=(t=this._isStrict?t.write("stripped"):t.write("standard")).write(40).write(41)},t.prototype.toString=function(){return J.debug(this)},t.standard=function(){return t._standard||(t._standard=new t(!1)),t._standard},t.stripped=function(){return t._stripped||(t._stripped=new t(!1)),t._stripped},t.create=function(e){return e?t.stripped():t.standard()},t.fromAny=function(e){return e instanceof t?e:"object"==typeof e&&e?t.create(e.isStripped):t.standard()},t}(),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.empty=function(t,r,i){return void 0===t&&(t=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),null===t&&r===D.zero()&&i===tt.standard()?(e._emptyBuffer||(e._emptyBuffer=new rt(null,D.zero(),tt.standard())),e._emptyBuffer):new rt(t,r,i)},e.done=function(t,r,i){return void 0===t&&(t=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),null===t&&r===D.zero()&&i===tt.standard()?(e._doneBuffer||(e._doneBuffer=new it(null,D.zero(),tt.standard())),e._doneBuffer):new it(t,r,i)},e.error=function(t,e,r,i){return void 0===e&&(e=null),void 0===r&&(r=D.zero()),void 0===i&&(i=tt.standard()),new nt(t,e,r,i)},e}(z),rt=function(t){function e(e,r,i){var n=t.call(this)||this;return n._id=e,n._mark=r,n._settings=i,n}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t||(t?this:et.done(this._id,this._mark,this._settings))},e.prototype.index=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid index");return et.error(e,this._id,this._mark,this._settings)},e.prototype.limit=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid limit");return et.error(e,this._id,this._mark,this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new T},e.prototype.set=function(t,e){throw new T},e.prototype.head=function(){throw new T},e.prototype.step=function(t){var e=new T("empty step");return et.error(e,this._id,this._mark,this._settings)},e.prototype.seek=function(t){var e=new T("empty seek");return et.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:et.empty(t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:et.empty(this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:et.empty(this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(et),it=function(t){function e(e,r,i){var n=t.call(this)||this;return n._id=e,n._mark=r,n._settings=i,n}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&(t?et.empty(this._id,this._mark,this._settings):this)},e.prototype.index=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid index");return et.error(e,this._id,this._mark,this._settings)},e.prototype.limit=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid limit");return et.error(e,this._id,this._mark,this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new T},e.prototype.set=function(t,e){throw new T},e.prototype.head=function(){throw new T},e.prototype.step=function(t){var e=new T("done step");return et.error(e,this._id,this._mark,this._settings)},e.prototype.seek=function(t){var e=new T("done seek");return et.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:et.done(t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:et.done(this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:et.done(this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(et),nt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._error=e,o._id=r,o._mark=i,o._settings=n,o}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.index=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid index");return et.error(e,this._id,this._mark,this._settings)},e.prototype.limit=function(t){if(void 0===t)return 0;if(0===t)return this;var e=new T("invalid limit");return et.error(e,this._id,this._mark,this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new T},e.prototype.set=function(t,e){throw new T},e.prototype.head=function(){throw new T},e.prototype.step=function(t){var e=new T("error step");return et.error(e,this._id,this._mark,this._settings)},e.prototype.trap=function(){return this._error},e.prototype.seek=function(t){var e=new T("error seek");return et.error(e,this._id,this._mark,this._settings)},e.prototype.id=function(t){return void 0===t?this._id:et.error(this._error,t,this._mark,this._settings)},e.prototype.mark=function(t){return void 0===t?this._mark:et.error(this._error,this._id,t,this._settings)},e.prototype.settings=function(t){return void 0===t?this._settings:et.error(this._error,this._id,this._mark,t)},e.prototype.clone=function(){return this},e}(et),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeln=function(t){return"string"==typeof t&&this.write(t),this.write(this.settings().lineSeparator())},e.prototype.display=function(t){return J.display(t,this),this},e.prototype.debug=function(t){return J.debug(t,this),this},e.prototype.flush=function(){return this},e.prototype.clone=function(){throw new Error},e.full=function(t,r){return void 0===t&&(t=null),void 0===r&&(r=R.standard()),null===t&&r===R.standard()?(e._fullBuffer||(e._fullBuffer=new st(t,R.standard())),e._fullBuffer):new st(t,r)},e.done=function(t,r){return void 0===t&&(t=null),void 0===r&&(r=R.standard()),null===t&&r===R.standard()?(e._doneBuffer||(e._doneBuffer=new ut(t,R.standard())),e._doneBuffer):new ut(t,r)},e.error=function(t,e){return void 0===e&&(e=R.standard()),new at(t,e)},e}(F),st=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t||(t?ot.done(this._value,this._settings):this)},e.prototype.index=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.limit=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new I},e.prototype.set=function(t,e){throw new I},e.prototype.write=function(t){return ot.error(new I("full"),this._settings)},e.prototype.writeln=function(t){return ot.error(new I("full"),this._settings)},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:ot.error(new I("invalid step"),this._settings)},e.prototype.bind=function(){return this._value},e.prototype.settings=function(t){return void 0===t?this._settings:ot.full(this._value,t)},e.prototype.clone=function(){return this},e}(ot),ut=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&(t?this:ot.full(this._value,this._settings))},e.prototype.index=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.limit=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new I},e.prototype.set=function(t,e){throw new I},e.prototype.write=function(t){return ot.error(new I("done"),this._settings)},e.prototype.writeln=function(t){return ot.error(new I("done"),this._settings)},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:ot.error(new I("invalid step"),this._settings)},e.prototype.bind=function(){return this._value},e.prototype.settings=function(t){return void 0===t?this._settings:ot.done(this._value,t)},e.prototype.clone=function(){return this},e}(ot),at=function(t){function e(e,r){var i=t.call(this)||this;return i._error=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.index=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.limit=function(t){return void 0===t?0:0===t?this:ot.error(new I("invalid index"),this._settings)},e.prototype.capacity=function(){return 0},e.prototype.remaining=function(){return 0},e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new I},e.prototype.set=function(t,e){throw new I},e.prototype.write=function(t){return this},e.prototype.writeln=function(t){return this},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:ot.error(new I("invalid step"),this._settings)},e.prototype.bind=function(){throw new I},e.prototype.trap=function(){return this._error},e.prototype.settings=function(t){return void 0===t?this._settings:ot.error(this._error,t)},e.prototype.clone=function(){return this},e}(ot),ht=function(){function t(){}return t.reset=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(109))},t.bold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(109))},t.faint=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(50).write(109))},t.black=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(48).write(109))},t.red=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(49).write(109))},t.green=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(50).write(109))},t.yellow=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(51).write(109))},t.blue=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(52).write(109))},t.magenta=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(53).write(109))},t.cyan=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(54).write(109))},t.gray=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(55).write(109))},t.blackBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(48).write(109))},t.redBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(49).write(109))},t.greenBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(50).write(109))},t.yellowBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(51).write(109))},t.blueBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(52).write(109))},t.magentaBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(53).write(109))},t.cyanBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(54).write(109))},t.grayBold=function(t){t.settings().isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(55).write(109))},t}(),pt=function(){function t(){}return t.isDigit=function(t){return t>=48&&t<=57},t.decodeDigit=function(t){if(t>=48&&t<=57)return t-48;var e=$.stringOutput();throw e.write("Invalid base-10 digit: "),J.debugChar(t,e),new Error(e.bind())},t.encodeDigit=function(t){if(t>=0&&t<=9)return 48+t;throw new Error(""+t)},t.countDigits=function(t){var e=0;do{e+=1,t=t/10|0}while(t);return e},t.integerParser=function(){return new t.NumberParser(void 0,void 0,0)},t.parseInteger=function(e){return t.NumberParser.parse(e,void 0,void 0,0)},t.decimalParser=function(){return new t.NumberParser(void 0,void 0,1)},t.parseDecimal=function(e){return t.NumberParser.parse(e,void 0,void 0,1)},t.numberParser=function(){return new t.NumberParser},t.parseNumber=function(e){return t.NumberParser.parse(e)},t.integerWriter=function(e){return void 0===e?new t.IntegerWriter(void 0,0):new t.IntegerWriter(void 0,e)},t.writeInteger=function(e,r){return t.IntegerWriter.write(r,void 0,e)},t}(),lt=function(){function t(t,e,r,i,n,o){this._input=t,this._tag=e,this._severity=r,this._message=i,this._note=n,this._cause=o}return t.prototype.input=function(){return this._input.clone()},t.prototype.tag=function(){return this._tag},t.prototype.severity=function(){return this._severity},t.prototype.message=function(){return this._message},t.prototype.note=function(){return this._note},t.prototype.cause=function(){return this._cause},t.prototype.lineDigits=function(){var t=pt.countDigits(this._tag.end().line());return null!==this._cause&&(t=Math.max(t,this._cause.lineDigits())),t},t.prototype.display=function(e){var r=this._input.clone(),i=this._tag.start(),n=this._tag.end(),o=this._severity,s=this._message,u=this._note,a=this._cause,h=this.lineDigits();t.displayDiagnostic(r,i,n,o,s,u,a,2,h,e)},t.prototype.toString=function(t){return J.display(this,t)},t.from=function(e,r,i,n,o,s){return n instanceof t?(s=n,o=null,n=null):o instanceof t&&(s=o,o=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),new t(e=e.clone(),r,i,n,o,s)},t.message=function(e,r,i,n,o){null===i||i instanceof t?(o=i,i=void 0):"string"==typeof i&&(n=i,i=void 0),(null===n||n instanceof t)&&(o=n,n=void 0),void 0===n&&(n=null),void 0===i&&(i=A.error());var s=r.mark(),u=r.clone();return u.seek(),t.from(u,s,i,e,n,o)},t.unexpected=function(e,r,i,n){var o;if(null===r||r instanceof t?(n=r,r=void 0):"string"==typeof r&&(i=r,r=void 0),(null===i||i instanceof t)&&(n=i,i=void 0),void 0===i&&(i=null),void 0===r&&(r=A.error()),e.isCont()){var s=$.stringOutput().write("unexpected").write(32);J.debugChar(e.head(),s),o=s.bind()}else o="unexpected end of input";var u=e.mark(),a=e.clone();return a.seek(),t.from(a,u,r,o,i,n)},t.expected=function(e,r,i,n,o){null===i||i instanceof t?(o=i,i=void 0):"string"==typeof i&&(n=i,i=void 0),(null===n||n instanceof t)&&(o=n,n=void 0),void 0===n&&(n=null),void 0===i&&(i=A.error());var s=$.stringOutput().write("expected").write(32);"number"==typeof e?J.debugChar(e,s):s=s.write(e),s=s.write(44).write(32).write("but found").write(32),r.isCont()?J.debugChar(r.head(),s):s=s.write("end of input");var u=s.bind(),a=r.mark(),h=r.clone();return h.seek(),t.from(h,a,i,u,n,o)},t.displayDiagnostic=function(e,r,i,n,o,s,u,a,h,p){for(;;){null!==o&&(t.displayMessage(n,o,p),p=p.writeln()),t.displayAnchor(e,r,h,p),p=p.writeln();var l=t.displayContext(e,r,i,n,s,u,a,h,p);if(null===l)break;p=p.writeln(),e=l._input.clone(),r=l._tag.start(),i=l._tag.end(),n=l._severity,o=l._message,s=l._note,u=l._cause}},t.displayMessage=function(e,r,i){t.formatSeverity(e,i),i=i.write(e.label()),ht.reset(i),ht.bold(i),i=i.write(58),null!==r&&(i=i.write(32).write(r)),ht.reset(i)},t.displayAnchor=function(e,r,i,n){t.displayLineLeadArrow(i,n),n=n.write(32);var o=e.id();null!==o&&J.display(o,n),n=n.write(58),J.displayNumber(r._line,n),n=n.write(58),J.displayNumber(r._column,n),n=n.writeln(),t.displayLineLead(i,n)},t.displayCause=function(e,r,i,n){var o=e._input.clone(),s=e._tag.start(),u=e._tag.end(),a=e._severity,h=e._note,p=e._cause;return t.displayContext(o,s,u,a,h,p,r,i,n)},t.displayContext=function(e,r,i,n,o,s,u,a,h){var p=s,l=null!==s&&null===s._message&&f.equal(e.id(),s._input.id())?r._offset<=s._tag.start()._offset?-1:1:0;return 1===l&&(p=t.displayCause(s,u,a,h),h=h.writeln(),t.displayLineLeadEllipsis(a,h),h=h.writeln()),t.displayLines(e,r,i,n,u,a,h),null!==o&&t.displayNote(o,a,h),-1===l&&(h=h.writeln(),t.displayLineLeadEllipsis(a,h),h=h.writeln(),p=t.displayCause(s,u,a,h)),p},t.displayLines=function(e,r,i,n,o,s,u){for(var a=r.line(),h=i.line(),p=e.line();p<a;)t.consumeLineText(e,p),p+=1;if(h-a>2*o+2){for(;p<=a+o;)t.displayLine(e,r,i,n,p,s,u),p+=1;for(t.displayLineLeadEllipsis(s,u),u=u.write(32),t.formatSeverity(n,u),u=u.write(124),ht.reset(u),u=u.writeln();p<h-o;)t.consumeLineText(e,p),p+=1}for(;p<=h;)t.displayLine(e,r,i,n,p,s,u),p+=1},t.displayNote=function(e,r,i){i=i.writeln(),t.displayLineLead(r,i),i=i.writeln(),t.displayLineComment("note",e,r,i)},t.displayLine=function(e,r,i,n,o,s,u){r._line===o&&i._line===o?t.displaySingleLine(e,r,i,n,o,s,u):r._line===o?t.displayStartLine(e,r,n,o,s,u):i._line===o?t.displayEndLine(e,i,n,o,s,u):t.displayMidLine(e,n,o,s,u)},t.displaySingleLine=function(e,r,i,n,o,s,u){t.displayLineLeadNumber(o,s,u),u=u.write(32);for(var a=1;a<e.column();a+=1)u=u.write(32);t.displayLineText(e,o,u),t.displayLineLead(s,u),u=u.write(32);for(var h=1;h<r._column;)u=u.write(32),h+=1;for(t.formatSeverity(n,u);h<=i._column;)u=u.write(94),h+=1;null!==i._note&&(u=u.write(32).write(i._note)),ht.reset(u)},t.displayStartLine=function(e,r,i,n,o,s){t.displayLineLeadNumber(n,o,s),s=s.write(32).write(32).write(32);for(var u=1;u<e.column();u+=1)s=s.write(32);t.displayLineText(e,n,s),t.displayLineLead(o,s),s=s.write(32).write(32),t.formatSeverity(i,s),s=s.write(95);for(var a=1;a<r._column;)s=s.write(95),a+=1;s=s.write(94),null!==r._note&&(s=s.write(32).write(r._note)),ht.reset(s),s=s.writeln()},t.displayEndLine=function(e,r,i,n,o,s){t.displayLineLeadNumber(n,o,s),s=s.write(32),t.formatSeverity(i,s),s=s.write(124),ht.reset(s),s=s.write(32),t.displayLineText(e,n,s),t.displayLineLead(o,s),s=s.write(32),t.formatSeverity(i,s),s=s.write(124).write(95);for(var u=1;u<r._column;)s=s.write(95),u+=1;s=s.write(94),null!==r._note&&(s=s.write(32).write(r._note)),ht.reset(s)},t.displayMidLine=function(e,r,i,n,o){t.displayLineLeadNumber(i,n,o),o=o.write(32),t.formatSeverity(r,o),o=o.write(124),ht.reset(o),o=o.write(32),t.displayLineText(e,i,o)},t.displayLineComment=function(e,r,i,n){t.displayLineLeadComment(i,n),n=n.write(32),ht.bold(n),n=n.write(e).write(58),ht.reset(n),null!=r&&(n=n.write(32).write(r))},t.displayLineLead=function(t,e){ht.blueBold(e);for(var r=1+t,i=0;i<r;i+=1)e=e.write(32);e=e.write(124),ht.reset(e)},t.displayLineLeadComment=function(t,e){ht.blueBold(e);for(var r=1+t,i=0;i<r;i+=1)e=e.write(32);e=e.write(61),ht.reset(e)},t.displayLineLeadArrow=function(t,e){for(var r=0;r<t;r+=1)e=e.write(32);ht.blueBold(e),e=e.write(45).write(45).write(62),ht.reset(e)},t.displayLineLeadEllipsis=function(t,e){ht.blueBold(e);for(var r=0;r<t;r+=1)e=e.write(46);ht.reset(e),e=e.write(32).write(32)},t.displayLineLeadNumber=function(t,e,r){for(var i=e-pt.countDigits(t),n=0;n<i;n+=1)r=r.write(32);ht.blueBold(r),J.displayNumber(t,r),r=r.write(32).write(124),ht.reset(r)},t.displayLineText=function(t,e,r){for(;t.isCont()&&t.line()===e;)r=r.write(t.head()),t=t.step();t.line()===e&&(r=r.writeln())},t.consumeLineText=function(t,e){for(;t.isCont()&&t.line()===e;)t=t.step()},t.formatSeverity=function(t,e){switch(t.level()){case A.FATAL_LEVEL:case A.ALERT_LEVEL:case A.ERROR_LEVEL:ht.redBold(e);break;case A.WARNING_LEVEL:ht.yellowBold(e);break;case A.NOTE_LEVEL:ht.greenBold(e);break;case A.INFO_LEVEL:ht.cyanBold(e);break;case A.DEBUG_LEVEL:case A.TRACE_LEVEL:default:ht.magentaBold(e)}},t}(),ct=function(t){function e(r){var i=t.call(this,r instanceof lt?r.message()||void 0:r)||this;return r instanceof lt&&(i.diagnostic=r),i.__proto__=e.prototype,i}return _(e,t),e.prototype.toString=function(){return this.diagnostic?this.diagnostic.toString():t.prototype.toString.call(this)},e}(Error),ft=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.fork=function(t){return this},t.prototype.bind=function(){throw new Error},t.prototype.trap=function(){throw new Error},t.prototype.asError=function(){throw new Error},t.done=function(e){return void 0===e?(t._done||(t._done=new dt(void 0)),t._done):new dt(e)},t.error=function(t){return t instanceof Error?new yt(t):new yt(new ct(t))},t}(),dt=function(t){function e(e){var r=t.call(this)||this;return r._output=e,r}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){return this._output},e}(ft),yt=function(t){function e(e){var r=t.call(this)||this;return r._error=e,r}return _(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){throw this._error},e.prototype.trap=function(){return this._error},e.prototype.asError=function(){return this},e}(ft),vt=function(){function t(){}return t.prototype.isFatal=function(){return!1},t.prototype.isReplacement=function(){return!1},t.prototype.replacementChar=function(){return 65533},t.prototype.toString=function(){return J.debug(this)},t.fatal=function(){return t._fatal||(t._fatal=new _t(!1)),t._fatal},t.fatalNonZero=function(){return t._fatalNonZero||(t._fatalNonZero=new _t(!0)),t._fatalNonZero},t.replacement=function(e){return void 0===e||65533===e?(t._replacement||(t._replacement=new mt(65533,!1)),t._replacement):new mt(e,!1)},t.replacementNonZero=function(e){return void 0===e||65533===e?(t._replacementNonZero||(t._replacementNonZero=new mt(65533,!0)),t._replacementNonZero):new mt(e,!0)},t}(),_t=function(t){function e(e){var r=t.call(this)||this;return r._isNonZero=e,r}return _(e,t),e.prototype.isFatal=function(){return!0},e.prototype.isNonZero=function(t){return void 0===t?this._isNonZero:t?vt.fatalNonZero():vt.fatal()},e.prototype.equals=function(t){return this===t||t instanceof e&&this._isNonZero===t._isNonZero},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._isNonZero)))},e.prototype.debug=function(t){t=t.write("UtfErrorMode").write(46).write(this.isNonZero?"fatalNonZero":"fatal").write(40).write(41)},e}(vt),mt=function(t){function e(e,r){var i=t.call(this)||this;return i._replacementChar=e,i._isNonZero=r,i}return _(e,t),e.prototype.isReplacement=function(){return!0},e.prototype.replacementChar=function(){return this._replacementChar},e.prototype.isNonZero=function(t){return void 0===t?this._isNonZero:65533===this._replacementChar?t?vt.replacementNonZero():vt.replacement():new e(this._replacementChar,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.replacementChar===t.replacementChar&&this.isNonZero===t.isNonZero)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._replacementChar),c.hash(this._isNonZero)))},e.prototype.debug=function(t){t=t.write("UtfErrorMode").write(46).write(this._isNonZero?"replacementNonZero":"replacement").write(40),65533!==this._replacementChar&&J.debugChar(this._replacementChar,t),t=t.write(41)},e}(vt),wt=function(t){function e(e,r,i,n,o){void 0===n&&(n=R.standard()),void 0===o&&(o=!1);var s=t.call(this)||this;return s._array=e,s._index=r,s._limit=i,s._settings=n,s._isPart=o,s}return _(e,t),e.prototype.isCont=function(){return this._index<this._limit},e.prototype.isFull=function(){return this._isPart&&this._index>=this._limit},e.prototype.isDone=function(){return!this._isPart&&this._index>=this._limit},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t?this._isPart:(this._isPart=t,this)},e.prototype.index=function(t){return void 0===t?this._index:0<=t&&t<=this._limit?(this._index=t,this):ot.error(new I("invalid index"),this._settings)},e.prototype.limit=function(t){return void 0===t?this._limit:0<=t&&t<=this._array.length?(this._limit=t,this):ot.error(new I("invalid limit"),this._settings)},e.prototype.capacity=function(){return this._array.length},e.prototype.remaining=function(){return this._limit-this._index},e.prototype.has=function(t){return 0<=t&&t<this._limit},e.prototype.get=function(t){if(0<=t&&t<this._limit)return this._array[t];throw new I},e.prototype.set=function(t,e){if(!(0<=t&&t<this._limit))throw new I;this._array[t]=e},e.prototype.write=function(t){if("number"==typeof t){var e=this._index;return e<this._limit?(this._array[e]=t,this._index=e+1,this):ot.error(new I("full"),this._settings)}return ot.error(new I("binary output"),this._settings)},e.prototype.writeln=function(t){return ot.error(new I("binary output"),this._settings)},e.prototype.step=function(t){var e=this._index+t;return 0<=e&&e<=this._limit?(this._index=e,this):ot.error(new I("invalid step"),this._settings)},e.prototype.bind=function(){return new Uint8Array(this._array.buffer,0,this._index)},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=R.fromAny(t),this)},e.prototype.clone=function(){return new e(this._array,this._index,this._limit,this._settings,this._isPart)},e}(ot),gt=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.bind=function(){return this.toUint8Array()},e.prototype.clone=function(){return new e(this.cloneArray(),this._size,this._settings)},e}(function(t){function e(e,r,i){var n=t.call(this)||this;return n._array=e,n._size=r,n._settings=i,n}return _(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.write=function(t){if("number"==typeof t){var r=this._size,i=this._array,n=void 0;return null===i||r+1>i.length?(n=new Uint8Array(e.expand(r+1)),null!==i&&n.set(i,0),this._array=n):n=i,n[r]=t,this._size=r+1,this}throw new TypeError(""+t)},e.prototype.writeln=function(t){throw new TypeError(""+t)},e.prototype.toUint8Array=function(){var t=this._size,e=this._array;if(null!==e&&t===e.length)return e;var r=new Uint8Array(t);return null!==e&&r.set(e.slice(0,t),0),this._array=r,r},e.prototype.cloneArray=function(){var t=this._array;return null!==t?t.slice(0,this._size):null},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=R.fromAny(t),this)},e.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e}(F)),bt=function(){function t(){}return t.outputBuffer=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=t.length),new wt(t,e,e+r)},t.uint8ArrayOutput=function(t,e){var r;return void 0===e&&"number"!=typeof t?(e=t,t=void 0):"number"!=typeof t&&(t=void 0),r="number"==typeof t?new Uint8Array(t):null,e=R.fromAny(e),new gt(r,0,e)},t}(),xt=function(){function t(t){this._alphabet=t}return t.prototype.alphabet=function(){return this._alphabet},t.prototype.encodeDigit=function(t){return this._alphabet.charCodeAt(t)},t.prototype.uint8ArrayWriter=function(e){return void 0===e?new t.Writer(void 0,void 0,this):new t.Writer(e,e,this)},t.prototype.writeUint8Array=function(e,r){return t.Writer.write(r,void 0,e,this)},t.prototype.writeInteger=function(e,r,i){return void 0===i&&(i=0),t.IntegerWriter.write(r,void 0,e,i,this)},t.prototype.writeIntegerLiteral=function(e,r,i){return void 0===i&&(i=0),t.IntegerWriter.writeLiteral(r,void 0,e,i,this)},t.lowercase=function(){return t._lowercase||(t._lowercase=new t("0123456789abcdef")),t._lowercase},t.uppercase=function(){return t._uppercase||(t._uppercase=new t("0123456789ABCDEF")),t._uppercase},t.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},t.decodeDigit=function(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-65+10;if(t>=97&&t<=102)return t-97+10;var e=$.stringOutput();throw e.write("Invalid base-16 digit: "),J.debugChar(t,e),new Error(e.bind())},t.writeQuantum=function(e,r,i){var n=t.decodeDigit(e),o=t.decodeDigit(r);i=i.write(n<<4|o)},t.parser=function(e){return new t.Parser(e)},t.parse=function(e,r){return t.Parser.parse(e,r)},t.parseUint8Array=function(e){return t.Parser.parse(e,bt.uint8ArrayOutput())},t}(),Ct=function(t){function e(e,r,i,n,o,s){void 0===i&&(i=-1),void 0===n&&(n=-1),void 0===o&&(o=-1),void 0===s&&(s=0);var u=t.call(this)||this;return u._output=e,u._errorMode=r,u._c1=i,u._c2=n,u._c3=o,u._have=s,u}return _(e,t),e.prototype.isCont=function(){return this._output.isCont()},e.prototype.isFull=function(){return this._output.isFull()},e.prototype.isDone=function(){return this._output.isDone()},e.prototype.isError=function(){return this._output.isError()},e.prototype.isPart=function(t){return void 0===t?this._output.isPart():(this._output=this._output.isPart(t),this)},e.prototype.write=function(t){if("number"==typeof t){var r=this._c1,i=this._c2,n=this._c3,o=-1,s=this._have;if(t>=0)switch(s){case 0:r=255&t,s=1;break;case 1:i=255&t,s=2;break;case 2:n=255&t,s=3;break;case 3:o=255&t,s=4;break;default:throw new Error("unreachable")}if(0===r&&this._errorMode.isNonZero())return F.error(new I("unexpected NUL byte"));if(r>=0&&r<=127)this._output=this._output.write(r),this._have=0;else if(r>=194&&r<=244)if(r>=194&&r<=223&&i>=128&&i<=191)this._output=this._output.write((31&r)<<6|63&i),this._c1=-1,this._have=0;else if(224===r&&i>=160&&i<=191||r>=225&&r<=236&&i>=128&&i<=191||237===r&&i>=128&&i<=159||r>=238&&r<=239&&i>=128&&i<=191)if(n>=128&&n<=191)this._output=this._output.write((15&r)<<12|(63&i)<<6|63&n),this._c1=-1,this._c2=-1,this._have=0;else if(n>=0){if(this._errorMode.isFatal())return F.error(new I(e.invalid(r,i,n)));this._output=this._output.write(this._errorMode.replacementChar()),this._c1=n,this._c2=-1,this._have=1}else{if(t<0||this._output.isDone())return F.error(new I(e.invalid(r,i)));this._c2=i,this._have=2}else if(240===r&&i>=144&&i<=191||r>=241&&r<=243&&i>=128&&i<=191||244===r&&i>=128&&i<=143)if(n>=128&&n<=191)if(o>=128&&o<=191)this._have=4,this._output=this._output.write((7&r)<<18|(63&i)<<12|(63&n)<<6|63&o),this._c1=-1,this._c2=-1,this._c3=-1,this._have=0;else if(o>=0){if(this._errorMode.isFatal())return F.error(new I(e.invalid(r,i,n,o)));this._output=this._output.write(this._errorMode.replacementChar()),this._c1=o,this._c2=-1,this._c3=-1,this._have=1}else{if(t<0||this._output.isDone())return F.error(new I(e.invalid(r,i,n)));this._c3=n,this._have=3}else if(n>=0){if(this._errorMode.isFatal())return F.error(new I(e.invalid(r,i,n)));this._output=this._output.write(this._errorMode.replacementChar()),this._c1=n,this._c2=-1,this._have=1}else{if(t<0||this._output.isDone())return F.error(new I(e.invalid(r,i)));this._c2=i,this._have=2}else if(i>=0){if(this._errorMode.isFatal())return F.error(new I(e.invalid(r,i)));this._output=this._output.write(this._errorMode.replacementChar()),this._c1=i,this._have=1}else{if(t<0||this._output.isDone())return F.error(new I(e.invalid(r)));this._c1=r,this._have=1}else if(r>=0){if(this._errorMode.isFatal())return F.error(new I(e.invalid(r)));this._output=this._output.write(this._errorMode.replacementChar()),this._have=0}return this._output.isError()?this._output:this}if("string"==typeof t)return this._output.write(t),this;throw new TypeError(""+t)},e.invalid=function(t,e,r,i){var n=$.stringOutput();return n=n.write("invalid UTF-8 code unit sequence: "),xt.uppercase().writeIntegerLiteral(t,n,2),void 0!==e&&(n=n.write(" "),xt.uppercase().writeIntegerLiteral(e,n,2),void 0!==r&&(n=n.write(" "),xt.uppercase().writeIntegerLiteral(r,n,2),void 0!==i&&(n=n.write(" "),xt.uppercase().writeIntegerLiteral(i,n,2)))),n.bind()},e.prototype.settings=function(t){return void 0===t?this._output.settings():(this._output.settings(t),this)},e.prototype.bind=function(){return 0===this._have?this._output.bind():this.write(-1).bind()},e.prototype.trap=function(){return this._output.trap()},e.prototype.clone=function(){return new e(this._output.clone(),this._errorMode,this._c1,this._c2,this._c3,this._have)},e}(F),St=function(t){function e(e,r,i,n,o,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=4);var u=t.call(this)||this;return u._output=e,u._errorMode=r,u._c2=i,u._c3=n,u._c4=o,u._index=s,u}return _(e,t),e.prototype.isCont=function(){return this._output.isCont()},e.prototype.isFull=function(){return this._output.isFull()},e.prototype.isDone=function(){return this._output.isDone()},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0===t?this._output.isPart():(this._output=this._output.isPart(t),this)},e.prototype.write=function(t){if("number"==typeof t){for(var e=0,r=this._c2,i=this._c3,n=this._c4,o=this._index;o<4;){if(!this._output.isCont())return F.error(new I("unable to flush buffered code units"));switch(o){case 1:this._output=this._output.write(r),this._c2=0;break;case 2:this._output=this._output.write(i),this._c3=0;break;case 3:this._output=this._output.write(n),this._c4=0;break;default:throw new Error("unreachable")}o+=1}if(t>=0&&t<=127)n=t,o=3;else if(t>=128&&t<=2047)i=192|t>>>6,n=128|63&t,o=2;else if(t>=2048&&t<=65535||t>=57344&&t<=65535)r=224|t>>>12,i=128|t>>>6&63,n=128|63&t,o=1;else{if(!(t>=65536&&t<=1114111))return this._errorMode.isFatal()?F.error(new I("invalid code point: "+t)):this.write(this._errorMode.replacementChar());e=240|t>>>18,r=128|t>>>12&63,i=128|t>>>6&63,n=128|63&t,o=0}do{switch(o){case 0:this._output=this._output.write(e);break;case 1:this._output=this._output.write(r),this._c2=0;break;case 2:this._output=this._output.write(i),this._c3=0;break;case 3:this._output=this._output.write(n),this._c4=0;break;default:throw new Error("unreachable")}o+=1}while(o<4&&this._output.isCont());return o<4&&(o<3&&(o<2&&(this._c2=r),this._c3=i),this._c4=n),this._index=o,this}if("string"==typeof t)return this._output.write(t),this;throw new TypeError(""+t)},e.prototype.flush=function(){for(var t=this._index;t<4;){if(!this._output.isCont())return F.error(new I("unable to flush buffered code units"));switch(t){case 1:this._output=this._output.write(this._c2),this._c2=0;break;case 2:this._output=this._output.write(this._c3),this._c3=0;break;case 3:this._output=this._output.write(this._c4),this._c4=0;break;default:throw new Error("unreachable")}t+=1}return this._index=t,this},e.prototype.settings=function(t){return void 0===t?this._output.settings():(this._output.settings(t),this)},e.prototype.bind=function(){return this._output.bind()},e.prototype.clone=function(){return new e(this._output.clone(),this._errorMode,this._c2,this._c3,this._c4,this._index)},e}(F),At=function(){function t(){}return t.sizeOf=function(e,r){if("number"==typeof e||void 0===e){if("number"==typeof e){if(0===e&&void 0!==r&&r.isNonZero())return 2;if(e>=0&&e<=127)return 1;if(e>=128&&e<=2047)return 2;if(e>=2048&&e<=65535||e>=57344&&e<=65535)return 3;if(e>=65536&&e<=1114111)return 4}return void 0===r?3:r.isReplacement()?t.sizeOf(r.replacementChar()):0}if("string"==typeof e){for(var i=0,n=0,o=e.length;n<o;n=e.offsetByCodePoints(n,1))i+=t.sizeOf(e.charCodeAt(n),r);return i}throw new TypeError(""+e)},t.decodedOutput=function(t,e){return void 0===e&&(e=vt.fatal()),new Ct(t,e)},t.encodedOutput=function(t,e){return void 0===e&&(e=vt.fatal()),new St(t,e)},t.decodedString=function(){return t.decodedOutput($.stringOutput())},t}(),kt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._sign=e,o._value=r,o._mode=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._sign,this._value,this._mode,this._step)},e.parse=function(t,r,i,n,o){void 0===r&&(r=1),void 0===i&&(i=0),void 0===n&&(n=2),void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont())45===(s=t.head())&&(t=t.step(),r=-1),o=2;else if(t.isDone())return ft.error(lt.expected("number",t));if(2===o)if(t.isCont())if(48===(s=t.head()))t=t.step(),o=4;else{if(!(s>=49&&s<=57)){if(n>0&&46===s){var u=$.stringOutput();return r<0&&(u=u.write(45)),Et.parse(t,u,n)}return ft.error(lt.expected("number",t))}t=t.step(),i=r*(s-48),o=3}else if(t.isDone())return ft.error(lt.expected("number",t));if(3===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;){var a=10*i+r*(s-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return ft.error(lt.message("integer overflow",t));i=a,t=t.step()}if(t.isCont())o=4;else if(t.isDone())return ft.done(i)}if(4===o){if(t.isCont()){if(s=t.head(),n>0&&46===s||n>1&&(69===s||101===s)){u=$.stringOutput();return u=r<0&&0===i?u.write(45).write(48):u.write(""+i),Et.parse(t,u,n)}return ft.done(i)}if(t.isDone())return ft.done(i)}return new e(r,i,n,o)},e}(ft);pt.NumberParser=kt;var Et=function(t){function e(e,r,i){var n=t.call(this)||this;return n._output=e,n._mode=r,n._step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._output,this._mode,this._step)},e.parse=function(t,r,i,n){void 0===i&&(i=2),void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont())if(46===(o=t.head()))t=t.step(),r=r.write(o),n=2;else{if(!(i>1)||69!==o&&101!==o)return ft.error(lt.expected("decimal or exponent",t));t=t.step(),r=r.write(o),n=5}else if(t.isDone())return ft.error(lt.expected("decimal or exponent",t));if(2===n)if(t.isCont()){if(!((o=t.head())>=48&&o<=57))return ft.error(lt.expected("digit",t));t=t.step(),r=r.write(o),n=3}else if(t.isDone())return ft.error(lt.expected("digit",t));if(3===n){for(;t.isCont()&&(o=t.head())>=48&&o<=57;)t=t.step(),r=r.write(o);if(t.isCont()){if(!(i>1))return ft.done(+r.bind());n=4}else if(t.isDone())return ft.done(+r.bind())}if(4===n){if(69!==(o=t.head())&&101!==o)return ft.done(+r.bind());t=t.step(),r=r.write(o),n=5}if(5===n)if(t.isCont())43!==(o=t.head())&&45!==o||(t=t.step(),r=r.write(o)),n=6;else if(t.isDone())return ft.error(lt.unexpected(t));if(6===n)if(t.isCont()){if(!((o=t.head())>=48&&o<=57))return ft.error(lt.expected("digit",t));t=t.step(),r=r.write(o),n=7}else if(t.isDone())return ft.error(lt.expected("digit",t));if(7===n){for(;t.isCont()&&(o=t.head())>=48&&o<=57;)t=t.step(),r=r.write(o);if(!t.isEmpty())return ft.done(+r.bind())}return new e(r,i,n)},e}(ft),Ot=function(t){function e(e,r,i,n){void 0===i&&(i=0),void 0===n&&(n=1);var o=t.call(this)||this;return o._value=e,o._input=r,o._index=i,o._step=n,o}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._value,this._input,this._index,this._step)},e.write=function(t,r,i,n,o){if(void 0===n&&(n=0),void 0===o&&(o=1),0===o)return G.done();if(1===o&&(i<0?t.isCont()&&(t=t.write(45),o=2):o=2),2===o)if(i>-10&&i<10){if(t.isCont())return t=t.write(pt.encodeDigit(Math.abs(0|i))),G.done(r)}else{for(var s=new Array(19),u=i,a=18;u;)s[a]=Math.abs(u%10|0),u=u/10|0,a-=1;for(a+=1+n;a<19&&t.isCont();)t=t.write(pt.encodeDigit(s[a])),n+=1,a+=1;if(19===a)return G.done(r)}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o)},e}(G);pt.IntegerWriter=Ot;var Vt=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=1);var n=t.call(this)||this;return n._output=e,n._p=r,n._step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._output.clone(),this._p,this._step)},e.parse=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=1);for(var o=0;!t.isEmpty();){if(1===n)if(t.isCont()&&(o=t.head(),xt.isDigit(o)))t=t.step(),i=o,n=2;else if(!t.isEmpty())return ft.done(r.bind());if(2===n)if(t.isCont()&&(o=t.head(),xt.isDigit(o)))t=t.step(),xt.writeQuantum(i,o,r),i=0,n=1;else if(!t.isEmpty())return ft.error(lt.expected("base16 digit",t))}return new e(r,i,n)},e}(ft);xt.Parser=Vt;var Pt=function(t){function e(e,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=1);var s=t.call(this)||this;return s._value=e,s._input=r,s._base16=i,s._index=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){if(t instanceof Uint8Array)return new e(void 0,t,this._base16);throw new TypeError(""+t)},e.prototype.pull=function(t){return e.write(t,this._value,this._input,this._base16,this._index,this._step)},e.write=function(t,r,i,n,o,s){for(void 0===o&&(o=0),void 0===s&&(s=1);o<i.length;){var u=i[o];1===s&&t.isCont()&&(t=t.write(n.encodeDigit(u>>>4)),s=2),2===s&&t.isCont()&&(t=t.write(n.encodeDigit(15&u)),o+=1,s=1)}return o===i.length?G.done(r):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G);xt.Writer=Pt;var Dt=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._value=e,u._input=r,u._width=i,u._base16=n,u._index=o,u._step=s,u}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._value,this._input,this._width,this._base16,this._index,this._step)},e.write=function(t,r,i,n,o,s,u){if(void 0===s&&(s=0),void 0===u&&(u=3),u<=0)return G.done();if(1===u&&t.isCont()&&(t=t.write(48),u=2),2===u&&t.isCont()&&(t=t.write(120),u=3),3===u)if(i>=0&&i<16&&n<=1){if(t.isCont())return t=t.write(o.encodeDigit(i)),G.done(r)}else{for(var a=15,h=new Array(16),p=i;0!==p||a>=16-n;)h[a]=15&p,p>>>=4,a-=1;for(a+=1+s;a<16&&t.isCont();)t=t.write(o.encodeDigit(h[a])),s+=1,a+=1;if(16===a)return G.done(r)}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u)},e.writeLiteral=function(t,r,i,n,o){return e.write(t,r,i,n,o,0,1)},e}(G);xt.IntegerWriter=Dt;var Mt=function(){function t(){}return t.prototype.decodeDigit=function(t){if(t>=65&&t<=90)return t-65;if(t>=97&&t<=122)return t+-71;if(t>=48&&t<=57)return t+4;if(43===t||45===t)return 62;if(47===t||95===t)return 63;var e=$.stringOutput();throw e.write("Invalid base-64 digit: "),J.debugChar(t,e),new Error(e.bind())},t.prototype.encodeDigit=function(t){return this.alphabet().charCodeAt(t)},t.prototype.writeQuantum=function(t,e,r,i,n){var o=this.decodeDigit(t),s=this.decodeDigit(e);if(61!==r){var u=this.decodeDigit(r);if(61!==i){var a=this.decodeDigit(i);n=(n=(n=n.write(o<<2|s>>>4)).write(s<<4|u>>>2)).write(u<<6|a)}else n=(n=n.write(o<<2|s>>>4)).write(s<<4|u>>>2)}else{if(61!==i)throw new Error("Improperly padded base-64");n=n.write(o<<2|s>>>4)}},t.prototype.parser=function(e){return new t.Parser(e,this)},t.prototype.parse=function(e,r){return t.Parser.parse(e,r,this)},t.prototype.parseUint8Array=function(e){return t.Parser.parse(e,bt.uint8ArrayOutput(),this)},t.prototype.uint8ArrayWriter=function(e){return void 0===e?new t.Writer(void 0,void 0,this):new t.Writer(e,e,this)},t.prototype.writeUint8Array=function(e,r){return t.Writer.write(r,void 0,e,this)},t.standard=function(e){return void 0===e&&(e=!0),e?(t._standard||(t._standard=new Tt(!0)),t._standard):(t._standardUnpadded||(t._standardUnpadded=new Tt(!0)),t._standardUnpadded)},t.url=function(e){return void 0===e&&(e=!0),e?(t._url||(t._url=new Rt(!0)),t._url):(t._urlUnpadded||(t._urlUnpadded=new Rt(!1)),t._urlUnpadded)},t}(),Tt=function(t){function e(e){var r=t.call(this)||this;return r._isPadded=e,r}return _(e,t),e.prototype.alphabet=function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"},e.prototype.isPadded=function(t){return void 0===t?this._isPadded:t===this._isPadded?this:Mt.standard(t)},e.prototype.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||43===t||47===t},e}(Mt),Rt=function(t){function e(e){var r=t.call(this)||this;return r._isPadded=e,r}return _(e,t),e.prototype.alphabet=function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},e.prototype.isPadded=function(t){return void 0===t?this._isPadded:t===this._isPadded?this:Mt.url(t)},e.prototype.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||45===t||95===t},e}(Mt),It=function(t){function e(e,r,i,n,o,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=t.call(this)||this;return u._output=e,u._base64=r,u._p=i,u._q=n,u._r=o,u._step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._output.clone(),this._base64,this._p,this._q,this._r,this._step)},e.parse=function(t,r,i,n,o,s,u){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=1);for(var a=0;!t.isEmpty();){if(1===u)if(t.isCont()&&(a=t.head(),i.isDigit(a)))t=t.step(),n=a,u=2;else if(!t.isEmpty())return ft.done(r.bind());if(2===u)if(t.isCont()&&(a=t.head(),i.isDigit(a)))t=t.step(),o=a,u=3;else if(!t.isEmpty())return ft.error(lt.expected("base64 digit",t));if(3===u)if(t.isCont()&&(a=t.head(),i.isDigit(a)||61===a))t=t.step(),s=a,u=61!==a?4:5;else if(!t.isEmpty())return i.isPadded()?ft.error(lt.unexpected(t)):(i.writeQuantum(n,o,61,61,r),ft.done(r.bind()));if(4===u){if(t.isCont()&&(a=t.head(),i.isDigit(a)||61===a)){if(t=t.step(),i.writeQuantum(n,o,s,a,r),s=0,o=0,n=0,61===a)return ft.done(r.bind());u=1}else if(!t.isEmpty())return i.isPadded()?ft.error(lt.unexpected(t)):(i.writeQuantum(n,o,s,61,r),ft.done(r.bind()))}else if(5===u){if(t.isCont()&&61===(a=t.head()))return t=t.step(),i.writeQuantum(n,o,s,a,r),s=0,o=0,n=0,ft.done(r.bind());if(!t.isEmpty())return ft.error(lt.expected(61,t))}}return new e(r,i,n,o,s,u)},e}(ft);Mt.Parser=It;var Ft=function(t){function e(e,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=1);var s=t.call(this)||this;return s._value=e,s._input=r,s._base64=i,s._index=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){if(t instanceof Uint8Array)return new e(void 0,t,this._base64);throw new TypeError(""+t)},e.prototype.pull=function(t){return e.write(t,this._value,this._input,this._base64,this._index,this._step)},e.write=function(t,r,i,n,o,s){for(void 0===o&&(o=0),void 0===s&&(s=1);o+2<i.length&&t.isCont();){var u=i[o],a=i[o+1],h=i[o+2];1===s&&t.isCont()&&(t=t.write(n.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(n.encodeDigit(63&(u<<4|a>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(n.encodeDigit(63&(a<<2|h>>>6))),s=4),4===s&&t.isCont()&&(t=t.write(n.encodeDigit(63&h)),o+=3,s=1)}if(o+1<i.length&&t.isCont()){u=i[o],a=i[o+1];1===s&&t.isCont()&&(t=t.write(n.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(n.encodeDigit(63&(u<<4|a>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(n.encodeDigit(a<<2&63)),s=4),4===s&&(n.isPadded()?t.isCont()&&(t=t.write(61),o+=2):o+=2)}else if(o<i.length&&t.isCont()){u=i[o];1===s&&t.isCont()&&(t=t.write(n.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(n.encodeDigit(u<<4&63)),s=3),3===s&&(n.isPadded()?t.isCont()&&(t=t.write(61),s=4):o+=1),4===s&&t.isCont()&&(t=t.write(61),o+=1)}return o===i.length?G.done(r):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G);Mt.Writer=Ft;var Lt=function(t){function e(e){var r=t.call(this)||this;return r._cursor=e,r}return _(e,t),e.prototype.isEmpty=function(){return this._cursor.isEmpty()},e.prototype.head=function(){return this._cursor.head()[0]},e.prototype.step=function(){this._cursor.step()},e.prototype.skip=function(t){this._cursor.skip(t)},e.prototype.hasNext=function(){return this._cursor.hasNext()},e.prototype.nextIndex=function(){return this._cursor.nextIndex()},e.prototype.next=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e.prototype.hasPrevious=function(){return this._cursor.hasPrevious()},e.prototype.previousIndex=function(){return this._cursor.previousIndex()},e.prototype.previous=function(){var t=this._cursor.previous(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e.prototype.delete=function(){this._cursor.delete()},e}(y),Ut=function(t){function e(e){var r=t.call(this)||this;return r._cursor=e,r}return _(e,t),e.prototype.isEmpty=function(){return this._cursor.isEmpty()},e.prototype.head=function(){return this._cursor.head()[1]},e.prototype.step=function(){this._cursor.step()},e.prototype.skip=function(t){this._cursor.skip(t)},e.prototype.hasNext=function(){return this._cursor.hasNext()},e.prototype.nextIndex=function(){return this._cursor.nextIndex()},e.prototype.next=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e.prototype.hasPrevious=function(){return this._cursor.hasPrevious()},e.prototype.previousIndex=function(){return this._cursor.previousIndex()},e.prototype.previous=function(){var t=this._cursor.previous(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e.prototype.delete=function(){this._cursor.delete()},e}(y),Nt=function(t){function e(e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this)||this;return o._pages=e,o._index=r,o._pageIndex=i,o._pageCursor=n,o}return _(e,t),e.prototype.isEmpty=function(){for(;;)if(this._pageCursor){if(!this._pageCursor.isEmpty())return!1;this._pageCursor=void 0}else{if(!(this._pageIndex<this._pages.length))return this._pageIndex=this._pages.length,!0;this._pageCursor=this.pageCursor(this._pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.head=function(){for(;;)if(this._pageCursor){if(!this._pageCursor.isEmpty())return this._pageCursor.head();this._pageCursor=void 0}else{if(!(this._pageIndex<this._pages.length))throw this._pageIndex=this._pages.length,new Error("empty");this._pageCursor=this.pageCursor(this._pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.step=function(){for(;;)if(this._pageCursor){if(!this._pageCursor.isEmpty())return void(this._index+=1);this._pageCursor=void 0}else{if(!(this._pageIndex<this._pages.length))throw this._pageIndex=this._pages.length,new Error("empty");this._pageCursor=this.pageCursor(this._pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.skip=function(t){for(;t>0;)if(this._pageCursor)this._pageCursor.hasNext()?(this._index+=1,t-=1,this._pageCursor.next()):this._pageCursor=void 0;else{if(!(this._pageIndex<this._pages.length))break;var e=this._pages[this._pageIndex],r=this.pageSize(e);if(this._pageIndex+=1,r<t){this._pageCursor=this.pageCursor(e),t>0&&(this._index+=t,this._pageCursor.skip(t),t=0);break}this._index+=r,t-=r}},e.prototype.hasNext=function(){for(;;)if(this._pageCursor){if(this._pageCursor.hasNext())return!0;this._pageCursor=void 0}else{if(!(this._pageIndex<this._pages.length))return this._pageIndex=this._pages.length,!1;this._pageCursor=this.pageCursor(this._pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){for(;;)if(this._pageCursor){if(this._pageCursor.hasNext())return this._index+=1,this._pageCursor.next();this._pageCursor=void 0}else{if(!(this._pageIndex<this._pages.length))return this._pageIndex=this._pages.length,{done:!0};this._pageCursor=this.pageCursor(this._pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.hasPrevious=function(){for(;;)if(this._pageCursor){if(this._pageCursor.hasPrevious())return!0;this._pageCursor=void 0}else{if(!(this._pageIndex>0))return this._pageIndex=0,!1;this._pageCursor=this.reversePageCursor(this._pages[this._pageIndex-1]),this._pageIndex-=1}},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){for(;;)if(this._pageCursor){if(this._pageCursor.hasPrevious())return this._index-=1,this._pageCursor.previous();this._pageCursor=void 0}else{if(!(this._pageIndex>0))return this._pageIndex=0,{done:!0};this._pageCursor=this.reversePageCursor(this._pages[this._pageIndex-1]),this._pageIndex-=1}},e.prototype.set=function(t){this._pageCursor.set(t)},e.prototype.delete=function(){this._pageCursor.delete()},e}(y),zt=function(){function t(){}return t.prototype.compare=function(t,e){return f.compare(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}();zt.prototype.pageSplitSize=32;var jt=function(t){function e(r){void 0===r&&(r=e.Page.empty());var i=t.call(this)||this;return i.root=r,i}return _(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.root.isEmpty()},e.prototype.has=function(t){return this.root.has(t,this)},e.prototype.get=function(t){return this.root.get(t,this)},e.prototype.getEntry=function(t){return this.root.getEntry(t)},e.prototype.firstKey=function(){var t=this.root.firstEntry();return t?t[0]:void 0},e.prototype.firstValue=function(){var t=this.root.firstEntry();return t?t[1]:void 0},e.prototype.firstEntry=function(){return this.root.firstEntry()},e.prototype.lastKey=function(){var t=this.root.lastEntry();return t?t[0]:void 0},e.prototype.lastValue=function(){var t=this.root.lastEntry();return t?t[1]:void 0},e.prototype.lastEntry=function(){return this.root.lastEntry()},e.prototype.nextKey=function(t){var e=this.root.nextEntry(t,this);return e?e[0]:void 0},e.prototype.nextValue=function(t){var e=this.root.nextEntry(t,this);return e?e[1]:void 0},e.prototype.nextEntry=function(t){return this.root.nextEntry(t,this)},e.prototype.previousKey=function(t){var e=this.root.previousEntry(t,this);return e?e[0]:void 0},e.prototype.previousValue=function(t){var e=this.root.previousEntry(t,this);return e?e[1]:void 0},e.prototype.previousEntry=function(t){return this.root.previousEntry(t,this)},e.prototype.set=function(t,e){var r=this.root,i=this.root.updated(t,e,this);return r!==i&&(i.size>r.size&&(i=i.balanced(this)),this.root=i),this},e.prototype.delete=function(t){var e=this.root,r=this.root.removed(t,this);return e!==r&&(this.root=r,!0)},e.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=e.Page.empty()),this},e.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):e.Page.empty()),this},e.prototype.clear=function(){this.root=e.Page.empty()},e.prototype.updated=function(t,e){var r=this.root,i=r.updated(t,e,this);return r!==i?(i.size>r.size&&(i=i.balanced(this)),this.copy(i)):this},e.prototype.removed=function(t){var e=this.root,r=e.removed(t,this);return e!==r?this.copy(r):this},e.prototype.cleared=function(){return this.root.isEmpty()?this:this.copy(e.Page.empty())},e.prototype.reduced=function(t,e,r){var i=this.root,n=i.reduced(t,e,r);return i!==n&&(this.root=n),n.fold()},e.prototype.forEach=function(t,e){return this.root.forEach(t,e,this)},e.prototype.keys=function(){return this.root.keys()},e.prototype.values=function(){return this.root.values()},e.prototype.entries=function(){return this.root.entries()},e.prototype.reverseKeys=function(){return this.root.reverseKeys()},e.prototype.reverseValues=function(){return this.root.reverseValues()},e.prototype.reverseEntries=function(){return this.root.reverseEntries()},e.prototype.clone=function(){return this.copy(this.root)},e.prototype.copy=function(t){var r=new e(t);return r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},e}(zt),Wt=function(){function t(){}return t.prototype.keys=function(){return new Lt(this.entries())},t.prototype.values=function(){return new Ut(this.entries())},t.prototype.reverseKeys=function(){return new Lt(this.reverseEntries())},t.prototype.reverseValues=function(){return new Ut(this.reverseEntries())},t.empty=function(){return t._empty||(t._empty=new jt.Leaf([],void 0)),t._empty},t}();jt.Page=Wt;var qt=function(t){function e(e,r){var i=t.call(this)||this;return i._slots=e,i._fold=r,i}return _(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this._slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._slots.length},e.prototype.fold=function(){return this._fold},e.prototype.minKey=function(){return this._slots[0][0]},e.prototype.maxKey=function(){return this._slots[this._slots.length-1][0]},e.prototype.has=function(t,e){return this.lookup(t,e)>=0},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?this._slots[r][1]:void 0},e.prototype.getEntry=function(t){return this._slots[t]},e.prototype.firstEntry=function(){return this._slots.length?this._slots[0]:void 0},e.prototype.lastEntry=function(){return this._slots.length?this._slots[this._slots.length-1]:void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this._slots[r]},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r-=1:r=-(r+2),this._slots[r]},e.prototype.updated=function(t,e,r){var i=this.lookup(t,r);return i>=0?this.updatedSlot(i,t,e):(i=-(i+1),this.insertedSlot(i,t,e))},e.prototype.updatedSlot=function(t,e,r){var i=this._slots;if(r!==i[t][1]){var n=i.slice(0);return n[t]=[e,r],this.newLeaf(n,void 0)}return this},e.prototype.insertedSlot=function(t,e,r){for(var i=this._slots,n=i.length+1,o=new Array(n),s=0;s<t;s+=1)o[s]=i[s];o[t]=[e,r];for(s=t;s<n-1;s+=1)o[s+1]=i[s];return this.newLeaf(o,void 0)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);return r>=0?this._slots.length>1?this.removedSlot(r):Wt.empty():this},e.prototype.removedSlot=function(t){for(var e=this._slots,r=new Array(e.length-1),i=0;i<t;i+=1)r[i]=e[i];for(i=t;i<r.length;i+=1)r[i]=e[i+1];return this.newLeaf(r,void 0)},e.prototype.drop=function(t,e){if(t>0){var r=this._slots;if(t<r.length){for(var i=r.length-t,n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+t];return this.newLeaf(n,void 0)}return Wt.empty()}return this},e.prototype.take=function(t,e){var r=this._slots;if(t<r.length){if(t>0){for(var i=new Array(t),n=0;n<t;n+=1)i[n]=r[n];return this.newLeaf(i,void 0)}return Wt.empty()}return this},e.prototype.balanced=function(t){var e=this._slots.length;if(e>1&&t.pageShouldSplit(this)){var r=e>>>1;return this.split(r)}return this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;var n=new Array(1);return n[0]=i.minKey(),this.newNode(e,n,void 0,this._slots.length)},e.prototype.splitLeft=function(t){for(var e=this._slots,r=new Array(t),i=0;i<t;i+=1)r[i]=e[i];return this.newLeaf(r,void 0)},e.prototype.splitRight=function(t){for(var e=this._slots,r=e.length-t,i=new Array(r),n=0;n<r;n+=1)i[n]=e[n+t];return this.newLeaf(i,void 0)},e.prototype.reduced=function(t,e,r){if(void 0===this._fold){for(var i=this._slots,n=t,o=0,s=i.length;o<s;o+=1)n=e(n,i[o][1]);return this.newLeaf(i,n)}return this},e.prototype.forEach=function(t,e,r){for(var i=this._slots,n=0,o=i.length;n<o;n+=1){var s=i[n],u=t.call(e,s[0],s[1],r);if(void 0!==u)return u}},e.prototype.entries=function(){return y.array(this._slots)},e.prototype.reverseEntries=function(){return y.array(this._slots,this._slots.length)},e.prototype.lookup=function(t,e){for(var r=0,i=this._slots.length-1;r<=i;){var n=r+i>>>1,o=e.compare(t,this._slots[n][0]);if(o>0)r=n+1;else{if(!(o<0))return n;i=n-1}}return-(r+1)},e.prototype.newLeaf=function(t,r){return new e(t,r)},e.prototype.newNode=function(t,e,r,i){return new jt.Node(t,e,r,i)},e}(Wt);jt.Leaf=qt;var Bt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._pages=e,o._knots=r,o._fold=i,o._size=n,o}return _(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this._pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._size},e.prototype.fold=function(){return this._fold},e.prototype.minKey=function(){return this._pages[0].minKey()},e.prototype.maxKey=function(){return this._pages[this._pages.length-1].maxKey()},e.prototype.has=function(t,e){var r=this.lookup(t,e);if(r>0)r+=1;else{if(!(r<0))return!0;r=-(r+1)}return this._pages[r].has(t,e)},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this._pages[r].get(t,e)},e.prototype.getEntry=function(t){for(var e=this._pages,r=0,i=e.length;r<i;r+=1){var n=e[r];if(t<n.size)return n.getEntry(t);t-=n.size}},e.prototype.firstEntry=function(){var t=this._pages;return t.length?t[0].firstEntry():void 0},e.prototype.lastEntry=function(){var t=this._pages;return t.length?t[t.length-1].lastEntry():void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this._pages,n=i[r].nextEntry(t,e);return void 0===n&&r+1<i.length&&(n=i[r+1].nextEntry(t,e)),n},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this._pages,n=i[r].previousEntry(t,e);return void 0===n&&r>0&&(n=i[r-1].previousEntry(t,e)),n},e.prototype.updated=function(t,e,r){var i=this.lookup(t,r);i>=0?i+=1:i=-(i+1);var n=this._pages[i],o=n.updated(t,e,r);return n!==o?n.size!==o.size&&r.pageShouldSplit(o)?this.updatedPageSplit(i,o,n):this.updatedPage(i,o,n):this},e.prototype.updatedPage=function(t,e,r){var i=this._pages.slice(0);i[t]=e;var n,o=this._knots;o.length>0?(n=o.slice(0),t>0&&(n[t-1]=e.minKey())):n=[];var s=this._size-r.size+e.size;return this.newNode(i,n,void 0,s)},e.prototype.updatedPageSplit=function(t,e,r){for(var i=this._pages,n=new Array(i.length+1),o=0;o<t;o+=1)n[o]=i[o];var s=e.splitLeft(e.arity>>>1),u=e.splitRight(e.arity>>>1);n[t]=s,n[t+1]=u;for(o=t+1;o<i.length;o+=1)n[o+1]=i[o];var a=this._knots,h=new Array(i.length);if(t>0){for(o=0;o<t-1;o+=1)h[o]=a[o];h[t-1]=s.minKey(),h[t]=u.minKey();for(o=t;o<a.length;o+=1)h[o+1]=a[o]}else{h[0]=u.minKey();for(o=0;o<a.length;o+=1)h[o+1]=a[o]}var p=this._size-r.size+e.size;return this.newNode(n,h,void 0,p)},e.prototype.updatedPageMerge=function(t,e,r){for(var i=this._pages,n=e._pages,o=new Array(i.length+n.length-1),s=0;s<t;s+=1)o[s]=i[s];for(s=0;s<n.length;s+=1)o[s+t]=n[s];for(s=t+1;s<i.length;s+=1)o[s+n.length-1]=i[s];var u=this._knots,a=e._knots,h=new Array(o.length-1);if(t>0){for(s=0;s<t-1;s+=1)h[s]=u[s];h[t-1]=n[0].minKey();for(s=0;s<a.length;s+=1)h[s+t]=a[s];for(s=t;s<u.length;s+=1)h[s+a.length]=u[s]}else{for(s=0;s<a.length;s+=1)h[s]=a[s];h[a.length]=i[1].minKey();for(s=1;s<u.length;s+=1)h[s+a.length]=u[s]}var p=this._size-r.size+e.size;return this.newNode(o,h,void 0,p)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this._pages[r],n=i.removed(t,e);return i!==n?this.replacedPage(r,n,i,e):this},e.prototype.replacedPage=function(t,r,i,n){return r.isEmpty()?this._pages.length>2?this.removedPage(t,r,i):this._pages.length>1?0===t?this._pages[1]:this._pages[0]:Wt.empty():r instanceof e&&n.pageShouldMerge(r)?this.updatedPageMerge(t,r,i):this.updatedPage(t,r,i)},e.prototype.removedPage=function(t,e,r){for(var i=this._pages,n=new Array(i.length-1),o=0;o<t;o+=1)n[o]=i[o];for(o=t+1;o<i.length;o+=1)n[o-1]=i[o];var s=this._knots,u=new Array(s.length-1);if(t>0){for(o=0;o<t-1;o+=1)u[o]=s[o];for(o=t;o<s.length;o+=1)u[o-1]=s[o]}else for(o=1;o<s.length;o+=1)u[o-1]=s[o];var a=this._size-r.size;return this.newNode(n,u,void 0,a)},e.prototype.drop=function(t,e){if(t>0){var r=this._size;if(t<r){for(var i=this._pages,n=0;n<i.length;){var o=i[n].size;if(!(o<=t))break;r-=o,t-=o,n+=1}var s=i.length-n;if(s>1){var u=void 0;if(n>0){for(var a=new Array(s),h=0;h<s;h+=1)a[h]=i[h+n];var p=new Array(s-1);for(h=0;h<p.length;h+=1)p[h]=this._knots[h+n];u=this.newNode(a,p,void 0,r)}else u=this;if(t>0){var l=i[n],c=l.drop(t,e);return u.replacedPage(0,c,l,e)}return u}return i[n].drop(t,e)}return Wt.empty()}return this},e.prototype.take=function(t,e){if(t<this._size){if(t>0){for(var r=this._pages,i=0,n=0;i<r.length&&t>0;){var o=r[i].size;if(n+=o,i+=1,!(o<=t))break;t-=o}var s=0===t?i:i+1;if(s>1){var u=void 0;if(i<r.length){for(var a=new Array(s),h=0;h<s;h+=1)a[h]=r[h];var p=new Array(s-1);for(h=0;h<p.length;h+=1)p[h]=this._knots[h];u=this.newNode(a,p,void 0,n)}else u=this;if(t>0){var l=r[i-1],c=l.take(t,e);return u.replacedPage(i-1,c,l,e)}return u}return t>0?r[0].take(t,e):r[0]}return Wt.empty()}return this},e.prototype.balanced=function(t){if(this._pages.length>1&&t.pageShouldSplit(this)){var e=this._knots.length>>>1;return this.split(e)}return this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;var n=new Array(1);return n[0]=i.minKey(),this.newNode(e,n,void 0,this._size)},e.prototype.splitLeft=function(t){for(var e=this._pages,r=new Array(t+1),i=0;i<t+1;i+=1)r[i]=e[i];var n=this._knots,o=new Array(t);for(i=0;i<t;i+=1)o[i]=n[i];var s=0;for(i=0;i<=t;i+=1)s+=r[i].size;return this.newNode(r,o,void 0,s)},e.prototype.splitRight=function(t){for(var e=this._pages,r=e.length-(t+1),i=new Array(r),n=0;n<r;n+=1)i[n]=e[n+(t+1)];var o=this._knots,s=new Array(r-1);for(n=0;n<s.length;n+=1)s[n]=o[n+(t+1)];var u=0;for(n=0;n<r;n+=1)u+=i[n].size;return this.newNode(i,s,void 0,u)},e.prototype.reduced=function(t,e,r){if(void 0===this._fold){for(var i=this._pages,n=i.length,o=new Array(n),s=0;s<n;s+=1)o[s]=i[s].reduced(t,e,r);var u=o[0].fold();for(s=1;s<n;s+=1)u=r(u,o[s].fold());return this.newNode(o,this._knots,u,this._size)}return this},e.prototype.forEach=function(t,e,r){for(var i=this._pages,n=0,o=i.length;n<o;n+=1){var s=i[n].forEach(t,e,r);if(void 0!==s)return s}},e.prototype.entries=function(){return new jt.NodeCursor(this._pages)},e.prototype.reverseEntries=function(){return new jt.NodeCursor(this._pages,this._size,this._pages.length)},e.prototype.lookup=function(t,e){for(var r=0,i=this._knots.length-1;r<=i;){var n=r+i>>>1,o=e.compare(t,this._knots[n]);if(o>0)r=n+1;else{if(!(o<0))return n;i=n-1}}return-(r+1)},e.prototype.newNode=function(t,r,i,n){return new e(t,r,i,n)},e}(Wt);jt.Node=Bt;var Kt=function(t){function e(e,r,i,n){return t.call(this,e,r,i,n)||this}return _(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(Nt);jt.NodeCursor=Kt;var Ht=function(){function t(){}return t.prototype.identify=function(t){var e=new Uint8Array(6);return u.fillBytes(e),e},t.prototype.compare=function(t,e){return f.compare(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}();Ht.prototype.pageSplitSize=32;var Gt=function(t){function e(r){void 0===r&&(r=e.Page.empty());var i=t.call(this)||this;return i.root=r,i}return _(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this.root.isEmpty()},e.prototype.get=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.get(t)},e.prototype.getEntry=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.getEntry(t)},e.prototype.set=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);var i=this.root;if(t<0||t>=i.size)throw new RangeError(""+t);return this.root=i.updated(t,e,this),this},e.prototype.insert=function(t,e,r){var i=this.root;if(t<0||t>i.size)throw new RangeError(""+t);return this.root=i.inserted(t,e,r,this).balanced(this),this},e.prototype.remove=function(t,e){if(void 0!==e&&(t=this.lookup(e,t))<0)throw new RangeError(""+e);var r=this.root;if(t<0||t>r.size)throw new RangeError(""+t);return this.root=r.removed(t,this),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.root,i=0;i<t.length;i+=1)r=r.inserted(r.size,t[i],void 0,this).balanced(this);return this.root=r,r.size},e.prototype.pop=function(){var t=this.root,e=t.size-1;if(e>=0){var r=t.get(e);return this.root=t.removed(e,this),r}},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.root,i=t.length-1;i>=0;i-=1)r=r.inserted(0,t[i],void 0,this).balanced(this);return this.root=r,r.size},e.prototype.shift=function(){var t=this.root;if(t.size>0){var e=t.get(0);return this.root=t.removed(0,this),e}},e.prototype.move=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);var i=this.root;if(t<0||t>=i.size)throw new RangeError(""+t);if(e<0||e>=i.size)throw new RangeError(""+e);if(t!==e){var n=i.getEntry(t);this.root=i.removed(t,this).inserted(e,n[1],n[0],this).balanced(this)}return this},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this.root;t<0&&(t=n.size+t),t=Math.min(Math.max(0,t),n.size),void 0===e&&(e=n.size-t);for(var o=[],s=t,u=t+e;s<u;s+=1)o.push(n.get(t)),n=n.removed(t,this);for(s=0;s<r.length;s+=1)n=n.inserted(t+s,r[s],void 0,this).balanced(this);return this.root=n,o},e.prototype.drop=function(t){var r=this.root;return t>0&&r.size>0&&(t<r.size?this.root=r.drop(t,this):this.root=e.Page.empty()),this},e.prototype.take=function(t){var r=this.root;return t<r.size&&r.size>0&&(this.root=t>0?r.take(t,this):e.Page.empty()),this},e.prototype.clear=function(){this.root=e.Page.empty()},e.prototype.forEach=function(t,e){return this.root.forEach(t,e,0,this)},e.prototype.keys=function(){return this.root.keys()},e.prototype.values=function(){return this.root.values()},e.prototype.entries=function(){return this.root.entries()},e.prototype.reverseKeys=function(){return this.root.reverseKeys()},e.prototype.reverseValues=function(){return this.root.reverseValues()},e.prototype.reverseEntries=function(){return this.root.reverseEntries()},e.prototype.clone=function(){return this.copy(this.root)},e.prototype.copy=function(t){var r=new e(t);return r.identify!==this.identify&&(r.identify=this.identify),r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},e.prototype.lookup=function(t,e){void 0===e&&(e=0);var r=this.root,i=e=Math.min(Math.max(0,e),r.size-1);do{var n=r.getEntry(i);if(n&&0===this.compare(n[0],t))return i;i=(i+1)%r.size}while(isFinite(i)&&i!==e);return-1},e}(Ht);Gt.prototype.pageSplitSize=32;var Xt=function(){function t(){}return t.prototype.keys=function(){return new Lt(this.entries())},t.prototype.values=function(){return new Ut(this.entries())},t.prototype.reverseKeys=function(){return new Lt(this.reverseEntries())},t.prototype.reverseValues=function(){return new Ut(this.reverseEntries())},t.empty=function(){return t._empty||(t._empty=new Gt.Leaf([])),t._empty},t}();Gt.Page=Xt;var Yt=function(t){function e(e){var r=t.call(this)||this;return r._slots=e,r}return _(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this._slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._slots.length},e.prototype.get=function(t){var e=this._slots[t];return e?e[1]:void 0},e.prototype.getEntry=function(t){return this._slots[t]},e.prototype.updated=function(t,e,r){if(t<0||t>=this._slots.length)throw new RangeError(""+t);return this.updatedItem(t,e)},e.prototype.updatedItem=function(t,r){var i=this._slots,n=i[t];if(r!==n[1]){var o=i.slice(0);return o[t]=[n[0],r],new e(o)}return this},e.prototype.inserted=function(t,e,r,i){if(t<0||t>this._slots.length)throw new RangeError(""+t);return this.insertedItem(t,e,r,i)},e.prototype.insertedItem=function(t,r,i,n){void 0===i&&(i=n.identify(r));for(var o=this._slots,s=new Array(o.length+1),u=0;u<t;u+=1)s[u]=o[u];s[t]=[i,r];for(u=t;u<o.length;u+=1)s[u+1]=o[u];return new e(s)},e.prototype.removed=function(t,e){if(t<0||t>=this._slots.length)throw new RangeError(""+t);return this._slots.length>1?this.removedSlot(t):Xt.empty()},e.prototype.removedSlot=function(t){for(var r=this._slots,i=new Array(r.length-1),n=0;n<t;n+=1)i[n]=r[n];for(n=t;n<i.length;n+=1)i[n]=r[n+1];return new e(i)},e.prototype.drop=function(t,r){var i=this._slots;if(t>0&&i.length>0){if(t<i.length){for(var n=i.length-t,o=new Array(n),s=0;s<n;s+=1)o[s]=i[s+t];return new e(o)}return Xt.empty()}return this},e.prototype.take=function(t,r){var i=this._slots;if(t<i.length&&i.length>0){if(t>0){for(var n=new Array(t),o=0;o<t;o+=1)n[o]=i[o];return new e(n)}return Xt.empty()}return this},e.prototype.balanced=function(t){var e=this._slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;var n=new Array(1);return n[0]=t,new Gt.Node(e,n,this._slots.length)},e.prototype.splitLeft=function(t){for(var r=this._slots,i=new Array(t),n=0;n<t;n+=1)i[n]=r[n];return new e(i)},e.prototype.splitRight=function(t){for(var r=this._slots,i=r.length-t,n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+t];return new e(n)},e.prototype.forEach=function(t,e,r,i){for(var n=0;n<this._slots.length;n+=1){var o=this._slots[n],s=t.call(e,o[1],r+n,i,o[0]);if(void 0!==s)return s}},e.prototype.entries=function(){return y.array(this._slots)},e.prototype.reverseEntries=function(){return y.array(this._slots,this._slots.length)},e}(Xt);Gt.Leaf=Yt;var Zt=function(t){function e(e,r,i){var n=t.call(this)||this;if(n._pages=e,void 0===r||void 0===i){i=0;for(var o=0,s=(r=new Array(e.length-1)).length;o<s;o+=1)i+=e[o].size,r[o]=i;i+=e[r.length].size}return n._knots=r,n._size=i,n}return _(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this._pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._size},e.prototype.get=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this._knots[e-1];return this._pages[e].get(r)},e.prototype.getEntry=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this._knots[e-1];return this._pages[e].getEntry(r)},e.prototype.updated=function(t,e,r){var i=this.lookup(t);i>=0?i+=1:i=-(i+1);var n=0===i?t:t-this._knots[i-1],o=this._pages[i],s=o.updated(n,e,r);return o!==s?o.size!==s.size&&r.pageShouldSplit(s)?this.updatedPageSplit(i,s,o):this.updatedPage(i,s,o):this},e.prototype.updatedPage=function(t,r,i){var n=this._pages,o=n.slice(0);o[t]=r;var s,u,a=this._knots;if(n.length-1>0){s=a.slice(0),u=t>0?a[t-1]:0;for(var h=t;h<s.length;h+=1)u+=o[h].size,s[h]=u;u+=o[s.length].size}else s=[],u=0;return new e(o,s,u)},e.prototype.updatedPageSplit=function(t,r,i){for(var n=this._pages,o=new Array(n.length+1),s=0;s<t;s+=1)o[s]=n[s];var u=r.splitLeft(r.arity>>>1),a=r.splitRight(r.arity>>>1);o[t]=u,o[t+1]=a;for(s=t+1;s<n.length;s+=1)o[s+1]=n[s];return new e(o)},e.prototype.updatedPageMerge=function(t,r,i){for(var n=this._pages,o=r._pages,s=new Array(n.length+o.length-1),u=0;u<t;u+=1)s[u]=n[u];for(u=0;u<o.length;u+=1)s[u+t]=o[u];for(u=t+1;u<n.length;u+=1)s[u+o.length-1]=n[u];return new e(s)},e.prototype.inserted=function(t,e,r,i){var n=this.lookup(t);n>=0?n+=1:n=-(n+1);var o=0===n?t:t-this._knots[n-1],s=this._pages[n],u=s.inserted(o,e,r,i);return s!==u?i.pageShouldSplit(u)?this.updatedPageSplit(n,u,s):this.updatedPage(n,u,s):this},e.prototype.removed=function(t,e){var r=this.lookup(t);r>=0?r+=1:r=-(r+1);var i=0===r?t:t-this._knots[r-1],n=this._pages[r],o=n.removed(i,e);return n!==o?this.replacedPage(r,o,n,e):this},e.prototype.replacedPage=function(t,r,i,n){return r.isEmpty()?this._pages.length>2?this.removedPage(t,r,i):this._pages.length>1?0===t?this._pages[1]:this._pages[0]:Xt.empty():r instanceof e&&n.pageShouldMerge(r)?this.updatedPageMerge(t,r,i):this.updatedPage(t,r,i)},e.prototype.removedPage=function(t,r,i){for(var n=this._pages,o=new Array(n.length-1),s=0;s<t;s+=1)o[s]=n[s];for(s=t+1;s<n.length;s+=1)o[s-1]=n[s];var u,a=this._knots,h=new Array(a.length-1);if(t>0){for(s=0;s<t;s+=1)h[s]=a[s];u=a[t-1]}else u=0;for(s=t;s<h.length;s+=1)u+=o[s].size,h[s]=u;return new e(o,h,u+=o[h.length].size)},e.prototype.drop=function(t,r){if(t>0){if(t<this._size){var i=this.lookup(t);i>=0?i+=1:i=-(i+1),t=0===i?t:t-this._knots[i-1];var n=this._pages,o=n.length-i;if(o>1){var s=void 0;if(i>0){for(var u=new Array(o),a=0;a<o;a+=1)u[a]=n[a+i];s=new e(u)}else s=this;if(t>0){var h=n[i],p=h.drop(t,r);return s.replacedPage(0,p,h,r)}return s}return n[i].drop(t,r)}return Xt.empty()}return this},e.prototype.take=function(t,r){if(t<this._size){if(t>0){var i=this.lookup(t);i>=0?i+=1:i=-(i+1),t=0===i?t:t-this._knots[i-1];var n=this._pages,o=0===t?i:i+1;if(o>1){var s=void 0;if(i<n.length){for(var u=new Array(o),a=0;a<o;a+=1)u[a]=n[a];var h=new Array(o-1);for(a=0;a<h.length;a+=1)h[a]=this._knots[a];s=new e(u,h,h[o-2]+u[o-1].size)}else s=this;if(t>0){var p=n[i],l=p.take(t,r);return s.replacedPage(i,l,p,r)}return s}return t>0?n[0].take(t,r):n[0]}return Xt.empty()}return this},e.prototype.balanced=function(t){if(this._pages.length>1&&t.pageShouldSplit(this)){var e=this._knots.length>>>1;return this.split(e)}return this},e.prototype.split=function(t){var r=new Array(2),i=this.splitLeft(t),n=this.splitRight(t);r[0]=i,r[1]=n;var o=new Array(1);return o[0]=i._size,new e(r,o,this._size)},e.prototype.splitLeft=function(t){for(var r=this._pages,i=new Array(t+1),n=0;n<t+1;n+=1)i[n]=r[n];var o=this._knots,s=new Array(t);for(n=0;n<t;n+=1)s[n]=o[n];var u=0;for(n=0;n<=t;n+=1)u+=i[n].size;return new e(i,s,u)},e.prototype.splitRight=function(t){for(var r=this._pages,i=r.length-(t+1),n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+(t+1)];var s,u=new Array(i-1);if(i>0){s=n[0].size;for(o=1;o<i;o+=1)u[o-1]=s,s+=n[o].size}else s=0;return new e(n,u,s)},e.prototype.forEach=function(t,e,r,i){for(var n=0;n<this._pages.length;n+=1){var o=this._pages[n],s=o.forEach(t,e,r,i);if(void 0!==s)return s;r+=o.size}},e.prototype.entries=function(){return new Gt.NodeCursor(this._pages)},e.prototype.reverseEntries=function(){return new Gt.NodeCursor(this._pages,this._size,this._pages.length)},e.prototype.lookup=function(t){for(var e=0,r=this._knots.length-1;e<=r;){var i=e+r>>>1;if(t>this._knots[i])e=i+1;else{if(!(t<this._knots[i]))return i;r=i-1}}return-(e+1)},e}(Xt);Gt.Node=Zt;var Qt=function(t){function e(e,r,i,n){return t.call(this,e,r,i,n)||this}return _(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(Nt);Gt.NodeCursor=Qt;var $t=function(){function t(){}return t.prototype.updated=function(e,r){var i=t.Record.create(2);return i.push(this),i.set(e,r),i},t.prototype.updatedAttr=function(e,r){var i=t.Record.create(2);return i.push(this),i.setAttr(e,r),i},t.prototype.updatedSlot=function(e,r){var i=t.Record.create(2);return i.push(this),i.setSlot(e,r),i},t.prototype.appended=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.Record.create(1+arguments.length);return i.push(this),i.push.apply(i,arguments),i},t.prototype.prepended=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.Record.create(arguments.length+1);return i.push.apply(i,arguments),i.push(this),i},t.prototype.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.Record.create();i.push(this);for(var n=0,o=arguments.length;n<o;n+=1)t.fromAny(arguments[n]).forEach((function(t){i.push(t)}));return i},t.prototype.lt=function(e){return e=t.fromAny(e),this.compareTo(e)<0?t.Bool.from(!0):t.absent()},t.prototype.le=function(e){return e=t.fromAny(e),this.compareTo(e)<=0?t.Bool.from(!0):t.absent()},t.prototype.eq=function(e){return e=t.fromAny(e),this.equals(e)?t.Bool.from(!0):t.absent()},t.prototype.ne=function(e){return e=t.fromAny(e),this.equals(e)?t.absent():t.Bool.from(!0)},t.prototype.ge=function(e){return e=t.fromAny(e),this.compareTo(e)>=0?t.Bool.from(!0):t.absent()},t.prototype.gt=function(e){return e=t.fromAny(e),this.compareTo(e)>0?t.Bool.from(!0):t.absent()},t.prototype.invoke=function(e){return t.absent()},t.prototype.filter=function(e){var r=t.Selector.literal(this);return r.filter.apply(r,arguments)},t.prototype.max=function(t){return this.compareTo(t)>=0?this:t},t.prototype.min=function(t){return this.compareTo(t)<=0?this:t},t.prototype.evaluate=function(t){return this},t.prototype.substitute=function(t){return this},t.prototype.cast=function(t,e){var r=t.cast(this);return void 0===r&&(r=e),r},t.prototype.coerce=function(t,e){var r=t.cast(this);return void 0===r&&(r=t.unit()),void 0===r&&(r=e),r},t.prototype.precedence=function(){return 11},t.prototype.forEach=function(t,e){return t.call(e,this,0)},t.prototype.iterator=function(){return y.unary(this)},t.prototype.display=function(t){this.debug(t)},t.prototype.toString=function(){return J.debug(this)},t.empty=function(){return t.Record.empty()},t.extant=function(){return t.Extant.extant()},t.absent=function(){return t.Absent.absent()},t.fromAny=function(e){return e instanceof t?e:t.Value.fromAny(e)},t.globalScope=function(){return t._globalScope||(t._globalScope=t.Record.create(1).slot("math",t.MathModule.scope()).commit()),t._globalScope},t}(),Jt=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isDistinct=function(){return!0},e.prototype.toValue=function(){return this.value},e.prototype.tag=function(){},e.prototype.target=function(){return this.value},e.prototype.flattened=function(){return $t.Value.absent()},e.prototype.unflattened=function(){return $t.Record.of(this)},e.prototype.header=function(t){return $t.Value.absent()},e.prototype.headers=function(t){},e.prototype.head=function(){return $t.absent()},e.prototype.tail=function(){return $t.Record.empty()},e.prototype.body=function(){return $t.Value.absent()},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return $t.Value.absent()},e.prototype.getAttr=function(t){return $t.Value.absent()},e.prototype.getSlot=function(t){return $t.Value.absent()},e.prototype.getField=function(t){},e.prototype.getItem=function(t){return $t.absent()},e.prototype.deleted=function(t){return this},e.prototype.conditional=function(t,e){return t=$t.fromAny(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=$t.fromAny(t)},e.prototype.lambda=function(t){return $t.Value.absent()},e.prototype.stringValue=function(t){return this.value.stringValue(t)},e.prototype.numberValue=function(t){return this.value.numberValue(t)},e.prototype.booleanValue=function(t){return this.value.booleanValue(t)},e.of=function(t,e){var r;return"string"==typeof t?r=t:t instanceof $t.Text&&(r=t.value),void 0!==r&&64===r.charCodeAt(0)?(arguments[0]=r.slice(1),$t.Attr.of.apply(void 0,arguments)):$t.Slot.of.apply(void 0,arguments)},e.fromAny=function(t){if(t instanceof e)return t;if(t&&"object"==typeof t){if(void 0!==t.$key)return e.of(t.$key,t.$value);for(var r in t)return e.of(r,t[r])}throw new TypeError(""+t)},e.IMMUTABLE=1,e}($t);$t.Field=Jt;var te=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),ee=function(){function t(t){this._maxScopeDepth=t}return t.prototype.maxScopeDepth=function(t){return void 0===t?this._maxScopeDepth:this.copy(t)},t.prototype.copy=function(e){return new t(e)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this._maxScopeDepth===e._maxScopeDepth)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(t._hashSeed,this._maxScopeDepth))},t.prototype.debug=function(t){t=t.write("new").write(32).write("InterpreterSettings").write(40).debug(this._maxScopeDepth).write(41)},t.prototype.toString=function(){return J.debug(this)},t.standard=function(){if(!t._standard){t._standard=new t(1024)}return t._standard},t}(),re=function(){function t(t,e,r){void 0===t&&(t=ee.standard()),void 0===e&&(e=null),void 0===r&&(r=0),this._settings=t,this._scopeStack=e,this._scopeDepth=r}return t.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=t,this)},t.prototype.scopeDepth=function(){return this._scopeDepth},t.prototype.peekScope=function(){var t=this._scopeDepth;if(t<=0)throw new te("scope stack empty");return this._scopeStack[t-1]},t.prototype.getScope=function(t){if(t<0||t>=this._scopeDepth)throw new RangeError(""+t);return this._scopeStack[t]},t.prototype.pushScope=function(e){var r=this._scopeDepth;if(r>=this._settings._maxScopeDepth)throw new te("scope stack overflow");var i,n=this._scopeStack;if(null===n||r+1>n.length){if(i=new Array(t.expand(r+1)),null!=n)for(var o=0;o<r;o+=1)i[o]=n[o];this._scopeStack=i}else i=n;i[r]=e,this._scopeDepth=r+1},t.prototype.popScope=function(){var t=this._scopeDepth;if(t<=0)throw new te("scope stack empty");var e=this._scopeStack,r=e[t-1];return e[t-1]=void 0,this._scopeDepth=t-1,r},t.prototype.swapScope=function(t){var e=this._scopeDepth;if(e<=0)throw new te("scope stack empty");var r=this._scopeStack,i=r[e-1];return r[e-1]=t,i},t.prototype.willOperate=function(t){},t.prototype.didOperate=function(t,e){},t.prototype.willSelect=function(t){},t.prototype.didSelect=function(t,e){},t.prototype.willTransform=function(t){},t.prototype.didTransform=function(t,e){},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=arguments.length,n=new Array(t.expand(i)),o=0;o<i;o+=1){var s=$t.fromAny(arguments[o]);n[o]=s}return new t(ee.standard(),n,i)},t.fromAny=function(e,r){if(void 0===r&&(r=$t.globalScope()),!(e instanceof t)){var i=e;e=new t,r&&e.pushScope(r),void 0!==i&&e.pushScope($t.fromAny(i))}return e},t.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},t}(),ie=function(t){function e(e,r,i){void 0===r&&(r=$t.Value.extant()),void 0===i&&(i=0);var n=t.call(this)||this;return n._key=e,n._value=r,n._flags=i,n}return _(e,t),e.prototype.isConstant=function(){return this._key.isConstant()&&this._value.isConstant()},Object.defineProperty(e.prototype,"name",{get:function(){return this._key.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){if(0!=(this._flags&Jt.IMMUTABLE))throw new Error("immutable");var e=this._value;return this._value=t,e},e.prototype.updatedValue=function(t){return new e(this._key,t)},e.prototype.bitwiseOr=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseOrOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseOr(t._value):t instanceof $t.Value?this._value.bitwiseOr(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.bitwiseXor=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseXorOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseXor(t._value):t instanceof $t.Value?this._value.bitwiseXor(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.bitwiseAnd=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseAndOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseAnd(t._value):t instanceof $t.Value?this._value.bitwiseAnd(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.plus=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.PlusOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.plus(t._value):t instanceof $t.Value?this._value.plus(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.minus=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.MinusOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.minus(t._value):t instanceof $t.Value?this._value.minus(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.times=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.TimesOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.times(t._value):t instanceof $t.Value?this._value.times(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.divide=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.DivideOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.divide(t._value):t instanceof $t.Value?this._value.divide(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.modulo=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.ModuloOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.modulo(t._value):t instanceof $t.Value?this._value.modulo(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.not=function(){var t=this._value.not();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.bitwiseNot=function(){var t=this._value.bitwiseNot();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.negative=function(){var t=this._value.negative();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.positive=function(){var t=this._value.positive();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.inverse=function(){var t=this._value.inverse();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.evaluate=function(t){t=re.fromAny(t);var r=this._key.evaluate(t).toValue(),i=this._value.evaluate(t).toValue();return r===this._key&&i===this._value?this:r.isDefined()&&i.isDefined()?r instanceof $t.Text?new e(r,i):new $t.Slot(r,i):$t.absent()},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._key.substitute(t).toValue(),i=this._value.substitute(t).toValue();return r===this._key&&i===this._value?this:r.isDefined()&&i.isDefined()?r instanceof $t.Text?new e(r,i):new $t.Slot(r,i):$t.absent()},e.prototype.toAny=function(){var t={};return t["@"+this._key.value]=this._value.toAny(),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return 0==(this._flags&Jt.IMMUTABLE)},e.prototype.alias=function(){this._flags|=Jt.IMMUTABLE},e.prototype.branch=function(){return 0!=(this._flags&Jt.IMMUTABLE)?new e(this._key,this._value,this._flags&~Jt.IMMUTABLE):this},e.prototype.clone=function(){return new e(this._key.clone(),this._value.clone())},e.prototype.commit=function(){return 0==(this._flags&Jt.IMMUTABLE)&&(this._flags|=Jt.IMMUTABLE,this._value.commit()),this},e.prototype.typeOrder=function(){return 1},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._key.compareTo(t._key);return 0===r&&(r=this._value.compareTo(t._value)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.keyEquals=function(t){return"string"==typeof t?this._key.value===t:t instanceof Jt?this._key.equals(t.key):this._key.equals(t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._value.equals(t._value))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._key.hashCode()),this._value.hashCode()))},e.prototype.debug=function(t){t=t.write("Attr").write(46).write("of").write(40).display(this.key),this.value instanceof $t.Extant||(t=t.write(44).write(32).display(this.value)),t=t.write(41)},e.prototype.display=function(t){this.debug(t)},e.of=function(t,r){return new e(t=$t.Text.fromAny(t),r=arguments.length>=2?$t.Value.fromAny(r):$t.Value.extant())},e}(Jt);$t.Attr=ie;var ne=function(t){function e(e,r,i){void 0===r&&(r=$t.Value.extant()),void 0===i&&(i=0);var n=t.call(this)||this;return n._key=e.commit(),n._value=r,n._flags=i,n}return _(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.isConstant=function(){return this._key.isConstant()&&this._value.isConstant()},e.prototype.setValue=function(t){if(0!=(this._flags&Jt.IMMUTABLE))throw new Error("immutable");var e=this._value;return this._value=t,e},e.prototype.updatedValue=function(t){return new e(this._key,t)},e.prototype.bitwiseOr=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseOrOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseOr(t._value):t instanceof $t.Value?this._value.bitwiseOr(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.bitwiseXor=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseXorOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseXor(t._value):t instanceof $t.Value?this._value.bitwiseXor(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.bitwiseAnd=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.BitwiseAndOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.bitwiseAnd(t._value):t instanceof $t.Value?this._value.bitwiseAnd(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.plus=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.PlusOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.plus(t._value):t instanceof $t.Value?this._value.plus(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.minus=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.MinusOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.minus(t._value):t instanceof $t.Value?this._value.minus(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.times=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.TimesOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.times(t._value):t instanceof $t.Value?this._value.times(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.divide=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.DivideOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.divide(t._value):t instanceof $t.Value?this._value.divide(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.modulo=function(t){return(t=$t.fromAny(t))instanceof $t.Expression?new $t.ModuloOperator(this,t):(r=t instanceof e&&this._key.equals(t._key)?this._value.modulo(t._value):t instanceof $t.Value?this._value.modulo(t):$t.Value.absent()).isDefined()?new e(this._key,r):$t.absent();var r},e.prototype.not=function(){var t=this._value.not();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.bitwiseNot=function(){var t=this._value.bitwiseNot();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.negative=function(){var t=this._value.negative();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.positive=function(){var t=this._value.positive();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.inverse=function(){var t=this._value.inverse();return t.isDefined()?new e(this._key,t):$t.absent()},e.prototype.evaluate=function(t){t=re.fromAny(t);var r=this._key.evaluate(t).toValue(),i=this._value.evaluate(t).toValue();return r===this._key&&i===this._value?this:r.isDefined()&&i.isDefined()?new e(r,i):$t.absent()},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._key.substitute(t).toValue(),i=this._value.substitute(t).toValue();return r===this._key&&i===this._value?this:r.isDefined()&&i.isDefined()?new e(r,i):$t.absent()},e.prototype.toAny=function(){var t={};return this._key instanceof $t.Text?t[this._key.value]=this._value.toAny():(t.$key=this._key.toAny(),t.$value=this._value.toAny()),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return 0==(this._flags&Jt.IMMUTABLE)},e.prototype.alias=function(){this._flags|=Jt.IMMUTABLE},e.prototype.branch=function(){return 0!=(this._flags&Jt.IMMUTABLE)?new e(this._key,this._value,this._flags&~Jt.IMMUTABLE):this},e.prototype.clone=function(){return new e(this._key.clone(),this._value.clone())},e.prototype.commit=function(){return 0==(this._flags&Jt.IMMUTABLE)&&(this._flags|=Jt.IMMUTABLE,this._value.commit()),this},e.prototype.typeOrder=function(){return 2},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._key.compareTo(t._key);return 0===r&&(r=this._value.compareTo(t._value)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.keyEquals=function(t){return"string"==typeof t&&this._key instanceof $t.Text?this._key.value===t:t instanceof Jt?this._key.equals(t.key):this._key.equals(t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._value.equals(t._value))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._key.hashCode()),this._value.hashCode()))},e.prototype.debug=function(t){t=t.write("Slot").write(46).write("of").write(40).display(this.key),this.value instanceof $t.Extant||(t=t.write(44).write(32).display(this.value)),t=t.write(41)},e.prototype.display=function(t){this.debug(t)},e.of=function(t,r){return new e(t=$t.Value.fromAny(t),r=arguments.length>=2?$t.Value.fromAny(r):$t.Value.extant())},e}(Jt);$t.Slot=ne;var oe=function(){function t(){this._record=null,this._value=null}return t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=arguments.length;r<i;r+=1){var n=arguments[r];if(n instanceof Jt)return this.pushField(n);if(n instanceof se)return this.pushValue(n);throw new TypeError(""+n)}},t.prototype.pushField=function(t){null===this._record&&(this._record=$t.Record.create(),null!==this._value&&(this._record.push(this._value),this._value=null)),this._record.push(t)},t.prototype.pushValue=function(t){null!=this._record?this._record.push(t):null==this._value?this._value=t:(this._record=$t.Record.create(),this._record.push(this._value),this._value=null,this._record.push(t))},t.prototype.bind=function(){return null!==this._record?this._record:null!==this._value?this._value:se.absent()},t}(),se=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isDistinct=function(){return!0},Object.defineProperty(e.prototype,"key",{get:function(){return e.absent()},enumerable:!0,configurable:!0}),e.prototype.toValue=function(){return this},e.prototype.tag=function(){},e.prototype.target=function(){return this},e.prototype.flattened=function(){return this},e.prototype.unflattened=function(){return e.Record.of(this)},e.prototype.header=function(t){return e.absent()},e.prototype.headers=function(t){},e.prototype.head=function(){return $t.absent()},e.prototype.tail=function(){return e.Record.empty()},e.prototype.body=function(){return e.extant()},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return e.absent()},e.prototype.getAttr=function(t){return e.absent()},e.prototype.getSlot=function(t){return e.absent()},e.prototype.getField=function(t){},e.prototype.getItem=function(t){return $t.absent()},e.prototype.deleted=function(t){return this},e.prototype.conditional=function(t,e){return t=$t.fromAny(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=$t.fromAny(t)},e.prototype.bitwiseOr=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.BitwiseOrOperator(this,t);if(t instanceof $t.Attr){if((e=this.bitwiseOr(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.bitwiseOr(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.bitwiseXor=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.BitwiseXorOperator(this,t);if(t instanceof $t.Attr){if((e=this.bitwiseXor(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.bitwiseXor(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.bitwiseAnd=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.BitwiseAndOperator(this,t);if(t instanceof $t.Attr){if((e=this.bitwiseAnd(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.bitwiseAnd(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.lt=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.LtOperator(this,e):t.prototype.lt.call(this,e)},e.prototype.le=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.LeOperator(this,e):t.prototype.le.call(this,e)},e.prototype.eq=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.EqOperator(this,e):t.prototype.eq.call(this,e)},e.prototype.ne=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.NeOperator(this,e):t.prototype.ne.call(this,e)},e.prototype.ge=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.GeOperator(this,e):t.prototype.ge.call(this,e)},e.prototype.gt=function(e){return(e=$t.fromAny(e))instanceof $t.Expression?new $t.GtOperator(this,e):t.prototype.gt.call(this,e)},e.prototype.plus=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.PlusOperator(this,t);if(t instanceof $t.Attr){if((e=this.plus(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.plus(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.minus=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.MinusOperator(this,t);if(t instanceof $t.Attr){if((e=this.minus(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.minus(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.times=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.TimesOperator(this,t);if(t instanceof $t.Attr){if((e=this.times(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.times(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.divide=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.DivideOperator(this,t);if(t instanceof $t.Attr){if((e=this.divide(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.divide(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.modulo=function(t){if((t=$t.fromAny(t))instanceof $t.Expression)return new $t.ModuloOperator(this,t);if(t instanceof $t.Attr){if((e=this.modulo(t.value)).isDefined())return new $t.Attr(t.key,e)}else if(t instanceof $t.Slot){var e;if((e=this.modulo(t.value)).isDefined())return new $t.Slot(t.key,e)}return $t.absent()},e.prototype.not=function(){return e.absent()},e.prototype.bitwiseNot=function(){return e.absent()},e.prototype.negative=function(){return e.absent()},e.prototype.positive=function(){return e.absent()},e.prototype.inverse=function(){return e.absent()},e.prototype.lambda=function(t){return new $t.LambdaFunc(this,t)},e.prototype.stringValue=function(t){return t},e.prototype.numberValue=function(t){return t},e.prototype.booleanValue=function(t){return t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!1},e.prototype.alias=function(){},e.prototype.branch=function(){return this},e.prototype.clone=function(){return this},e.prototype.commit=function(){return this},e.prototype.keyEquals=function(t){return!1},e.builder=function(){return new oe},e.empty=function(){return e.Record.empty()},e.extant=function(){return e.Extant.extant()},e.absent=function(){return e.Absent.absent()},e.fromAny=function(t){if(t instanceof e)return t;if(void 0===t)return e.Absent.absent();if(null===t)return e.Extant.extant();if("boolean"==typeof t)return e.Bool.from(t);if("number"==typeof t)return e.Num.from(t);if("string"==typeof t)return e.Text.from(t);if(t instanceof Uint8Array)return e.Data.wrap(t);if(Array.isArray(t))return e.Record.fromArray(t);if("object"==typeof t)return e.Record.fromObject(t);throw new TypeError(""+t)},e}($t);$t.Value=se;var ue=function(t){function e(e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=e.length),void 0===n&&(n=r);var o=t.call(this)||this;return o._record=e,o._lower=r,o._upper=i,o._index=n,o._direction=0,o}return _(e,t),e.prototype.isEmpty=function(){return this._index>=this._upper},e.prototype.head=function(){if(this._direction=0,this._index<this._upper)return this._record.getItem(this._index);throw new Error("empty")},e.prototype.step=function(){if(this._direction=0,!(this._index<this._upper))throw new Error("empty");this._index+=1},e.prototype.skip=function(t){this._index=Math.min(Math.max(this._lower,this._index+t,this._upper))},e.prototype.hasNext=function(){return this._index<this._upper},e.prototype.nextIndex=function(){return this._index-this._lower},e.prototype.next=function(){this._direction=1;var t=this._index;return t<this._upper?(this._index=t+1,{value:this._record.getItem(t),done:this._index===this._upper}):(this._index=this._upper,{done:!0})},e.prototype.hasPrevious=function(){return this._index>this._lower},e.prototype.previousIndex=function(){return this._index-this._lower-1},e.prototype.previous=function(){this._direction=-1;var t=this._index-1;return t>=this._lower?(this._index=t,{value:this._record.getItem(t),done:t===this._lower}):(this._index=0,{done:!0})},e.prototype.set=function(t){this._direction>0?this._record.setItem(this._index-1,t):this._record.setItem(this._index,t)},e.prototype.delete=function(){this._direction>0&&(this._index-=1),this._record.splice(this._index,1),this._direction=0},e}(y),ae=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isArray=function(){return 0===this.fieldCount()},e.prototype.isObject=function(){return 0===this.valueCount()},e.prototype.fieldCount=function(){var t=0;return this.forEach((function(e){e instanceof $t.Field&&(t+=1)}),this),t},e.prototype.valueCount=function(){var t=0;return this.forEach((function(e){e instanceof se&&(t+=1)}),this),t},e.prototype.isConstant=function(){return void 0===this.forEach((function(t){return!!t.isConstant()&&void 0}),this)},e.prototype.tag=function(){var t=this.head();if(t instanceof $t.Attr)return t.key.value},e.prototype.target=function(){var t,r,i=!1;return this.forEach((function(n){n instanceof $t.Attr?i=!0:void 0===t&&n instanceof se?t=n:(void 0===r&&(r=e.create(),void 0!==t&&r.push(t)),r.push(n))}),this),void 0===t?se.extant():void 0===r?t:i?r:this},e.prototype.flattened=function(){if(this.isEmpty())return se.extant();var t=this.iterator(),e=t.head();return t.step(),t.isEmpty()&&e instanceof se?e:this.branch()},e.prototype.unflattened=function(){return this},e.prototype.header=function(t){var e=this.head();return e instanceof $t.Attr&&e.key.value===t?e.value:se.absent()},e.prototype.headers=function(t){var r=this.head();if(r instanceof $t.Attr&&r.key.value===t){var i=r.value;return i instanceof e?i:e.of(i)}},e.prototype.head=function(){return this.forEach((function(t){return t}),this)||$t.absent()},e.prototype.tail=function(){var t=e.create();return this.forEach((function(e,r){r>0&&t.push(e)}),this),t},e.prototype.body=function(){var t=this.tail();return t.isEmpty()?se.absent():t.flattened()},e.prototype.has=function(t){return t=se.fromAny(t),this.forEach((function(e){return!!(e instanceof $t.Field&&e.key.equals(t))||void 0}),this)||!1},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=$t.fromAny(t),e<0&&(e=Math.max(0,this.length+e));var r=this.forEach((function(r,i){return i>=e&&t.equals(r)?i:void 0}),this);return void 0!==r?r:-1},e.prototype.lastIndexOf=function(t,e){t=$t.fromAny(t);var r=this.length;for(void 0===e?e=r-1:e<0&&(e=r+e),e=Math.min(e,r-1);e>=0;){if(t.equals(this.getItem(e)))return e;e-=1}return-1},e.prototype.get=function(t){return t=se.fromAny(t),this.forEach((function(e){return e instanceof $t.Field&&e.key.equals(t)?e.value:void 0}),this)||se.absent()},e.prototype.getAttr=function(t){return t=se.Text.fromAny(t),this.forEach((function(e){return e instanceof $t.Attr&&e.key.equals(t)?e.value:void 0}),this)||se.absent()},e.prototype.getSlot=function(t){return t=se.fromAny(t),this.forEach((function(e){return e instanceof $t.Slot&&e.key.equals(t)?e.value:void 0}),this)||se.absent()},e.prototype.getField=function(t){return t=se.fromAny(t),this.forEach((function(e){return e instanceof $t.Field&&e.key.equals(t)?e:void 0}),this)},e.prototype.set=function(t,e){t=se.fromAny(t),e=se.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var i=r.head();if(i instanceof $t.Field&&i.key.equals(t))return i.isMutable()?i.setValue(e):r.set(i.updatedValue(e)),this;r.step()}return this.push(new $t.Slot(t,e)),this},e.prototype.setAttr=function(t,e){t=se.Text.fromAny(t),e=se.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var i=r.head();if(i instanceof $t.Field&&i.key.equals(t))return i instanceof $t.Attr&&i.isMutable()?i.setValue(e):r.set(new $t.Attr(t,e)),this;r.step()}return this.push(new $t.Attr(t,e)),this},e.prototype.setSlot=function(t,e){t=se.fromAny(t),e=se.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var i=r.head();if(i instanceof $t.Field&&i.key.equals(t))return i instanceof $t.Slot&&i.isMutable()?i.setValue(e):r.set(new $t.Slot(t,e)),this;r.step()}return this.push(new $t.Slot(t,e)),this},e.prototype.updated=function(t,e){t=se.fromAny(t),e=se.fromAny(e);for(var r=this.isMutable()?this:this.branch(),i=r.iterator();!i.isEmpty();){var n=i.head();if(n.key.equals(t))return n instanceof $t.Field&&n.isMutable()?n.setValue(e):i.set(new $t.Slot(t,e)),r;i.step()}return r.push(new $t.Slot(t,e)),r},e.prototype.updatedAttr=function(t,e){t=se.Text.fromAny(t),e=se.fromAny(e);for(var r=this.isMutable()?this:this.branch(),i=r.iterator();!i.isEmpty();){var n=i.head();if(n.key.equals(t))return n instanceof $t.Attr&&n.isMutable()?n.setValue(e):i.set(new $t.Attr(t,e)),r;i.step()}return r.push(new $t.Attr(t,e)),r},e.prototype.updatedSlot=function(t,e){t=se.fromAny(t),e=se.fromAny(e);for(var r=this.isMutable()?this:this.branch(),i=r.iterator();!i.isEmpty();){var n=i.head();if(n.key.equals(t))return n instanceof $t.Slot&&n.isMutable()?n.setValue(e):i.set(new $t.Slot(t,e)),r;i.step()}return r.push(new $t.Slot(t,e)),r},e.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.isMutable()?this:this.branch();return r.push.apply(r,arguments),r},e.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.isMutable()?this:this.branch();return r.splice.apply(r,Array.prototype.concat.apply([0,0],arguments)),r},e.prototype.deleted=function(t){var e=this.isMutable()?this:this.branch();return e.delete(t),e},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.isMutable()?this:this.branch(),i=0,n=arguments.length;i<n;i+=1)$t.fromAny(arguments[i]).forEach((function(t){r.push(t)}));return r},e.prototype.slice=function(t,e){return this.subRecord.apply(this,arguments).branch()},e.prototype.attr=function(t,e){return this.push($t.Attr.of.apply(void 0,arguments)),this},e.prototype.slot=function(t,e){return this.push($t.Slot.of.apply(void 0,arguments)),this},e.prototype.item=function(t){return this.push(t),this},e.prototype.items=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.push.apply(this,arguments),this},e.prototype.evaluate=function(t){t=re.fromAny(t);var r=e.create();t.pushScope(r);var i=!1;return this.forEach((function(e){var n=e.evaluate(t);n.isDefined()&&r.push(n),e!==n&&(i=!0)}),this),t.popScope(),i?r:this},e.prototype.substitute=function(t){t=re.fromAny(t);var r=e.create();t.pushScope(r);var i=!1;return this.forEach((function(e){var n=e.substitute(t);n.isDefined()&&r.push(n),e!==n&&(i=!0)}),this),t.popScope(),i?r:this},e.prototype.stringValue=function(t){var e="";return void 0===this.forEach((function(t){if(t instanceof se){var r=t.stringValue();if(void 0!==r)return void(e+=r)}return null}),this)?e:void 0},e.prototype.toAny=function(){return!this.isEmpty()&&this.isArray()?this.toArray():this.toObject()},e.prototype.toArray=function(){var t=new Array(this.length);return this.forEach((function(e,r){e instanceof se?t[r]=e.toAny():e instanceof $t.Field&&(t[r]={$key:e.key.toAny(),$value:e.value.toAny()})}),this),t},e.prototype.toObject=function(){var t={};return this.forEach((function(e,r){e instanceof $t.Attr?t["@"+e.key.value]=e.value.toAny():e instanceof $t.Slot?e.key instanceof se.Text?t[e.key.value]=e.value.toAny():t["$"+r]={$key:e.key.toAny(),$value:e.value.toAny()}:e instanceof se&&(t["$"+r]=e.toAny())}),this),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!0},e.prototype.alias=function(){},e.prototype.branch=function(){var t=e.create();return this.forEach((function(e){t.push(e)}),this),t},e.prototype.clone=function(){var t=e.create();return this.forEach((function(e){t.push(e.clone())}),this),t},e.prototype.commit=function(){return this},e.prototype.bind=function(){return this},e.prototype.subRecord=function(t,e){var r=this.length;void 0===t?t=0:t<0&&(t=r+t),t=Math.min(Math.max(0,t),r),void 0===e?e=r:e<0&&(e=r+e);var i=se.Record.create();return this.forEach((function(r,n){return n<t?void 0:n<e?void i.push(r):null}),this),i},e.prototype.iterator=function(){return new ue(this)},e.prototype.typeOrder=function(){return 3},e.prototype.compareTo=function(t){if(t instanceof e){var r=this.iterator(),i=t.iterator(),n=0;do{if(r.isEmpty()||i.isEmpty())break;n=r.head().compareTo(i.head()),r.step(),i.step()}while(0===n);return 0!==n?n:r.isEmpty()&&!i.isEmpty()?-1:!r.isEmpty()&&i.isEmpty()?1:0}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){for(var r=this.iterator(),i=t.iterator();!r.isEmpty()&&!i.isEmpty();){if(!r.head().equals(i.head()))return!1;r.step(),i.step()}return r.isEmpty()&&i.isEmpty()}return!1},e.prototype.hashCode=function(){if(void 0===this._hashCode){void 0===e._hashSeed&&(e._hashSeed=c.seed(e));var t=e._hashSeed;this.forEach((function(e){t=c.mix(t,e.hashCode())}),this),this._hashCode=c.mash(t)}return this._hashCode},e.prototype.debug=function(t){t=t.write("Record").write(46),this.isEmpty()?t=t.write("empty").write(40).write(41):(t=t.write("of").write(40),this.forEach((function(e,r){0!==r&&(t=t.write(44).write(32)),t.display(e)}),this),t=t.write(41))},e.prototype.display=function(t){this.debug(t)},e.empty=function(){return e.RecordMap.empty()},e.create=function(t){return e.RecordMap.create(t)},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.RecordMap.of.apply(void 0,arguments)},e.fromAny=function(t){if(t instanceof e)return t;if(Array.isArray(t))return e.fromArray(t);if(t&&"object"==typeof t)return e.fromObject(t);throw new TypeError(""+t)},e.fromArray=function(t){for(var r=t.length||0,i=e.create(r),n=0;n<r;n+=1)i.push($t.fromAny(t[n]));return i},e.fromObject=function(t){var r=e.create();for(var i in t){var n=t[i];36===i.charCodeAt(0)?n&&"object"==typeof n&&n.hasOwnProperty("$key")?r.push($t.Field.of(n.$key,n.$value)):r.push(se.fromAny(n)):r.push($t.Field.of(i,n))}return r},e.expand=function(t){return t=Math.max(8,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e.ALIASED=1,e.IMMUTABLE=2,e}(se);$t.Record=ae;var he=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._array=e,s._table=r,s._itemCount=i,s._fieldCount=n,s._flags=o,s}return _(e,t),e.prototype.isEmpty=function(){return 0===this._itemCount},Object.defineProperty(e.prototype,"length",{get:function(){return this._itemCount},enumerable:!0,configurable:!0}),e.prototype.fieldCount=function(){return this._fieldCount},e.prototype.valueCount=function(){return this._itemCount-this._fieldCount},e.prototype.isConstant=function(){for(var t=this._array,e=0,r=this._itemCount;e<r;e+=1)if(!t[e].isConstant())return!1;return!0},e.prototype.tag=function(){if(this._fieldCount>0){var t=this._array[0];if(t instanceof $t.Attr)return t.key.value}},e.prototype.target=function(){for(var t,e,r=!1,i=this._array,n=0,o=this._itemCount;n<o;n+=1){var s=i[n];s instanceof $t.Attr?r=!0:void 0===t&&s instanceof se?t=s:(void 0===e&&(e=ae.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?se.extant():void 0===e?t:r?e:this},e.prototype.head=function(){return this._itemCount>0?this._array[0]:$t.absent()},e.prototype.tail=function(){var t=this._itemCount;return t>0?new ae.RecordMapView(this,1,t):ae.empty()},e.prototype.body=function(){var t=this._itemCount;if(t>2)return new ae.RecordMapView(this,1,t).branch();if(2===t){var e=this._array[1];return e instanceof se?e:ae.of(e)}return se.absent()},e.prototype.has=function(t){if(0!==this._fieldCount){t=se.fromAny(t);var e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r),n=i;do{var o=e[n];if(void 0===o)break;if(o.key.equals(t))return!0;n=(n+1)%r}while(n!==i)}return!1},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=$t.fromAny(t);var r=this._array,i=this._itemCount;for(e<0&&(e=Math.max(0,i+e));e<i;){if(t.equals(r[e]))return e;e+=1}return-1},e.prototype.lastIndexOf=function(t,e){t=$t.fromAny(t);var r=this._array,i=this._itemCount;for(void 0===e?e=i-1:e<0&&(e=i+e),e=Math.min(e,i-1);e>=0;){if(t.equals(r[e]))return e;e-=1}return-1},e.prototype.get=function(t){if(this._fieldCount>0){t=se.fromAny(t);var e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r),n=i;do{var o=e[n];if(void 0===o)break;if(o.key.equals(t))return o.value;n=(n+1)%r}while(n!==i)}return se.absent()},e.prototype.getAttr=function(t){if(this._fieldCount>0){t=se.Text.fromAny(t);var e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r),n=i;do{var o=e[n];if(void 0===o)break;if(o instanceof $t.Attr&&o.key.equals(t))return o.value;n=(n+1)%r}while(n!==i)}return se.absent()},e.prototype.getSlot=function(t){if(this._fieldCount>0){t=se.fromAny(t);var e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r),n=i;do{var o=e[n];if(void 0===o)break;if(o instanceof $t.Slot&&o.key.equals(t))return o.value;n=(n+1)%r}while(n!==i)}return se.absent()},e.prototype.getField=function(t){if(this._fieldCount>0){t=se.fromAny(t);var e=this.hashTable(),r=e.length,i=Math.abs(t.hashCode()%r),n=i;do{var o=e[n];if(void 0===o)break;if(o.key.equals(t))return o;n=(n+1)%r}while(n!==i)}},e.prototype.getItem=function(t){t instanceof $t.Num&&(t=t.value);var e=this._itemCount;return t<0&&(t=e+t),t>=0&&t<e?this._array[t]:$t.absent()},e.prototype.set=function(t,e){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");return t=se.fromAny(t),e=se.fromAny(e),0!=(this._flags&ae.ALIASED)?this._fieldCount>0?this.setAliased(t,e):this.pushAliased(new $t.Slot(t,e)):this._fieldCount>0?null!==this._table?this.setMutable(t,e):this.updateMutable(t,e):this.pushMutable(new $t.Slot(t,e)),this},e.prototype.setAliased=function(t,e){for(var r=this._itemCount,i=this._array,n=new Array(ae.expand(r+1)),o=0;o<r;o+=1){var s=i[o];if(s instanceof $t.Field&&s.key.equals(t)){for(n[o]=s.updatedValue(e),o+=1;o<r;)n[o]=i[o],o+=1;return this._array=n,this._table=null,void(this._flags&=~ae.ALIASED)}n[o]=s}n[r]=new $t.Slot(t,e),this._array=n,this._table=null,this._itemCount=r+1,this._fieldCount+=1,this._flags&=~ae.ALIASED},e.prototype.setMutable=function(t,r){var i=this._table,n=i.length,o=Math.abs(t.hashCode()%n),s=o;do{var u=i[s];if(void 0===u)break;if(u.key.equals(t))return u.isMutable()?void u.setValue(r):void this.updateMutable(t,r);s=(s+1)%n}while(s!==o);var a=new $t.Slot(t,r);this.pushMutable(a),e.put(i,a)},e.prototype.updateMutable=function(t,r){for(var i=this._array,n=0,o=this._itemCount;n<o;n+=1){var s=i[n];if(s instanceof $t.Field&&s.key.equals(t))return i[n]=s.updatedValue(r),void(this._table=null)}var u=new $t.Slot(t,r);this.pushMutable(u),e.put(this._table,u)},e.prototype.setAttr=function(t,e){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");return t=se.Text.fromAny(t),e=se.fromAny(e),0!=(this._flags&ae.ALIASED)?this._fieldCount>0?this.setAttrAliased(t,e):this.pushAliased(new $t.Attr(t,e)):this._fieldCount>0?null!==this._table?this.setAttrMutable(t,e):this.updateAttrMutable(t,e):this.pushMutable(new $t.Attr(t,e)),this},e.prototype.setAttrAliased=function(t,e){for(var r=this._itemCount,i=this._array,n=new Array(ae.expand(r+1)),o=0;o<r;o+=1){var s=i[o];if(s instanceof $t.Field&&s.key.equals(t)){for(n[o]=new $t.Attr(t,e),o+=1;o<r;)n[o]=i[o],o+=1;return this._array=n,this._table=null,void(this._flags&=~ae.ALIASED)}n[o]=s}n[r]=new $t.Attr(t,e),this._array=n,this._table=null,this._itemCount=r+1,this._fieldCount+=1,this._flags&=~ae.ALIASED},e.prototype.setAttrMutable=function(t,r){var i=this._table,n=i.length,o=Math.abs(t.hashCode()%n),s=o;do{var u=i[s];if(void 0===u)break;if(u.key.equals(t))return void(u instanceof $t.Attr&&u.isMutable()?u.setValue(r):this.updateAttrMutable(t,r));s=(s+1)%n}while(s!==o);var a=new $t.Attr(t,r);this.push(a),e.put(i,a)},e.prototype.updateAttrMutable=function(t,r){for(var i=this._array,n=0,o=this._itemCount;n<o;n+=1){var s=i[n];if(s instanceof $t.Field&&s.key.equals(t))return i[n]=new $t.Attr(t,r),void(this._table=null)}var u=new $t.Attr(t,r);this.push(u),e.put(this._table,u)},e.prototype.setSlot=function(t,e){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");return t=se.fromAny(t),e=se.fromAny(e),0!=(this._flags&ae.ALIASED)?this._fieldCount>0?this.setSlotAliased(t,e):this.pushAliased(new $t.Slot(t,e)):this._fieldCount>0?null!==this._table?this.setSlotMutable(t,e):this.updateSlotMutable(t,e):this.pushMutable(new $t.Slot(t,e)),this},e.prototype.setSlotAliased=function(t,e){for(var r=this._itemCount,i=this._array,n=new Array(ae.expand(r+1)),o=0;o<r;o+=1){var s=i[o];if(s instanceof $t.Field&&s.key.equals(t)){for(n[o]=new $t.Slot(t,e),o+=1;o<r;)n[o]=i[o],o+=1;return this._array=n,this._table=null,void(this._flags&=~ae.ALIASED)}n[o]=s}n[r]=new $t.Slot(t,e),this._array=n,this._table=null,this._itemCount=r+1,this._fieldCount+=1,this._flags&=~ae.ALIASED},e.prototype.setSlotMutable=function(t,r){var i=this._table,n=i.length,o=Math.abs(t.hashCode()%n),s=o;do{var u=i[s];if(void 0===u)break;if(u.key.equals(t))return void(u instanceof $t.Slot&&u.isMutable()?u.setValue(r):this.updateSlotMutable(t,r));s=(s+1)%n}while(s!==o);var a=new $t.Slot(t,r);this.push(a),e.put(i,a)},e.prototype.updateSlotMutable=function(t,r){for(var i=this._array,n=0,o=this._itemCount;n<o;n+=1){var s=i[n];if(s instanceof $t.Field&&s.key.equals(t))return i[n]=new $t.Slot(t,r),void(this._table=null)}var u=new $t.Slot(t,r);this.push(u),e.put(this._table,u)},e.prototype.setItem=function(t,e){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");e=$t.fromAny(e);var r=this._itemCount;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this._flags&ae.ALIASED)?this.setItemAliased(t,e):this.setItemMutable(t,e),this},e.prototype.setItemAliased=function(t,e){for(var r=this._itemCount,i=this._array,n=new Array(ae.expand(r)),o=0;o<r;o+=1)n[o]=i[o];var s=i[t];n[t]=e,this._array=n,this._table=null,e instanceof $t.Field?s instanceof $t.Field||(this._fieldCount+=1):s instanceof $t.Field&&(this._fieldCount-=1),this._flags&=~ae.ALIASED},e.prototype.setItemMutable=function(t,e){var r=this._array,i=r[t];r[t]=e,e instanceof $t.Field?(this._table=null,i instanceof $t.Field||(this._fieldCount+=1)):i instanceof $t.Field&&(this._table=null,this._fieldCount-=1)},e.prototype.updated=function(t,e){t=se.fromAny(t),e=se.fromAny(e);var r=0==(this._flags&ae.IMMUTABLE)?this:this.branch();return 0!=(r._flags&ae.ALIASED)?r._fieldCount>0?r.setAliased(t,e):r.pushAliased(new $t.Slot(t,e)):r._fieldCount>0?null!==r._table?r.setMutable(t,e):r.updateMutable(t,e):r.pushMutable(new $t.Slot(t,e)),r},e.prototype.updatedAttr=function(t,e){t=se.Text.fromAny(t),e=se.fromAny(e);var r=0==(this._flags&ae.IMMUTABLE)?this:this.branch();return 0!=(r._flags&ae.ALIASED)?r._fieldCount>0?r.setAttrAliased(t,e):r.pushAliased(new $t.Attr(t,e)):r._fieldCount>0?null!==r._table?r.setAttrMutable(t,e):r.updateAttrMutable(t,e):r.pushMutable(new $t.Attr(t,e)),r},e.prototype.updatedSlot=function(t,e){t=se.fromAny(t),e=se.fromAny(e);var r=0==(this._flags&ae.IMMUTABLE)?this:this.branch();return 0!=(r._flags&ae.ALIASED)?r._fieldCount>0?r.setSlotAliased(t,e):r.pushAliased(new $t.Slot(t,e)):r._fieldCount>0?null!==r._table?r.setSlotMutable(t,e):r.updateSlotMutable(t,e):r.pushMutable(new $t.Slot(t,e)),r},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");return 0!=(this._flags&ae.ALIASED)?this.pushAliased.apply(this,arguments):this.pushMutable.apply(this,arguments),this._itemCount},e.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=arguments.length,i=this._itemCount,n=this._fieldCount,o=this._array,s=new Array(ae.expand(i+r));if(null!==o)for(var u=0;u<i;u+=1)s[u]=o[u];for(u=0;u<r;u+=1){var a=$t.fromAny(arguments[u]);s[i]=a,i+=1,a instanceof $t.Field&&(n+=1)}this._array=s,this._table=null,this._itemCount=i,this._fieldCount=n,this._flags&=~ae.ALIASED},e.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r,i=arguments.length,n=this._itemCount,o=this._fieldCount,s=this._array;if(null===s||n+i>s.length){if(r=new Array(ae.expand(n+i)),null!==s)for(var u=0;u<n;u+=1)r[u]=s[u]}else r=s;for(u=0;u<i;u+=1){var a=$t.fromAny(arguments[u]);r[n]=a,n+=1,a instanceof $t.Field&&(o+=1,this._table=null)}this._array=r,this._itemCount=n,this._fieldCount=o},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");var n=this._itemCount;return t<0&&(t=n+t),t=Math.min(Math.max(0,t),n),e=Math.min(Math.max(0,e),n-t),0!=(this._flags&ae.ALIASED)?this.spliceAliased.apply(this,arguments):this.spliceMutable.apply(this,arguments)},e.prototype.spliceAliased=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];for(var n=r.length,o=this._itemCount,s=this._fieldCount,u=this._array,a=new Array(ae.expand(o-e+n)),h=0;h<t;h+=1)a[h]=u[h];var p=[];for(h=t;h<t+e;h+=1){var l=u[h];p.push(l),o-=1,l instanceof $t.Field&&(s-=1)}for(h=t;h<o;h+=1)a[h+n]=u[h+e];for(h=0;h<n;h+=1){var c=$t.fromAny(r[h]);a[h+t]=c,o+=1,c instanceof $t.Field&&(s+=1)}return this._array=a,this._table=null,this._itemCount=o,this._fieldCount=s,this._flags&=~ae.ALIASED,p},e.prototype.spliceMutable=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n,o=r.length,s=this._itemCount,u=this._fieldCount,a=this._array;if(null===a||s-e+o>a.length){if(n=new Array(ae.expand(s-e+o)),null!==a)for(var h=0;h<t;h+=1)n[h]=a[h]}else n=a;var p=[];for(h=t;h<t+e;h+=1){var l=a[h];p.push(l),s-=1,l instanceof $t.Field&&(u-=1)}if(o>e)for(h=s-1;h>=t;h-=1)n[h+o]=a[h+e];else for(h=t;h<s;h+=1)n[h+o]=a[h+e];for(h=0;h<o;h+=1){var c=$t.fromAny(r[h]);n[h+t]=c,s+=1,c instanceof $t.Field&&(u+=1)}return this._array=n,this._itemCount=s,this._fieldCount=u,p},e.prototype.delete=function(t){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");return t=se.fromAny(t),0!=(this._flags&ae.ALIASED)?this.deleteAliased(t):this.deleteMutable(t)},e.prototype.deleteAliased=function(t){for(var e=this._itemCount,r=this._array,i=new Array(ae.expand(e)),n=0;n<e;n+=1){var o=r[n];if(o instanceof $t.Field&&o.key.equals(t)){for(var s=n+1;s<e;s+=1,n+=1)i[n]=r[s];return this._array=i,this._table=null,this._itemCount=e-1,this._fieldCount-=1,this._flags&=~ae.ALIASED,o}i[n]=o}return $t.absent()},e.prototype.deleteMutable=function(t){for(var e=this._itemCount,r=this._array,i=0;i<e;i+=1){var n=r[i];if(n instanceof $t.Field&&n.key.equals(t)){for(var o=i+1;o<e;o+=1,i+=1)r[i]=r[o];return r[e-1]=void 0,this._table=null,this._itemCount=e-1,this._fieldCount-=1,n}}return $t.absent()},e.prototype.clear=function(){if(0!=(this._flags&ae.IMMUTABLE))throw new Error("immutable");this._array=null,this._table=null,this._itemCount=0,this._fieldCount=0,this._flags=0},e.prototype.isAliased=function(){return 0!=(this._flags&ae.ALIASED)},e.prototype.isMutable=function(){return 0==(this._flags&ae.IMMUTABLE)},e.prototype.alias=function(){this._flags|=ae.ALIASED},e.prototype.branch=function(){if(0==(this._flags&(ae.ALIASED|ae.IMMUTABLE)))for(var t=this._array,r=0,i=this._itemCount;r<i;r+=1)t[r].alias();return this._flags|=ae.ALIASED,new e(this._array,this._table,this._itemCount,this._fieldCount,ae.ALIASED)},e.prototype.clone=function(){for(var t=this._itemCount,r=this._array,i=new Array(t),n=0;n<t;n+=1)i[n]=r[n].clone();return new e(i,null,t,this._fieldCount,0)},e.prototype.commit=function(){if(0==(this._flags&ae.IMMUTABLE)){this._flags|=ae.IMMUTABLE;for(var t=this._array,e=0,r=this._itemCount;e<r;e+=1)t[e].commit()}return this},e.prototype.hashTable=function(){var t=this._fieldCount,r=this._table;if(0!==t&&null===this._table){r=new Array(ae.expand(Math.max(t,10*t/7)));for(var i=this._array,n=0,o=this._itemCount;n<o;n+=1){var s=i[n];s instanceof $t.Field&&e.put(r,s)}this._table=r}return r},e.put=function(t,e){if(null!==t){var r=t.length,i=Math.abs(e.key.hashCode()%r),n=i;do{var o=t[n];if(void 0===o)return void(t[n]=e);if(e.key.equals(o.key))return void(t[n]=e);n=(n+1)%r}while(n!==i);throw new Error}},e.prototype.evaluate=function(t){t=re.fromAny(t);var e=this._array,r=this._itemCount,i=ae.create(r);t.pushScope(i);for(var n=!1,o=0;o<r;o+=1){var s=e[o],u=s.evaluate(t);u.isDefined()&&i.push(u),s!==u&&(n=!0)}return t.popScope(),n?i:this},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._array,r=this._itemCount,i=ae.create(r);t.pushScope(i);for(var n=!1,o=0;o<r;o+=1){var s=e[o],u=s.substitute(t);u.isDefined()&&i.push(u),s!==u&&(n=!0)}return t.popScope(),n?i:this},e.prototype.subRecord=function(t,e){var r=this._itemCount;if(void 0===t?t=0:t<0&&(t=r+t),void 0===e?e=r:e<0&&(e=r+e),t<0||e>r||t>e)throw new RangeError(t+", "+e);return new ae.RecordMapView(this,t,e)},e.prototype.forEach=function(t,e){for(var r=this._array,i=0,n=this._itemCount;i<n;i+=1){var o=t.call(e,r[i],i);if(void 0!==o)return o}},e.empty=function(){return e._empty||(e._empty=new e(null,null,0,0,ae.ALIASED|ae.IMMUTABLE)),e._empty},e.create=function(t){return void 0===t?new e(null,null,0,0,ae.ALIASED):new e(new Array(t),null,0,0,0)},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=arguments.length;if(0===i)return new e(null,null,0,0,ae.ALIASED);for(var n=new Array(i),o=0,s=0,u=0;u<i;u+=1){var a=$t.fromAny(arguments[u]);n[u]=a,o+=1,a instanceof $t.Field&&(s+=1)}return new e(n,null,o,s,0)},e}(ae);$t.RecordMap=he;var pe=function(t){function e(e,r,i){var n=t.call(this)||this;return n._record=e,n._lower=r,n._upper=i,n}return _(e,t),e.prototype.isEmpty=function(){return this._lower===this._upper},e.prototype.isArray=function(){for(var t=this._record._array,e=this._lower,r=this._upper;e<r;e+=1)if(t[e]instanceof $t.Field)return!1;return!0},e.prototype.isObject=function(){for(var t=this._record._array,e=this._lower,r=this._upper;e<r;e+=1)if(t[e]instanceof se)return!1;return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this._upper-this._lower},enumerable:!0,configurable:!0}),e.prototype.fieldCount=function(){for(var t=this._record._array,e=0,r=this._lower,i=this._upper;r<i;r+=1)t[r]instanceof $t.Field&&(e+=1);return e},e.prototype.valueCount=function(){for(var t=0,e=this._record._array,r=this._lower,i=this._upper;r<i;r+=1)e[r]instanceof se&&(t+=1);return t},e.prototype.isConstant=function(){for(var t=this._record._array,e=this._lower,r=this._upper;e<r;e+=1)if(!t[e].isConstant())return!1;return!0},e.prototype.tag=function(){if(this.length>0){var t=this._record._array[this._lower];if(t instanceof $t.Attr)return t.key.value}},e.prototype.target=function(){for(var t,e,r=!1,i=this._record._array,n=this._lower,o=this._upper;n<o;n+=1){var s=i[n];s instanceof $t.Attr?r=!0:void 0===t&&s instanceof se?t=s:(void 0===e&&(e=ae.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?se.extant():void 0===e?t:r?e:this},e.prototype.head=function(){return this.length>0?this._record._array[this._lower]:$t.absent()},e.prototype.tail=function(){return this.length>0?new e(this._record,this._lower+1,this._upper):ae.empty()},e.prototype.body=function(){var t=this.length;if(t>2)return new e(this._record,this._lower+1,this._upper).branch();if(2===t){var r=this._record._array[this._lower+1];return r instanceof se?r:ae.of(r)}return se.absent()},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=$t.fromAny(t);var r=this._record._array,i=this.length;for(e<0&&(e=Math.max(0,i+e)),e=this._lower+e;e<this._upper;){if(t.equals(r[e]))return e-this._lower;e+=1}return-1},e.prototype.lastIndexOf=function(t,e){t=$t.fromAny(t);var r=this._record._array,i=this.length;for(void 0===e?e=i-1:e<0&&(e=i+e),e=this._lower+Math.min(e,i-1);e>=this._lower;){if(t.equals(r[e]))return e-this._lower;e-=1}return-1},e.prototype.getItem=function(t){t instanceof $t.Num&&(t=t.value);var e=this.length;return t<0&&(t=e+t),t>=0&&t<e?this._record._array[this._lower+t]:$t.absent()},e.prototype.setItem=function(t,e){if(0!=(this._record._flags&ae.IMMUTABLE))throw new Error("immutable");e=$t.fromAny(e);var r=this.length;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this._record._flags&ae.ALIASED)?this.setItemAliased(t,e):this.setItemMutable(t,e),this},e.prototype.setItemAliased=function(t,e){for(var r=this._record._itemCount,i=this._record._array,n=new Array(ae.expand(r)),o=0;o<r;o+=1)n[o]=i[o];var s=i[this._lower+t];n[this._lower+t]=e,this._record._array=n,this._record._table=null,e instanceof $t.Field?s instanceof $t.Field||(this._record._fieldCount+=1):s instanceof $t.Field&&(this._record._fieldCount-=1),this._record._flags&=~ae.ALIASED},e.prototype.setItemMutable=function(t,e){var r=this._record._array,i=r[this._lower+t];r[this._lower+t]=e,e instanceof $t.Field?(this._record._table=null,i instanceof $t.Field||(this._record._fieldCount+=1)):i instanceof $t.Field&&(this._record._table=null,this._record._fieldCount-=1)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this._record._flags&ae.IMMUTABLE))throw new Error("immutable");return 0!=(this._record._flags&ae.ALIASED)?this.pushAliased.apply(this,arguments):this.pushMutable.apply(this,arguments),this.length},e.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length,i=this._record._itemCount,n=this._record._fieldCount,o=this._record._array,s=new Array(ae.expand(i+r));if(null!==o){for(var u=0;u<this._upper;u+=1)s[u]=o[u];for(u=this._upper;u<i;u+=1)s[u+r]=o[u]}for(u=0;u<r;u+=1){var a=$t.fromAny(t[u]);s[u+this._upper]=a,i+=1,a instanceof $t.Field&&(n+=1)}this._record._array=s,this._record._table=null,this._record._itemCount=i,this._record._fieldCount=n,this._record._flags&=~ae.ALIASED,this._upper+=r},e.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r,i=t.length,n=this._record._itemCount,o=this._record._fieldCount,s=this._record._array;if(null===s||n+i>s.length){if(r=new Array(ae.expand(n+i)),null!==s)for(var u=0;u<this._upper;u+=1)r[u]=s[u]}else r=s;for(u=n-1;u>=this._upper;u-=1)r[u+i]=s[u];for(u=0;u<i;u+=1){var a=$t.fromAny(t[u]);r[u+this._upper]=a,n+=1,a instanceof $t.Field&&(o+=1,this._record._table=null)}this._record._array=r,this._record._itemCount=n,this._record._fieldCount=o,this._upper+=i},e.prototype.splice=function(t,e){var r,i;void 0===e&&(e=0);for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(0!=(this._record._flags&ae.IMMUTABLE))throw new Error("immutable");var s,u=this.length;return t<0&&(t=u+t),t=Math.min(Math.max(0,t),u),e=Math.min(Math.max(0,e),u-t),s=0!=(this._record._flags&ae.ALIASED)?(r=this._record).spliceAliased.apply(r,w([this._lower+t,e],n)):(i=this._record).spliceMutable.apply(i,w([this._lower+t,e],n)),this._upper+=n.length-s.length,s},e.prototype.delete=function(t){if(0!=(this._record._flags&ae.IMMUTABLE))throw new Error("immutable");return t=se.fromAny(t),0!=(this._record._flags&ae.ALIASED)?this.deleteAliased(t):this.deleteMutable(t)},e.prototype.deleteAliased=function(t){for(var e=this._record._itemCount,r=this._record._array,i=new Array(ae.expand(e)),n=this._lower;n<this._upper;n+=1){var o=r[n];if(o instanceof $t.Field&&o.key.equals(t)){for(var s=n+1;s<e;s+=1,n+=1)i[n]=r[s];return this._record._array=i,this._record._table=null,this._record._itemCount=e-1,this._record._fieldCount-=1,this._record._flags&=~ae.ALIASED,this._upper-=1,o}i[n]=o}return $t.absent()},e.prototype.deleteMutable=function(t){for(var e=this._record._itemCount,r=this._record._array,i=this._lower;i<this._upper;i+=1){var n=r[i];if(n instanceof $t.Field&&n.key.equals(t)){for(var o=i+1;o<e;o+=1,i+=1)r[i]=r[o];return r[e-1]=void 0,this._record._table=null,this._record._itemCount-=1,this._record._fieldCount-=1,this._upper-=1,n}}return $t.absent()},e.prototype.clear=function(){if(0!=(this._record._flags&ae.IMMUTABLE))throw new Error("immutable");0!=(this._record._flags&ae.ALIASED)?this.clearAliased():this.clearMutable()},e.prototype.clearAliased=function(){for(var t=this._record._itemCount,e=this._record._fieldCount,r=t-this.length,i=this._record._array,n=new Array(ae.expand(r)),o=0;o<this._lower;)n[o]=i[o],o+=1;for(;o<this._upper;)i[o]instanceof $t.Field&&(e-=1),o+=1;o=this._lower;for(var s=this._upper;s<t;)n[o]=i[s],o+=1,s+=1;this._record._array=n,this._record._table=null,this._record._itemCount=r,this._record._fieldCount=e,this._record._flags&=~ae.ALIASED,this._upper=this._lower},e.prototype.clearMutable=function(){for(var t=this._record._itemCount,e=this._record._fieldCount,r=this._record._array,i=this._lower;i<this._upper;)r[i]instanceof $t.Field&&(e-=1),i+=1;i=this._lower;for(var n=this._upper;n<t;){var o=r[n];o instanceof $t.Field&&(this._record._table=null),r[i]=o,i+=1,n+=1}for(this._record._itemCount=i,this._record._fieldCount=e;i<t;)r[i]=void 0,i+=1;this._upper=this._lower},e.prototype.isAliased=function(){return 0!=(this._record._flags&ae.ALIASED)},e.prototype.isMutable=function(){return 0==(this._record._flags&ae.IMMUTABLE)},e.prototype.alias=function(){this._record._flags|=ae.ALIASED},e.prototype.branch=function(){for(var t=this.length,e=0,r=this._record._array,i=new Array(ae.expand(t)),n=this._lower,o=0;o<t;){var s=r[n];i[o]=s,s instanceof $t.Field&&(e+=1),n+=1,o+=1}return new he(i,null,t,e,0)},e.prototype.clone=function(){for(var t=this.length,e=0,r=this._record._array,i=new Array(ae.expand(t)),n=this._lower,o=0;o<t;){var s=r[n];i[o]=s.clone(),s instanceof $t.Field&&(e+=1),n+=1,o+=1}return new he(i,null,t,e,0)},e.prototype.commit=function(){return this._record.commit(),this},e.prototype.subRecord=function(t,r){var i=this.length;if(void 0===t?t=0:t<0&&(t=i+t),void 0===r?r=i:r<0&&(r=i+r),t<0||r>i||t>r)throw new RangeError(t+", "+r);return new e(this._record,this._lower+t,this._upper+r)},e.prototype.forEach=function(t,e){for(var r=this._record._array,i=this._lower,n=this._upper;i<n;i+=1){var o=t.call(e,r[i],i);if(void 0!==o)return o}},e}(ae);$t.RecordMapView=pe;var le=function(t){function e(e,r){var i=t.call(this)||this;return i._data=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.write=function(t){if("number"==typeof t)return this._data.addByte(t),this;throw new TypeError(""+t)},e.prototype.writeln=function(t){throw new TypeError(""+t)},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=R.fromAny(t),this)},e.prototype.bind=function(){return this._data},e.prototype.clone=function(){return new e(this._data.branch(),this._settings)},e}(F),ce=function(t){function e(e,r,i){var n=t.call(this)||this;return n._array=e,n._size=r,n._flags=i,n}return _(e,t),e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.getByte=function(t){if(t<0||t>=this.size)throw new RangeError(""+t);return this._array[t]},e.prototype.setByte=function(t,r){var i=this._flags;if(0!=(i&e.IMMUTABLE))throw new Error("immutable");if(t<0||t>=this._size)throw new RangeError(""+t);return 0!=(i&e.ALIASED)?this.setByteAliased(t,r):this.setByteMutable(t,r)},e.prototype.setByteAliased=function(t,r){var i=this.size,n=this._array,o=new Uint8Array(e.expand(i));return o.set(n,0),o[t]=r,this._array=o,this._flags&=~e.ALIASED,this},e.prototype.setByteMutable=function(t,e){return this._array[t]=e,this},e.prototype.addByte=function(t){var r=this._flags;if(0!=(r&e.IMMUTABLE))throw new Error("immutable");return 0!=(r&e.ALIASED)?this.addByteAliased(t):this.addByteMutable(t)},e.prototype.addByteAliased=function(t){var r=this.size,i=this._array,n=new Uint8Array(e.expand(r+1));return null!=i&&n.set(i,0),n[r]=t,this._array=n,this._size=r+1,this._flags&=~e.ALIASED,this},e.prototype.addByteMutable=function(t){var r,i=this.size,n=this._array;return null===n||i+1>n.length?(r=new Uint8Array(e.expand(i+1)),null!==n&&r.set(n,0),this._array=r):r=n,r[i]=t,this._size=i+1,this},e.prototype.addData=function(t){var e=t._array;if(null!==e){var r=t._size;return e.length>r&&(e=e.slice(0,r)),this.addUint8Array(e)}return this},e.prototype.addUint8Array=function(t){var r=this._flags;if(0!=(r&e.IMMUTABLE))throw new Error("immutable");return 0!=(r&e.ALIASED)?this.addUint8ArrayAliased(t):this.addUint8ArrayMutable(t)},e.prototype.addUint8ArrayAliased=function(t){var r=t.length;if(0===r)return this;var i=this.size,n=this._array,o=new Uint8Array(e.expand(i+r));return null!==n&&o.set(n,0),o.set(t,i),this._array=o,this._size=i+r,this._flags&=~e.ALIASED,this},e.prototype.addUint8ArrayMutable=function(t){var r=t.length;if(0===r)return this;var i,n=this.size,o=this._array;return null===o||n+r>o.length?(i=new Uint8Array(e.expand(n+r)),null!==o&&i.set(o,0),this._array=i):i=o,i.set(t,n),this._size=n+r,this},e.prototype.clear=function(){if(0!=(this._flags&e.IMMUTABLE))throw new Error("immutable");this._array=null,this._size=0,this._flags=e.ALIASED},e.prototype.toUint8Array=function(){var t=this._array,r=this._flags;if(0!=(r&e.IMMUTABLE))return null!==t?t.slice(0):new Uint8Array(0);if(0!=(r&e.ALIASED)||this._size!==t.length){var i=null!==t?t.slice(0):new Uint8Array(0);return this._array=i,this._flags&=~e.ALIASED,i}return t},e.prototype.asUint8Array=function(){var t;return this._array&&this._size>0?(t=this._array).length!==this._size&&(t=new Uint8Array(t.buffer,t.byteOffset,this._size)):t=void 0,t},e.prototype.toAny=function(){return this.toUint8Array()},e.prototype.isAliased=function(){return 0!=(this._flags&e.ALIASED)},e.prototype.isMutable=function(){return 0==(this._flags&e.IMMUTABLE)},e.prototype.branch=function(){return this._flags|=e.ALIASED,new e(this._array,this._size,e.ALIASED)},e.prototype.clone=function(){return this.branch()},e.prototype.commit=function(){return this._flags|=e.IMMUTABLE,this},e.prototype.writeBase16=function(t,e){void 0===e&&(e=xt.uppercase());var r=this._array,i=this._size;return null!==r&&0!==i?(r.length!==i&&(r=r.slice(0,i)),e.writeUint8Array(r,t)):G.done()},e.prototype.toBase16=function(t){void 0===t&&(t=xt.uppercase());var e=$.stringOutput();return this.writeBase16(e,t),e.bind()},e.prototype.writeBase64=function(t,e){void 0===e&&(e=Mt.standard());var r=this._array,i=this._size;return null!==r&&0!==i?(r.length!==i&&(r=r.slice(0,i)),e.writeUint8Array(r,t)):G.done()},e.prototype.toBase64=function(t){void 0===t&&(t=Mt.standard());var e=$.stringOutput();return this.writeBase64(e,t),e.bind()},e.prototype.typeOrder=function(){return 4},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._array,i=t._array,n=this._size,o=t._size,s=0,u=0;do{if(!(u<n&&u<o))break;s=r[u]-i[u],u+=1}while(0===s);return s>0?1:s<0?-1:n>o?1:n<o?-1:0}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var r=this._array,i=t._array,n=this._size;if(n!==t._size)return!1;for(var o=0;o<n;o+=1)if(r[o]!==i[o])return!1;return!0}return!1},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._array||new Uint8Array(0)))},e.prototype.debug=function(t){t=t.write("Data").write(46),0===this._size?t=t.write("empty").write(40).write(41):(t=t.write("base16").write(40).write(34),this.writeBase16(t),t=t.write(34).write(41))},e.prototype.display=function(t){this.debug(t)},e.output=function(t){return t instanceof e||(t=e.create(t)),new le(t,R.standard())},e.empty=function(){return null==e._empty&&(e._empty=new e(null,0,e.ALIASED|e.IMMUTABLE)),e._empty},e.create=function(t){return void 0===t?new e(null,0,e.ALIASED):new e(new Uint8Array(t),0,0)},e.wrap=function(t){return new e(t,t.length,e.ALIASED)},e.fromBase16=function(t){return"string"==typeof t&&(t=$.stringInput(t)),xt.parse(t,e.output()).bind()},e.fromBase64=function(t,r){return void 0===r&&(r=Mt.standard()),"string"==typeof t&&(t=$.stringInput(t)),r.parse(t,e.output()).bind()},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof Uint8Array)return e.wrap(t);throw new TypeError(""+t)},e.random=function(t){var r=new Uint8Array(t);return u.fillBytes(r),e.wrap(r)},e.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e.ALIASED=1,e.IMMUTABLE=2,e}(se);$t.Data=ce;var fe=function(t){function e(e,r){var i=t.call(this)||this;return i._string=e,i._settings=r,i}return _(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(t){return void 0!==t&&this},e.prototype.write=function(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){var e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="ï¿½";return this._string+=t,this},e.prototype.settings=function(t){return void 0===t?this._settings:(this._settings=R.fromAny(t),this)},e.prototype.bind=function(){return de.from(this._string)},e.prototype.clone=function(){return new e(this._string,this._settings)},e.prototype.toString=function(){return this._string},e}(F),de=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._value.length},enumerable:!0,configurable:!0}),e.prototype.stringValue=function(t){return this._value},e.prototype.numberValue=function(t){try{return $t.Num.from(this._value).numberValue()}catch(e){return t}},e.prototype.booleanValue=function(t){return"true"===this._value||"false"!==this._value&&t},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.plus=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value+r._value):t.prototype.plus.call(this,r)},e.prototype.branch=function(){return this},e.prototype.clone=function(){return this},e.prototype.commit=function(){return this},e.prototype.typeOrder=function(){return 5},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._value.localeCompare(t._value);return r<0?-1:r>0?1:0}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this._value)),this._hashCode},e.prototype.debug=function(t){t=t.write("Text").write(46),t=0===this._value.length?t.write("empty").write(40).write(41):t.write("from").write(40).debug(this._value).write(41)},e.prototype.display=function(t){J.debug(this._value,t)},e.prototype.toString=function(){return this._value},e.output=function(t){return void 0===t&&(t=R.standard()),new fe("",t)},e.empty=function(){return e._empty||(e._empty=new e("")),e._empty},e.from=function(t){var r=t.length;if(0===r)return e.empty();var i=new e(t);return r<=64&&(i=e.cache().put(i)),i},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.from(t);throw new TypeError(""+t)},e.cache=function(){if(null==e._cache){e._cache=new O(128)}return e._cache},e}(se);$t.Text=de;var ye=function(t){function e(e,r){void 0===r&&(r=0);var i=t.call(this)||this;return i._value=e,i._flags=r,i}return _(e,t),e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.isNaN=function(){return isNaN(this._value)},e.prototype.isInfinite=function(){return!isNaN(this._value)&&!isFinite(this._value)},e.prototype.isUint32=function(){return 0!=(this._flags&e.UINT32)},e.prototype.isUint64=function(){return 0!=(this._flags&e.UINT64)},e.prototype.stringValue=function(t){return""+this._value},e.prototype.numberValue=function(t){return this._value},e.prototype.booleanValue=function(t){return!!this._value},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.bitwiseOr=function(r){return(r=$t.fromAny(r))instanceof e?e.from((this._value|r._value)>>>0):t.prototype.bitwiseOr.call(this,r)},e.prototype.bitwiseXor=function(r){return(r=$t.fromAny(r))instanceof e?e.from((this._value^r._value)>>>0):t.prototype.bitwiseXor.call(this,r)},e.prototype.bitwiseAnd=function(r){return(r=$t.fromAny(r))instanceof e?e.from((this._value&r._value)>>>0):t.prototype.bitwiseAnd.call(this,r)},e.prototype.plus=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value+r._value):t.prototype.plus.call(this,r)},e.prototype.minus=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value-r._value):t.prototype.minus.call(this,r)},e.prototype.times=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value*r._value):t.prototype.times.call(this,r)},e.prototype.divide=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value/r._value):t.prototype.divide.call(this,r)},e.prototype.modulo=function(r){return(r=$t.fromAny(r))instanceof e?e.from(this._value%r._value):t.prototype.modulo.call(this,r)},e.prototype.bitwiseNot=function(){return e.from(~this._value>>>0)},e.prototype.negative=function(){return e.from(-this._value)},e.prototype.positive=function(){return this},e.prototype.inverse=function(){return e.from(1/this._value)},e.prototype.abs=function(){return e.from(Math.abs(this._value))},e.prototype.ceil=function(){return e.from(Math.ceil(this._value))},e.prototype.floor=function(){return e.from(Math.floor(this._value))},e.prototype.round=function(){return e.from(Math.round(this._value))},e.prototype.sqrt=function(){return e.from(Math.sqrt(this._value))},e.prototype.pow=function(t){return t=e.fromAny(t),e.from(Math.pow(this._value,t._value))},e.prototype.max=function(t){return this.compareTo(t)>=0?this:t},e.prototype.min=function(t){return this.compareTo(t)<=0?this:t},e.prototype.typeOrder=function(){return 6},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._value,i=t._value;return r<i?-1:r>i?1:isNaN(i)?isNaN(r)?0:-1:isNaN(r)?1:0}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var r=this._value,i=t._value;return r===i||isNaN(r)&&isNaN(i)}return!1},e.prototype.hashCode=function(){return c.hash(this._value)},e.prototype.debug=function(t){t=t.write("Num").write(46).write("from").write(40).display(this).write(41)},e.prototype.display=function(t){J.displayNumber(this._value,t)},e.positiveZero=function(){return void 0===e._positiveZero&&(e._positiveZero=new e(0)),e._positiveZero},e.negativeZero=function(){return void 0===e._negativeZero&&(e._negativeZero=new e(-0)),e._negativeZero},e.positiveOne=function(){return void 0===e._positiveOne&&(e._positiveOne=new e(1)),e._positiveOne},e.negativeOne=function(){return void 0===e._negativeOne&&(e._negativeOne=new e(-1)),e._negativeOne},e.nan=function(){return void 0===e._nan&&(e._nan=new e(NaN)),e._nan},e.uint32=function(t){return new e(t,e.UINT32)},e.uint64=function(t){return new e(t,e.UINT64)},e.from=function(t){if("number"==typeof t)return 0===t?1/t==-1/0?e.negativeZero():e.positiveZero():1===t?e.positiveOne():-1===t?e.negativeOne():isNaN(t)?e.nan():e.cache().put(new e(t));if("string"==typeof t){if("NaN"===t)return e.nan();var r=+t;if(isFinite(r))return e.from(r);throw new Error(t)}throw new TypeError(""+t)},e.fromAny=function(t){if(t instanceof e)return t;if("number"==typeof t)return e.from(t);throw new TypeError(""+t)},e.cache=function(){if(null==e._cache){e._cache=new O(16)}return e._cache},e.TYPE_MASK=3,e.UINT32=1,e.UINT64=2,e}(se);$t.Num=ye;var ve=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.stringValue=function(t){return this._value?"true":"false"},e.prototype.booleanValue=function(t){return this._value},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.conditional=function(t,e){return this._value?$t.fromAny(t):$t.fromAny(e)},e.prototype.or=function(t){return this._value?this:$t.fromAny(t)},e.prototype.and=function(t){return this._value?$t.fromAny(t):this},e.prototype.not=function(){return e.from(!this._value)},e.prototype.typeOrder=function(){return 7},e.prototype.compareTo=function(t){return t instanceof e?this._value&&!t._value?-1:!this._value&&t._value?1:0:f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this._value?"true":"false")),this._hashCode},e.prototype.debug=function(t){t=t.write("Bool").write(46).write("from").write(40).write(this._value?"true":"false").write(41)},e.prototype.display=function(t){t=t.write(this._value?"true":"false")},e.from=function(t){return t?e.True:e.False},e.fromAny=function(t){if(t instanceof e)return t;if("boolean"==typeof t)return e.from(t);throw new TypeError(""+t)},e.True=new e(!0),e.False=new e(!1),e}(se);$t.Bool=ve;var _e=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.conditional=function(t,e){return t=$t.fromAny(t),e=$t.fromAny(e),new $t.ConditionalOperator(this,t,e)},e.prototype.or=function(t){return t=$t.fromAny(t),new $t.OrOperator(this,t)},e.prototype.and=function(t){return t=$t.fromAny(t),new $t.AndOperator(this,t)},e.prototype.bitwiseOr=function(t){return t=$t.fromAny(t),new $t.BitwiseOrOperator(this,t)},e.prototype.bitwiseXor=function(t){return t=$t.fromAny(t),new $t.BitwiseXorOperator(this,t)},e.prototype.bitwiseAnd=function(t){return t=$t.fromAny(t),new $t.BitwiseAndOperator(this,t)},e.prototype.lt=function(t){return t=$t.fromAny(t),new $t.LtOperator(this,t)},e.prototype.le=function(t){return t=$t.fromAny(t),new $t.LeOperator(this,t)},e.prototype.eq=function(t){return t=$t.fromAny(t),new $t.EqOperator(this,t)},e.prototype.ne=function(t){return t=$t.fromAny(t),new $t.NeOperator(this,t)},e.prototype.ge=function(t){return t=$t.fromAny(t),new $t.GeOperator(this,t)},e.prototype.gt=function(t){return t=$t.fromAny(t),new $t.GtOperator(this,t)},e.prototype.plus=function(t){return t=$t.fromAny(t),new $t.PlusOperator(this,t)},e.prototype.minus=function(t){return t=$t.fromAny(t),new $t.MinusOperator(this,t)},e.prototype.times=function(t){return t=$t.fromAny(t),new $t.TimesOperator(this,t)},e.prototype.divide=function(t){return t=$t.fromAny(t),new $t.DivideOperator(this,t)},e.prototype.modulo=function(t){return t=$t.fromAny(t),new $t.ModuloOperator(this,t)},e.prototype.not=function(){return new $t.NotOperator(this)},e.prototype.bitwiseNot=function(){return new $t.BitwiseNotOperator(this)},e.prototype.negative=function(){return new $t.NegativeOperator(this)},e.prototype.positive=function(){return new $t.PositiveOperator(this)},e.prototype.inverse=function(){return new $t.DivideOperator($t.Num.positiveOne(),this)},e.prototype.toAny=function(){return this},e}(se);$t.Expression=_e;var me=function(t){function e(){return t.call(this)||this}return _(e,t),e}(_e);$t.Operator=me;var we=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isConstant=function(){return!1},e.prototype.evaluate=function(t){t=re.fromAny(t);var e=$t.Record.create();return this.forSelected(t,(function(t){var r=t.peekScope();r&&e.push(r)}),this),e.isEmpty()?$t.absent():e.flattened()},e.prototype.get=function(t){return t=se.fromAny(t),this.andThen(new $t.GetSelector(t,e.identity()))},e.prototype.getAttr=function(t){return t=$t.Text.fromAny(t),this.andThen(new $t.GetAttrSelector(t,e.identity()))},e.prototype.getItem=function(t){return t=$t.Num.fromAny(t),this.andThen(new $t.GetItemSelector(t,e.identity()))},e.prototype.keys=function(){return this.andThen(e.keys())},e.prototype.values=function(){return this.andThen(e.values())},e.prototype.children=function(){return this.andThen(e.children())},e.prototype.descendants=function(){return this.andThen(e.descendants())},e.prototype.filter=function(t){return 0===arguments.length?new $t.FilterSelector(this,e.identity()):(t=$t.fromAny(t),this.andThen(t.filter()))},e.prototype.invoke=function(t){return new $t.InvokeOperator(this,t)},e.prototype.precedence=function(){return 11},e.prototype.debug=function(t){t=t.write("Selector").write(46).write("identity").write(40).write(41),this.debugThen(t)},e.identity=function(){return e._identity},e.get=function(t){return t=se.fromAny(t),new $t.GetSelector(t,e.identity())},e.getAttr=function(t){return t=$t.Text.fromAny(t),new $t.GetAttrSelector(t,e.identity())},e.getItem=function(t){return t=$t.Num.fromAny(t),new $t.GetItemSelector(t,e.identity())},e.keys=function(){return e._keys||(e._keys=new $t.KeysSelector(e.identity())),e._keys},e.values=function(){return e._values||(e._values=new $t.ValuesSelector(e.identity())),e._values},e.children=function(){return e._children||(e._children=new $t.ChildrenSelector(e.identity())),e._children},e.descendants=function(){return e._descendants||(e._descendants=new $t.DescendantsSelector(e.identity())),e._descendants},e.literal=function(t){return(t=$t.fromAny(t))instanceof e||(t=new $t.LiteralSelector(t,e.identity())),t},e}(_e);$t.Selector=we;var ge=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.expand=function(t,e,r){},e.prototype.isConstant=function(){return!1},e}(_e);$t.Func=ge;var be=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isDistinct=function(){return!1},e.prototype.isConstant=function(){return!0},e.prototype.unflattened=function(){return se.Record.empty()},e.prototype.not=function(){return se.absent()},e.prototype.stringValue=function(t){return""},e.prototype.booleanValue=function(t){return!0},e.prototype.toAny=function(){return null},e.prototype.typeOrder=function(){return 98},e.prototype.compareTo=function(t){return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),e._hashSeed},e.prototype.debug=function(t){t=t.write("Value").write(46).write("extant").write(40).write(41)},e.prototype.display=function(t){t=t.write("null")},e.extant=function(){return e._extant},e.fromAny=function(t){if(t instanceof e)return t;if(null===t)return e.extant();throw new TypeError(""+t)},e._extant=new e,e}(se);$t.Extant=be;var xe=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isDistinct=function(){return!1},e.prototype.isConstant=function(){return!0},e.prototype.unflattened=function(){return se.Record.empty()},e.prototype.updated=function(t,e){return se.Record.of($t.Slot.of(t,e))},e.prototype.updatedAttr=function(t,e){return se.Record.of($t.Attr.of(t,e))},e.prototype.updatedSlot=function(t,e){return se.Record.of($t.Slot.of(t,e))},e.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return se.Record.of(t)},e.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return se.Record.of(t)},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=se.Record.create(),i=0,n=arguments.length;i<n;i+=1)$t.fromAny(arguments[i]).forEach((function(t){r.push(t)}));return r},e.prototype.cond=function(t,e){return $t.fromAny(e)},e.prototype.or=function(t){return $t.fromAny(t)},e.prototype.and=function(t){return this},e.prototype.not=function(){return se.extant()},e.prototype.booleanValue=function(t){return!1},e.prototype.toAny=function(){},e.prototype.forEach=function(t,e){},e.prototype.iterator=function(){return y.empty()},e.prototype.typeOrder=function(){return 99},e.prototype.compareTo=function(t){return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),e._hashSeed},e.prototype.debug=function(t){t=t.write("Value").write(46).write("absent").write(40).write(41)},e.prototype.display=function(t){t=t.write("undefined")},e.absent=function(){return e._absent},e.fromAny=function(t){if(t instanceof e)return t;if(void 0===t)return e.absent();throw new TypeError(""+t)},e._absent=new e,e}(se);$t.Absent=xe;var Ce=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),Se=function(){function t(){}return t.prototype.tag=function(e){return 0===arguments.length?void 0:void 0!==e?new t.TagForm(e,this):this},t.prototype.unit=function(e){return 0===arguments.length?void 0:void 0!==e?new t.UnitForm(e,this):this},t.forString=function(){return t._stringForm||(t._stringForm=new t.StringForm("")),t._stringForm},t.forNumber=function(){return t._numberForm||(t._numberForm=new t.NumberForm(0)),t._numberForm},t.forBoolean=function(){return t._booleanForm||(t._booleanForm=new t.BooleanForm(!1)),t._booleanForm},t.forAny=function(){return t._anyForm||(t._anyForm=new t.AnyForm(void 0)),t._anyForm},t.forItem=function(){return t._itemForm||(t._itemForm=new t.ItemForm($t.absent())),t._itemForm},t.forValue=function(){return t._valueForm||(t._valueForm=new t.ValueForm(se.absent())),t._valueForm},t}(),Ae=function(t){function e(e,r){var i=t.call(this)||this;return i._operand1=e,i._operand2=r,i}return _(e,t),e.prototype.operand1=function(){return this._operand1},e.prototype.operand2=function(){return this._operand2},e.prototype.isConstant=function(){return this._operand1.isConstant()&&this._operand2.isConstant()},e}(me);$t.BinaryOperator=Ae;var ke=function(t){function e(e){var r=t.call(this)||this;return r._operand=e,r}return _(e,t),e.prototype.operand=function(){return this._operand},e.prototype.isConstant=function(){return this._operand.isConstant()},e}(me);$t.UnaryOperator=ke;var Ee=function(t){function e(e,r,i){var n=t.call(this)||this;return n._ifTerm=e.commit(),n._thenTerm=r.commit(),n._elseTerm=i.commit(),n}return _(e,t),e.prototype.ifTerm=function(){return this._ifTerm},e.prototype.thenTerm=function(){return this._thenTerm},e.prototype.elseTerm=function(){return this._elseTerm},e.prototype.isConstant=function(){return this._ifTerm.isConstant()&&this._thenTerm.isConstant()&&this._elseTerm.isConstant()},e.prototype.precedence=function(){return 2},e.prototype.evaluate=function(t){var e;((t=re.fromAny(t)).willOperate(this),this._ifTerm.evaluate(t).booleanValue(!1))?e=this._thenTerm.evaluate(t):e=this._elseTerm.evaluate(t);return t.didOperate(this,e),e},e.prototype.substitute=function(t){return t=re.fromAny(t),new e(this._ifTerm.substitute(t),this._thenTerm.substitute(t),this._elseTerm.substitute(t))},e.prototype.typeOrder=function(){return 20},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._ifTerm.compareTo(t._ifTerm);return 0===r&&0===(r=this._thenTerm.compareTo(t._thenTerm))&&(r=this._elseTerm.compareTo(t._elseTerm)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._ifTerm.equals(t._ifTerm)&&this._thenTerm.equals(t._thenTerm)&&this._elseTerm.equals(t._elseTerm))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(e._hashSeed,this._ifTerm.hashCode()),this._thenTerm.hashCode()),this._elseTerm.hashCode()))},e.prototype.debug=function(t){t.debug(this._ifTerm).write(46).write("conditional").write(40).debug(this._thenTerm).write(44).write(32).debug(this._elseTerm).write(41)},e.prototype.clone=function(){return new e(this._ifTerm.clone(),this._thenTerm.clone(),this._elseTerm.clone())},e}(me);$t.ConditionalOperator=Ee;var Oe=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"||"},e.prototype.precedence=function(){return 3},e.prototype.evaluate=function(t){var e;(t=re.fromAny(t)).willOperate(this);var r=this._operand1.evaluate(t);r.booleanValue(!1)?e=r:e=this._operand2.evaluate(t);return t.didOperate(this,e),e},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.or(r)},e.prototype.typeOrder=function(){return 21},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("or").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.OrOperator=Oe;var Ve=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"&&"},e.prototype.precedence=function(){return 4},e.prototype.evaluate=function(t){var e;(t=re.fromAny(t)).willOperate(this);var r=this._operand1.evaluate(t);r.booleanValue(!1)?e=this._operand2.evaluate(t):e=r;return t.didOperate(this,e),e},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.and(r)},e.prototype.typeOrder=function(){return 22},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("and").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.AndOperator=Ve;var Pe=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"|"},e.prototype.precedence=function(){return 5},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.bitwiseOr(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.bitwiseOr(r)},e.prototype.typeOrder=function(){return 23},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("bitwiseOr").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.BitwiseOrOperator=Pe;var De=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"^"},e.prototype.precedence=function(){return 6},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.bitwiseXor(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.bitwiseXor(r)},e.prototype.typeOrder=function(){return 24},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("bitwiseXor").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.BitwiseXorOperator=De;var Me=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"&"},e.prototype.precedence=function(){return 7},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.bitwiseAnd(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.bitwiseAnd(r)},e.prototype.typeOrder=function(){return 25},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("bitwiseAnd").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.BitwiseAndOperator=Me;var Te=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"<"},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.lt(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.lt(r)},e.prototype.typeOrder=function(){return 26},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("lt").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.LtOperator=Te;var Re=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"<="},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.le(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.le(r)},e.prototype.typeOrder=function(){return 27},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("le").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.LeOperator=Re;var Ie=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"=="},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.eq(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.eq(r)},e.prototype.typeOrder=function(){return 28},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("eq").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.EqOperator=Ie;var Fe=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"!="},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.ne(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.ne(r)},e.prototype.typeOrder=function(){return 29},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("ne").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.NeOperator=Fe;var Le=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return">="},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.ge(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.ge(r)},e.prototype.typeOrder=function(){return 30},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("ge").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.GeOperator=Le;var Ue=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return">"},e.prototype.precedence=function(){return 0},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.gt(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.gt(r)},e.prototype.typeOrder=function(){return 31},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("gt").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.GtOperator=Ue;var Ne=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"+"},e.prototype.precedence=function(){return 8},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.plus(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.plus(r)},e.prototype.typeOrder=function(){return 32},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("plus").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.PlusOperator=Ne;var ze=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"-"},e.prototype.precedence=function(){return 8},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.minus(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.minus(r)},e.prototype.typeOrder=function(){return 33},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("minus").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.MinusOperator=ze;var je=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"*"},e.prototype.precedence=function(){return 9},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.times(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.times(r)},e.prototype.typeOrder=function(){return 34},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("times").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.TimesOperator=je;var We=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"/"},e.prototype.precedence=function(){return 9},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.divide(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.divide(r)},e.prototype.typeOrder=function(){return 35},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("divide").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.DivideOperator=We;var qe=function(t){function e(e,r){return t.call(this,e,r)||this}return _(e,t),e.prototype.operator=function(){return"%"},e.prototype.precedence=function(){return 9},e.prototype.evaluate=function(t){(t=re.fromAny(t)).willOperate(this);var e=this._operand1.evaluate(t),r=this._operand2.evaluate(t),i=e.modulo(r);return t.didOperate(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var e=this._operand1.substitute(t),r=this._operand2.substitute(t);return e.modulo(r)},e.prototype.typeOrder=function(){return 36},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._operand1.compareTo(t._operand1);return 0===r&&(r=this._operand2.compareTo(t._operand2)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._operand1.equals(t._operand1)&&this._operand2.equals(t._operand2))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._operand1.hashCode()),this._operand2.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand1).write(46).write("modulo").write(40).debug(this._operand2).write(41)},e.prototype.clone=function(){return new e(this._operand1.clone(),this._operand2.clone())},e}(Ae);$t.ModuloOperator=qe;var Be=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.operator=function(){return"!"},e.prototype.precedence=function(){return 10},e.prototype.evaluate=function(t){return t=re.fromAny(t),this._operand.evaluate(t).not()},e.prototype.substitute=function(t){return t=re.fromAny(t),this._operand.substitute(t).not()},e.prototype.typeOrder=function(){return 37},e.prototype.compareTo=function(t){return t instanceof e?this._operand.compareTo(t._operand):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._operand.equals(t._operand)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._operand.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand).write(46).write("not").write(40).write(41)},e.prototype.clone=function(){return new e(this._operand.clone())},e}(ke);$t.NotOperator=Be;var Ke=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.operator=function(){return"~"},e.prototype.precedence=function(){return 10},e.prototype.evaluate=function(t){return t=re.fromAny(t),this._operand.evaluate(t).bitwiseNot()},e.prototype.substitute=function(t){return t=re.fromAny(t),this._operand.substitute(t).bitwiseNot()},e.prototype.typeOrder=function(){return 38},e.prototype.compareTo=function(t){return t instanceof e?this._operand.compareTo(t._operand):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._operand.equals(t._operand)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._operand.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand).write(46).write("bitwiseNot").write(40).write(41)},e.prototype.clone=function(){return new e(this._operand.clone())},e}(ke);$t.BitwiseNotOperator=Ke;var He=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.operator=function(){return"-"},e.prototype.precedence=function(){return 10},e.prototype.evaluate=function(t){return t=re.fromAny(t),this._operand.evaluate(t).negative()},e.prototype.substitute=function(t){return t=re.fromAny(t),this._operand.substitute(t).negative()},e.prototype.typeOrder=function(){return 39},e.prototype.compareTo=function(t){return t instanceof e?this._operand.compareTo(t._operand):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._operand.equals(t._operand)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._operand.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand).write(46).write("negative").write(40).write(41)},e.prototype.clone=function(){return new e(this._operand.clone())},e}(ke);$t.NegativeOperator=He;var Ge=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.operator=function(){return"+"},e.prototype.precedence=function(){return 10},e.prototype.evaluate=function(t){return t=re.fromAny(t),this._operand.evaluate(t).positive()},e.prototype.substitute=function(t){return t=re.fromAny(t),this._operand.substitute(t).positive()},e.prototype.typeOrder=function(){return 40},e.prototype.compareTo=function(t){return t instanceof e?this._operand.compareTo(t._operand):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._operand.equals(t._operand)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._operand.hashCode()))},e.prototype.debug=function(t){t.debug(this._operand).write(46).write("positive").write(40).write(41)},e.prototype.clone=function(){return new e(this._operand.clone())},e}(ke);$t.PositiveOperator=Ge;var Xe=function(t){function e(e,r){var i=t.call(this)||this;return i._func=e,i._args=r.commit(),i}return _(e,t),e.prototype.func=function(){return this._func},e.prototype.args=function(){return this._args},e.prototype.state=function(){return this._state},e.prototype.setState=function(t){this._state=t},e.prototype.isConstant=function(){return this._func.isConstant()&&this._args.isConstant()},e.prototype.precedence=function(){return 11},e.prototype.evaluate=function(t){t=re.fromAny(t);var e=this._func.evaluate(t);return e instanceof $t.Func?e.invoke(this._args,t,this):$t.absent()},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._func.evaluate(t);if(r instanceof $t.Func){var i=r.expand(this._args,t,this);if(i)return i}var n=this._args.substitute(t).toValue();return new e(this._func,n)},e.prototype.typeOrder=function(){return 41},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._func.compareTo(t._func);return 0===r&&(r=this._args.compareTo(t._args)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._func.equals(t._func)&&this._args.equals(t._args))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._func.hashCode()),this._args.hashCode()))},e.prototype.debug=function(t){t.debug(this._func).write(46).write("invoke").write(40).debug(this._args).write(41)},e.prototype.clone=function(){return new e(this._func.clone(),this._args.clone())},e}(me);$t.InvokeOperator=Xe;var Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.then=function(){return this},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=t.popScope(),o=n.evaluate(t);t.pushScope(o),i=e.call(r,t),t.swapScope(n)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){return e.call(r,t)},e.prototype.substitute=function(t){return(t=re.fromAny(t)).peekScope().substitute(t)},e.prototype.get=function(t){return t=se.fromAny(t),new $t.GetSelector(t,this)},e.prototype.getAttr=function(t){return t=$t.Text.fromAny(t),new $t.GetAttrSelector(t,this)},e.prototype.getItem=function(t){return t=$t.Num.fromAny(t),new $t.GetItemSelector(t,this)},e.prototype.andThen=function(t){return t},e.prototype.keys=function(){return we.keys()},e.prototype.values=function(){return we.values()},e.prototype.children=function(){return we.children()},e.prototype.descendants=function(){return we.descendants()},e.prototype.filter=function(t){return 0===arguments.length?new $t.FilterSelector(this,this):(t=$t.fromAny(t)).filter()},e.prototype.typeOrder=function(){return 10},e.prototype.compareTo=function(t){return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),e._hashSeed},e.prototype.debugThen=function(t){},e.prototype.clone=function(){return this},e}(we);$t.IdentitySelector=Ye,we._identity=new Ye;var Ze=function(t){function e(e,r){var i=t.call(this)||this;return i._key=e.commit(),i._then=r,i}return _(e,t),e.prototype.accessor=function(){return this._key},e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,r,i){t.willSelect(this);var n=this._key.evaluate(t).toValue(),o=e.forSelected(n,this._then,t,r,i);return t.didSelect(this,o),o},e.forSelected=function(t,r,i,n,o){var s;if(0!==i.scopeDepth()){var u=i.popScope().toValue(),a=void 0;u instanceof $t.Record&&(a=u.getField(t))&&(i.pushScope(a.toValue()),s=r.forSelected(i,n,o),i.popScope()),void 0===a&&void 0===s&&e.forSelected(t,r,i,n,o),i.pushScope(u)}return s},e.prototype.mapSelected=function(t,e,r){var i;t.willTransform(this);var n=this._key.evaluate(t).toValue();if(0!==t.scopeDepth()){var o=t.popScope().toValue();if(o instanceof $t.Record){var s=o.getField(n);if(s){t.pushScope(s.toValue());var u=this._then.mapSelected(t,e,r);t.popScope(),u instanceof $t.Field?n.equals(u.key)?o.set(n,u.toValue()):(o.delete(n),o.push(u)):u.isDefined()?o.set(n,u.toValue()):o.delete(n)}}t.pushScope(o),i=o}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._key.evaluate(t).toValue(),i=e.substitute(r,this._then,t);if(i)return i;var n=this._then.substitute(t);return n instanceof we||(n=this._then),new e(this._key,n)},e.substitute=function(t,r,i){var n;if(0!==i.scopeDepth()){var o=i.popScope().toValue(),s=void 0;o instanceof $t.Record&&(s=o.getField(t))&&(n=s.toValue().substitute(i)),void 0===s&&void 0===n&&e.substitute(t,r,i),i.pushScope(o)}return n},e.prototype.andThen=function(t){return new e(this._key,this._then.andThen(t))},e.prototype.typeOrder=function(){return 12},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._key.compareTo(t._key);return 0===r&&(r=this._then.compareTo(t._then)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._then.equals(t._then))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._key.hashCode()),this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("get").write(40).debug(this._key).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._key.clone(),this._then.clone())},e}(we);$t.GetSelector=Ze;var Qe=function(t){function e(e,r){var i=t.call(this)||this;return i._key=e,i._then=r,i}return _(e,t),e.prototype.accessor=function(){return this._key},e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,r,i){t.willSelect(this);var n=this._key,o=e.forSelected(n,this._then,t,r);return t.didSelect(this,o),o},e.forSelected=function(t,r,i,n,o){var s;if(0!==i.scopeDepth()){var u=i.popScope().toValue(),a=void 0;u instanceof $t.Record&&(a=u.getField(t))instanceof ie&&(i.pushScope(a.toValue()),s=r.forSelected(i,n,o),i.popScope()),void 0===a&&void 0===s&&e.forSelected(t,r,i,n,o),i.pushScope(u)}return s},e.prototype.mapSelected=function(t,e,r){var i;t.willTransform(this);var n=this._key;if(0!==t.scopeDepth()){var o=t.popScope().toValue();if(o instanceof $t.Record){var s=o.getField(n);if(s instanceof $t.Attr){t.pushScope(s.toValue());var u=this._then.mapSelected(t,e,r);t.popScope(),u instanceof $t.Field?n.equals(u.key)?o.setAttr(n,u.toValue()):(o.delete(n),o.push(u)):u.isDefined()?o.setAttr(n,u.toValue()):o.delete(n)}}t.pushScope(o),i=o}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._key,i=e.substitute(r,this._then,t);if(i)return i;var n=this._then.substitute(t);return n instanceof we||(n=this._then),new e(this._key,n)},e.substitute=function(t,r,i){var n;if(0!==i.scopeDepth()){var o=i.popScope().toValue(),s=void 0;o instanceof $t.Record&&(s=o.getField(t))instanceof $t.Attr&&(n=s.toValue().substitute(i)),void 0===s&&void 0===n&&e.substitute(t,r,i),i.pushScope(o)}return n},e.prototype.andThen=function(t){return new e(this._key,this._then.andThen(t))},e.prototype.typeOrder=function(){return 13},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._key.compareTo(t._key);return 0===r&&(r=this._then.compareTo(t._then)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._then.equals(t._then))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._key.hashCode()),this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("getAttr").write(40).debug(this._key).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._key.clone(),this._then.clone())},e}(we);$t.GetAttrSelector=Qe;var $e=function(t){function e(e,r){var i=t.call(this)||this;return i._index=e,i._then=r,i}return _(e,t),e.prototype.accessor=function(){return this._index},e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;t.willSelect(this);var n=this._index.numberValue();if(0!==t.scopeDepth()){var o=t.popScope().toValue();if(o instanceof $t.Record&&n<o.length){var s=o.getItem(n);t.pushScope(s),i=this._then.forSelected(t,e,r),t.popScope()}t.pushScope(o)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=t.popScope().toValue(),o=this._index.numberValue();if(n instanceof $t.Record&&o<n.length){var s=n.getItem(o);t.pushScope(s);var u=this._then.mapSelected(t,e,r);t.popScope(),u.isDefined()?n.setItem(o,u):n.splice(o,1)}t.pushScope(n),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._index.numberValue();if(0!==t.scopeDepth()){var i=t.popScope().toValue(),n=void 0;if(i instanceof $t.Record&&r<i.length)n=i.getItem(r).substitute(t);if(t.pushScope(i),n)return n}var o=this._then.substitute(t);return o instanceof we||(o=this._then),new e(this._index,o)},e.prototype.andThen=function(t){return new e(this._index,this._then.andThen(t))},e.prototype.typeOrder=function(){return 14},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._index.compareTo(t._index);return 0===r&&(r=this._then.compareTo(t._then)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._index.equals(t._index)&&this._then.equals(t._then))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._index.hashCode()),this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("getItem").write(40).debug(this._index).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._index,this._then.clone())},e}(we);$t.GetItemSelector=$e;var Je=function(t){function e(e){var r=t.call(this)||this;return r._then=e,r}return _(e,t),e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=t.popScope();if(n instanceof $t.Record)for(var o=n.iterator();void 0===i&&o.hasNext();){var s=o.next().value;s instanceof $t.Field&&(t.pushScope(s.key),i=this._then.forSelected(t,e,r),t.popScope())}else n instanceof $t.Field&&(t.pushScope(n.key),i=this._then.forSelected(t,e,r),t.popScope());t.pushScope(n)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=t.popScope();if(n instanceof $t.Record)for(var o=n.iterator();o.hasNext();){var s=o.next().value;if(s instanceof $t.Field){var u=s.key;t.pushScope(u);var a=this._then.mapSelected(t,e,r).toValue();t.popScope(),a.isDefined()?u!==a&&(n instanceof $t.Attr&&a instanceof $t.Text?o.set($t.Attr.of(a,n.toValue())):o.set($t.Slot.of(a,n.toValue()))):o.delete()}}else if(n instanceof $t.Field){u=n.key;t.pushScope(u);a=this._then.mapSelected(t,e,r).toValue();t.popScope(),a.isDefined()?u!==a&&(n=n instanceof $t.Attr&&a instanceof $t.Text?$t.Attr.of(a,n.toValue()):$t.Slot.of(a,n.toValue())):n=$t.absent()}t.pushScope(n),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._then.substitute(t);return r instanceof we||(r=this._then),new e(r)},e.prototype.andThen=function(t){return new e(this._then.andThen(t))},e.prototype.typeOrder=function(){return 15},e.prototype.compareTo=function(t){return t instanceof e?this._then.compareTo(t._then):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._then.equals(t._then)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("keys").write(40).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._then.clone())},e}(we);$t.KeysSelector=Je;var tr=function(t){function e(e){var r=t.call(this)||this;return r._then=e,r}return _(e,t),e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=t.popScope();if(n instanceof $t.Record)for(var o=n.iterator();void 0===i&&o.hasNext();){var s=o.next().value;t.pushScope(s.toValue()),i=this._then.forSelected(t,e,r),t.popScope()}else t.pushScope(n.toValue()),i=this._then.forSelected(t,e,r),t.popScope();t.pushScope(n)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=t.popScope();if(n instanceof $t.Record)for(var o=n.iterator();o.hasNext();){var s=o.next().value;if(s instanceof $t.Field){var u=s.toValue();t.pushScope(u);var a=this._then.mapSelected(t,e,r);t.popScope(),a.isDefined()?a instanceof $t.Field?o.set(a):a!==u&&o.set(s.updatedValue(a.toValue())):o.delete()}else{t.pushScope(s.toValue());a=this._then.mapSelected(t,e,r);t.popScope(),a.isDefined()?s!==a&&o.set(a):o.delete()}}else if(n instanceof $t.Field){u=n.toValue();t.pushScope(u);a=this._then.mapSelected(t,e,r);t.popScope(),a.isDefined()?a instanceof $t.Field?n=a:a!==u&&(n=n.updatedValue(a.toValue())):n=$t.absent()}else t.pushScope(n),n=this._then.mapSelected(t,e,r),t.popScope();t.pushScope(n),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._then.substitute(t);return r instanceof we||(r=this._then),new e(r)},e.prototype.andThen=function(t){return new e(this._then.andThen(t))},e.prototype.typeOrder=function(){return 16},e.prototype.compareTo=function(t){return t instanceof e?this._then.compareTo(t._then):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._then.equals(t._then)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("values").write(40).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._then.clone())},e}(we);$t.ValuesSelector=tr;var er=function(t){function e(e){var r=t.call(this)||this;return r._then=e,r}return _(e,t),e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=t.popScope().toValue();if(n instanceof $t.Record)for(var o=n.iterator();void 0===i&&o.hasNext();){var s=o.next().value;t.pushScope(s),i=this._then.forSelected(t,e,r),t.popScope()}t.pushScope(n)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=t.popScope().toValue();if(n instanceof $t.Record)for(var o=n.iterator();o.hasNext();){var s=o.next().value;t.pushScope(s);var u=this._then.mapSelected(t,e);t.popScope(),u.isDefined()?u!==s&&o.set(u):o.delete()}t.pushScope(n),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._then.substitute(t);return r instanceof we||(r=this._then),new e(r)},e.prototype.andThen=function(t){return new e(this._then.andThen(t))},e.prototype.typeOrder=function(){return 17},e.prototype.compareTo=function(t){return t instanceof e?this._then.compareTo(t._then):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._then.equals(t._then)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("children").write(40).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._then.clone())},e}(we);$t.ChildrenSelector=er;var rr=function(t){function e(e){var r=t.call(this)||this;return r._then=e,r}return _(e,t),e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=t.popScope().toValue();if(n instanceof $t.Record)for(var o=n.iterator();void 0===i&&o.hasNext();){var s=o.next().value;t.pushScope(s),void 0===(i=this._then.forSelected(t,e,r))&&this.forSelected(t,e,r),t.popScope()}t.pushScope(n)}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=t.popScope().toValue();if(n instanceof $t.Record)for(var o=n.iterator();o.hasNext();){var s=o.next().value;t.pushScope(s);var u=this._then.mapSelected(t,e,r);u.isDefined()&&(u=this.mapSelected(t,e,r)),t.popScope(),u.isDefined()?u!==s&&o.set(u):o.delete()}t.pushScope(n),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._then.substitute(t);return r instanceof we||(r=this._then),new e(r)},e.prototype.andThen=function(t){return new e(this._then.andThen(t))},e.prototype.typeOrder=function(){return 18},e.prototype.compareTo=function(t){return t instanceof e?this._then.compareTo(t._then):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&this._then.equals(t._then)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("descendants").write(40).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._then.clone())},e}(we);$t.DescendantsSelector=rr;var ir=function(t){function e(e,r){var i=t.call(this)||this;return i._predicate=e,i._then=r,i}return _(e,t),e.prototype.predicate=function(){return this._predicate},e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;return t.willSelect(this),0!==t.scopeDepth()&&this.filterSelected(t)&&(i=this._then.forSelected(t,e,r)),t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;return t.willTransform(this),i=0!==t.scopeDepth()?this.filterSelected(t)?this._then.mapSelected(t,e,r):t.peekScope().toValue():$t.absent(),t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._predicate.substitute(t);r instanceof we||(r=this._predicate);var i=this._then.substitute(t);return i instanceof we||(i=this._then),new e(r,i)},e.prototype.filterSelected=function(t){return void 0!==this._predicate.forSelected(t,this.selected,this)},e.prototype.selected=function(t){return null},e.prototype.andThen=function(t){return new e(this._predicate,this._then.andThen(t))},e.prototype.filter=function(t){return 0===arguments.length?this:(t=$t.fromAny(t),this.andThen(t.filter()))},e.prototype.typeOrder=function(){return 19},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._predicate.compareTo(t._predicate);return 0===r&&(r=this._then.compareTo(t._then)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._predicate.equals(t._predicate)&&this._then.equals(t._then))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._predicate.hashCode()),this._then.hashCode()))},e.prototype.debugThen=function(t){t=t.write(46).write("filter").write(40).debug(this._predicate).write(41),this._then.debugThen(t)},e.prototype.clone=function(){return new e(this._predicate.clone(),this._then.clone())},e}(we);$t.FilterSelector=ir;var nr=function(t){function e(e,r){var i=t.call(this)||this;return i._item=e.commit(),i._then=r,i}return _(e,t),e.prototype.item=function(){return this._item},e.prototype.then=function(){return this._then},e.prototype.forSelected=function(t,e,r){var i;if(t.willSelect(this),0!==t.scopeDepth()){var n=this._item.evaluate(t);n.isDefined()&&(t.pushScope(n),i=this._then.forSelected(t,e,r),t.popScope())}return t.didSelect(this,i),i},e.prototype.mapSelected=function(t,e,r){var i;if(t.willTransform(this),0!==t.scopeDepth()){var n=this._item.evaluate(t);n.isDefined()&&(t.pushScope(n),n=this._then.mapSelected(t,e,r),t.popScope()),i=n}else i=$t.absent();return t.didTransform(this,i),i},e.prototype.substitute=function(t){t=re.fromAny(t);var r=this._item.substitute(t),i=this._then.substitute(t);return i instanceof we||(i=this._then),new e(r,i)},e.prototype.andThen=function(t){return new e(this._item,this._then.andThen(t))},e.prototype.precedence=function(){return this._item.precedence()},e.prototype.typeOrder=function(){return 11},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._item.compareTo(t._item);return 0===r&&(r=this._then.compareTo(t._then)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._item.equals(t._item)&&this._then.equals(t._then))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._item.hashCode()),this._then.hashCode()))},e.prototype.debug=function(t){t=t.write("Selector").write(46).write("literal").write(40).debug(this._item).write(41),this._then.debugThen(t)},e.prototype.debugThen=function(t){},e.prototype.clone=function(){return new e(this._item.clone(),this._then.clone())},e}(we);$t.LiteralSelector=nr;var or=function(t){function e(e,r){var i=t.call(this)||this;return i._bindings=e,i._template=r,i}return _(e,t),e.prototype.bindings=function(){return this._bindings},e.prototype.template=function(){return this._template},e.prototype.precedence=function(){return 1},e.prototype.invoke=function(t,e,r){e=re.fromAny(e);for(var i=this._bindings,n=Math.max(1,i.length),o=$t.Record.create(n),s=0,u=0;s<n;){var a=i instanceof $t.Record?i.getItem(s):0===s?i:$t.absent(),h=t instanceof $t.Record?t.getItem(u).toValue():0===u?t:$t.Value.absent();a instanceof $t.Text&&h.isDistinct()?(o.push($t.Slot.of(a,h)),u+=1):a instanceof $t.Slot&&(h.isDistinct()?o.push(a.updatedValue(h)):o.push(a),u+=1),s+=1}e.pushScope(o);var p=this._template.evaluate(e);return e.popScope(),p},e.prototype.typeOrder=function(){return 50},e.prototype.compareTo=function(t){if(t instanceof e){var r=this._bindings.compareTo(t._bindings);return 0===r&&(r=this._template.compareTo(t._template)),r}return f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._bindings.equals(t._bindings)&&this._template.equals(t._template))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._bindings.hashCode()),this._template.hashCode()))},e.prototype.debug=function(t){t.debug(this.bindings).write(46).write("lambda").write(40).debug(this.template).write(41)},e}(ge);$t.LambdaFunc=or;var sr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.typeOrder=function(){return 51},e.prototype.compareTo=function(t){return t instanceof e?f.compare(this.__proto__.constructor.name,t.__proto__.constructor.name):f.compare(this.typeOrder(),t.typeOrder())},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return c.seed(this.__proto__.constructor)},e.prototype.debug=function(t){t=t.write(this.__proto__.constructor.name)},e}(ge);$t.BridgeFunc=sr;var ur=function(){function t(){}return t.max=function(){return t._max||(t._max=new ar),t._max},t.min=function(){return t._min||(t._min=new hr),t._min},t.abs=function(){return t._abs||(t._abs=new pr),t._abs},t.ceil=function(){return t._ceil||(t._ceil=new lr),t._ceil},t.floor=function(){return t._floor||(t._floor=new cr),t._floor},t.round=function(){return t._round||(t._round=new fr),t._round},t.sqrt=function(){return t._sqrt||(t._sqrt=new dr),t._sqrt},t.pow=function(){return t._pow||(t._pow=new yr),t._pow},t.rate=function(){return t._rate||(t._rate=new vr),t._rate},t.random=function(){return t._random||(t._random=new _r),t._random},t.scope=function(){return t._scope||(t._scope=$t.Record.create(10).slot("max",t.max()).slot("min",t.min()).slot("abs",t.abs()).slot("ceil",t.ceil()).slot("floor",t.floor()).slot("round",t.round()).slot("pow",t.pow()).slot("sqrt",t.sqrt()).slot("rate",t.rate()).slot("random",t.random()).commit()),t._scope},t}();$t.MathModule=ur;var ar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){var i,n;if(e=re.fromAny(e),t.length>=2?(i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e)):i=t.evaluate(e),void 0!==n)return i.max(n);if(r){var o=void 0!==(n=r.state())?i.max(n):i;return r.setState(o),o}return $t.absent()},e.prototype.expand=function(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(sr),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){var i,n;if(e=re.fromAny(e),t.length>=2?(i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e)):i=t.evaluate(e),void 0!==n)return i.min(n);if(r){var o=void 0!==(n=r.state())?i.min(n):i;return r.setState(o),o}return $t.absent()},e.prototype.expand=function(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(sr),pr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof $t.Num?t.abs():$t.absent()},e}(sr),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof $t.Num?t.ceil():$t.absent()},e}(sr),cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof $t.Num?t.floor():$t.absent()},e}(sr),fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof $t.Num?t.round():$t.absent()},e}(sr),dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof $t.Num?t.sqrt():$t.absent()},e}(sr),yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){e=re.fromAny(e);var i=t.getItem(0).evaluate(e),n=t.getItem(1).evaluate(e);return i instanceof $t.Num&&n instanceof $t.Num?i.pow(n):$t.absent()},e}(sr),vr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){var i,n;if(e=re.fromAny(e),t.length>=2?(i=t.getItem(0).evaluate(e).numberValue(NaN),n=t.getItem(1).evaluate(e).numberValue(1e3)):(i=t.evaluate(e).numberValue(NaN),n=1e3),isFinite(i)&&r){var o=r.state();if(void 0===o)o={v0:i,t0:Date.now(),dv:0,dt:0},r.setState(o);else{var s=Date.now(),u=s-o.t0;if(u>n&&s>o.t0||u>2*n){var a=i-o.v0;o.v0=i,o.t0=s,o.dv=a,o.dt=u}if(r.setState(o),0!==o.dt){var h=n*o.dv/o.dt;return $t.Num.from(h)}}}return $t.absent()},e.prototype.expand=function(t,e,r){return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(sr),_r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.invoke=function(t,e,r){var i=(t=t.evaluate(e).toValue()).length>=1?t.getItem(0).numberValue(0):0,n=t.length>=2?t.getItem(1).numberValue(i+1):i+1,o=i+Math.random()*(n-i);return $t.Num.from(o)},e}(sr),mr=function(t){function e(e,r){var i=t.call(this)||this;return i._tag=e,i._form=r,i}return _(e,t),e.prototype.tag=function(t){return 0===arguments.length?this._tag:void 0!==t?new e(t,this._form):this._form},e.prototype.unit=function(t){return 0===arguments.length?this._form.unit():new e(this._tag,this._form.unit(t))},e.prototype.mold=function(t,e){return(e=this._form.mold(t,e)).header(this._tag).isDefined()||(e=e.prepended(ie.of(this._tag))),e},e.prototype.cast=function(t,e){return t.header(this._tag).isDefined()?this._form.cast(t,e):t.keyEquals(this._tag)?this._form.cast(t.toValue(),e):void 0},e}(Se);Se.TagForm=mr;var wr=function(t){function e(e,r){var i=t.call(this)||this;return i._unit=e,i._form=r,i}return _(e,t),e.prototype.tag=function(t){return 0===arguments.length?this._form.tag():new e(this._unit,this._form.tag(t))},e.prototype.unit=function(t){return 0===arguments.length?this._form.unit():void 0!==t?new e(t,this._form):this._form},e.prototype.mold=function(t,e){return this._form.mold.apply(this._form,arguments)},e.prototype.cast=function(t,e){return this._form.cast.apply(this._form,arguments)},e}(Se);Se.UnitForm=wr;var gr=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return void 0===e?de.from(t):e.concat(de.from(t))},e.prototype.cast=function(t,e){var r=t.target();try{return r.stringValue()}catch(t){return}},e}(Se);Se.StringForm=gr;var br=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return void 0===e?ye.from(t):e.concat(ye.from(t))},e.prototype.cast=function(t,e){var r=t.target();try{return r.numberValue()}catch(t){return}},e}(Se);Se.NumberForm=br;var xr=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return void 0===e?ve.from(t):e.concat(ve.from(t))},e.prototype.cast=function(t,e){var r=t.target();try{return r.booleanValue()}catch(t){return}},e}(Se);Se.BooleanForm=xr;var Cr=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return t=$t.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t.toAny()},e}(Se);Se.AnyForm=Cr;var Sr=function(t){function e(e){var r=t.call(this)||this;return r._unit=e?e.commit():e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return t=$t.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t},e}(Se);Se.ItemForm=Sr;var Ar=function(t){function e(e){var r=t.call(this)||this;return r._unit=e?e.commit():e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return t=se.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t.toValue()},e}(Se);Se.ValueForm=Ar;var kr,Er=function(t){function e(e,r){var i=t.call(this)||this;return i._cursor=e,i._form=r,i}return _(e,t),e.prototype.isEmpty=function(){return this._cursor.isEmpty()},e.prototype.head=function(){return this._cursor.head().coerce(this._form)},e.prototype.step=function(){this._cursor.step()},e.prototype.skip=function(t){this._cursor.skip(t)},e.prototype.hasNext=function(){return this._cursor.hasNext()},e.prototype.nextIndex=function(){return this._cursor.nextIndex()},e.prototype.next=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&e.coerce(this._form),done:r}},e.prototype.hasPrevious=function(){return this._cursor.hasPrevious()},e.prototype.previousIndex=function(){return this._cursor.previousIndex()},e.prototype.previous=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&e.coerce(this._form),done:r}},e.prototype.delete=function(){this._cursor.delete()},e}(y),Or=function(t){function e(e,r,i){var n=t.call(this)||this;return n._cursor=e,n._keyForm=r,n._valueForm=i,n}return _(e,t),e.prototype.isEmpty=function(){return this._cursor.isEmpty()},e.prototype.head=function(){var t=this._cursor.head();return[t[0].coerce(this._keyForm),t[1].coerce(this._valueForm)]},e.prototype.step=function(){this._cursor.step()},e.prototype.skip=function(t){this._cursor.skip(t)},e.prototype.hasNext=function(){return this._cursor.hasNext()},e.prototype.nextIndex=function(){return this._cursor.nextIndex()},e.prototype.next=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&[e[0].coerce(this._keyForm),e[1].coerce(this._valueForm)],done:r}},e.prototype.hasPrevious=function(){return this._cursor.hasPrevious()},e.prototype.previousIndex=function(){return this._cursor.previousIndex()},e.prototype.previous=function(){var t=this._cursor.next(),e=t.value,r=t.done;return{value:e&&[e[0].coerce(this._keyForm),e[1].coerce(this._valueForm)],done:r}},e.prototype.delete=function(){this._cursor.delete()},e}(y),Vr={is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.input&&"function"==typeof e.bindInput&&"function"==typeof e.unbindInput}return!1}},Pr={is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.outputIterator&&"function"==typeof e.bindOutput&&"function"==typeof e.unbindOutput}return!1},MemoizeValueCombinator:void 0,MapValueCombinator:void 0,WatchValueCombinator:void 0};(kr=t.KeyEffect||(t.KeyEffect={}))[kr.Update=0]="Update",kr[kr.Remove=1]="Remove";var Dr={is:function(t){if("object"==typeof t&&t){var e=t;return Vr.is(e)&&"function"==typeof e.decohereOutputKey&&"function"==typeof e.recohereOutputKey}return!1}},Mr={is:function(t){if("object"==typeof t&&t){var e=t;return Pr.is(e)&&"function"==typeof e.keyIterator&&"function"==typeof e.outlet}return!1},MemoizeMapCombinator:void 0,FilterFieldsCombinator:void 0,MapFieldValuesCombinator:void 0,ReduceFieldsCombinator:void 0,WatchFieldsCombinator:void 0},Tr=function(t){function e(r){var i=t.call(this,r)||this;return i.__proto__=e.prototype,i}return _(e,t),e}(Error),Rr={is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.streamletScope&&"function"==typeof e.streamletContext&&"function"==typeof e.outlet}return!1}},Ir=function(){function t(){this._input=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.decohereOutput=function(){this._version>=0&&(this.willDecohereOutput(),this._version=-1,this.onDecohereOutput(),this.didDecohereOutput())},t.prototype.recohereOutput=function(t){this._version<0&&(this.willRecohereOutput(t),this._version=t,null!==this._input&&this._input.recohereInput(t),this.onRecohereOutput(t),this.didRecohereOutput(t))},t.prototype.willDecohereOutput=function(){},t.prototype.onDecohereOutput=function(){},t.prototype.didDecohereOutput=function(){},t.prototype.willRecohereOutput=function(t){},t.prototype.onRecohereOutput=function(t){},t.prototype.didRecohereOutput=function(t){},t}(),Fr=function(){function t(){this._outputs=null,this._version=-1}return t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=0,i=null!==e?e.length:0;r<i;r+=1)if(e[r]===t){if(i>1){for(var n=new Array(i-1),o=0;o<r;o+=1)n[o]=e[o];for(o=r;o<i-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){var i=t[e];i.unbindInput(),i.disconnectOutputs()}}},t.prototype.disconnectInputs=function(){},t.prototype.decohereInput=function(){if(this._version>=0){this.willDecohereInput(),this._version=-1,this.onDecohereInput();for(var t=0,e=null!==this._outputs?this._outputs.length:0;t<e;t+=1)this._outputs[t].decohereOutput();this.didDecohereInput()}},t.prototype.recohereInput=function(t){if(this._version<0){this.willRecohereInput(t),this._version=t,this.onRecohereInput(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohereInput(t)}},t.prototype.willDecohereInput=function(){},t.prototype.onDecohereInput=function(){},t.prototype.didDecohereInput=function(){},t.prototype.willRecohereInput=function(t){},t.prototype.onRecohereInput=function(t){},t.prototype.didRecohereInput=function(t){},t.prototype.memoize=function(){var t=new Pr.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var e=new Pr.MapValueCombinator(t);return e.bindInput(this),e},t.prototype.watch=function(t){return new Pr.WatchValueCombinator(t).bindInput(this),this},t}(),Lr=function(){function t(){this._input=null,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){var i=t[e];i.unbindInput(),i.disconnectOutputs()}}}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this.didDecohere()}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._version=t,null!==this._input&&this._input.recohereInput(t),this.onRecohere(t);for(var e=null!==this._outputs?this._outputs.length:0,r=0;r<e;r+=1)this._outputs[r].recohereOutput(t);this.didRecohere(t)}},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t.prototype.memoize=function(){var t=new Pr.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var e=new Pr.MapValueCombinator(t);return e.bindInput(this),e},t.prototype.watch=function(t){return new Pr.WatchValueCombinator(t).bindInput(this),this},t}(),Ur=function(t){function e(e,r){var i=t.call(this)||this;return i._input=e,i._key=r,i}return _(e,t),e.prototype.input=function(){return this._input},e.prototype.key=function(){return this._key},e.prototype.get=function(){return this._input.get(this._key)},e}(Fr),Nr=function(){function t(){this._input=null,this._effects=new jt,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!Mr.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!=this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.decohereOutputKey=function(t,e){var r=this._effects;r.get(t)!==e&&(this.willDecohereOutputKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereOutputKey(t,e),this.didDecohereOutputKey(t,e))},t.prototype.decohereOutput=function(){this._version>=0&&(this.willDecohereOutput(),this._version=-1,this.onDecohereOutput(),this.didDecohereOutput())},t.prototype.recohereOutputKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);void 0!==i&&(this.willRecohereOutputKey(t,i,e),this._effects=r.removed(t),null!==this._input&&this._input.recohereInputKey(t,e),this.onRecohereOutputKey(t,i,e),this.didRecohereOutputKey(t,i,e))}},t.prototype.recohereOutput=function(t){this._version<0&&(this.willRecohereOutput(t),this._effects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this._version=t,this.onRecohereOutput(t),this.didRecohereOutput(t))},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohereOutput=function(){},t.prototype.onDecohereOutput=function(){},t.prototype.didDecohereOutput=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohereOutput=function(t){},t.prototype.onRecohereOutput=function(t){},t.prototype.didRecohereOutput=function(t){},t}(),zr=function(){function t(){this._effects=new jt,this._outlets=new jt,this._outputs=null,this._version=-1}return t.prototype.outlet=function(t){var e=this._outlets.get(t);return void 0===e&&(e=new Ur(this,t),this._outlets=this._outlets.updated(t,e)),e},t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){e[r].unbindInput()}}},t.prototype.disconnectOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){var n=e[r];n.unbindInput(),n.disconnectOutputs()}}},t.prototype.disconnectInputs=function(){},t.prototype.decohereInputKey=function(t,e){var r=this._effects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereInputKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){var o=this._outputs[n];Dr.is(o)?o.decohereOutputKey(t,e):o.decohereOutput()}var s=this._outlets.get(t);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(t,e)}},t.prototype.decohereInput=function(){if(this._version>=0){this.willDecohereInput(),this._version=-1,this.onDecohereInput();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this._outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohereInput()}},t.prototype.recohereInputKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);if(void 0!==i){this.willRecohereInputKey(t,i,e),this._effects=r.removed(t),this.onRecohereInputKey(t,i,e);for(var n=0,o=null!==this._outputs?this._outputs.length:0;n<o;n+=1){var s=this._outputs[n];Dr.is(s)&&s.recohereOutputKey(t,e)}var u=this._outlets.get(t);void 0!==u&&u.recohereInput(e),this.didRecohereInputKey(t,i,e)}}},t.prototype.recohereInput=function(t){if(this._version<0){this.willRecohereInput(t),this._effects.forEach((function(e){this.recohereInputKey(e,t)}),this),this._version=t,this.onRecohereInput(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohereInput(t)}},t.prototype.willDecohereInputKey=function(t,e){},t.prototype.onDecohereInputKey=function(t,e){},t.prototype.didDecohereInputKey=function(t,e){},t.prototype.willDecohereInput=function(){},t.prototype.onDecohereInput=function(){},t.prototype.didDecohereInput=function(){},t.prototype.willRecohereInputKey=function(t,e,r){},t.prototype.onRecohereInputKey=function(t,e,r){},t.prototype.didRecohereInputKey=function(t,e,r){},t.prototype.willRecohereInput=function(t){},t.prototype.onRecohereInput=function(t){},t.prototype.didRecohereInput=function(t){},t.prototype.memoize=function(){var t=new Mr.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var e=new Mr.FilterFieldsCombinator(t);return e.bindInput(this),e},t.prototype.map=function(t){var e;return 1===t.length?((e=new Pr.MapValueCombinator(t)).bindInput(this),e):((e=new Mr.MapFieldValuesCombinator(t)).bindInput(this),e)},t.prototype.reduce=function(t,e,r){var i=new Mr.ReduceFieldsCombinator(t,e,r);return i.bindInput(this),i},t.prototype.watch=function(t){return 1===t.length?(new Pr.WatchValueCombinator(t).bindInput(this),this):(new Mr.WatchFieldsCombinator(t).bindInput(this),this)},t}(),jr=function(){function t(){this._input=null,this._effects=new jt,this._outlets=new jt,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!Mr.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs&&this._outlets.isEmpty()){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outlet=function(t){var e=this._outlets.get(t);return void 0===e&&(e=new Ur(this,t),this._outlets=this._outlets.updated(t,e)),e},t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){e[r].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){var n=e[r];n.unbindInput(),n.disconnectOutputs()}}}},t.prototype.decohereOutputKey=function(t,e){this.decohereKey(t,e)},t.prototype.decohereInputKey=function(t,e){this.decohereKey(t,e)},t.prototype.decohereKey=function(t,e){var r=this._effects;if(r.get(t)!==e){this.willDecohereKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){var o=this._outputs[n];Dr.is(o)?o.decohereOutputKey(t,e):o.decohereOutput()}var s=this._outlets.get(t);void 0!==s&&s.decohereInput(),this.didDecohereKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this._outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){this.recohereKey(t,e)},t.prototype.recohereInputKey=function(t,e){this.recohereKey(t,e)},t.prototype.recohereKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);if(void 0!==i){this.willRecohereKey(t,i,e),this._effects=r.removed(t),null!==this._input&&this._input.recohereInputKey(t,e),this.onRecohereKey(t,i,e);for(var n=0,o=null!==this._outputs?this._outputs.length:0;n<o;n+=1){var s=this._outputs[n];Dr.is(s)&&s.recohereOutputKey(t,e)}var u=this._outlets.get(t);void 0!==u&&u.recohereInput(e),this.didRecohereKey(t,i,e)}}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._effects.forEach((function(e){this.recohereKey(e,t)}),this),this._version=t,this.onRecohere(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohere(t)}},t.prototype.willDecohereKey=function(t,e){},t.prototype.onDecohereKey=function(t,e){},t.prototype.didDecohereKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereKey=function(t,e,r){},t.prototype.onRecohereKey=function(t,e,r){},t.prototype.didRecohereKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t.prototype.memoize=function(){var t=new Mr.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var e=new Mr.FilterFieldsCombinator(t);return e.bindInput(this),e},t.prototype.map=function(t){var e;return 1===t.length?((e=new Pr.MapValueCombinator(t)).bindInput(this),e):((e=new Mr.MapFieldValuesCombinator(t)).bindInput(this),e)},t.prototype.reduce=function(t,e,r){var i=new Mr.ReduceFieldsCombinator(t,e,r);return i.bindInput(this),i},t.prototype.watch=function(t){return 1===t.length?(new Pr.WatchValueCombinator(t).bindInput(this),this):(new Mr.WatchFieldsCombinator(t).bindInput(this),this)},t}(),Wr=function(){function t(){this._input=null,this._effects=new jt,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!Mr.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){var i=t[e];i.unbindInput(),i.disconnectOutputs()}}}},t.prototype.decohereOutputKey=function(t,e){var r=this._effects;if(r.get(t)!==e){this.willDecohereOutputKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereOutputKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){this._outputs[n].decohereOutput()}this.didDecohereOutputKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);void 0!==i&&(this.willRecohereOutputKey(t,i,e),this._effects=r.removed(t),null!==this._input&&this._input.recohereInputKey(t,e),this.onRecohereOutputKey(t,i,e),this.didRecohereOutputKey(t,i,e))}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._effects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this._version=t,this.onRecohere(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohere(t)}},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t.prototype.memoize=function(){var t=new Pr.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var e=new Pr.MapValueCombinator(t);return e.bindInput(this),e},t.prototype.watch=function(t){return new Pr.WatchValueCombinator(t).bindInput(this),this},t}(),qr=function(){function t(){this._input=null,this._outputEffects=new jt,this._inputEffects=new jt,this._outlets=new jt,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!Mr.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs&&this._outlets.isEmpty()){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outlet=function(t){var e=this._outlets.get(t);return void 0===e&&(e=new Ur(this,t),this._outlets=this._outlets.updated(t,e)),e},t.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},t.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},t.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){e[r].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){var n=e[r];n.unbindInput(),n.disconnectOutputs()}}}},t.prototype.decohereOutputKey=function(t,e){var r=this._outputEffects;r.get(t)!==e&&(this.willDecohereOutputKey(t,e),this._outputEffects=r.updated(t,e),this._version=-1,this.onDecohereOutputKey(t,e),this.didDecohereOutputKey(t,e))},t.prototype.decohereInputKey=function(t,e){var r=this._inputEffects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this._inputEffects=r.updated(t,e),this._version=-1,this.onDecohereInputKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){var o=this._outputs[n];Dr.is(o)?o.decohereOutputKey(t,e):o.decohereOutput()}var s=this._outlets.get(t);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this._outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){if(this._version<0){var r=this._outputEffects,i=r.get(t);void 0!==i&&(this.willRecohereOutputKey(t,i,e),this._outputEffects=r.removed(t),null!==this._input&&this._input.recohereInputKey(t,e),this.onRecohereOutputKey(t,i,e),this.didRecohereOutputKey(t,i,e))}},t.prototype.recohereInputKey=function(t,e){if(this._version<0){var r=this._inputEffects,i=r.get(t);if(void 0!==i){var n=this.willRecohereInputKey(t,i,e);i!==n&&this.decohereInputKey(t,n),this._inputEffects=r.removed(t),this.onRecohereInputKey(t,n,e);for(var o=0,s=null!==this._outputs?this._outputs.length:0;o<s;o+=1){var u=this._outputs[o];Dr.is(u)&&u.recohereOutputKey(t,e)}var a=this._outlets.get(t);void 0!==a&&a.recohereInput(e),this.didRecohereInputKey(t,n,e)}}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._outputEffects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this._inputEffects.forEach((function(e){this.recohereInputKey(e,t)}),this),this._version=t,this.onRecohere(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohere(t)}},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohereInputKey=function(t,e){},t.prototype.onDecohereInputKey=function(t,e){},t.prototype.didDecohereInputKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohereInputKey=function(t,e,r){return e},t.prototype.onRecohereInputKey=function(t,e,r){},t.prototype.didRecohereInputKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t.prototype.memoize=function(){var t=new Mr.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var e=new Mr.FilterFieldsCombinator(t);return e.bindInput(this),e},t.prototype.map=function(t){var e;return 1===t.length?((e=new Pr.MapValueCombinator(t)).bindInput(this),e):((e=new Mr.MapFieldValuesCombinator(t)).bindInput(this),e)},t.prototype.reduce=function(t,e,r){var i=new Mr.ReduceFieldsCombinator(t,e,r);return i.bindInput(this),i},t.prototype.watch=function(t){return 1===t.length?(new Pr.WatchValueCombinator(t).bindInput(this),this):(new Mr.WatchFieldsCombinator(t).bindInput(this),this)},t}(),Br=function(t){function e(e){var r=t.call(this)||this;return r._outlet=e,r}return _(e,t),e.prototype.outlet=function(){return this._outlet},e.prototype.onDecohereOutput=function(){this._outlet.decohereInput()},e.prototype.onRecohereOutput=function(t){this._outlet.recohereInput(t)},e}(Ir),Kr=function(t){function e(e){var r=t.call(this)||this;return r._outlet=e,r}return _(e,t),e.prototype.outlet=function(){return this._outlet},e.prototype.onDecohereOutputKey=function(t,e){this._outlet.decohereInput()},e.prototype.onDecohereOutput=function(){this._outlet.decohereInput()},e.prototype.onRecohereOutputKey=function(t,e,r){this._outlet.recohereInput(r)},e.prototype.onRecohereOutput=function(t){this._outlet.recohereInput(t)},e}(Nr),Hr=function(t){function e(e){var r=t.call(this)||this;return r._state=e,r}return _(e,t),e.prototype.get=function(){return this._state},e.prototype.set=function(t){var e=this._state;return this._state=t,this.decohereInput(),e},e}(Fr),Gr=function(t){function e(e){var r=t.call(this)||this;return r._state=e,r}return _(e,t),e.prototype.get=function(){return this._state},e.prototype.onRecohereOutput=function(t){null!==this._input&&(this._state=this._input.get())},e}(Ir),Xr=function(t){function e(e){void 0===e&&(e=new jt);var r=t.call(this)||this;return r._state=e,e.forEach((function(t){this._effects=this._effects.updated(t,0)}),r),r}return _(e,t),e.prototype.has=function(t){return this._state.has(t)},e.prototype.get=function(t){return void 0===t?this._state:this._state.get(t)},e.prototype.set=function(t,e){var r=this._state.get(t);return this._state=this._state.updated(t,e),this.decohereInputKey(t,0),r},e.prototype.delete=function(t){var e=this._state,r=e.removed(t);return e!==r&&(this._state=r,this.decohereInputKey(t,1)),this},e.prototype.keyIterator=function(){return this._state.keys()},e}(zr),Yr=function(t){function e(){var e=t.call(this)||this;return e._state=new jt,e}return _(e,t),e.prototype.get=function(){return this._state},e.prototype.onRecohereOutputKey=function(t,e,r){if(0===e){if(null!==this._input){var i=this._input.get(t);this._state=void 0!==i?this._state.updated(t,i):this._state.removed(t)}}else 1===e&&(this._state=this._state.removed(t))},e}(Nr),Zr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.get=function(){return this._state},e.prototype.onRecohere=function(t){null!==this._input&&(this._state=this._input.get())},e.prototype.memoize=function(){return this},e}(Lr);Pr.MemoizeValueCombinator=Zr;var Qr=function(t){function e(){var e=t.call(this)||this;return e._cache=new jt,e}return _(e,t),e.prototype.has=function(t){return this._cache.has(t)},e.prototype.get=function(t){return void 0===t?(void 0===this._state&&null!=this._input&&(this._state=this._input.get()),this._state):this._cache.get(t)},e.prototype.keyIterator=function(){return this._cache.keys()},e.prototype.onRecohereKey=function(t,e,r){if(0===e){if(null!==this._input){var i=this._input.get(t);this._cache=void 0!==i?this._cache.updated(t,i):this._cache.removed(t)}}else 1===e&&(this._cache=this._cache.removed(t))},e.prototype.onRecohere=function(t){this._state=void 0},e.prototype.memoize=function(){return this},e}(jr);Mr.MemoizeMapCombinator=Qr;var $r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.has=function(t){if(null!==this._input){var e=this._input.get(t);return void 0!==e&&this.evaluate(t,e)}return!1},e.prototype.get=function(t){if(void 0===t){for(var e=new jt,r=this.keyIterator();;){var i=r.next();if(i.done)break;var n=i.value;void 0!==(o=this._input.get(n))&&this.evaluate(n,o)&&e.set(n,o)}return e}var o;if(null!==this._input&&void 0!==(o=this._input.get(t))&&this.evaluate(t,o))return o},e.prototype.keyIterator=function(){return null!==this._input?this._input.keyIterator():y.empty()},e.prototype.onDecohereOutputKey=function(t,e){this.decohereInputKey(t,e)},e.prototype.onRecohereOutputKey=function(t,e,r){this.recohereInputKey(t,r)},e.prototype.willRecohereInputKey=function(t,e,r){if(0===e&&null!==this._input){var i=this._input.get(t);if(void 0===i||!this.evaluate(t,i))return 1}return e},e}(qr),Jr=function(t){function e(e){var r=t.call(this)||this;return r._func=e,r}return _(e,t),e.prototype.evaluate=function(t,e){return this._func(t,e)},e}($r);Mr.FilterFieldsCombinator=Jr;var ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.get=function(){return null!==this._input?this.evaluate(this._input.get()):void 0},e}(Lr),ei=function(t){function e(e){var r=t.call(this)||this;return r._func=e,r}return _(e,t),e.prototype.evaluate=function(t){return void 0!==t?this._func(t):void 0},e}(ti);Pr.MapValueCombinator=ei;var ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.has=function(t){return null!==this._input&&this._input.has(t)},e.prototype.get=function(t){if(void 0===t){for(var e=new jt,r=this.keyIterator();;){var i=r.next();if(i.done)break;var n=i.value,o=this.evaluate(n,this._input.get(n));void 0!==o&&e.set(n,o)}return e}return null!==this._input?this.evaluate(t,this._input.get(t)):void 0},e.prototype.keyIterator=function(){return null!==this._input?this._input.keyIterator():y.empty()},e}(jr),ii=function(t){function e(e){var r=t.call(this)||this;return r._func=e,r}return _(e,t),e.prototype.evaluate=function(t,e){return void 0!==e?this._func(t,e):void 0},e}(ri);Mr.MapFieldValuesCombinator=ii;var ni=function(t){function e(){var e=t.call(this)||this;return e._state=new jt,e}return _(e,t),e.prototype.get=function(){return this._state.reduced(this.identity(),this.accumulate.bind(this),this.combine.bind(this))},e.prototype.onRecohereOutputKey=function(t,e,r){if(0===e){if(null!==this._input){var i=this._input.get(t);void 0!==i?this._state.set(t,i):this._state.delete(t)}}else 1===e&&this._state.delete(t)},e}(Wr),oi=function(t){function e(e,r,i){var n=t.call(this)||this;return n._identity=e,n._accumulator=r,n._combiner=i,n}return _(e,t),e.prototype.get=function(){return this._state.reduced(this._identity,this._accumulator,this._combiner)},e.prototype.identity=function(){return this._identity},e.prototype.accumulate=function(t,e){return this._accumulator(t,e)},e.prototype.combine=function(t,e){return this._combiner(t,e)},e}(ni);Mr.ReduceFieldsCombinator=oi;var si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.onRecohereOutput=function(t){null!==this._input&&this.evaluate(this._input.get())},e}(Ir),ui=function(t){function e(e){var r=t.call(this)||this;return r._func=e,r}return _(e,t),e.prototype.evaluate=function(t){if(void 0!==t)return this._func(t)},e}(si);Pr.WatchValueCombinator=ui;var ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.onRecohereOutputKey=function(t,e,r){0===e?null!==this._input?this.evaluate(t,this._input.get(t)):this.evaluate(t,void 0):1===e&&this.evaluate(t,void 0)},e}(Nr),hi=function(t){function e(e){var r=t.call(this)||this;return r._func=e,r}return _(e,t),e.prototype.evaluate=function(t,e){if(void 0!==e)return this._func(t,e)},e}(ai);Mr.WatchFieldsCombinator=hi;var pi=function(t){function e(e){var r=t.call(this)||this;return r._streamlet=e,r}return _(e,t),e.prototype.streamlet=function(){return this._streamlet},e.prototype.willDecohereOutput=function(){var t=this._streamlet;t.willDecohereInlet&&t.willDecohereInlet(this)},e.prototype.didDecohereOutput=function(){var t=this._streamlet;t.didDecohereInlet?t.didDecohereInlet(this):t.decohere()},e.prototype.willRecohereOutput=function(t){var e=this._streamlet;e.willRecohereInlet&&e.willRecohereInlet(this,t)},e.prototype.didRecohereOutput=function(t){var e=this._streamlet;e.didRecohereInlet?e.didRecohereInlet(this,t):e.recohere(t)},e}(Ir),li=function(t){function e(e){var r=t.call(this)||this;return r._streamlet=e,r}return _(e,t),e.prototype.streamlet=function(){return this._streamlet},e.prototype.get=function(){var t=this._streamlet;if(t.getOutput)return t.getOutput(this)},e.prototype.willDecohereInput=function(){var t=this._streamlet;t.willDecohereOutlet&&t.willDecohereOutlet(this)},e.prototype.didDecohereInput=function(){var t=this._streamlet;t.didDecohereOutlet?t.didDecohereOutlet(this):t.decohere()},e.prototype.willRecohereInput=function(t){var e=this._streamlet;e.willRecohereOutlet&&e.willRecohereOutlet(this,t)},e.prototype.didRecohereInput=function(t){var e=this._streamlet;e.didRecohereOutlet&&e.didRecohereOutlet(this,t)},e}(Fr),ci=function(t){function e(e){var r=t.call(this)||this;return r._streamlet=e,r}return _(e,t),e.prototype.streamlet=function(){return this._streamlet},e.prototype.get=function(){var t=this._streamlet;if(t.getOutput){var e=t.getOutput(this);if(void 0!==e)return e}if(null!==this._input)return this._input.get()},e.prototype.willDecohere=function(){var t=this._streamlet;t.willDecohereOutlet&&t.willDecohereOutlet(this)},e.prototype.didDecohere=function(){var t=this._streamlet;t.didDecohereOutlet?t.didDecohereOutlet(this):t.decohere()},e.prototype.willRecohere=function(t){var e=this._streamlet;e.willRecohereOutlet&&e.willRecohereOutlet(this,t)},e.prototype.didRecohere=function(t){var e=this._streamlet;e.didRecohereOutlet&&e.didRecohereOutlet(this,t)},e}(Lr),fi=function(t,e,r){this.key=t,this.name=e,this.type=r},di=function(t,e,r){this.key=t,this.name=e,this.type=r},yi=function(t,e,r){this.key=t,this.name=e,this.type=r},vi=function(){function t(t){void 0===t&&(t=null),this.scope=t,this._version=-1}return t.prototype.streamletClass=function(){return this.__proto__},t.prototype.streamletScope=function(){return this.scope},t.prototype.setStreamletScope=function(t){this.scope=t},t.prototype.streamletContext=function(){if(this.context)return this.context;var t=this.streamletScope();return null!==t?t.streamletContext():null},t.prototype.setStreamletContext=function(t){this.context=t},t.prototype.inlet=function(e){return void 0===e?new pi(this):t.reflectInletKey(e,this,this.streamletClass())},t.prototype.bindInput=function(t,e){var r=this.inlet(t);if(null===r)throw new Error(""+t);r.bindInput(e)},t.prototype.unbindInput=function(t){var e=this.inlet(t);if(null===e)throw new Error(""+t);e.unbindInput()},t.prototype.outlet=function(e){return void 0===e?new li(this):"string"==typeof e?t.reflectOutletKey(e,this,this.streamletClass()):e},t.prototype.inoutlet=function(){return new ci(this)},t.prototype.decohere=function(){this._version>=0&&(this.willDecohere(),this._version=-1,this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},t.prototype.recohere=function(t){this._version<0&&(this.willRecohere(t),this._version=t,this.onRecohereInlets(t),this.onRecohere(t),this.onRecohereOutlets(t),this.didRecohere(t))},t.prototype.getInput=function(t,e){var r;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var i=t.input();null!==i&&(r=i.get())}return void 0===r&&(r=e),r},t.prototype.getOutput=function(t){},t.prototype.disconnectInputs=function(){t.disconnectInputs(this,this.streamletClass())},t.disconnectInputs=function(e,r){for(;r;){if(r.hasOwnProperty("_inlets"))for(var i in r._inlets){var n=r._inlets[i];if(n instanceof fi)t.reflectInletField(e,n).disconnectInputs();else if(n instanceof yi){t.reflectInoutletField(e,n).disconnectInputs()}}r=r.__proto__}},t.prototype.disconnectOutputs=function(){t.disconnectOutputs(this,this.streamletClass())},t.disconnectOutputs=function(e,r){for(;r;){if(r.hasOwnProperty("_outlets"))for(var i in r._outlets){var n=r._outlets[i];if(n instanceof di)t.reflectOutletField(e,n).disconnectOutputs();else if(n instanceof yi){t.reflectInoutletField(e,n).disconnectOutputs()}}r=r.__proto__}},t.prototype.willDecohereInlet=function(t){},t.prototype.didDecohereInlet=function(t){this.decohere()},t.prototype.willRecohereInlet=function(t,e){},t.prototype.didRecohereInlet=function(t,e){this.recohere(e)},t.prototype.willDecohereOutlet=function(t){},t.prototype.didDecohereOutlet=function(t){},t.prototype.willRecohereOutlet=function(t,e){},t.prototype.didRecohereOutlet=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.onDecohereOutlets=function(){t.decohereOutlets(this,this.streamletClass())},t.decohereOutlets=function(e,r){for(;r;){if(r.hasOwnProperty("_outlets"))for(var i in r._outlets){var n=r._outlets[i];if(n instanceof di)t.reflectOutletField(e,n).decohereInput();else if(n instanceof yi){t.reflectInoutletField(e,n).decohereInput()}}r=r.__proto__}},t.prototype.didDecohere=function(){},t.prototype.willRecohere=function(t){},t.prototype.onRecohereInlets=function(e){t.recohereInlets(e,this,this.streamletClass())},t.recohereInlets=function(e,r,i){for(;i;){if(i.hasOwnProperty("_inlets"))for(var n in i._inlets){var o=i._inlets[n];if(o instanceof fi)t.reflectInletField(r,o).recohereOutput(e);else if(o instanceof yi){t.reflectInoutletField(r,o).recohereOutput(e)}}i=i.__proto__}},t.prototype.onRecohere=function(t){},t.prototype.onRecohereOutlets=function(e){t.recohereOutlets(e,this,this.streamletClass())},t.recohereOutlets=function(e,r,i){for(;i;){if(i.hasOwnProperty("_outlets"))for(var n in i._outlets){var o=i._outlets[n];if(o instanceof di)t.reflectOutletField(r,o).recohereInput(e);else if(o instanceof yi){t.reflectInoutletField(r,o).recohereInput(e)}}i=i.__proto__}},t.prototype.didRecohere=function(t){},t.reflectEachInlet=function(e,r,i,n){for(var o=0;r;){if(r.hasOwnProperty("_inlets"))for(var s in r._inlets){var u=r._inlets[s],a=void 0;a=u instanceof fi?t.reflectInletField(e,u):u instanceof yi?t.reflectInoutletField(e,u):null;var h=i.call(n,a,u.name,o);if(void 0!==h)return h;o+=1}r=r.__proto__}},t.reflectEachOutlet=function(e,r,i,n){for(var o=0;r;){if(r.hasOwnProperty("_outlets"))for(var s in r._outlets){var u=r._outlets[s],a=void 0;a=u instanceof di?t.reflectOutletField(e,u):u instanceof yi?t.reflectInoutletField(e,u):null;var h=i.call(n,a,u.name,o);if(void 0!==h)return h;o+=1}r=r.__proto__}},t.reflectInletCount=function(t){for(var e=0;t;){if(t.hasOwnProperty("_inlets"))for(var r in t._inlets)e+=1;t=t.__proto__}return e},t.reflectOutletCount=function(t){for(var e=0;t;){if(t.hasOwnProperty("_outlets"))for(var r in t._outlets)e+=1;t=t.__proto__}return e},t.reflectInletIndex=function(e,r,i){for(;i;){if(i.hasOwnProperty("_inlets"))for(var n in i._inlets){if(0===e){var o=i._inlets[n];return o instanceof fi?[o.name,t.reflectInletField(r,o)]:o instanceof yi?[o.name,t.reflectInoutletField(r,o)]:null}e-=1}i=i.__proto__}return null},t.reflectOutletIndex=function(e,r,i){for(;i;){if(i.hasOwnProperty("_outlets"))for(var n in i._outlets){if(0===e){var o=i._outlets[n];return o instanceof di?[o.name,t.reflectOutletField(r,o)]:o instanceof yi?[o.name,t.reflectInoutletField(r,o)]:null}e-=1}i=i.__proto__}return null},t.reflectInletKey=function(e,r,i){for(;i;){if(i.hasOwnProperty("_inlets")){var n=i._inlets[e];if(void 0!==n)return n instanceof fi?t.reflectInletField(r,n):n instanceof yi?t.reflectInoutletField(r,n):null}i=i.__proto__}return null},t.reflectOutletKey=function(e,r,i){for(;i;){if(i.hasOwnProperty("_outlets")){var n=i._outlets[e];if(void 0!==n)return n instanceof di?t.reflectOutletField(r,n):n instanceof yi?t.reflectInoutletField(r,n):null}i=i.__proto__}return null},t.reflectInletField=function(e,r){if("value"===r.type)return t.reflectValueInletField(e,r.key);if("map"===r.type)return t.reflectMapInletField(e,r.key);throw new TypeError(r.type)},t.reflectValueInletField=function(e,r){var i=e[r];return i||(i=e instanceof t?e.inlet():new pi(e),e[r]=i),i},t.reflectMapInletField=function(t,e){return null},t.reflectOutletField=function(e,r){if("value"===r.type)return t.reflectValueOutletField(e,r.key);if("map"===r.type)return t.reflectMapOutletField(e,r.key);throw new TypeError(r.type)},t.reflectValueOutletField=function(e,r){var i=e[r];return i||(i=e instanceof t?e.outlet():new li(e),e[r]=i),i},t.reflectMapOutletField=function(t,e){return null},t.reflectInoutletField=function(e,r){if("value"===r.type)return t.reflectValueInoutletField(e,r.key);if("map"===r.type)return t.reflectMapInoutletField(e,r.key);throw new TypeError(r.type)},t.reflectValueInoutletField=function(e,r){var i=e[r];return i||(i=e instanceof t?e.inoutlet():new ci(e),e[r]=i),i},t.reflectMapInoutletField=function(t,e){return null},t.init=function(t){t.hasOwnProperty("_inlets")||(t._inlets={}),t.hasOwnProperty("_outlets")||(t._outlets={}),t.hasOwnProperty("_inoutlets")||(t._inoutlets={})},t.decorateInlet=function(e,r,i){t.init(r);var n=void 0!==e.name?e.name:i,o=void 0!==e.type?e.type:"value",s=new fi(i,n,o);r._inlets[n]=s},t.decorateOutlet=function(e,r,i){t.init(r);var n=void 0!==e.name?e.name:i,o=void 0!==e.type?e.type:"value",s=new di(i,n,o);r._outlets[n]=s},t.decorateInoutlet=function(e,r,i){t.init(r);var n=void 0!==e.name?e.name:i,o=void 0!==e.type?e.type:"value",s=new yi(i,n,o);r._inlets[n]=s,r._outlets[n]=s,r._inoutlets[n]=s},t}();function _i(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),vi.decorateOutlet.bind(void 0,t);vi.decorateOutlet({},t,e)}function mi(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),vi.decorateInoutlet.bind(void 0,t);vi.decorateInoutlet({},t,e)}var wi={is:function(t){if("object"==typeof t&&t){var e=t;return Mr.is(e)&&Rr.is(e)}return!1},Streamlet:void 0,Model:void 0,Scope:void 0,Dataflow:void 0},gi=function(t){function e(){var e=t.call(this)||this;return e._effects=new jt,e._outlets=new jt,e._outputs=null,e._version=-1,e}return _(e,t),e.prototype.streamletScope=function(){return null},e.prototype.streamletContext=function(){var t=this.streamletScope();return null!==t?t.streamletContext():null},e.prototype.hasOwn=function(t){return this.has(t)},e.prototype.get=function(e){return void 0===e?this:t.prototype.get.call(this,e)},e.prototype.outlet=function(t){if("string"==typeof t&&(t=de.from(t)),!this.hasOwn(t)){var e=this.streamletScope();if(wi.is(e)&&e.has(t))return e.outlet(t)}var r=this._outlets.get(t);return void 0===r&&(r=new Ur(this,t),this._outlets=this._outlets.updated(t,r),this.decohereInputKey(t,0)),r},e.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},e.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},e.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},e.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1)e[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.disconnectOutputs()}),this));var r=this._outputs;if(null!==r){this._outputs=null;for(var i=0,n=r.length;i<n;i+=1){var o=r[i];o.unbindInput(),o.disconnectOutputs()}}this.forEach((function(t){t instanceof Jt&&(t=t.toValue()),(t instanceof e||t instanceof wi.Streamlet||wi.is(t))&&t.disconnectOutputs()}),this)},e.prototype.disconnectInputs=function(){},e.prototype.decohereInputKey=function(t,e){var r=this._effects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereInputKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){var o=this._outputs[n];Dr.is(o)?o.decohereOutputKey(t,e):o.decohereOutput()}var s=this._outlets.get(t);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(t,e)}},e.prototype.decohereInput=function(){if(this._version>=0){this.willDecohereInput(),this._version=-1,this.onDecohereInput();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this._outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohereInput()}},e.prototype.recohereInputKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);if(void 0!==i){this.willRecohereInputKey(t,i,e),this._effects=r.removed(t),this.onRecohereInputKey(t,i,e);for(var n=0,o=null!==this._outputs?this._outputs.length:0;n<o;n+=1){var s=this._outputs[n];Dr.is(s)&&s.recohereOutputKey(t,e)}var u=this._outlets.get(t);void 0!==u&&u.recohereInput(e),this.didRecohereInputKey(t,i,e)}}},e.prototype.recohereInput=function(t){if(this._version<0){this.willRecohereInput(t),this._effects.forEach((function(e){this.recohereInputKey(e,t)}),this),this._version=t,this.onRecohereInput(t);for(var r=0,i=null!==this._outputs?this._outputs.length:0;r<i;r+=1)this._outputs[r].recohereOutput(t);this.forEach((function(r){r instanceof Jt&&(r=r.toValue()),r instanceof e?r.recohereInput(t):r instanceof wi.Streamlet?r.recohere(t):wi.is(r)&&r.recohereInput(t)}),this),this.didRecohereInput(t)}},e.prototype.willDecohereInputKey=function(t,e){},e.prototype.onDecohereInputKey=function(t,e){},e.prototype.didDecohereInputKey=function(t,e){},e.prototype.willDecohereInput=function(){},e.prototype.onDecohereInput=function(){},e.prototype.didDecohereInput=function(){},e.prototype.willRecohereInputKey=function(t,e,r){},e.prototype.onRecohereInputKey=function(t,e,r){},e.prototype.didRecohereInputKey=function(t,e,r){},e.prototype.willRecohereInput=function(t){},e.prototype.onRecohereInput=function(t){},e.prototype.didRecohereInput=function(t){},e.prototype.memoize=function(){var t=new Qr;return t.bindInput(this),t},e.prototype.filter=function(e){if("function"!=typeof e)return t.prototype.filter.call(this,e);var r=new Jr(e);return r.bindInput(this),r},e.prototype.map=function(t){var e;return 1===t.length?((e=new ei(t)).bindInput(this),e):((e=new ii(t)).bindInput(this),e)},e.prototype.reduce=function(t,e,r){var i=new oi(t,e,r);return i.bindInput(this),i},e.prototype.watch=function(t){return 1===t.length?(new ui(t).bindInput(this),this):(new hi(t).bindInput(this),this)},e}(ae),bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isConstant=function(){return!1},e.prototype.streamletClass=function(){return this.__proto__},e.prototype.compile=function(){vi.reflectEachInlet(this,this.streamletClass(),(function(t,e){null===t.input()&&this.compileInlet(t,e)}),this)},e.prototype.compileInlet=function(t,e){var r=this.streamletScope();if(null!==r){var i=r.outlet(e);null!==i&&t.bindInput(i)}},e}(ae);wi.Streamlet=bi;var xi=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.scope=e,r.context=null,r._version=-1,r}return _(e,t),e.prototype.streamletScope=function(){return this.scope},e.prototype.setStreamletScope=function(t){this.scope=t},e.prototype.streamletContext=function(){if(this.context)return this.context;var t=this.streamletScope();return null!==t?t.streamletContext():null},e.prototype.setStreamletContext=function(t){this.context=t},e.prototype.isEmpty=function(){return 0!==this.length},Object.defineProperty(e.prototype,"length",{get:function(){return vi.reflectOutletCount(this.streamletClass())},enumerable:!0,configurable:!0}),e.prototype.has=function(t){if(t instanceof de)t=t.value;else if("string"!=typeof t)return!1;return null!==this.outlet(t)},e.prototype.get=function(t){if(t instanceof de)t=t.value;else if("string"!=typeof t)return se.absent();var e=this.outlet(t);if(null!==e){var r=e.get();if(void 0!==r)return r}return se.absent()},e.prototype.getAttr=function(t){return se.absent()},e.prototype.getSlot=function(t){return this.get(t)},e.prototype.getField=function(t){if("string"==typeof t)t=de.from(t);else if(!(t instanceof de))return;var e=this.get(t);if(e.isDefined())return ne.of(t,e)},e.prototype.getItem=function(t){t instanceof ye&&(t=t.value);var e=vi.reflectOutletIndex(t,this,this.streamletClass());if(null!==e){var r=e[0],i=e[1].get();return void 0===i&&(i=se.extant()),ne.of(r,i)}return $t.absent()},e.prototype.set=function(t,e){throw new Error("unsupported")},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){throw new Error("unsupported")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];throw new Error("unsupported")},e.prototype.delete=function(t){throw new Error("unsupported")},e.prototype.clear=function(){throw new Error("unsupported")},e.prototype.forEach=function(t,e){return vi.reflectEachOutlet(this,this.streamletClass(),(function(r,i,n){var o=r.get();if(void 0!==o){var s=t.call(e,o,n);if(void 0!==s)return s}}),this)},e.prototype.inlet=function(t){return void 0===t?new pi(this):vi.reflectInletKey(t,this,this.streamletClass())},e.prototype.bindInput=function(t,e){var r=this.inlet(t);if(null===r)throw new Error(""+t);r.bindInput(e)},e.prototype.unbindInput=function(t){var e=this.inlet(t);if(null===e)throw new Error(""+t);e.unbindInput()},e.prototype.outlet=function(t){return void 0===t?new li(this):"string"==typeof t?vi.reflectOutletKey(t,this,this.streamletClass()):t},e.prototype.inoutlet=function(){return new ci(this)},e.prototype.decohere=function(){this._version>=0&&(this.willDecohere(),this._version=-1,this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},e.prototype.recohere=function(t){this._version<0&&(this.willRecohere(t),this._version=t,this.onRecohereInlets(t),this.onRecohere(t),this.onRecohereOutlets(t),this.didRecohere(t))},e.prototype.getInput=function(t,e){var r;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var i=t.input();null!==i&&(r=i.get())}return void 0===r&&(r=e),r},e.prototype.castInput=function(t,e,r){var i,n=this.getInput(t);return void 0!==n&&(i=e.cast(n)),void 0===i&&(i=r),i},e.prototype.coerceInput=function(t,e,r){var i,n=this.getInput(t);return void 0!==n&&(i=e.cast(n)),void 0===i&&(i=e.unit()),void 0===i&&(i=r),i},e.prototype.getOutput=function(t){},e.prototype.disconnectInputs=function(){vi.disconnectInputs(this,this.streamletClass())},e.prototype.disconnectOutputs=function(){vi.disconnectOutputs(this,this.streamletClass())},e.prototype.willDecohereInlet=function(t){},e.prototype.didDecohereInlet=function(t){this.decohere()},e.prototype.willRecohereInlet=function(t,e){},e.prototype.didRecohereInlet=function(t,e){this.recohere(e)},e.prototype.willDecohereOutlet=function(t){},e.prototype.didDecohereOutlet=function(t){},e.prototype.willRecohereOutlet=function(t,e){},e.prototype.didRecohereOutlet=function(t,e){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.onDecohereOutlets=function(){vi.decohereOutlets(this,this.streamletClass())},e.prototype.willRecohere=function(t){},e.prototype.onRecohereInlets=function(t){vi.recohereInlets(t,this,this.streamletClass())},e.prototype.onRecohere=function(t){},e.prototype.onRecohereOutlets=function(t){vi.recohereOutlets(t,this,this.streamletClass())},e.prototype.didRecohere=function(t){},e}(bi),Ci=function(t){function e(e,r){var i=t.call(this)||this;return i._record=e,i._key=r,i}return _(e,t),e.prototype.onDecohereOutput=function(){wi.is(this._record)&&this._record.decohereInputKey(this._key,0)},e.prototype.onRecohereOutput=function(t){if(null!==this._input){var e=this._input.get();void 0!==e?this._record.set(this._key,e):this._record.delete(this._key)}},e}(Ir),Si=function(){function t(){}return t.system=function(){return null},t}(),Ai=function(t){function e(e){void 0===e&&(e=ae.create());var r=t.call(this)||this;return r._state=e,r._fieldUpdaters=new jt,r}return _(e,t),e.prototype.isEmpty=function(){return this._state.isEmpty()},e.prototype.isArray=function(){return this._state.isArray()},e.prototype.isObject=function(){return this._state.isObject()},Object.defineProperty(e.prototype,"length",{get:function(){return this._state.length},enumerable:!0,configurable:!0}),e.prototype.fieldCount=function(){return this._state.fieldCount()},e.prototype.valueCount=function(){return this._state.valueCount()},e.prototype.has=function(t){if(this._state.has(t))return!0;var e=this.streamletScope();return e instanceof ae&&e.has(t)},e.prototype.hasOwn=function(t){return this._state.has(t)},e.prototype.indexOf=function(t,e){return this._state.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return void 0===e&&(e=0),this._state.lastIndexOf(t,e)},e.prototype.get=function(t){if(void 0===t)return this;t=se.fromAny(t);var e=this._state.get(t);if(!e.isDefined()){var r=this.streamletScope();r instanceof ae&&(e=r.get(t))}return e},e.prototype.getAttr=function(t){t=de.fromAny(t);var e=this._state.getAttr(t);if(!e.isDefined()){var r=this.streamletScope();r instanceof ae&&(e=r.getAttr(t))}return e},e.prototype.getSlot=function(t){t=se.fromAny(t);var e=this._state.getSlot(t);if(!e.isDefined()){var r=this.streamletScope();r instanceof ae&&(e=r.getSlot(t))}return e},e.prototype.getField=function(t){t=se.fromAny(t);var e=this._state.getField(t);if(void 0===e){var r=this.streamletScope();r instanceof ae&&(e=r.getField(t))}return e},e.prototype.getItem=function(t){return this._state.getItem(t)},e.prototype.bindValue=function(t,e){var r=new Ci(this,t),i=wi.Dataflow.compile(e,this);r.bindInput(i),this._fieldUpdaters=this._fieldUpdaters.updated(t,r)},e.prototype.set=function(t,e){if(t=se.fromAny(t),this._state.has(t))this._state.set(t,e);else{var r=this.streamletScope();r instanceof ae&&r.has(t)?r.set(t,e):this._state.set(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setAttr=function(t,e){if(t=de.fromAny(t),this._state.has(t))this._state.setAttr(t,e);else{var r=this.streamletScope();r instanceof ae&&r.has(t)?r.setAttr(t,e):this._state.setAttr(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setSlot=function(t,e){if(t=se.fromAny(t),this._state.has(t))this._state.setSlot(t,e);else{var r=this.streamletScope();r instanceof ae&&r.has(t)?r.setSlot(t,e):this._state.setSlot(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setItem=function(t,e){var r=this._state.getItem(t);return e=$t.fromAny(e),this._state.setItem(t,e),r instanceof Jt&&e instanceof Jt?r.key.equals(e.key)?this.decohereInputKey(r.key,0):(this.decohereInputKey(r.key,1),this.decohereInputKey(e.key,0)):r instanceof Jt?this.decohereInputKey(r.key,1):e instanceof Jt?this.decohereInputKey(e.key,0):this.decohereInput(),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._state.length,i=this._state.push.apply(this._state,arguments);r<i;){var n=this._state.get(r);n instanceof Jt&&this.decohereInputKey(n.key,0),r+=1}return i},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this._state.length;t<0&&(t=n+t),t=Math.max(0,t),e=Math.max(0,e);for(var o=this._state.splice.apply(this._state,arguments),s=0;s<o.length;s+=1){var u=o[s];u instanceof Jt&&this.decohereInputKey(u.key,1)}for(s=t;s<t+r.length;s+=1){var a=this._state.get(s);a instanceof Jt&&this.decohereInputKey(a.key,0)}return o},e.prototype.delete=function(t){var e=this._state.delete(t);return e instanceof Jt&&this.decohereInputKey(e.key,1),e},e.prototype.clear=function(){var t=this._state.branch();this._state.clear(),t.forEach((function(t){t instanceof Jt&&this.decohereInputKey(t.key,1)}),this)},e.prototype.forEach=function(t,e){return this._state.forEach(t,e)},e.prototype.keyIterator=function(){throw new Error},e.prototype.disconnectInputs=function(){var t=this._fieldUpdaters;t.isEmpty()||(this._fieldUpdaters=new jt,t.forEach((function(t,e){e.disconnectInputs()}),this))},e.prototype.memoize=function(){return this},e.prototype.materialize=function(t){t.forEach((function(t){this.materializeItem(t)}),this)},e.prototype.materializeItem=function(t){t instanceof Jt?this.materializeField(t):this.materializeValue(t)},e.prototype.materializeField=function(t){var e=t.value;if(e instanceof bi)e.setStreamletScope(this),this._state.push(t);else if(e instanceof ae){var r=new wi.Scope(this);r.materialize(e),this._state.push(t.updatedValue(r))}else this._state.push(t)},e.prototype.materializeValue=function(t){if(t instanceof bi)t.setStreamletScope(this),this._state.push(t);else if(t instanceof ae){var e=new wi.Scope(this);e.materialize(t),this._state.push(e)}else this._state.push(t)},e.prototype.compile=function(t){t.forEach((function(t,e){this.compileItem(t,e)}),this)},e.prototype.compileItem=function(t,e){t instanceof Jt?this.compileField(t,e):this.compileValue(t,e)},e.prototype.compileField=function(t,e){var r=t.key,i=t.value;r.isConstant()&&(i.isConstant()?this.decohereInputKey(r,0):i instanceof bi?(i.compile(),this.decohereInputKey(r,0)):i instanceof ae?(this._state.getItem(e).toValue().compile(i),this.decohereInputKey(r,0)):(t.setValue(se.extant()),this.bindValue(r,i)))},e.prototype.compileValue=function(t,e){t instanceof bi?t.compile():t instanceof ae?this._state.getItem(e).compile(t):t.isConstant()},e.prototype.reify=function(t){void 0===t&&(t=Si.system()),this.forEach((function(e,r){var i=this.reifyItem(e,t);e!==i&&this.setItem(r,i)}),this)},e.prototype.reifyItem=function(t,r){var i=this.streamletScope();return i instanceof e?i.reifyItem(t,r):t},e.from=function(t){var r=new e;return r.materialize(t),r.compile(t),r},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.from(ae.of.apply(void 0,arguments))},e.globalScope=function(){var t=new e;return t.materializeField(ne.of("math",ur.scope().branch())),t},e}(gi);wi.Model=Ai;var ki=function(t){function e(e,r){var i=t.call(this,r)||this;return i.scope=e,i}return _(e,t),e.prototype.streamletScope=function(){return this.scope},e.from=function(t){var r=new e(e.globalScope());return r.materialize(t),r.compile(t),r},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.from(ae.of.apply(void 0,arguments))},e}(Ai);wi.Scope=ki;var Ei=function(t){function e(){var e=t.call(this)||this;return e._keyInlet=new Br(e),e._mapInlet=new Kr(e),e}return _(e,t),e.prototype.keyInlet=function(){return this._keyInlet},e.prototype.mapInlet=function(){return this._mapInlet},e.prototype.get=function(){var t=this._keyInlet.input();if(null!==t){var e=t.get();if(void 0!==e){var r=this._mapInlet.input();if(null!==r){var i=r.get(e);if(void 0!==i)return i}}}return se.absent()},e}(Fr),Oi=function(t){function e(){var e=t.call(this)||this;return e._operand1Inlet=new Br(e),e._operand2Inlet=new Br(e),e}return _(e,t),e.prototype.operand1Inlet=function(){return this._operand1Inlet},e.prototype.operand2Inlet=function(){return this._operand2Inlet},e.prototype.get=function(){var t=this._operand1Inlet.input(),e=this._operand2Inlet.input();if(null!==t&&null!==e){var r=t.get(),i=e.get();if(void 0!==r&&void 0!==i)return this.evaluate(r,i).toValue()}return se.absent()},e}(Fr),Vi=function(t){function e(){var e=t.call(this)||this;return e._operandInlet=new Br(e),e}return _(e,t),e.prototype.operandInlet=function(){return this._operandInlet},e.prototype.get=function(){var t=this._operandInlet.input();if(null!==t){var e=t.get();if(void 0!==e)return this.evaluate(e).toValue()}return se.absent()},e}(Fr),Pi=function(t){function e(){var e=t.call(this)||this;return e._ifInlet=new Br(e),e._thenInlet=new Br(e),e._elseInlet=new Br(e),e}return _(e,t),e.prototype.ifInlet=function(){return this._ifInlet},e.prototype.thenInlet=function(){return this._thenInlet},e.prototype.elseInlet=function(){return this._elseInlet},e.prototype.get=function(){var t=this._ifInlet.input();if(null!==t){var e=t.get();if(void 0!==e)if(e.booleanValue(!1)){var r=this._thenInlet.input();if(null!==r){var i=r.get();if(void 0!==i)return i}}else{var n=this._elseInlet.input();if(null!==n){var o=n.get();if(void 0!==o)return o}}}return se.absent()},e}(Fr),Di=function(t){function e(){var e=t.call(this)||this;return e._operand1Inlet=new Br(e),e._operand2Inlet=new Br(e),e}return _(e,t),e.prototype.operand1Inlet=function(){return this._operand1Inlet},e.prototype.operand2Inlet=function(){return this._operand2Inlet},e.prototype.get=function(){var t=this._operand1Inlet.input(),e=null!==t?t.get():void 0;if(void 0!==e&&e.booleanValue(!1))return e;var r=this._operand2Inlet.input(),i=null!==r?r.get():void 0;return void 0!==i?i:se.absent()},e}(Fr),Mi=function(t){function e(){var e=t.call(this)||this;return e._operand1Inlet=new Br(e),e._operand2Inlet=new Br(e),e}return _(e,t),e.prototype.operand1Inlet=function(){return this._operand1Inlet},e.prototype.operand2Inlet=function(){return this._operand2Inlet},e.prototype.get=function(){var t=this._operand1Inlet.input(),e=null!==t?t.get():void 0;if(void 0!==e){if(e.booleanValue(!1)){var r=this._operand2Inlet.input(),i=null!==r?r.get():void 0;if(void 0!==i)return i}return e}return se.absent()},e}(Fr),Ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseOr(e)},e}(Oi),Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseXor(e)},e}(Oi),Ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseAnd(e)},e}(Oi),Fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.lt(e)},e}(Oi),Li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.le(e)},e}(Oi),Ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.eq(e)},e}(Oi),Ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.ne(e)},e}(Oi),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.ge(e)},e}(Oi),ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.gt(e)},e}(Oi),Wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.plus(e)},e}(Oi),qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.minus(e)},e}(Oi),Bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.times(e)},e}(Oi),Ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.divide(e)},e}(Oi),Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t,e){return t.modulo(e)},e}(Oi),Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t){return t.not()},e}(Vi),Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t){return t.bitwiseNot()},e}(Vi),Yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t){return t.negative()},e}(Vi),Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.evaluate=function(t){return t.positive()},e}(Vi),Qi=function(t){function e(e){var r=t.call(this)||this;return r._scope=e,r._funcInlet=new Br(r),r._argsInlet=new Br(r),r}return _(e,t),e.prototype.funcInlet=function(){return this._funcInlet},e.prototype.argsInlet=function(){return this._argsInlet},e.prototype.get=function(){var t=this._funcInlet.input(),e=this._argsInlet.input();if(null!==t&&null!==e){var r=t.get();if(r instanceof ge){var i=e.get();if(void 0!==i){var n=new re;return n.pushScope(this._scope),r.invoke(i,n,void 0).toValue()}}}return se.absent()},e}(Fr),$i=function(){function t(){}return t.compile=function(e,r){if(r instanceof Ur){var i=r.get();Pr.is(i)&&(r=i)}if(e.isConstant())return new Hr(e);if(e instanceof we)return t.compileSelector(e,r);if(e instanceof me)return t.compileOperator(e,r);throw new TypeError(""+e)},t.compileSelector=function(e,r){if(e instanceof Ye)return t.compileIdentitySelector(r);if(e instanceof Ze)return t.compileGetSelector(e,r);if(e instanceof Qe)return t.compileGetAttrSelector(e,r);if(e instanceof $e)return t.compileGetItemSelector(e,r);if(e instanceof Je)return t.compileKeysSelector(r);if(e instanceof tr)return t.compileValuesSelector(r);if(e instanceof er)return t.compileChildrenSelector(r);if(e instanceof rr)return t.compileDescendantsSelector(r);if(e instanceof ir)return t.compileFilterSelector(e,r);throw new TypeError(""+e)},t.compileIdentitySelector=function(t){return t},t.compileGetSelector=function(e,r){var i=e.accessor();if(!i.isConstant()){var n=new Ei;o=t.compile(i,r);return n.keyInlet().bindInput(o),n.mapInlet().bindInput(r),n}if(wi.is(r)){if(null!==(o=r.outlet(i)))return t.compile(e.then(),o)}else if(Rr.is(r)){var o,s=i.stringValue(void 0);if(void 0!==s)if(null!==(o=r.outlet(s)))return t.compile(e.then(),o)}return null},t.compileGetAttrSelector=function(t,e){throw new Error},t.compileGetItemSelector=function(t,e){throw new Error},t.compileKeysSelector=function(t){throw new Error},t.compileValuesSelector=function(t){throw new Error},t.compileChildrenSelector=function(t){throw new Error},t.compileDescendantsSelector=function(t){throw new Error},t.compileFilterSelector=function(t,e){throw new Error},t.compileOperator=function(e,r){if(e instanceof Ee)return t.compileConditionalOperator(e,r);if(e instanceof Ae)return t.compileBinaryOperator(e,r);if(e instanceof ke)return t.compileUnaryOperator(e,r);if(e instanceof Xe)return t.compileInvokeOperator(e,r);throw new TypeError(""+e)},t.compileConditionalOperator=function(e,r){var i=new Pi,n=e.ifTerm().toValue(),o=e.thenTerm().toValue(),s=e.elseTerm().toValue(),u=t.compile(n,r),a=t.compile(o,r),h=t.compile(s,r);return i.ifInlet().bindInput(u),i.thenInlet().bindInput(a),i.elseInlet().bindInput(h),i},t.compileBinaryOperator=function(e,r){if(e instanceof Oe)return t.compileOrOperator(e,r);if(e instanceof Ve)return t.compileAndOperator(e,r);if(e instanceof Pe)return t.compileBitwiseOrOperator(e,r);if(e instanceof De)return t.compileBitwiseXorOperator(e,r);if(e instanceof Me)return t.compileBitwiseAndOperator(e,r);if(e instanceof Te)return t.compileLtOperator(e,r);if(e instanceof Re)return t.compileLeOperator(e,r);if(e instanceof Ie)return t.compileEqOperator(e,r);if(e instanceof Fe)return t.compileNeOperator(e,r);if(e instanceof Le)return t.compileGeOperator(e,r);if(e instanceof Ue)return t.compileGtOperator(e,r);if(e instanceof Ne)return t.compilePlusOperator(e,r);if(e instanceof ze)return t.compileMinusOperator(e,r);if(e instanceof je)return t.compileTimesOperator(e,r);if(e instanceof We)return t.compileDivideOperator(e,r);if(e instanceof qe)return t.compileModuloOperator(e,r);throw new TypeError(""+e)},t.compileBinaryOutlet=function(e,r,i){var n=e.operand1().toValue(),o=e.operand2().toValue(),s=t.compile(n,i),u=t.compile(o,i);return r.operand1Inlet().bindInput(s),r.operand2Inlet().bindInput(u),r},t.compileOrOperator=function(e,r){var i=new Di,n=e.operand1().toValue(),o=e.operand2().toValue(),s=t.compile(n,r),u=t.compile(o,r);return i.operand1Inlet().bindInput(s),i.operand2Inlet().bindInput(u),i},t.compileAndOperator=function(e,r){var i=new Mi,n=e.operand1().toValue(),o=e.operand2().toValue(),s=t.compile(n,r),u=t.compile(o,r);return i.operand1Inlet().bindInput(s),i.operand2Inlet().bindInput(u),i},t.compileBitwiseOrOperator=function(e,r){return t.compileBinaryOutlet(e,new Ti,r)},t.compileBitwiseXorOperator=function(e,r){return t.compileBinaryOutlet(e,new Ri,r)},t.compileBitwiseAndOperator=function(e,r){return t.compileBinaryOutlet(e,new Ii,r)},t.compileLtOperator=function(e,r){return t.compileBinaryOutlet(e,new Fi,r)},t.compileLeOperator=function(e,r){return t.compileBinaryOutlet(e,new Li,r)},t.compileEqOperator=function(e,r){return t.compileBinaryOutlet(e,new Ui,r)},t.compileNeOperator=function(e,r){return t.compileBinaryOutlet(e,new Ni,r)},t.compileGeOperator=function(e,r){return t.compileBinaryOutlet(e,new zi,r)},t.compileGtOperator=function(e,r){return t.compileBinaryOutlet(e,new ji,r)},t.compilePlusOperator=function(e,r){return t.compileBinaryOutlet(e,new Wi,r)},t.compileMinusOperator=function(e,r){return t.compileBinaryOutlet(e,new qi,r)},t.compileTimesOperator=function(e,r){return t.compileBinaryOutlet(e,new Bi,r)},t.compileDivideOperator=function(e,r){return t.compileBinaryOutlet(e,new Ki,r)},t.compileModuloOperator=function(e,r){return t.compileBinaryOutlet(e,new Hi,r)},t.compileUnaryOperator=function(e,r){if(e instanceof Be)return t.compileNotOperator(e,r);if(e instanceof Ke)return t.compileBitwiseNotOperator(e,r);if(e instanceof He)return t.compileNegativeOperator(e,r);if(e instanceof Ge)return t.compilePositiveOperator(e,r);throw new TypeError(""+e)},t.compileUnaryOutlet=function(e,r,i){var n=e.operand().toValue(),o=t.compile(n,i);return r.operandInlet().bindInput(o),r},t.compileNotOperator=function(e,r){return t.compileUnaryOutlet(e,new Gi,r)},t.compileBitwiseNotOperator=function(e,r){return t.compileUnaryOutlet(e,new Xi,r)},t.compileNegativeOperator=function(e,r){return t.compileUnaryOutlet(e,new Yi,r)},t.compilePositiveOperator=function(e,r){return t.compileUnaryOutlet(e,new Zi,r)},t.compileInvokeOperator=function(e,r){var i=e.func(),n=e.args(),o=new Qi(r),s=t.compile(i,r),u=t.compile(n,r);return o.funcInlet().bindInput(s),o.argsInlet().bindInput(u),o},t}();wi.Dataflow=$i;var Ji=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._keyParser=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._keyParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;t:for(;;){if(1===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont())if(33===u||34===u||36===u||37===u||39===u||40===u||43===u||45===u||u>=48&&u<=57||64===u||91===u||123===u||126===u||to.isIdentStartChar(u))i=i||r.valueBuilder(),s=2;else{if(35!==u)return i?ft.done(i.bind()):ft.done(r.absent());t=t.step(),s=7}else if(t.isDone())return i?ft.done(i.bind()):ft.done(r.absent())}if(2===s){for(n||(n=r.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=3;else if(n.isError())return n}if(3===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont())58===u?(t=t.step(),s=4):(i.push(r.item(n.bind())),n=void 0,s=6);else if(t.isDone())return i.push(r.item(n.bind())),ft.done(i.bind())}if(4===s){for(;t.isCont()&&to.isSpace(t.head());)t=t.step();if(t.isCont())s=5;else if(t.isDone())return i.push(r.slot(n.bind())),ft.done(i.bind())}if(5===s){for(o||(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i.push(r.slot(n.bind(),o.bind())),n=void 0,o=void 0,s=6;else if(o.isError())return o}if(6===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(44===u||59===u||to.isNewline(u)){t=t.step(),s=1;continue}if(35!==u)return ft.done(i.bind());t=t.step(),s=7}else if(t.isDone())return ft.done(i.bind())}if(7===s){for(;t.isCont();){if(u=t.head(),to.isNewline(u)){s=1;continue t}t=t.step()}if(t.isDone()){s=1;continue}}break}return new e(r,i,n,o,s)},e}(ft),tn=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._recon=e,o._keyParser=r,o._valueParser=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._keyParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont()){if(64!==(s=t.head()))return ft.error(lt.expected(64,t));t=t.step(),o=2}else if(t.isDone())return ft.error(lt.expected(64,t));if(2===o){if(i)i=i.feed(t);else if(t.isCont())if(34===(s=t.head())||39===s)i=r.parseString(t);else{if(!to.isIdentStartChar(s))return ft.error(lt.expected("attribute name",t));i=r.parseIdent(t)}else if(t.isDone())return ft.error(lt.expected("attribute name",t));if(i)if(i.isDone())o=3;else if(i.isError())return i.asError()}if(3===o)if(t.isCont()&&40===t.head())t=t.step(),o=4;else if(!t.isEmpty())return ft.done(r.attr(i.bind()));if(4===o){for(;t.isCont()&&(s=t.head(),to.isWhitespace(s));)t=t.step();if(t.isCont()){if(41===s)return t=t.step(),ft.done(r.attr(i.bind()));o=5}else if(t.isDone())return ft.error(lt.expected(")",t))}if(5===o){for(n||(n=r.parseBlock(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())o=6;else if(n.isError())return n.asError()}if(6===o){for(;t.isCont()&&(s=t.head(),to.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),ft.done(r.attr(i.bind(),n.bind()))):ft.error(lt.expected(")",t));if(t.isDone())return ft.error(lt.expected(")",t))}return new e(r,i,n,o)},e}(ft),en=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._fieldParser=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._fieldParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s)if(t.isCont())if(64===(u=t.head()))n=r.parseAttr(t),s=2;else if(123===u)i=i||r.recordBuilder(),o=r.parseRecord(t,i),s=5;else if(91===u)i=i||r.recordBuilder(),o=r.parseMarkup(t,i),s=5;else if(to.isIdentStartChar(u))o=r.parseIdent(t),s=4;else if(34===u||39===u)o=r.parseString(t),s=4;else if(45===u||u>=48&&u<=57)o=r.parseNumber(t),s=4;else if(37===u)o=r.parseData(t),s=4;else{if(36!==u)return i?ft.done(i.bind()):ft.done(r.extant());o=r.parseSelector(t),s=4}else if(t.isDone())return i?ft.done(i.bind()):ft.done(r.extant());if(2===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())(i=i||r.valueBuilder()).push(n.bind()),n=void 0,s=3;else if(n.isError())return n.asError()}if(3===s){for(;t.isCont()&&to.isSpace(t.head());)t=t.step();if(t.isCont()){s=1;continue}if(t.isDone())return ft.done(i.bind())}if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())(i=i||r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o}if(5===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())o=void 0,s=6;else if(o.isError())return o}if(6===s){for(;t.isCont()&&to.isSpace(t.head());)t=t.step();if(t.isCont()){if(64!==t.head())return ft.done(i.bind());s=1}else if(t.isDone())return ft.done(i.bind())}break}return new e(r,i,n,o,s)},e}(ft),rn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._fieldParser=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._fieldParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont())if(64===(u=t.head()))n=r.parseAttr(t),s=2;else if(123===u)i?(o=r.parseRecord(t,i),s=5):(o=r.parseRecord(t),s=4);else{if(91!==u)return i?ft.done(i.bind()):ft.done(r.extant());i?(o=r.parseMarkup(t,i),s=5):(o=r.parseMarkup(t),s=4)}else if(t.isDone())return i?ft.done(i.bind()):ft.done(r.extant());if(2===s){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())(i=i||r.valueBuilder()).push(n.bind()),n=void 0,s=3;else if(n.isError())return n.asError()}if(3===s)if(t.isCont())if(123===(u=t.head()))o=r.parseRecord(t,i),s=5;else{if(91!==u)return ft.done(i.bind());o=r.parseMarkup(t,i),s=5}else if(t.isDone())return ft.done(i.bind());if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())return(i=i||r.valueBuilder()).push(r.item(o.bind())),ft.done(i.bind());if(o.isError())return o}if(5===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())return ft.done(i.bind());if(o.isError())return o}return new e(r,i,n,o,s)},e}(ft),nn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._keyParser=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._keyParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){if(123!==(u=t.head()))return ft.error(lt.expected(123,t));t=t.step(),s=2}else if(t.isDone())return ft.error(lt.expected(123,t));t:for(;;){if(2===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont()){if(i=i||r.recordBuilder(),125===u)return t=t.step(),ft.done(i.bind());35===u?(t=t.step(),s=8):s=3}else if(t.isDone())return ft.error(lt.expected(125,t))}if(3===s){for(n||(n=r.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=4;else if(n.isError())return n}if(4===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont())58===u?(t=t.step(),s=5):(i.push(r.item(n.bind())),n=void 0,s=7);else if(t.isDone())return ft.error(lt.expected(125,t))}if(5===s){for(;t.isCont()&&to.isSpace(t.head());)t=t.step();if(t.isCont())s=6;else if(t.isDone())return i.push(r.slot(n.bind())),ft.done(i.bind())}if(6===s){for(o||(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i.push(r.slot(n.bind(),o.bind())),n=void 0,o=void 0,s=7;else if(o.isError())return o}if(7===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(44===u||59===u||to.isNewline(u)){t=t.step(),s=2;continue}if(35!==u)return 125===u?(t=t.step(),ft.done(i.bind())):ft.error(lt.expected("'}', ';', ',', or newline",t));t=t.step(),s=8}else if(t.isDone())return ft.error(lt.expected(125,t))}if(8===s){for(;t.isCont();){if(u=t.head(),to.isNewline(u)){s=2;continue t}t=t.step()}if(t.isDone()){s=2;continue}}break}return new e(r,i,n,o,s)},e}(ft),on=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._textOutput=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._textOutput,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){if(91!==(u=t.head()))return ft.error(lt.expected(91,t));t=t.step(),s=2}else if(t.isDone())return ft.error(lt.expected(91,t));for(;;){if(2===s){for(;t.isCont()&&64!==(u=t.head())&&91!==u&&92!==u&&93!==u&&123!==u&&125!==u;)t=t.step(),(n=n||r.textOutput()).write(u);if(t.isCont()){if(93===u)return t=t.step(),i=i||r.recordBuilder(),n&&i.push(r.item(n.bind())),ft.done(i.bind());if(64===u)i=i||r.recordBuilder(),n&&(i.push(r.item(n.bind())),n=void 0),o=r.parseInlineItem(t),s=3;else if(123===u)i=i||r.recordBuilder(),n&&(i.push(r.item(n.bind())),n=void 0),o=r.parseRecord(t,i),s=4;else if(91===u)i=i||r.recordBuilder(),n&&(i.push(r.item(n.bind())),n=void 0),o=r.parseMarkup(t,i),s=4;else{if(92!==u)return ft.error(lt.unexpected(t));t=t.step(),s=5}}else if(t.isDone())return ft.error(lt.unexpected(t))}if(3===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){i.push(r.item(o.bind())),o=void 0,s=2;continue}if(o.isError())return o}if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){o=void 0,s=2;continue}if(o.isError())return o}if(5===s){if(t.isCont()){if(u=t.head(),n=n||r.textOutput(),34===u||36===u||39===u||47===u||64===u||91===u||92===u||93===u||123===u||125===u)t=t.step(),n.write(u),s=2;else if(98===u)t=t.step(),n.write(8),s=2;else if(102===u)t=t.step(),n.write(12),s=2;else if(110===u)t=t.step(),n.write(10),s=2;else if(114===u)t=t.step(),n.write(13),s=2;else{if(116!==u)return ft.error(lt.expected("escape character",t));t=t.step(),n.write(9),s=2}continue}if(t.isDone())return ft.error(lt.expected("escape character",t))}break}return new e(r,i,n,o,s)},e}(ft),sn=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._base64Parser=r,n._step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._base64Parser,this._step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);if(1===n)if(t.isCont()){if(37!==t.head())return ft.error(lt.expected(37,t));t=t.step(),n=2}else if(t.isDone())return ft.error(lt.expected(37,t));if(2===n){for(i||(i=Mt.standard().parse(t,r.dataOutput()));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return i;if(i.isError())return i}return new e(r,i,n)},e}(ft),un=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._output=r,n._step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._output,this._step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont()){if(o=t.head(),!to.isIdentStartChar(o))return ft.error(lt.expected("identifier",t));t=t.step(),i=(i=i||r.textOutput()).write(o),n=2}else if(t.isDone())return ft.error(lt.expected("identifier",t));if(2===n){for(;t.isCont()&&(o=t.head(),to.isIdentChar(o));)t=t.step(),i.write(o);if(!t.isEmpty())return ft.done(r.ident(i.bind()))}return new e(r,i,n)},e}(ft),an=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._output=r,s._quote=i,s._code=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._output,this._quote,this._code,this._step)},e.parse=function(t,r,i,n,o,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont()){if(34!==u&&(39!==u||n!==u&&0!==n))return ft.error(lt.expected("string",t));t=t.step(),i=i||r.textOutput(),n=u,s=2}else if(t.isDone())return ft.error(lt.expected("string",t))}t:for(;;){if(2===s){for(;t.isCont()&&(u=t.head())>=32&&u!==n&&92!==u;)t=t.step(),i.write(u);if(t.isCont()){if(u===n)return t=t.step(),ft.done(i.bind());if(92!==u)return ft.error(lt.expected(n,t));t=t.step(),s=3}else if(t.isDone())return ft.error(lt.expected(n,t))}if(3===s)if(t.isCont()){if(34===(u=t.head())||36===u||39===u||47===u||64===u||91===u||92===u||93===u||123===u||125===u){t=t.step(),i.write(u),s=2;continue}if(98===u){t=t.step(),i.write(8),s=2;continue}if(102===u){t=t.step(),i.write(12),s=2;continue}if(110===u){t=t.step(),i.write(10),s=2;continue}if(114===u){t=t.step(),i.write(13),s=2;continue}if(116===u){t=t.step(),i.write(9),s=2;continue}if(117!==u)return ft.error(lt.expected("escape character",t));t=t.step(),s=4}else if(t.isDone())return ft.error(lt.expected("escape character",t));if(s>=4)for(;;){if(t.isCont()){if(u=t.head(),xt.isDigit(u)){if(t=t.step(),o=16*o+xt.decodeDigit(u),s<=6){s+=1;continue}i.write(o),o=0,s=2;continue t}return ft.error(lt.expected("hex digit",t))}if(t.isDone())return ft.error(lt.expected("hex digit",t));break}break}return new e(r,i,n,o,s)},e}(ft),hn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._sign=r,s._value=i,s._mode=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._sign,this._value,this._mode,this._step)},e.parse=function(t,r,i,n,o,s){void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=2),void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont())45===u&&(t=t.step(),i=-1),s=2;else if(t.isDone())return ft.error(lt.expected("number",t))}if(2===s)if(t.isCont())if(48===(u=t.head()))t=t.step(),s=4;else{if(!(u>=49&&u<=57))return ft.error(lt.expected("digit",t));t=t.step(),n=i*(u-48),s=3}else if(t.isDone())return ft.error(lt.expected("digit",t));if(3===s){for(;t.isCont()&&(u=t.head())>=48&&u<=57;){var a=10*n+i*(u-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return ft.error(lt.message("integer overflow",t));n=a,t=t.step()}if(t.isCont())s=4;else if(t.isDone())return ft.done(r.num(n))}if(4===s){if(t.isCont()){if(u=t.head(),o>0&&46===u||o>1&&(69===u||101===u)){var h=$.stringOutput();return h=i<0&&0===n?h.write(45).write(48):h.write(""+n),pn.parse(t,r,h,o)}return 120===u&&i>0&&0===n?(t=t.step(),ln.parse(t,r)):ft.done(r.num(n))}if(t.isDone())return ft.done(r.num(n))}return new e(r,i,n,o,s)},e.parseInteger=function(t,r){return e.parse(t,r,void 0,void 0,0)},e.parseDecimal=function(t,r){return e.parse(t,r,void 0,void 0,1)},e}(ft),pn=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._recon=e,o._output=r,o._mode=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._output,this._mode,this._step)},e.parse=function(t,r,i,n,o){void 0===n&&(n=2),void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont())if(46===(s=t.head()))t=t.step(),i=i.write(s),o=2;else{if(!(n>1)||69!==s&&101!==s)return ft.error(lt.expected("decimal or exponent",t));t=t.step(),i=i.write(s),o=5}else if(t.isDone())return ft.error(lt.expected("decimal or exponent",t));if(2===o)if(t.isCont()){if(!((s=t.head())>=48&&s<=57))return ft.error(lt.expected("digit",t));t=t.step(),i=i.write(s),o=3}else if(t.isDone())return ft.error(lt.expected("digit",t));if(3===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;)t=t.step(),i=i.write(s);if(t.isCont()){if(!(n>1))return ft.done(r.num(i.bind()));o=4}else if(t.isDone())return ft.done(r.num(i.bind()))}if(4===o){if(69!==(s=t.head())&&101!==s)return ft.done(r.num(i.bind()));t=t.step(),i=i.write(s),o=5}if(5===o)if(t.isCont())43!==(s=t.head())&&45!==s||(t=t.step(),i=i.write(s)),o=6;else if(t.isDone())return ft.error(lt.unexpected(t));if(6===o)if(t.isCont()){if(!((s=t.head())>=48&&s<=57))return ft.error(lt.expected("digit",t));t=t.step(),i=i.write(s),o=7}else if(t.isDone())return ft.error(lt.expected("digit",t));if(7===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;)t=t.step(),i=i.write(s);if(!t.isEmpty())return ft.done(r.num(i.bind()))}return new e(r,i,n,o)},e}(ft),ln=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._value=r,n._size=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._value,this._size)},e.parse=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=0);for(var o=0;t.isCont()&&(o=t.head(),xt.isDigit(o));)t=t.step(),i=16*i+xt.decodeDigit(o),n+=1;return t.isEmpty()?new e(r,i,n):n>0?n<=8?ft.done(r.uint32(i)):ft.done(r.uint64(i)):ft.error(lt.expected("hex digit",t))},e}(ft),cn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._bindingsParser=i,s._templateParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._bindingsParser,this._templateParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);if(1===s){for(n||(n=r.parseConditionalOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s)if(t.isCont()){if(62!==t.head())return n;t=t.step(),s=3}else if(t.isDone())return n;if(3===s){for(o||(o=r.parseConditionalOperator(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=n.bind(),a=o.bind();return ft.done(r.lambda(u,a))}if(o.isError())return o.asError()}return new e(r,i,n,o,s)},e}(ft),fn=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._recon=e,u._builder=r,u._ifParser=i,u._thenParser=n,u._elseParser=o,u._step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._ifParser,this._thenParser,this._elseParser,this._step)},e.parse=function(t,r,i,n,o,s,u){void 0===u&&(u=1);var a=0;if(1===u){for(n||(n=r.parseOrOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())u=2;else if(n.isError())return n.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),to.isSpace(a));)t=t.step();if(t.isCont()){if(63!==a)return n;t=t.step(),u=3}else if(t.isDone())return n}if(3===u){for(o||(o=r.parseConditionalOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())u=4;else if(o.isError())return o.asError()}if(4===u){for(;t.isCont()&&(a=t.head(),to.isSpace(a));)t=t.step();if(t.isCont()){if(58!==a)return ft.error(lt.expected(58,t));t=t.step(),u=5}else if(t.isDone())return ft.error(lt.expected(58,t))}if(5===u){for(s||(s=r.parseConditionalOperator(t,i));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var h=n.bind(),p=o.bind(),l=s.bind();return ft.done(r.conditional(h,p,l))}if(s.isError())return s.asError()}return new e(r,i,n,o,s,u)},e}(ft),dn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._lhsParser=i,s._rhsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(;;){if(1===s){for(n||(n=r.parseAndOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s)if(t.isCont()){if(124!==t.head())return n;t=t.step(),s=3}else if(t.isDone())return n;if(3===s){for(o||(o=r.parseAndOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=n.bind(),a=o.bind();n=ft.done(r.or(u,a)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,i,n,o,s)},e}(ft),yn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._lhsParser=i,s._rhsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(;;){if(1===s){for(n||(n=r.parseBitwiseOrOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s)if(t.isCont()){if(38!==t.head())return n;t=t.step(),s=3}else if(t.isDone())return n;if(3===s){for(o||(o=r.parseBitwiseOrOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=n.bind(),a=o.bind();n=ft.done(r.and(u,a)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,i,n,o,s)},e}(ft),vn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._lhsParser=i,s._rhsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(n||(n=r.parseBitwiseXorOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(124!==u)return n;t=t.step(),s=3}else if(t.isDone())return n}if(3===s)if(t.isCont()){if(124===(u=t.head()))return n;s=4}else if(t.isDone())return ft.error(lt.unexpected(t));if(4===s){for(o||(o=r.parseBitwiseXorOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=n.bind(),h=o.bind();n=ft.done(r.bitwiseOr(a,h)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,i,n,o,s)},e}(ft),_n=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._lhsParser=i,s._rhsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(n||(n=r.parseBitwiseAndOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(94!==u)return n;t=t.step(),s=3}else if(t.isDone())return n}if(3===s){for(o||(o=r.parseBitwiseAndOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=n.bind(),h=o.bind();n=ft.done(r.bitwiseXor(a,h)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,i,n,o,s)},e}(ft),mn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._lhsParser=i,s._rhsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(n||(n=r.parseComparisonOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(38!==u)return n;t=t.step(),s=3}else if(t.isDone())return n}if(3===s)if(t.isCont()){if(38===(u=t.head()))return n;s=4}else if(t.isDone())return ft.error(lt.unexpected(t));if(4===s){for(o||(o=r.parseComparisonOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=n.bind(),h=o.bind();n=ft.done(r.bitwiseAnd(a,h)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,i,n,o,s)},e}(ft),wn=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._recon=e,u._builder=r,u._lhsParser=i,u._operator=n,u._rhsParser=o,u._step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._operator,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s,u){void 0===u&&(u=1);var a=0;if(1===u){for(n||(n=r.parseAttrExpression(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())u=2;else if(n.isError())return n.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),to.isSpace(a));)t=t.step();if(t.isCont())if(33===a)t=t.step(),u=3;else if(60===a)t=t.step(),u=4;else if(62===a)t=t.step(),u=5;else{if(61!==a)return n;t=t.step(),u=6}else if(t.isDone())return n}if(3===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o="!=",u=7):(o="!",u=7);else if(t.isDone())return ft.error(lt.unexpected(t));if(4===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o="<=",u=7):(o="<",u=7);else if(t.isDone())return ft.error(lt.unexpected(t));if(5===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o=">=",u=7):(o=">",u=7);else if(t.isDone())return ft.error(lt.unexpected(t));if(6===u)if(t.isCont())if(61===(a=t.head()))t=t.step(),o="==",u=7;else{if(62===a)return n;o="=",u=7}else if(t.isDone())return ft.error(lt.unexpected(t));if(7===u){for(s||(s=r.parseAttrExpression(t,i));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var h=n.bind(),p=s.bind();return"<"===o?ft.done(r.lt(h,p)):"<="===o?ft.done(r.le(h,p)):"=="===o?ft.done(r.eq(h,p)):"!="===o?ft.done(r.ne(h,p)):">="===o?ft.done(r.ge(h,p)):">"===o?ft.done(r.gt(h,p)):ft.error(lt.message(o,t))}if(s.isError())return s.asError()}return new e(r,i,n,o,s,u)},e}(ft),gn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._fieldParser=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._fieldParser,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont())if(64===u)s=2;else if(123===u||91===u)i=i||r.recordBuilder(),s=5;else if(40===u)s=4;else{if(!(33===u||34===u||36===u||37===u||39===u||43===u||45===u||u>=48&&u<=57||126===u||to.isIdentStartChar(u)))return i?ft.done(i.bind()):ft.done(r.extant());s=3}else if(t.isDone())return i?ft.done(i.bind()):ft.done(r.extant())}if(2===s){for(n||(n=r.parseAttr(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){(i=i||r.recordBuilder()).push(n.bind()),n=void 0,s=1;continue}if(n.isError())return n.asError()}if(3===s){for(o||(o=r.parseAdditiveOperator(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())(i=i||r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o.asError()}if(4===s){for(o||(o=r.parseAdditiveOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i||(i=r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o.asError()}if(5===s){for(o||(o=r.parseAdditiveOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())o=void 0,s=6;else if(o.isError())return o.asError()}if(6===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(64===u){s=1;continue}return ft.done(i.bind())}if(t.isDone())return ft.done(i.bind())}break}return new e(r,i,n,o,s)},e}(ft),bn=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._recon=e,u._builder=r,u._lhsParser=i,u._operator=n,u._rhsParser=o,u._step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._operator,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s,u){void 0===u&&(u=1);for(var a=0;;){if(1===u){for(n||(n=r.parseMultiplicativeOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())u=2;else if(n.isError())return n.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),to.isSpace(a));)t=t.step();if(t.isCont())if(43===a)t=t.step(),o="+",u=3;else{if(45!==a)return n;t=t.step(),o="-",u=3}else if(t.isDone())return n}if(3===u){for(s||(s=r.parseMultiplicativeOperator(t,i));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var h=n.bind(),p=s.bind();if("+"===o)n=ft.done(r.plus(h,p));else{if("-"!==o)return ft.error(lt.message(o,t));n=ft.done(r.minus(h,p))}s=void 0,o=void 0,u=2;continue}if(s.isError())return s.asError()}break}return new e(r,i,n,o,s,u)},e}(ft),xn=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._recon=e,u._builder=r,u._lhsParser=i,u._operator=n,u._rhsParser=o,u._step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._lhsParser,this._operator,this._rhsParser,this._step)},e.parse=function(t,r,i,n,o,s,u){void 0===u&&(u=1);for(var a=0;;){if(1===u){for(n||(n=r.parsePrefixOperator(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())u=2;else if(n.isError())return n.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),to.isSpace(a));)t=t.step();if(t.isCont())if(42===a)t=t.step(),o="*",u=3;else if(47===a)t=t.step(),o="/",u=3;else{if(37!==a)return n;t=t.step(),o="%",u=3}else if(t.isDone())return n}if(3===u){for(s||(s=r.parsePrefixOperator(t,i));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var h=n.bind(),p=s.bind();if("*"===o)n=ft.done(r.times(h,p));else if("/"===o)n=ft.done(r.divide(h,p));else{if("%"!==o)return ft.error(lt.message(o,t));n=ft.done(r.modulo(h,p))}s=void 0,o=void 0,u=2;continue}if(s.isError())return s.asError()}break}return new e(r,i,n,o,s,u)},e}(ft),Cn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._operator=i,s._operandParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._operator,this._operandParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(33===u)t=t.step(),n="!";else if(126===u)t=t.step(),n="~";else if(45===u)t=t.step(),n="-";else{if(43!==u)return r.parseInvokeOperator(t,i);t=t.step(),n="+"}s=2}else if(t.isDone())return r.parseInvokeOperator(t,i)}if(2===s){for(o||(o=r.parsePrefixOperator(t,i));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=o.bind();return r.isDistinct(a)?"!"===n?ft.done(r.not(a)):"~"===n?ft.done(r.bitwiseNot(a)):"-"===n?ft.done(r.negative(a)):"+"===n?ft.done(r.positive(a)):ft.error(lt.message(n,t)):ft.error(lt.expected("value",t))}if(o.isError())return o.asError()}return new e(r,i,n,o,s)},e}(ft),Sn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._exprParser=i,s._argsParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._exprParser,this._argsParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(n||(n=r.parsePrimary(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())s=2;else if(n.isError())return n.asError()}for(;;){if(2===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(40!==u)return n;t=t.step(),s=3}else if(t.isDone())return n}if(3===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont()){if(41===u){t=t.step();var a=n.bind();n=ft.done(r.invoke(a,r.extant())),s=2;continue}s=4}else if(t.isDone())return ft.error(lt.expected(41,t))}if(4===s){for(o||(o=r.parseBlock(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())s=5;else if(o.isError())return o.asError()}if(5===s){for(;t.isCont()&&(u=t.head(),to.isWhitespace(u));)t=t.step();if(t.isCont()){if(41===u){t=t.step();a=n.bind();var h=o.bind();n=ft.done(r.invoke(a,h)),o=void 0,s=2;continue}return ft.error(lt.expected(41,t))}if(t.isDone())return ft.error(lt.expected(41,t))}break}return new e(r,i,n,o,s)},e}(ft),An=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._recon=e,o._builder=r,o._exprParser=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._exprParser,this._step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),to.isSpace(s));)t=t.step();t.isCont()?40===s?(t=t.step(),o=3):o=2:t.isDone()&&(o=2)}if(2===o){for(n||(n=r.parseLiteral(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return n;if(n.isError())return n.asError()}if(3===o){for(n||(n=r.parseBlockExpression(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())o=4;else if(n.isError())return n.asError()}for(;;){if(4===o){for(;t.isCont()&&(s=t.head(),to.isSpace(s));)t=t.step();if(t.isCont()){if(44!==s)return 41===s?(t=t.step(),n||ft.done(i.bind())):ft.error(lt.expected(41,t));t=t.step(),n&&(i||(i=r.recordBuilder()).push(r.item(n.bind())),n=void 0),o=5}else if(t.isDone())return ft.error(lt.expected(41,t))}if(5===o){for(n||(n=r.parseBlockExpression(t,i));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone()){n=void 0,o=4;continue}if(n.isError())return n.asError()}break}return new e(r,i,n,o)},e}(ft),kn=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._recon=e,o._builder=r,o._valueParser=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._valueParser,this._step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),to.isSpace(s));)t=t.step();if(t.isCont())if(40===s)t=t.step(),o=4;else if(123===s)i=i||r.recordBuilder(),n=r.parseRecord(t,i),o=3;else if(91===s)i=i||r.recordBuilder(),n=r.parseMarkup(t,i),o=3;else if(to.isIdentStartChar(s))n=r.parseIdent(t),o=2;else if(34===s||39===s)n=r.parseString(t),o=2;else if(45===s||s>=48&&s<=57)n=r.parseNumber(t),o=2;else if(37===s)n=r.parseData(t),o=2;else{if(36!==s)return i?ft.done(i.bind()):ft.done(r.extant());n=r.parseSelector(t),o=2}else if(t.isDone())return i?ft.done(i.bind()):ft.done(r.extant())}if(2===o){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return(i=i||r.valueBuilder()).push(r.item(n.bind())),ft.done(i.bind());if(n.isError())return n.asError()}if(3===o){for(;n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return ft.done(i.bind());if(n.isError())return n.asError()}if(4===o){for(n||(n=r.parseBlockExpression(t));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())o=5;else if(n.isError())return n.asError()}if(5===o){for(;t.isCont()&&(s=t.head(),to.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),(i=i||r.valueBuilder()).push(r.item(n.bind())),ft.done(i.bind())):ft.error(lt.expected(41,t));if(t.isDone())return ft.error(lt.expected(41,t))}return new e(r,i,n,o)},e}(ft),En=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._builder=r,s._selector=i,s._valueParser=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._recon,this._builder,this._selector,this._valueParser,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()&&36===u)t=t.step(),n=n||r.selector(),s=2;else if(t.isDone())return ft.error(lt.expected(36,t))}if(2===s)if(t.isCont())91===(u=t.head())?(t=t.step(),s=8):64===u?(t=t.step(),s=7):58===u?(t=t.step(),s=6):42===u?(t=t.step(),s=5):35===u?(t=t.step(),s=4):s=3;else if(t.isDone())return ft.error(lt.unexpected(t));for(;;){if(3===s){for(o||(o=r.parseLiteral(t,r.valueBuilder()));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())n=r.get(n,o.bind()),o=void 0,s=10;else if(o.isError())return o.asError()}if(4===s){for(o||(o=r.parseInteger(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())n=r.value(r.getItem(n,o.bind())),o=void 0,s=10;else if(o.isError())return o.asError()}if(5===s&&(t.isCont()?58===(u=t.head())?(t=t.step(),n=r.keys(n),s=10):42===u?(t=t.step(),n=r.descendants(n),s=10):(n=r.children(n),s=10):t.isDone()&&(n=r.children(n),s=10)),6===s)if(t.isCont()){if(42!==(u=t.head()))return ft.error(lt.expected(42,t));t=t.step(),n=r.values(n),s=10}else if(t.isDone())return ft.error(lt.expected(42,t));if(7===s){for(o||(o=r.parseIdent(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())n=r.getAttr(n,o.bind()),o=void 0,s=10;else if(o.isError())return o.asError()}if(8===s){for(o||(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())s=9;else if(o.isError())return o.asError()}if(9===s){for(;t.isCont()&&(u=t.head(),to.isSpace(u));)t=t.step();if(t.isCont()){if(93!==u)return ft.error(lt.expected(93,t));t=t.step(),n=r.filter(n,o.bind()),o=void 0,s=10}else if(t.isDone())return ft.error(lt.expected(93,t))}if(10===s)if(t.isCont()){if(91===(u=t.head())){t=t.step(),s=8;continue}if(35===u){t=t.step(),s=4;continue}if(46!==u)return i?(i.push(r.item(n)),ft.done(i.bind())):ft.done(n);t=t.step(),s=11}else if(t.isDone())return i?(i.push(r.item(n)),ft.done(i.bind())):ft.done(n);if(11===s){if(t.isCont()){if(64===(u=t.head())){t=t.step(),s=7;continue}if(58===u){t=t.step(),s=6;continue}if(42===u){t=t.step(),s=5;continue}s=3;continue}if(t.isDone())return ft.error(lt.unexpected(t))}break}return new e(r,i,n,o,s)},e}(ft),On=function(){function t(){}return t.prototype.parseBlock=function(t){return Ji.parse(t,this)},t.prototype.parseAttr=function(t){return tn.parse(t,this)},t.prototype.parseBlockItem=function(t){return en.parse(t,this)},t.prototype.parseInlineItem=function(t){return rn.parse(t,this)},t.prototype.parseRecord=function(t,e){return nn.parse(t,this,e)},t.prototype.parseMarkup=function(t,e){return on.parse(t,this,e)},t.prototype.parseData=function(t){return sn.parse(t,this)},t.prototype.parseIdent=function(t){return un.parse(t,this)},t.prototype.parseString=function(t){return an.parse(t,this)},t.prototype.parseNumber=function(t){return hn.parse(t,this)},t.prototype.parseInteger=function(t){return hn.parseInteger(t,this)},t.prototype.parseBlockExpression=function(t,e){return this.parseLambdaFunc(t,e)},t.prototype.parseLambdaFunc=function(t,e){return cn.parse(t,this,e)},t.prototype.parseConditionalOperator=function(t,e){return fn.parse(t,this,e)},t.prototype.parseOrOperator=function(t,e){return dn.parse(t,this,e)},t.prototype.parseAndOperator=function(t,e){return yn.parse(t,this,e)},t.prototype.parseBitwiseOrOperator=function(t,e){return vn.parse(t,this,e)},t.prototype.parseBitwiseXorOperator=function(t,e){return _n.parse(t,this,e)},t.prototype.parseBitwiseAndOperator=function(t,e){return mn.parse(t,this,e)},t.prototype.parseComparisonOperator=function(t,e){return wn.parse(t,this,e)},t.prototype.parseAttrExpression=function(t,e){return gn.parse(t,this,e)},t.prototype.parseAdditiveOperator=function(t,e){return bn.parse(t,this,e)},t.prototype.parseMultiplicativeOperator=function(t,e){return xn.parse(t,this,e)},t.prototype.parsePrefixOperator=function(t,e){return Cn.parse(t,this,e)},t.prototype.parseInvokeOperator=function(t,e){return Sn.parse(t,this,e)},t.prototype.parsePrimary=function(t,e){return An.parse(t,this,e)},t.prototype.parseLiteral=function(t,e){return kn.parse(t,this,e)},t.prototype.parseSelector=function(t,e){return En.parse(t,this,e)},t.prototype.blockParser=function(){return new Ji(this)},t.prototype.parseBlockString=function(t){for(var e=$.stringInput(t);e.isCont()&&to.isWhitespace(e.head());)e=e.step();var r=this.parseBlock(e);if(r.isDone())for(;e.isCont()&&to.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.parseNumberString=function(t){for(var e=$.stringInput(t);e.isCont()&&to.isWhitespace(e.head());)e=e.step();var r=this.parseNumber(e);if(r.isDone())for(;e.isCont()&&to.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t}(),Vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isDistinct=function(t){return t.isDistinct()},e.prototype.item=function(t){return t},e.prototype.value=function(t){return t.toValue()},e.prototype.attr=function(t,e){return ie.of.apply(ie,arguments)},e.prototype.slot=function(t,e){return ne.of.apply(ne,arguments)},e.prototype.valueBuilder=function(){return se.builder()},e.prototype.recordBuilder=function(){return ae.create()},e.prototype.dataOutput=function(){return ce.output()},e.prototype.textOutput=function(){return de.output()},e.prototype.ident=function(t){if(t instanceof de){var e=t.stringValue();if("true"===e)return ve.from(!0);if("false"===e)return ve.from(!1)}return t},e.prototype.num=function(t){if("number"==typeof t)return ye.from(t);if("string"==typeof t)return ye.from(+t);throw new TypeError(""+t)},e.prototype.uint32=function(t){return ye.uint32(t)},e.prototype.uint64=function(t){return ye.uint64(t)},e.prototype.bool=function(t){return ve.from(t)},e.prototype.selector=function(){return we.identity()},e.prototype.extant=function(){return se.extant()},e.prototype.absent=function(){return se.absent()},e.prototype.conditional=function(t,e,r){return t.conditional(e,r)},e.prototype.or=function(t,e){return new Oe(t,e)},e.prototype.and=function(t,e){return new Ve(t,e)},e.prototype.bitwiseOr=function(t,e){return new Pe(t,e)},e.prototype.bitwiseXor=function(t,e){return new De(t,e)},e.prototype.bitwiseAnd=function(t,e){return new Me(t,e)},e.prototype.lt=function(t,e){return new Te(t,e)},e.prototype.le=function(t,e){return new Re(t,e)},e.prototype.eq=function(t,e){return new Ie(t,e)},e.prototype.ne=function(t,e){return new Fe(t,e)},e.prototype.ge=function(t,e){return new Le(t,e)},e.prototype.gt=function(t,e){return new Ue(t,e)},e.prototype.plus=function(t,e){return new Ne(t,e)},e.prototype.minus=function(t,e){return new ze(t,e)},e.prototype.times=function(t,e){return new je(t,e)},e.prototype.divide=function(t,e){return new We(t,e)},e.prototype.modulo=function(t,e){return new qe(t,e)},e.prototype.not=function(t){return new Be(t)},e.prototype.bitwiseNot=function(t){return new Ke(t)},e.prototype.negative=function(t){return t instanceof ye?t.negative():new He(t)},e.prototype.positive=function(t){return new Ge(t)},e.prototype.invoke=function(t,e){return new Xe(t,e)},e.prototype.lambda=function(t,e){return t.lambda(e)},e.prototype.get=function(t,e){return t.get(e)},e.prototype.getAttr=function(t,e){return t.getAttr(e)},e.prototype.getItem=function(t,e){return t.getItem(e)},e.prototype.children=function(t){return we.literal(t).children()},e.prototype.descendants=function(t){return we.literal(t).descendants()},e.prototype.keys=function(t){return we.literal(t).keys()},e.prototype.values=function(t){return we.literal(t).values()},e.prototype.filter=function(t,e){return t.filter(e)},e}(On),Pn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._key=r,s._value=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._key,this._value,this._part,this._step)},e.sizeOf=function(t,e,r){var i=0;return i+=1,i+=t.sizeOfValue(e),t.isExtant(t.item(r))||(i+=1,i+=t.sizeOfBlockValue(r),i+=1),i},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(64),s=2),2===s)if((o=o?o.pull(t):r.writeValue(i,t)).isDone()){if(o=void 0,r.isExtant(r.item(n)))return G.done();s=3}else if(o.isError())return o.asError();if(3===s&&t.isCont()&&(t=t.write(40),s=4),4===s)if((o=o?o.pull(t):r.writeBlockValue(n,t)).isDone())o=void 0,s=5;else if(o.isError())return o.asError();return 5===s&&t.isCont()?(t=t.write(41),G.done()):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G),Dn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._key=r,s._value=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._key,this._value,this._part,this._step)},e.sizeOf=function(t,e,r){var i=0;return i+=t.sizeOfValue(e),i+=1,t.isExtant(t.item(r))||(i+=t.sizeOfValue(r)),i},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s)if((o=o?o.pull(t):r.writeValue(i,t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()){if(t=t.write(58),r.isExtant(r.item(n)))return G.done();s=3}if(3===s){if((o=o?o.pull(t):r.writeValue(n,t)).isDone())return G.done();if(o.isError())return o.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G),Mn=function(t){function e(e,r,i,n,o,s,u,a,h,p,l,c){var f=t.call(this)||this;return f._recon=e,f._items=r,f._inBlock=i,f._inMarkup=n,f._inBraces=o,f._inBrackets=s,f._first=u,f._markupSafe=a,f._item=h,f._next=p,f._part=l,f._step=c,f}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._items,this._inBlock,this._inMarkup,this._inBraces,this._inBrackets,this._first,this._markupSafe,this._item,this._next,this._part,this._step)},e.sizeOf=function(t,r,i,n){for(var o,s=0,u=!1,a=!1,h=!0,p=!0;o||r.hasNext();){var l=void 0;o?(l=o,o=void 0):l=r.next().value,r.hasNext()&&(o=r.next().value),t.isExpression(l)&&(p=!1),a&&t.isAttr(l)&&(u&&(s+=1,u=!1),s+=1,a=!1),t.isAttr(l)?(u?(s+=1,u=!1):a&&(s+=1,a=!1),s+=t.sizeOfItem(l),h=!1):a&&t.isText(l)?(u&&(s+=1,u=!1),s+=t.sizeOfMarkupText(l)):u?(h?h=!1:s+=1,s+=e.sizeOfBlockItem(t,l)):a?t.isRecord(l)&&t.isMarkupSafe(t.items(l))?(s+=t.sizeOfBlock(t.items(l),!1,!0),o&&t.isText(o)?(s+=t.sizeOfMarkupText(o),o=void 0):o&&!t.isAttr(o)?(s+=1,u=!0,h=!0):(s+=1,a=!1)):(s+=1,s+=t.sizeOfItem(l),u=!0,h=!1):p&&t.isText(l)&&o&&!t.isField(o)&&!t.isText(o)&&!t.isBool(o)?(s+=1,s+=t.sizeOfMarkupText(l),a=!0):i&&!u?(h?h=!1:s+=1,s+=e.sizeOfBlockItem(t,l)):n&&t.isText(l)&&!o?(s+=1,s+=t.sizeOfMarkupText(l),s+=1):!n&&t.isValue(l)&&!t.isRecord(l)&&(!h&&!o||o&&t.isAttr(o))?(!h&&(t.isText(l)&&t.isIdent(l)||t.isNum(l)||t.isBool(l))&&(s+=1),s+=t.sizeOfItem(l)):(s+=1,s+=t.sizeOfItem(l),u=!0,h=!1)}return u&&(s+=1),a&&(s+=1),s},e.sizeOfBlockItem=function(t,e){var r=0;return t.isField(e)?r+=t.sizeOfSlot(t.key(e),t.value(e)):r+=t.sizeOfItem(e),r},e.write=function(t,r,i,n,o,s,u,a,h,p,l,c,f){for(void 0===s&&(s=!1),void 0===u&&(u=!1),void 0===a&&(a=!0),void 0===h&&(h=!0),void 0===f&&(f=1);;){if(1===f){if(!l&&!i.hasNext()){f=10;break}l?(p=l,l=void 0):p=i.next().value,i.hasNext()&&(l=i.next().value),r.isExpression(p)&&(h=!1),f=2}if(2===f&&t.isCont()&&(u&&r.isAttr(p)?(s&&(t=t.write(125),s=!1),f=3):f=4),3===f&&t.isCont()&&(t=t.write(93),u=!1,f=4),4===f&&t.isCont()&&(r.isAttr(p)?(s?(t=t.write(125),s=!1):u&&(t=t.write(93),u=!1),c=r.writeItem(p,t),a=!1,f=7):u&&r.isText(p)?(s&&(t=t.write(125),s=!1),c=r.writeMarkupText(p,t),f=7):s?(a?a=!1:t=t.write(44),c=e.writeBlockItem(t,r,p),f=7):u?r.isRecord(p)&&r.isMarkupSafe(r.items(p))?(c=r.writeBlock(r.items(p),t,!1,!0),f=5):(t=t.write(123),c=r.writeItem(p,t),s=!0,a=!1,f=7):h&&r.isText(p)&&l&&!r.isField(l)&&!r.isText(l)&&!r.isBool(l)?(t=t.write(91),c=r.writeMarkupText(p,t),u=!0,f=7):n&&!s?(a?a=!1:t=t.write(44),c=e.writeBlockItem(t,r,p),f=7):o&&r.isText(p)&&!l?(t=t.write(91),c=r.writeMarkupText(p,t),f=8):!o&&r.isValue(p)&&!r.isRecord(p)&&(!a&&!l||l&&r.isAttr(l))?(!a&&(r.isText(p)&&r.isIdent(p)||r.isNum(p)||r.isBool(p))&&(t=t.write(32)),c=r.writeItem(p,t),f=7):(t=t.write(123),c=r.writeItem(p,t),s=!0,a=!1,f=7)),5===f)if((c=c.pull(t)).isDone())c=void 0,f=6;else if(c.isError())return c.asError();if(6===f&&t.isCont()){if(!l||!r.isText(l)){if(l&&!r.isAttr(l)){t=t.write(123),s=!0,a=!0,f=1;continue}t=t.write(93),u=!1,f=1;continue}c=r.writeMarkupText(l,t),l=void 0,f=7}if(7===f){if((c=c.pull(t)).isDone()){c=void 0,f=1;continue}if(c.isError())return c.asError()}if(8===f)if((c=c.pull(t)).isDone())c=void 0,f=9;else if(c.isError())return c.asError();if(9!==f||!t.isCont())break;t=t.write(93),f=1}if(10===f&&(s?t.isCont()&&(t=t.write(125),f=11):f=11),11===f){if(!u)return G.done();if(t.isCont())return t=t.write(93),G.done()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u,a,h,p,l,c,f)},e.writeBlockItem=function(t,e,r){return e.isField(r)?e.writeSlot(e.key(r),e.value(r),t):e.writeItem(r,t)},e}(G),Tn=function(t){function e(e,r,i,n,o,s,u,a){var h=t.call(this)||this;return h._recon=e,h._items=r,h._inParens=i,h._first=n,h._item=o,h._next=s,h._part=u,h._step=a,h}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._items,this._inParens,this._first,this._item,this._next,this._part,this._step)},e.sizeOf=function(t,e){for(var r,i=0,n=!1,o=!0;r||e.hasNext();){var s=void 0;r?(s=r,r=void 0):s=e.next().value,e.hasNext()&&(r=e.next().value),n||o||(i+=1),t.isAttr(s)?(n&&(i+=1,n=!1),i+=t.sizeOfItem(s),o=!1):n?(o?o=!1:i+=1,i+=t.sizeOfBlockItem(s)):t.isValue(s)&&!t.isRecord(s)&&(!o&&!r||r&&t.isAttr(r))?i+=t.sizeOfItem(s):(i+=1,i+=t.sizeOfItem(s),n=!0,o=!1)}return n&&(i+=1),i},e.write=function(t,r,i,n,o,s,u,a,h){for(void 0===n&&(n=!1),void 0===o&&(o=!0),void 0===h&&(h=1);;){if(1===h){if(!u&&!i.hasNext()){h=5;break}u?(s=u,u=void 0):s=i.next().value,i.hasNext()&&(u=i.next().value),h=2}if(2===h&&t.isCont()&&(n||o||(t=t.write(32)),h=3),3===h&&t.isCont()&&(r.isAttr(s)?(n&&(t=t.write(41),n=!1),a=r.writeItem(s,t),o=!1,h=4):n?(o?o=!1:t=t.write(44),a=r.writeBlockItem(s,t),h=4):r.isValue(s)&&!r.isRecord(s)&&(!o&&!u||u&&r.isAttr(u))?(a=r.writeItem(s,t),h=4):(t=t.write(40),a=r.writeItem(s,t),n=!0,o=!1,h=4)),4===h){if((a=a.pull(t)).isDone()){a=void 0,h=1;continue}if(a.isError())return a.asError()}break}if(5===h){if(!n)return G.done();if(t.isCont())return t=t.write(41),G.done()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u,a,h)},e}(G),Rn=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._text=e,o._index=r,o._escape=i,o._step=n,o}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._text,this._index,this._escape,this._step)},e.sizeOf=function(t){for(var e=0,r=0,i=t.length;r<i;r=t.offsetByCodePoints(r,1)){var n=t.codePointAt(r);void 0===n&&(n=t.charCodeAt(r)),e+=36===n||64===n||91===n||92===n||93===n||123===n||125===n||8===n||12===n||10===n||13===n||9===n?2:n<32?6:At.sizeOf(n)}return e},e.write=function(t,r,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1);for(var s=r.length;t.isCont();)if(1===o){if(!(i<s))return G.done();var u=r.codePointAt(i);void 0===u&&(u=r.charCodeAt(i)),i=r.offsetByCodePoints(i,1),36===u||64===u||91===u||92===u||93===u||123===u||125===u?(t=t.write(92),n=u,o=2):8===u?(t=t.write(92),n=98,o=2):12===u?(t=t.write(92),n=102,o=2):10===u?(t=t.write(92),n=110,o=2):13===u?(t=t.write(92),n=114,o=2):9===u?(t=t.write(92),n=116,o=2):u<32?(t=t.write(92),n=u,o=3):t=t.write(u)}else 2===o?(t=t.write(n),n=0,o=1):3===o?(t=t.write(117),o=4):4===o?(t=t.write(xt.uppercase().encodeDigit(n>>>12&15)),o=5):5===o?(t=t.write(xt.uppercase().encodeDigit(n>>>8&15)),o=6):6===o?(t=t.write(xt.uppercase().encodeDigit(n>>>4&15)),o=7):7===o&&(t=t.write(xt.uppercase().encodeDigit(15&n)),n=0,o=1);return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o)},e}(G),In=function(t){function e(e,r,i){var n=t.call(this)||this;return n._array=e,n._part=r,n._step=i,n}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._array,this._part,this._step)},e.sizeOf=function(t){return 1+(Math.floor(4*t/3)+3&-4)},e.write=function(t,r,i,n){if(void 0===n&&(n=1),1===n&&t.isCont()&&(t=t.write(37),n=2),2===n){if((i=i?i.pull(t):Mt.standard().writeUint8Array(r,t)).isDone())return i=void 0,G.done();if(i.isError())return i.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e}(G),Fn=function(t){function e(e,r){var i=t.call(this)||this;return i._ident=e,i._index=r,i}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._ident,this._index)},e.sizeOf=function(t){return At.sizeOf(t)},e.write=function(t,r,i){var n;void 0===i&&(i=0);var o=r.length;if(0===o)return G.error(new H("empty identifier"));for(0===i&&t.isCont()&&(void 0===(n=r.codePointAt(0))&&(n=r.charCodeAt(0)),to.isIdentStartChar(n)&&(t=t.write(n),i=r.offsetByCodePoints(0,1)));i<o&&t.isCont();){if(void 0===(n=r.codePointAt(i))&&(n=r.charCodeAt(i)),!to.isIdentChar(n))return G.error(new H("invalid identifier"));t=t.write(n),i=r.offsetByCodePoints(i,1)}return i>=o?G.done():t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i)},e}(G),Ln=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._string=e,o._index=r,o._escape=i,o._step=n,o}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._string,this._index,this._escape,this._step)},e.sizeOf=function(t){var e=0;e+=1;for(var r=0,i=t.length;r<i;r=t.offsetByCodePoints(r,1)){var n=t.codePointAt(r);void 0===n&&(n=t.charCodeAt(r)),e+=34===n||92===n||8===n||12===n||10===n||13===n||9===n?2:n<32?6:At.sizeOf(n)}return e+=1},e.write=function(t,r,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1),1===o&&t.isCont()&&(t=t.write(34),o=2);for(var s=r.length;o>=2&&o<=8&&t.isCont();)if(2===o){if(!(i<s)){o=9;break}var u=r.codePointAt(i);void 0===u&&(u=r.charCodeAt(i)),i=r.offsetByCodePoints(i,1),34===u||92===u?(t=t.write(92),n=u,o=3):8===u?(t=t.write(92),n=98,o=3):12===u?(t=t.write(92),n=102,o=3):10===u?(t=t.write(92),n=110,o=3):13===u?(t=t.write(92),n=114,o=3):9===u?(t=t.write(92),n=116,o=3):u<32?(t=t.write("\\"),n=u,o=4):t=t.write(u)}else 3===o?(t=t.write(n),n=0,o=2):4===o?(t=t.write(117),o=5):5===o?(t=t.write(xt.uppercase().encodeDigit(n>>>12&15)),o=6):6===o?(t=t.write(xt.uppercase().encodeDigit(n>>>8&15)),o=7):7===o?(t=t.write(xt.uppercase().encodeDigit(n>>>4&15)),o=8):8===o&&(t=t.write(xt.uppercase().encodeDigit(15&n)),n=0,o=2);return 9===o&&t.isCont()?(t=t.write(34),G.done()):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o)},e}(G),Un=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._bindings=r,s._template=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._bindings,this._template,this._part,this._step)},e.sizeOf=function(t,e,r){var i=0;return i+=t.sizeOfPrimary(e),i+=4,i+=t.sizeOfValue(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s)if((o=o?o.pull(t):r.writePrimary(i,t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()&&(t=t.write(32),s=3),3===s&&t.isCont()&&(t=t.write(61),s=4),4===s&&t.isCont()&&(t=t.write(62),s=5),5===s&&t.isCont()&&(t=t.write(32),s=6),6===s){if((o=null==o?r.writeValue(n,t):o.pull(t)).isDone())return G.done();if(o.isError())return o.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G),Nn=function(t){function e(e,r,i,n,o,s,u){var a=t.call(this)||this;return a._recon=e,a._ifTerm=r,a._thenTerm=i,a._elseTerm=n,a._precedence=o,a._part=s,a._step=u,a}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._ifTerm,this._thenTerm,this._elseTerm,this._precedence,this._part,this._step)},e.sizeOf=function(t,e,r,i,n){var o=0;return t.precedence(e)>0&&t.precedence(e)<=n?(o+=1,o+=t.sizeOfItem(e),o+=1):o+=t.sizeOfItem(e),o+=3,o+=t.sizeOfItem(r),o+=3,o+=t.sizeOfItem(i)},e.write=function(t,r,i,n,o,s,u,a){if(void 0===a&&(a=1),1===a&&(r.precedence(i)>0&&r.precedence(i)<=s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((u=u?u.pull(t):r.writeItem(i,t)).isDone())u=void 0,a=3;else if(u.isError())return u.asError();if(3===a&&(r.precedence(i)>0&&r.precedence(i)<=s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a&&t.isCont()&&(t=t.write(63),a=6),6===a&&t.isCont()&&(t=t.write(32),a=7),7===a)if((u=u?u.pull(t):r.writeItem(n,t)).isDone())u=void 0,a=8;else if(u.isError())return u.asError();if(8===a&&t.isCont()&&(t=t.write(32),a=9),9===a&&t.isCont()&&(t=t.write(58),a=10),10===a&&t.isCont()&&(t=t.write(32),a=11),11===a){if((u=u?u.pull(t):r.writeItem(o,t)).isDone())return G.done();if(u.isError())return u.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u,a)},e}(G),zn=function(t){function e(e,r,i,n,o,s,u){var a=t.call(this)||this;return a._recon=e,a._lhs=r,a._operator=i,a._rhs=n,a._precedence=o,a._part=s,a._step=u,a}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._lhs,this._operator,this._rhs,this._precedence,this._part,this._step)},e.sizeOf=function(t,e,r,i,n){var o=0;return t.precedence(e)<n?(o+=1,o+=t.sizeOfItem(e),o+=1):o+=t.sizeOfItem(e),o+=1,o+=At.sizeOf(r),o+=1,t.precedence(i)<n?(o+=1,o+=t.sizeOfItem(i),o+=1):o+=t.sizeOfItem(i),o},e.write=function(t,r,i,n,o,s,u,a){if(void 0===a&&(a=1),1===a&&(r.precedence(i)<s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((u=u?u.pull(t):r.writeItem(i,t)).isDone())u=void 0,a=3;else if(u.isError())return u.asError();if(3===a&&(r.precedence(i)<s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a)if((u=u?u.pull(t):$.writeString(n,t)).isDone())u=void 0,a=6;else if(u.isError())return u.asError();if(6===a&&t.isCont()&&(t=t.write(32),a=7),7===a&&(r.precedence(o)<s?t.isCont()&&(t=t.write(40),a=8):a=8),8===a)if((u=u?u.pull(t):r.writeItem(o,t)).isDone())u=void 0,a=9;else if(u.isError())return u.asError();if(9===a){if(!(r.precedence(o)<s))return G.done();if(t.isCont())return t=t.write(41),G.done()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u,a)},e}(G),jn=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u._recon=e,u._operator=r,u._rhs=i,u._precedence=n,u._part=o,u._step=s,u}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._operator,this._rhs,this._precedence,this._part,this._step)},e.sizeOf=function(t,e,r,i){var n=0;return n+=At.sizeOf(e),t.precedence(r)<i?(n+=1,n+=t.sizeOfItem(r),n+=1):n+=t.sizeOfItem(r),n},e.write=function(t,r,i,n,o,s,u){if(void 0===u&&(u=1),1===u)if((s=s?s.pull(t):$.writeString(i,t)).isDone())s=void 0,u=2;else if(s.isError())return s.asError();if(2===u&&(r.precedence(n)<o?t.isCont()&&(t=t.write(40),u=3):u=3),3===u)if((s=s?s.pull(t):r.writeItem(n,t)).isDone())s=void 0,u=4;else if(s.isError())return s.asError();if(4===u){if(!(r.precedence(n)<o))return G.done();if(t.isCont())return t=t.write(41),G.done()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s,u)},e}(G),Wn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._func=r,s._args=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._func,this._args,this._part,this._step)},e.sizeOf=function(t,e,r){var i=0;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfBlockValue(r),i+=1},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s)if((o=o?o.pull(t):r.writeValue(i,t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()&&(t=t.write(40),s=3),3===s)if((o=o?o.pull(t):r.writeBlockValue(n,t)).isDone())o=void 0,s=4;else if(o.isError())return o.asError();return 4===s&&t.isCont()?(t=t.write(41),G.done()):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G),qn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._item=r,s._then=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._item,this._then,this._part,this._step)},e.sizeOf=function(t,e,r){var i=0;return t.precedence(e)<t.precedence(t.item(r))?(i+=1,i+=t.sizeOfItem(e),i+=1):i+=t.sizeOfItem(e),i+=t.sizeOfThen(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&(r.precedence(i)<r.precedence(r.item(n))?t.isCont()&&(t=t.write(40),s=2):s=2),2===s)if((o=o?o.pull(t):r.writeItem(i,t)).isDone())o=void 0,s=3;else if(o.isError())return o.asError();return 3===s&&(r.precedence(i)<r.precedence(r.item(n))?t.isCont()&&(t=t.write(41),s=4):s=4),4===s?r.writeThen(n,t):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e}(G),Bn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._key=r,s._then=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._key,this._then,this._part,this._step)},e.sizeOf=function(t,e,r){var i=1;return t.isRecord(t.item(e))?(i+=1,i+=t.sizeOfBlockValue(e),i+=1):i+=t.sizeOfValue(e),i+=t.sizeOfThen(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&(r.isRecord(r.item(i))?t.isCont()&&(t=t.write(123),s=4):s=4),4===s)if((o=o?o.pull(t):r.isRecord(r.item(i))?r.writeBlockValue(i,t):r.writeValue(i,t)).isDone())o=void 0,s=5;else if(o.isError())return o.asError();return 5===s&&(r.isRecord(r.item(i))?t.isCont()&&(t=t.write(125),s=6):s=6),6===s?r.writeThen(n,t):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e.writeThen=function(t,r,i,n){return e.write(t,r,i,n,void 0,2)},e}(G),Kn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._key=r,s._then=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._key,this._then,this._part,this._step)},e.sizeOf=function(t,e,r){var i=2;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&t.isCont()&&(t=t.write(64),s=4),4===s){if((o=o?o.pull(t):r.writeValue(i,t)).isDone())return r.writeThen(n,t);if(o.isError())return o.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e.writeThen=function(t,r,i,n){return e.write(t,r,i,n,void 0,2)},e}(G),Hn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._index=r,s._then=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._index,this._then,this._part,this._step)},e.sizeOf=function(t,e,r){var i=2;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r)},e.sizeOfThen=function(t,e,r){var i=1;return i+=t.sizeOfValue(e),i+=t.sizeOfThen(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(35),s=3),3===s){if((o=o?o.pull(t):r.writeValue(i,t)).isDone())return r.writeThen(n,t);if(o.isError())return o.asError()}return t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e.writeThen=function(t,r,i,n){return e.write(t,r,i,n,void 0,2)},e}(G),Gn=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._then=r,n._step=i,n}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._then,this._step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,i,n){return void 0===n&&(n=1),1===n&&t.isCont()?(t=t.write(36),n=3):2===n&&t.isCont()&&(t=t.write(46),n=3),3===n&&t.isCont()&&(t=t.write(42),n=4),4===n&&t.isCont()?(t=t.write(58),r.writeThen(i,t)):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e.writeThen=function(t,r,i){return e.write(t,r,i,2)},e}(G),Xn=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._then=r,n._step=i,n}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._then,this._step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,i,n){return void 0===n&&(n=1),1===n&&t.isCont()?(t=t.write(36),n=3):2===n&&t.isCont()&&(t=t.write(46),n=3),3===n&&t.isCont()&&(t=t.write(58),n=4),4===n&&t.isCont()?(t=t.write(42),r.writeThen(i,t)):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e.writeThen=function(t,r,i){return e.write(t,r,i,2)},e}(G),Yn=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._then=r,n._step=i,n}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._then,this._step)},e.sizeOf=function(t,e){var r=2;return r+=t.sizeOfThen(e)},e.write=function(t,r,i,n){return void 0===n&&(n=1),1===n&&t.isCont()?(t=t.write(36),n=3):2===n&&t.isCont()&&(t=t.write(46),n=3),3===n&&t.isCont()?(t=t.write(42),r.writeThen(i,t)):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e.writeThen=function(t,r,i){return e.write(t,r,i,2)},e}(G),Zn=function(t){function e(e,r,i){var n=t.call(this)||this;return n._recon=e,n._then=r,n._step=i,n}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._then,this._step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,i,n){return void 0===n&&(n=1),1===n&&t.isCont()?(t=t.write(36),n=3):2===n&&t.isCont()&&(t=t.write(46),n=3),3===n&&t.isCont()&&(t=t.write(42),n=4),4===n&&t.isCont()?(t=t.write(42),r.writeThen(i,t)):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n)},e.writeThen=function(t,r,i){return e.write(t,r,i,2)},e}(G),Qn=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._recon=e,s._predicate=r,s._then=i,s._part=n,s._step=o,s}return _(e,t),e.prototype.pull=function(t){return e.write(t,this._recon,this._predicate,this._then,this._part,this._step)},e.sizeOf=function(t,e,r){var i=2;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfThen(r)},e.sizeOfThen=function(t,e,r){var i=1;return i+=t.sizeOfValue(e),i+=1,i+=t.sizeOfThen(r)},e.write=function(t,r,i,n,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(91),s=3),3===s)if((o=o?o.pull(t):r.writeValue(i,t)).isDone())o=void 0,s=4;else if(o.isError())return o.asError();return 4===s&&t.isCont()?(t=t.write(93),r.writeThen(n,t)):t.isDone()?G.error(new H("truncated")):t.isError()?G.error(t.trap()):new e(r,i,n,o,s)},e.writeThen=function(t,r,i,n){return e.write(t,r,i,n,void 0,2)},e}(G),$n=function(){function t(){}return t.prototype.sizeOfAttr=function(t,e){return Pn.sizeOf(this,t,e)},t.prototype.writeAttr=function(t,e,r){return Pn.write(r,this,t,e)},t.prototype.sizeOfSlot=function(t,e){return Dn.sizeOf(this,t,e)},t.prototype.writeSlot=function(t,e,r){return Dn.write(r,this,t,e)},t.prototype.sizeOfBlock=function(t,e,r){if(3===arguments.length)return Mn.sizeOf(this,t,e,r);var i=this.items(t);return i.hasNext()?Mn.sizeOf(this,i,this.isBlockSafe(this.items(t)),!1):2},t.prototype.writeBlock=function(t,e,r,i){if(4===arguments.length)return Mn.write(e,this,t,r,i);var n=this.items(t);return n.hasNext()?Mn.write(e,this,n,this.isBlockSafe(this.items(t)),!1):$.writeString("{}",e)},t.prototype.sizeOfRecord=function(t){var e=this.items(t);return e.hasNext()?Mn.sizeOf(this,e,!1,!1):2},t.prototype.writeRecord=function(t,e){var r=this.items(t);return r.hasNext()?Mn.write(e,this,r,!1,!1):$.writeString("{}",e)},t.prototype.sizeOfPrimary=function(t){if(this.isRecord(this.item(t))){var e=this.items(this.item(t));if(e.hasNext())return Tn.sizeOf(this,e)}else if(!this.isExtant(this.item(t)))return this.sizeOfValue(t);return 2},t.prototype.writePrimary=function(t,e){if(this.isRecord(this.item(t))){var r=this.items(this.item(t));if(r.hasNext())return Tn.write(e,this,r)}else if(!this.isExtant(this.item(t)))return this.writeValue(t,e);return $.writeString("()",e)},t.prototype.isBlockSafe=function(t){for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0},t.prototype.isMarkupSafe=function(t){if(!t.hasNext()||!this.isAttr(t.next().value))return!1;for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0},t.prototype.sizeOfMarkupText=function(t){return"string"!=typeof t&&(t=this.string(t)),Rn.sizeOf(t)},t.prototype.writeMarkupText=function(t,e){return"string"!=typeof t&&(t=this.string(t)),Rn.write(e,t)},t.prototype.sizeOfData=function(t){return In.sizeOf(t)},t.prototype.writeData=function(t,e){return t?In.write(e,t):$.writeString("%",e)},t.prototype.isIdent=function(t){"string"!=typeof t&&(t=this.string(t));var e,r=t.length;if(0===r||void 0!==(e=t.codePointAt(0))&&!to.isIdentStartChar(e))return!1;for(var i=t.offsetByCodePoints(0,1);i<r;i=t.offsetByCodePoints(i,1))if(void 0===(e=t.codePointAt(i))||!to.isIdentChar(e))return!1;return!0},t.prototype.sizeOfText=function(t){return this.isIdent(t)?Fn.sizeOf(t):Ln.sizeOf(t)},t.prototype.writeText=function(t,e){return this.isIdent(t)?Fn.write(e,t):Ln.write(e,t)},t.prototype.sizeOfNum=function(t){if(isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648){var e=pt.countDigits(t);return t<0&&(e+=1),e}return(""+t).length},t.prototype.writeNum=function(t,e){return isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648?pt.writeInteger(t,e):$.writeString(""+t,e)},t.prototype.sizeOfUint32=function(t){return 10},t.prototype.writeUint32=function(t,e){return xt.lowercase().writeIntegerLiteral(t,e,8)},t.prototype.sizeOfUint64=function(t){return 18},t.prototype.writeUint64=function(t,e){return xt.lowercase().writeIntegerLiteral(t,e,16)},t.prototype.sizeOfBool=function(t){return t?4:5},t.prototype.writeBool=function(t,e){return $.writeString(t?"true":"false",e)},t.prototype.sizeOfLambdaFunc=function(t,e){return Un.sizeOf(this,t,e)},t.prototype.writeLambdaFunc=function(t,e,r){return Un.write(r,this,t,e)},t.prototype.sizeOfConditionalOperator=function(t,e,r,i){return Nn.sizeOf(this,t,e,r,i)},t.prototype.writeConditionalOperator=function(t,e,r,i,n){return Nn.write(n,this,t,e,r,i)},t.prototype.sizeOfInfixOperator=function(t,e,r,i){return zn.sizeOf(this,t,e,r,i)},t.prototype.writeInfixOperator=function(t,e,r,i,n){return zn.write(n,this,t,e,r,i)},t.prototype.sizeOfPrefixOperator=function(t,e,r){return jn.sizeOf(this,t,e,r)},t.prototype.writePrefixOperator=function(t,e,r,i){return jn.write(i,this,t,e,r)},t.prototype.sizeOfInvokeOperator=function(t,e){return Wn.sizeOf(this,t,e)},t.prototype.writeInvokeOperator=function(t,e,r){return Wn.write(r,this,t,e)},t.prototype.sizeOfIdentitySelector=function(){return 0},t.prototype.writeIdentitySelector=function(t){return G.done()},t.prototype.sizeOfThenIdentitySelector=function(){return 0},t.prototype.writeThenIdentitySelector=function(t){return G.done()},t.prototype.sizeOfLiteralSelector=function(t,e){return qn.sizeOf(this,t,e)},t.prototype.writeLiteralSelector=function(t,e,r){return qn.write(r,this,t,e)},t.prototype.sizeOfThenLiteralSelector=function(t,e){return 0},t.prototype.writeThenLiteralSelector=function(t,e,r){return G.done()},t.prototype.sizeOfGetSelector=function(t,e){return Bn.sizeOf(this,t,e)},t.prototype.writeGetSelector=function(t,e,r){return Bn.write(r,this,t,e)},t.prototype.sizeOfThenGetSelector=function(t,e){return Bn.sizeOf(this,t,e)},t.prototype.writeThenGetSelector=function(t,e,r){return Bn.writeThen(r,this,t,e)},t.prototype.sizeOfGetAttrSelector=function(t,e){return Kn.sizeOf(this,t,e)},t.prototype.writeGetAttrSelector=function(t,e,r){return Kn.write(r,this,t,e)},t.prototype.sizeOfThenGetAttrSelector=function(t,e){return Kn.sizeOf(this,t,e)},t.prototype.writeThenGetAttrSelector=function(t,e,r){return Kn.writeThen(r,this,t,e)},t.prototype.sizeOfGetItemSelector=function(t,e){return Hn.sizeOf(this,t,e)},t.prototype.writeGetItemSelector=function(t,e,r){return Hn.write(r,this,t,e)},t.prototype.sizeOfThenGetItemSelector=function(t,e){return Hn.sizeOfThen(this,t,e)},t.prototype.writeThenGetItemSelector=function(t,e,r){return Hn.writeThen(r,this,t,e)},t.prototype.sizeOfKeysSelector=function(t){return Gn.sizeOf(this,t)},t.prototype.writeKeysSelector=function(t,e){return Gn.write(e,this,t)},t.prototype.sizeOfThenKeysSelector=function(t){return Gn.sizeOf(this,t)},t.prototype.writeThenKeysSelector=function(t,e){return Gn.writeThen(e,this,t)},t.prototype.sizeOfValuesSelector=function(t){return Xn.sizeOf(this,t)},t.prototype.writeValuesSelector=function(t,e){return Xn.write(e,this,t)},t.prototype.sizeOfThenValuesSelector=function(t){return Xn.sizeOf(this,t)},t.prototype.writeThenValuesSelector=function(t,e){return Xn.writeThen(e,this,t)},t.prototype.sizeOfChildrenSelector=function(t){return Yn.sizeOf(this,t)},t.prototype.writeChildrenSelector=function(t,e){return Yn.write(e,this,t)},t.prototype.sizeOfThenChildrenSelector=function(t){return Yn.sizeOf(this,t)},t.prototype.writeThenChildrenSelector=function(t,e){return Yn.writeThen(e,this,t)},t.prototype.sizeOfDescendantsSelector=function(t){return Zn.sizeOf(this,t)},t.prototype.writeDescendantsSelector=function(t,e){return Zn.write(e,this,t)},t.prototype.sizeOfThenDescendantsSelector=function(t){return Zn.sizeOf(this,t)},t.prototype.writeThenDescendantsSelector=function(t,e){return Zn.writeThen(e,this,t)},t.prototype.sizeOfFilterSelector=function(t,e){return Qn.sizeOf(this,t,e)},t.prototype.writeFilterSelector=function(t,e,r){return Qn.write(r,this,t,e)},t.prototype.sizeOfThenFilterSelector=function(t,e){return Qn.sizeOfThen(this,t,e)},t.prototype.writeThenFilterSelector=function(t,e,r){return Qn.writeThen(r,this,t,e)},t.prototype.sizeOfExtant=function(){return 0},t.prototype.writeExtant=function(t){return G.done()},t.prototype.sizeOfAbsent=function(){return 0},t.prototype.writeAbsent=function(t){return G.done()},t}(),Jn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isField=function(t){return t instanceof Jt},e.prototype.isAttr=function(t){return t instanceof ie},e.prototype.isSlot=function(t){return t instanceof ne},e.prototype.isValue=function(t){return t instanceof se},e.prototype.isRecord=function(t){return t instanceof ae},e.prototype.isText=function(t){return t instanceof de},e.prototype.isNum=function(t){return t instanceof ye},e.prototype.isBool=function(t){return t instanceof ve},e.prototype.isExpression=function(t){return t instanceof _e},e.prototype.isExtant=function(t){return t instanceof be},e.prototype.items=function(t){return t.iterator()},e.prototype.item=function(t){return t},e.prototype.key=function(t){return t.key},e.prototype.value=function(t){return t.toValue()},e.prototype.string=function(t){return t.stringValue("")},e.prototype.precedence=function(t){return t.precedence()},e.prototype.sizeOfItem=function(t){if(t instanceof Jt){if(t instanceof ie)return this.sizeOfAttr(t.key,t.value);if(t instanceof ne)return this.sizeOfSlot(t.key,t.value)}else if(t instanceof se)return this.sizeOfValue(t);throw new H("No Recon serialization for "+t)},e.prototype.writeItem=function(t,e){if(t instanceof Jt){if(t instanceof ie)return this.writeAttr(t.key,t.value,e);if(t instanceof ne)return this.writeSlot(t.key,t.value,e)}else if(t instanceof se)return this.writeValue(t,e);return G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfValue=function(t){if(t instanceof ae)return this.sizeOfRecord(t);if(t instanceof ce)return this.sizeOfData(t.size);if(t instanceof de)return this.sizeOfText(t.value);if(t instanceof ye)return t.isUint32()?this.sizeOfUint32(t.value):t.isUint64()?this.sizeOfUint64(t.value):this.sizeOfNum(t.value);if(t instanceof ve)return this.sizeOfBool(t.value);if(t instanceof we)return this.sizeOfSelector(t);if(t instanceof me)return this.sizeOfOperator(t);if(t instanceof ge)return this.sizeOfFunc(t);if(t instanceof be)return this.sizeOfExtant();if(t instanceof xe)return this.sizeOfAbsent();throw new H("No Recon serialization for "+t)},e.prototype.writeValue=function(t,e){return t instanceof ae?this.writeRecord(t,e):t instanceof ce?this.writeData(t.asUint8Array(),e):t instanceof de?this.writeText(t.value,e):t instanceof ye?t.isUint32()?this.writeUint32(t.value,e):t.isUint64()?this.writeUint64(t.value,e):this.writeNum(t.value,e):t instanceof ve?this.writeBool(t.value,e):t instanceof we?this.writeSelector(t,e):t instanceof me?this.writeOperator(t,e):t instanceof ge?this.writeFunc(t,e):t instanceof be?this.writeExtant(e):t instanceof xe?this.writeAbsent(e):G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfSelector=function(t){if(t instanceof Ye)return this.sizeOfIdentitySelector();if(t instanceof nr)return this.sizeOfLiteralSelector(t.item(),t.then());if(t instanceof Ze)return this.sizeOfGetSelector(t.accessor(),t.then());if(t instanceof Qe)return this.sizeOfGetAttrSelector(t.accessor(),t.then());if(t instanceof $e)return this.sizeOfGetItemSelector(t.accessor(),t.then());if(t instanceof Je)return this.sizeOfKeysSelector(t.then());if(t instanceof tr)return this.sizeOfValuesSelector(t.then());if(t instanceof er)return this.sizeOfChildrenSelector(t.then());if(t instanceof rr)return this.sizeOfDescendantsSelector(t.then());if(t instanceof ir)return this.sizeOfFilterSelector(t.predicate(),t.then());throw new H("No Recon serialization for "+t)},e.prototype.writeSelector=function(t,e){return t instanceof Ye?this.writeIdentitySelector(e):t instanceof nr?this.writeLiteralSelector(t.item(),t.then(),e):t instanceof Ze?this.writeGetSelector(t.accessor(),t.then(),e):t instanceof Qe?this.writeGetAttrSelector(t.accessor(),t.then(),e):t instanceof $e?this.writeGetItemSelector(t.accessor(),t.then(),e):t instanceof Je?this.writeKeysSelector(t.then(),e):t instanceof tr?this.writeValuesSelector(t.then(),e):t instanceof er?this.writeChildrenSelector(t.then(),e):t instanceof rr?this.writeDescendantsSelector(t.then(),e):t instanceof ir?this.writeFilterSelector(t.predicate(),t.then(),e):G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfOperator=function(t){if(t instanceof Ae)return this.sizeOfInfixOperator(t.operand1(),t.operator(),t.operand2(),t.precedence());if(t instanceof ke)return this.sizeOfPrefixOperator(t.operator(),t.operand(),t.precedence());if(t instanceof Xe)return this.sizeOfInvokeOperator(t.func(),t.args());if(t instanceof Ee)return this.sizeOfConditionalOperator(t.ifTerm(),t.thenTerm(),t.elseTerm(),t.precedence());throw new H("No Recon serialization for "+t)},e.prototype.writeOperator=function(t,e){return t instanceof Ae?this.writeInfixOperator(t.operand1(),t.operator(),t.operand2(),t.precedence(),e):t instanceof ke?this.writePrefixOperator(t.operator(),t.operand(),t.precedence(),e):t instanceof Xe?this.writeInvokeOperator(t.func(),t.args(),e):t instanceof Ee?this.writeConditionalOperator(t.ifTerm(),t.thenTerm(),t.elseTerm(),t.precedence(),e):G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfFunc=function(t){if(t instanceof or)return this.sizeOfLambdaFunc(t.bindings(),t.template());if(t instanceof sr)return 0;throw new H("No Recon serialization for "+t)},e.prototype.writeFunc=function(t,e){return t instanceof or?this.writeLambdaFunc(t.bindings(),t.template(),e):t instanceof sr?G.done():G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfBlockItem=function(t){if(t instanceof Jt)return this.sizeOfItem(t);if(t instanceof se)return this.sizeOfBlockValue(t);throw new H("No Recon serialization for "+t)},e.prototype.writeBlockItem=function(t,e){return t instanceof Jt?this.writeItem(t,e):t instanceof se?this.writeBlockValue(t,e):G.error(new H("No Recon serialization for "+t))},e.prototype.sizeOfBlockValue=function(t){return t instanceof ae?this.sizeOfBlock(t):this.sizeOfValue(t)},e.prototype.writeBlockValue=function(t,e){return t instanceof ae?this.writeBlock(t,e):this.writeValue(t,e)},e.prototype.sizeOfThen=function(t){if(t instanceof we){if(t instanceof Ye)return this.sizeOfThenIdentitySelector();if(t instanceof nr)return this.sizeOfThenLiteralSelector(t.item(),t.then());if(t instanceof Ze)return this.sizeOfThenGetSelector(t.accessor(),t.then());if(t instanceof Qe)return this.sizeOfThenGetAttrSelector(t.accessor(),t.then());if(t instanceof $e)return this.sizeOfThenGetItemSelector(t.accessor(),t.then());if(t instanceof Je)return this.sizeOfThenKeysSelector(t.then());if(t instanceof tr)return this.sizeOfThenValuesSelector(t.then());if(t instanceof er)return this.sizeOfThenChildrenSelector(t.then());if(t instanceof rr)return this.sizeOfThenDescendantsSelector(t.then());if(t instanceof ir)return this.sizeOfThenFilterSelector(t.predicate(),t.then())}throw new H("No Recon serialization for "+t)},e.prototype.writeThen=function(t,e){if(t instanceof we){if(t instanceof Ye)return this.writeThenIdentitySelector(e);if(t instanceof nr)return this.writeThenLiteralSelector(t.item(),t.then(),e);if(t instanceof Ze)return this.writeThenGetSelector(t.accessor(),t.then(),e);if(t instanceof Qe)return this.writeThenGetAttrSelector(t.accessor(),t.then(),e);if(t instanceof $e)return this.writeThenGetItemSelector(t.accessor(),t.then(),e);if(t instanceof Je)return this.writeThenKeysSelector(t.then(),e);if(t instanceof tr)return this.writeThenValuesSelector(t.then(),e);if(t instanceof er)return this.writeThenChildrenSelector(t.then(),e);if(t instanceof rr)return this.writeThenDescendantsSelector(t.then(),e);if(t instanceof ir)return this.writeThenFilterSelector(t.predicate(),t.then(),e)}return G.error(new H("No Recon serialization for "+t))},e}($n),to=function(){function t(){}return t.isSpace=function(t){return 32===t||9===t},t.isNewline=function(t){return 10===t||13===t},t.isWhitespace=function(e){return t.isSpace(e)||t.isNewline(e)},t.isIdentStartChar=function(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},t.isIdentChar=function(t){return 45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},t.structureParser=function(){return t._structureParser||(t._structureParser=new Vn),t._structureParser},t.structureWriter=function(){return t._structureWriter||(t._structureWriter=new Jn),t._structureWriter},t.parse=function(e){return t.structureParser().parseBlockString(e)},t.parser=function(){return t.structureParser().blockParser()},t.sizeOf=function(e){return t.structureWriter().sizeOfItem(e)},t.sizeOfBlock=function(e){return t.structureWriter().sizeOfBlockItem(e)},t.write=function(e,r){return t.structureWriter().writeItem(e,r)},t.writeBlock=function(e,r){return t.structureWriter().writeBlockItem(e,r)},t.toString=function(e){var r=$.stringOutput();return t.write(e,r),r.bind()},t.toBlockString=function(e){var r=$.stringOutput();return t.writeBlock(e,r),r.bind()},t.toData=function(e){var r=At.encodedOutput(ce.output());return t.write(e,r),r.bind()},t.toBlockData=function(e){var r=At.encodedOutput(ce.output());return t.writeBlock(e,r),r.bind()},t}();$t.prototype.toRecon=function(){return to.toString(this)},$t.prototype.toReconBlock=function(){return to.toBlockString(this)},se.parseRecon=function(t){return to.parse(t)};var eo={fromAny:function(t){if(t instanceof eo.R2)return t;if("object"==typeof t&&t){if(Array.isArray(t)){if(2===t.length)return new eo.R2.Point(t[0],t[1]);throw new TypeError(""+t)}var e=t;if("number"==typeof e.x&&"number"==typeof e.y)return new eo.R2.Point(e.x,e.y);var r=t;if("number"==typeof r.x0&&"number"==typeof r.y0&&"number"==typeof r.x1&&"number"==typeof r.y1)return new eo.R2.Segment(r.x0,r.y0,r.x1,r.y1);var i=t;if("number"==typeof i.xMin&&"number"==typeof i.yMin&&"number"==typeof i.xMax&&"number"==typeof i.yMax)return new eo.R2.Box(i.xMin,i.yMin,i.xMax,i.yMax);var n=t;if("number"==typeof n.cx&&"number"==typeof n.cy&&"number"==typeof n.r)return new eo.R2.Circle(n.cx,n.cy,n.r)}throw new TypeError(""+t)},is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.contains&&"function"==typeof e.intersects}return!1},R2:void 0},ro=function(){function t(){}return t.prototype.union=function(e){return e=t.fromAny(e),new t.Box(Math.min(this.xMin,e.xMin),Math.min(this.yMin,e.yMin),Math.max(this.xMax,e.xMax),Math.max(this.yMax,e.yMax))},t.fromAny=function(t){return eo.fromAny(t)},t}();eo.R2=ro;var io=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.plus=function(e){return new t(this._x+e.x,this._y+e.y)},t.prototype.opposite=function(){return new t(-this._x,-this._y)},t.prototype.minus=function(e){return new t(this._x-e.x,this._y-e.y)},t.prototype.times=function(e){return new t(this._x*e,this._y*e)},t.prototype.toAny=function(){return{x:this._x,y:this._y}},t.prototype.canEqual=function(t){return!0},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this._x===e._x&&this._y===e._y)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(c.mix(t._hashSeed,c.hash(this._x)),c.hash(this._y)))},t.prototype.debug=function(t){t.write("VectorR2").write(46).write("of").write(40).debug(this._x).write(", ").debug(this._y).write(41)},t.prototype.toString=function(){return J.debug(this)},t.zero=function(){return void 0===t._zero&&(t._zero=new t(0,0)),t._zero},t.of=function(e,r){return new t(e,r)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return new t(e.x,e.y);throw new TypeError(""+e)},t}(),no=function(t){function e(e,r){var i=t.call(this)||this;return i._x=e,i._y=r,i}return _(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMin",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.plus=function(t){return new e(this._x+t.x,this._y+t.y)},e.prototype.minus=function(t){var r=this._x-t._x,i=this._y-t._y;return t instanceof io?new e(r,i):new io(r,i)},e.prototype.contains=function(t,r){return"number"==typeof t?this._x===t&&this._y===r:(t=eo.fromAny(t))instanceof e?this._x===t._x&&this._y===t._y:t instanceof ro&&(this._x<=t.xMin&&t.xMax<=this._x&&this._y<=t.yMin&&t.yMax<=this._y)},e.prototype.intersects=function(t){return(t=eo.fromAny(t)).intersects(this)},e.prototype.transform=function(t){return new e(t.transformX(this.x,this.y),t.transformY(this.x,this.y))},e.prototype.toAny=function(){return{x:this._x,y:this._y}},e.prototype.canEqual=function(t){return!0},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this._x===t._x&&this._y===t._y)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,c.hash(this._x)),c.hash(this._y)))},e.prototype.debug=function(t){t.write("PointR2").write(46).write("of").write(40).debug(this._x).write(", ").debug(this._y).write(41)},e.prototype.toString=function(){return J.debug(this)},e.origin=function(){return void 0===e._origin&&(e._origin=new e(0,0)),e._origin},e.of=function(t,r){return new e(t,r)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=void 0,i=void 0;return Array.isArray(t)?(r=t[0],i=t[1]):(r=t.x,i=t.y),new e(r,i)}throw new TypeError(""+t)},e}(ro);ro.Point=no;var oo=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._x0=e,o._y0=r,o._x1=i,o._y1=n,o}return _(e,t),Object.defineProperty(e.prototype,"x0",{get:function(){return this._x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y0",{get:function(){return this._y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMin",{get:function(){return Math.min(this._x0,this._x1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return Math.min(this._y0,this._y1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return Math.max(this._x0,this._x1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return Math.max(this._y0,this._y1)},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,r){if("number"==typeof t)return e.contains(this._x0,this._y0,this._x1,this._y1,t,r);if((t=eo.fromAny(t))instanceof ro){if(t instanceof no)return this.containsPoint(t);if(t instanceof e)return this.containsSegment(t)}return!1},e.prototype.containsPoint=function(t){return e.contains(this._x0,this._y0,this._x1,this._y1,t._x,t._y)},e.prototype.containsSegment=function(t){return e.contains(this._x0,this._y0,this._x1,this._y1,t._x0,t._y0)&&e.contains(this._x0,this._y0,this._x1,this._y1,t._x1,t._y1)},e.prototype.intersects=function(t){return(t=eo.fromAny(t))instanceof ro&&(t instanceof no?this.intersectsPoint(t):t instanceof e?this.intersectsSegment(t):t.intersects(this))},e.prototype.intersectsPoint=function(t){return e.contains(this._x0,this._y0,this._x1,this._y1,t._x,t._y)},e.prototype.intersectsSegment=function(t){return e.intersects(this._x0,this._y0,this._x1-this._x0,this._y1-this._y0,t._x0,t._y0,t._x1-t._x0,t._y1-t._y0)},e.prototype.transform=function(t){return new e(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1))},e.contains=function(t,e,r,i,n,o){return(t<=n&&n<=r||r<=n&&n<=t)&&(e<=o&&o<=i||i<=o&&o<=e)&&(r-t)*(o-e)==(n-t)*(i-e)},e.intersects=function(t,e,r,i,n,o,s,u){var a=n-t,h=o-e,p=a*i-h*r,l=r*u-i*s;if(0===p&&0===l){var c=r*r+i*i,f=s*r+u*i,d=(a*r+h*i)/c,y=d+f/c;return f>=0?0<y&&d<1:0<d&&y<1}if(0===l)return!1;var v=(a*u-h*s)/l,_=p/l;return 0<=v&&v<=1&&0<=_&&_<=1},e.prototype.toAny=function(){return{x0:this._x0,y0:this._y0,x1:this._x1,y1:this._y1}},e.prototype.canEqual=function(t){return!0},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this._x0===t._x0&&this._y0===t._y0&&this._x1===t._x1&&this._y1===t._y1)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this._x0)),c.hash(this._y0)),c.hash(this._x1)),c.hash(this._y1)))},e.prototype.debug=function(t){t.write("SegmentR2").write(46).write("of").write(40).debug(this._x0).write(", ").debug(this._y0).write(", ").debug(this._x1).write(", ").debug(this._y1).write(41)},e.prototype.toString=function(){return J.debug(this)},e.of=function(t,r,i,n){return new e(t,r,i,n)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t)return new e(t.x0,t.y0,t.x1,t.y1);throw new TypeError(""+t)},e}(ro);ro.Segment=oo;var so=function(t){function e(e,r,i){var n=t.call(this)||this;return n._cx=e,n._cy=r,n._r=i,n}return _(e,t),Object.defineProperty(e.prototype,"cx",{get:function(){return this._cx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cy",{get:function(){return this._cy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this._r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMin",{get:function(){return this._cx-this._r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this._cy-this._r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this._cx+this._r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this._cy+this._r},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,r){if("number"==typeof t){var i=t-this._cx,n=r-this._cy;return i*i+n*n<=this._r*this._r}if((t=eo.fromAny(t))instanceof ro){if(t instanceof no)return this.containsPoint(t);if(t instanceof oo)return this.containsSegment(t);if(t instanceof uo)return this.containsBox(t);if(t instanceof e)return this.containsCircle(t)}return!1},e.prototype.containsPoint=function(t){var e=t._x-this._cx,r=t._y-this._cy;return e*e+r*r<=this._r*this._r},e.prototype.containsSegment=function(t){var e=t._x0-this._cx,r=t._y0-this._cy,i=t._x1-this._cx,n=t._y1-this._cy,o=this._r*this._r;return e*e+r*r<=o&&i*i+n*n<=o},e.prototype.containsBox=function(t){var e=t._xMin-this._cx,r=t._yMin-this._cy,i=t._xMax-this._cx,n=t._yMax-this._cy,o=this._r*this._r;return e*e+r*r<=o&&e*e+n*n<=o&&i*i+r*r<=o&&i*i+n*n<=o},e.prototype.containsCircle=function(t){var e=t._cx-this._cx,r=t._cy-this._cy;return e*e+r*r+t._r*t._r<=this._r*this._r},e.prototype.intersects=function(t){return(t=eo.fromAny(t))instanceof ro&&(t instanceof no?this.intersectsPoint(t):t instanceof oo?this.intersectsSegment(t):t instanceof uo?this.intersectsBox(t):t instanceof e?this.intersectsCircle(t):t.intersects(this))},e.prototype.intersectsPoint=function(t){var e=t._x-this._cx,r=t._y-this._cy;return e*e+r*r<=this._r*this._r},e.prototype.intersectsSegment=function(t){var e=this._cx,r=this._cy,i=this._r,n=t._x0,o=t._y0,s=t._x1,u=t._y1,a=s-n,h=u-o,p=Math.sqrt(a*a+h*h),l=a/p,c=h/p,f=(e-n)*c-(r-o)*l;if(f<-i||i<f)return!1;var d=n-e,y=o-r,v=s-e,_=u-r,m=i*i;if(d*d+y*y<=m||v*v+_*_<=m)return!0;var w=l*e+c*r,g=l*n+c*o,b=l*s+c*u;return g<w&&w<=b||b<w&&w<=g},e.prototype.intersectsBox=function(t){var e=(this._cx<t._xMin?t._xMin:t._xMax<this._cx?t._xMax:this._cx)-this._cx,r=(this._cy<t._yMin?t._yMin:t._yMax<this._cy?t._yMax:this._cy)-this._cy;return e*e+r*r<=this._r*this._r},e.prototype.intersectsCircle=function(t){var e=t._cx-this._cx,r=t._cy-this._cy,i=this._r+t._r;return e*e+r*r<=i*i},e.prototype.transform=function(t){var r=t.transformX(this.cx,this.cy),i=t.transformY(this.cx,this.cy),n=t.transformX(this.cx+this.r,this.cy)-r,o=t.transformY(this.cx+this.r,this.cy)-i;return new e(r,i,Math.sqrt(n*n+o*o))},e.prototype.toAny=function(){return{cx:this._cx,cy:this._cy,r:this._r}},e.prototype.canEqual=function(t){return!0},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this._cx===t._cx&&this._cy===t._cy&&this._r===t._r)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this._cx)),c.hash(this._cy)),c.hash(this._r)))},e.prototype.debug=function(t){t.write("CircleR2").write(46).write("of").write(40).debug(this._cx).write(", ").debug(this._cy).write(", ").debug(this._r).write(41)},e.prototype.toString=function(){return J.debug(this)},e.of=function(t,r,i){return new e(t,r,i)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t)return new e(t.cx,t.cy,t.r);throw new TypeError(""+t)},e}(ro);ro.Circle=so;var uo=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._xMin=e<=i?e:i,o._yMin=r<=n?r:n,o._xMax=e<=i?i:e,o._yMax=r<=n?n:r,o}return _(e,t),Object.defineProperty(e.prototype,"xMin",{get:function(){return this._xMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this._yMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this._xMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this._yMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._xMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._yMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._xMax-this._xMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._yMax-this._yMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._yMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._xMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._yMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._xMin},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,r){return"number"==typeof t?this._xMin<=t&&t<=this._xMax&&this._yMin<=r&&r<=this._yMax:(t=eo.fromAny(t))instanceof ro&&(t instanceof no?this.containsPoint(t):t instanceof oo?this.containsSegment(t):t instanceof e?this.containsBox(t):t instanceof so?this.containsCircle(t):this._xMin<=t.xMin&&t.xMax<=this._xMax&&this._yMin<=t.yMin&&t.yMax<=this._yMax)},e.prototype.containsPoint=function(t){return this._xMin<=t._x&&t._x<=this._xMax&&this._yMin<=t._y&&t._y<=this._yMax},e.prototype.containsSegment=function(t){return this._xMin<=t._x0&&t._x0<=this._xMax&&this._yMin<=t._y0&&t._y0<=this._yMax&&this._xMin<=t._x1&&t._x1<=this._xMax&&this._yMin<=t._y1&&t._y1<=this._yMax},e.prototype.containsBox=function(t){return this._xMin<=t._xMin&&t._xMax<=this._xMax&&this._yMin<=t._yMin&&t._yMax<=this._yMax},e.prototype.containsCircle=function(t){return this._xMin<=t._cx-t._r&&t._cx+t._r<=this._xMax&&this._yMin<=t._cy-t._r&&t._cy+t._r<=this._yMax},e.prototype.intersects=function(t){return(t=eo.fromAny(t))instanceof ro&&(t instanceof no?this.intersectsPoint(t):t instanceof oo?this.intersectsSegment(t):t instanceof e?this.intersectsBox(t):t instanceof so?this.intersectsCircle(t):t.intersects(this))},e.prototype.intersectsPoint=function(t){return this._xMin<=t._x&&t._x<=this._xMax&&this._yMin<=t._y&&t._y<=this._yMax},e.prototype.intersectsSegment=function(t){var r=this._xMin,i=this._yMin,n=this._xMax,o=this._yMax,s=t._x0,u=t._y0,a=t._x1,h=t._y1;return!(s<r&&a<r||s>n&&a>n||u<i&&h<i||u>o&&h>o)&&(s>r&&s<n&&u>i&&u<o||!!(e.intersectsSegment(s-r,a-r,s,u,a,h)&&e._hitY>i&&e._hitY<o||e.intersectsSegment(u-i,h-i,s,u,a,h)&&e._hitX>r&&e._hitX<n||e.intersectsSegment(s-n,a-n,s,u,a,h)&&e._hitY>i&&e._hitY<o||e.intersectsSegment(u-o,h-o,s,u,a,h)&&e._hitX>r&&e._hitX<n))},e.intersectsSegment=function(t,r,i,n,o,s){if(t!==r||t*r<0){var u=-t/(r-t);return e._hitX=i+(o-i)*u,e._hitY=n+(s-n)*u,!0}return!1},e.prototype.intersectsBox=function(t){return this._xMin<=t._xMax&&t._xMin<=this._xMax&&this._yMin<=t._yMax&&t._yMin<=this._yMax},e.prototype.intersectsCircle=function(t){var e=(t._cx<this._xMin?this._xMin:this._xMax<t._cx?this._xMax:t._cx)-t._cx,r=(t._cy<this._yMin?this._yMin:this._yMax<t._cy?this._yMax:t._cy)-t._cy;return e*e+r*r<=t._r*t._r},e.prototype.union=function(e){return t.prototype.union.call(this,e)},e.prototype.transform=function(t){return new e(t.transformX(this.xMin,this.yMin),t.transformY(this.xMin,this.yMin),t.transformX(this.xMax,this.yMax),t.transformY(this.xMax,this.yMax))},e.prototype.toAny=function(){return{xMin:this._xMin,yMin:this._yMin,xMax:this._xMax,yMax:this._yMax}},e.prototype.canEqual=function(t){return!0},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this._xMin===t._xMin&&this._yMin===t._yMin&&this._xMax===t._xMax&&this._yMax===t._yMax)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this.xMin)),c.hash(this.yMin)),c.hash(this.xMax)),c.hash(this.yMax)))},e.prototype.debug=function(t){t.write("BoxR2").write(46).write("of").write(40).debug(this.xMin).write(", ").debug(this.yMin).write(", ").debug(this.xMax).write(", ").debug(this.yMax).write(41)},e.prototype.toString=function(){return J.debug(this)},e.empty=function(){return e._empty||(e._empty=new e(0,0,0,0)),e._empty},e.of=function(t,r,i,n){return new e(t,r,i,n)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t)return new e(t.xMin,t.yMin,t.xMax,t.yMax);throw new TypeError(""+t)},e._hitX=0,e._hitY=0,e}(ro);ro.Box=uo;var ao=function(){function t(t,e){this._name=t,this._offset=e}return t.prototype.isUTC=function(){return 0===this._offset},t.prototype.isLocal=function(){return this._offset===-(new Date).getTimezoneOffset()},t.prototype.name=function(){return this._name},t.prototype.offset=function(){return this._offset},t.prototype.equals=function(e){return this===e||e instanceof t&&this._offset===e._offset},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(t._hashSeed,c.hash(this._offset)))},t.prototype.debug=function(t){t=t.write("TimeZone").write(46),t="UTC"===this._name&&0===this._offset?t.write("utc").write(40).write(41):void 0===this._name?t.write("forOffset").write(40).debug(this._offset).write(41):t.write("from").write(40).debug(this._name).write(", ").debug(this._offset).write(41)},t.prototype.toString=function(){return J.debug(this)},t.utc=function(){return t._utc||(t._utc=new t("UTC",0)),t._utc},t.local=function(){return t._local||(t._local=t.forOffset(-(new Date).getTimezoneOffset())),t._local},t.forName=function(e){switch(e){case"UTC":return t.utc();default:return}},t.forOffset=function(e){switch(e){case 0:return t.utc();default:return new t(void 0,e)}},t.from=function(e,r){return"UTC"===e&&0===r?t.utc():new t(e,r)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e){var r=t.forName(e);if(void 0!==r)return r}else if("number"==typeof e)return t.forOffset(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.stringValue(void 0);if(void 0!==r)return t.forName(r);var i=e.numberValue(void 0);return void 0!==i?t.forOffset(i):void 0},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),e!==t.utc()?new t.Form(e):(t._form||(t._form=new t.Form(t.utc())),t._form)},t}(),ho=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){var e=(t=ao.fromAny(t)).name();return void 0!==e?de.from(e):ye.from(t._offset)},e.prototype.cast=function(t){var e=t.toValue();return ao.fromValue(e)},e}(Se);ao.Form=ho;var po=function(){function t(e,r,i,n,o){void 0===e&&(e=t.Periods),void 0===r&&(r=t.Weekdays),void 0===i&&(i=t.ShortWeekdays),void 0===n&&(n=t.Months),void 0===o&&(o=t.ShortMonths),this.periods=e,this.weekdays=r,this.shortWeekdays=i,this.months=n,this.shortMonths=o}return t.standard=function(){return t._standard||(t._standard=new t),t._standard},t.Periods=["AM","PM"],t.Weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.ShortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.ShortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t}(),lo=function(){function t(t,e){void 0===e&&(e=ao.utc()),this._time=t,this._zone=e}return t.prototype.time=function(e){return void 0===e?this._time:new t(e,this._zone)},t.prototype.zone=function(e){return void 0===e?this._zone:new t(this._time,e)},t.prototype.year=function(e,r,i,n,o,s,u){var a=this.toUTCLocalDate();return void 0===e?a.getUTCFullYear():(a.setUTCFullYear(e),void 0!==r&&a.setUTCMonth(r),void 0!==i&&a.setUTCDate(i),void 0!==n&&a.setUTCHours(n),void 0!==o&&a.setUTCMinutes(o),void 0!==s&&a.setUTCSeconds(s),void 0!==u&&a.setUTCMilliseconds(u),t.fromUTCLocalDate(a,this._zone))},t.prototype.month=function(e,r,i,n,o,s){var u=this.toUTCLocalDate();return void 0===e?u.getUTCMonth():(u.setUTCMonth(e),void 0!==r&&u.setUTCDate(r),void 0!==i&&u.setUTCHours(i),void 0!==n&&u.setUTCMinutes(n),void 0!==o&&u.setUTCSeconds(o),void 0!==s&&u.setUTCMilliseconds(s),t.fromUTCLocalDate(u,this._zone))},t.prototype.day=function(e,r,i,n,o){var s=this.toUTCLocalDate();return void 0===e?s.getUTCDate():(s.setUTCDate(e),void 0!==r&&s.setUTCHours(r),void 0!==i&&s.setUTCMinutes(i),void 0!==n&&s.setUTCSeconds(n),void 0!==o&&s.setUTCMilliseconds(o),t.fromUTCLocalDate(s,this._zone))},t.prototype.hour=function(e,r,i,n){var o=this.toUTCLocalDate();return void 0===e?o.getUTCHours():(o.setUTCHours(e),void 0!==r&&o.setUTCMinutes(r),void 0!==i&&o.setUTCSeconds(i),void 0!==n&&o.setUTCMilliseconds(n),t.fromUTCLocalDate(o,this._zone))},t.prototype.minute=function(e,r,i){var n=this.toUTCLocalDate();return void 0===e?n.getUTCMinutes():(n.setUTCMinutes(e),void 0!==r&&n.setUTCSeconds(r),void 0!==i&&n.setUTCMilliseconds(i),t.fromUTCLocalDate(n,this._zone))},t.prototype.second=function(e,r){var i=this.toUTCLocalDate();return void 0===e?i.getUTCSeconds():(i.setUTCSeconds(e),void 0!==r&&i.setUTCMilliseconds(r),t.fromUTCLocalDate(i,this._zone))},t.prototype.millisecond=function(e){var r=this.toUTCLocalDate();return void 0===e?r.getUTCMilliseconds():(r.setUTCMilliseconds(e),t.fromUTCLocalDate(r,this._zone))},t.prototype.weekday=function(){return this.toUTCLocalDate().getUTCDay()},t.prototype.toUTCLocalDate=function(){return new Date(this._time+6e4*this._zone._offset)},t.prototype.toDate=function(){return new Date(this._time)},t.prototype.valueOf=function(){return this._time},t.prototype.compareTo=function(e){var r=this._time,i=t.time(e);return r<i?-1:r>i?1:r===i?0:NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._time===e._time&&this._zone.equals(e._zone))},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(c.mix(t._hashSeed,c.hash(this._time)),this._zone.hashCode()))},t.prototype.display=function(e,r){void 0===r&&(r=t.Format.iso8601()),r.writeDate(this,e)},t.prototype.toString=function(e){return void 0===e&&(e=t.Format.iso8601()),e.format(this)},t.current=function(e){return e=void 0!==e?ao.fromAny(e):ao.local(),new t(Date.now(),e)},t.fromUTCLocalDate=function(e,r){return new t(e.getTime()-6e4*r._offset,r)},t.from=function(e,r){var i=Date.UTC(void 0!==e.year?e.year:1970,void 0!==e.month?e.month:0,void 0!==e.day?e.day:1,void 0!==e.hour?e.hour:0,void 0!==e.minute?e.minute:0,void 0!==e.second?e.second:0,void 0!==e.millisecond?e.millisecond:0);return void 0!==e.zone&&(r=ao.fromAny(e.zone)),void 0!==r?i+=6e4*(r=ao.fromAny(r))._offset:r=ao.utc(),new t(i,r)},t.fromAny=function(e,r){if(e instanceof t)return e;if(e instanceof Date)return r=void 0!==r?ao.fromAny(r):ao.utc(),new t(e.getTime(),r);if("number"==typeof e)return new t(e,r=void 0!==r?ao.fromAny(r):ao.utc());if("string"==typeof e)return t.parse(e,r);if(e&&"object"==typeof e)return t.from(e,r);throw new TypeError(""+e)},t.fromValue=function(e){var r,i=e.header("date");i.isDefined()?(e=i,r=!0):r=!1;var n={};if(e.forEach((function(t,e){var i=t.key.stringValue(void 0);void 0!==i?"year"===i?n.year=t.toValue().numberValue(n.year):"month"===i?n.month=t.toValue().numberValue(n.month):"day"===i?n.day=t.toValue().numberValue(n.day):"hour"===i?n.hour=t.toValue().numberValue(n.hour):"minute"===i?n.minute=t.toValue().numberValue(n.minute):"second"===i?n.second=t.toValue().numberValue(n.second):"millisecond"===i?n.millisecond=t.toValue().numberValue(n.millisecond):"zone"===i&&(n.zone=t.toValue().cast(ao.form(),n.zone)):t instanceof se&&r&&(0===e?n.year=t.numberValue(n.year):1===e?n.month=t.numberValue(n.month):2===e?n.day=t.numberValue(n.day):3===e?n.hour=t.numberValue(n.hour):4===e?n.minute=t.numberValue(n.minute):5===e?n.second=t.numberValue(n.second):6===e?n.millisecond=t.numberValue(n.millisecond):7===e&&(n.zone=t.cast(ao.form(),n.zone)))})),t.isInit(n))return t.from(n)},t.parse=function(e,r){return t.Format.iso8601().parse(e)},t.time=function(e){if(e instanceof t)return e._time;if(e instanceof Date)return e.getTime();if("number"==typeof e)return e;if("string"==typeof e)return t.parse(e).time();if(e&&"object"==typeof e)return t.from(e).time();throw new TypeError(""+e)},t.zone=function(e){return e instanceof t?e._zone:ao.utc()},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.year||void 0!==e.month||void 0!==e.day||void 0!==e.hour||void 0!==e.minute||void 0!==e.second||void 0!==e.millisecond}return!1},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),void 0!==e?new t.Form(e):(t._form||(t._form=new t.Form),t._form)},t}(),co=function(t){function e(e){var r=t.call(this)||this;return r.dateParser=e,r}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.dateParser)},e.parse=function(t,r){return(r=r.feed(t)).isDone()?ft.done(lo.fromAny(r.bind())):r.isError()?r.asError():new e(r)},e}(ft);lo.Parser=co;var fo=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?void 0!==this._unit?this._unit:new lo(0):new e(t)},e.prototype.mold=function(t){return t=lo.fromAny(t),de.from(t.toString())},e.prototype.cast=function(t){var e;try{if(!(e=lo.fromValue(t))){var r=t.numberValue(void 0);if(void 0!==r)e=new lo(r);else{var i=t.stringValue(void 0);void 0!==i&&(e=lo.parse(i))}}}catch(t){}return e},e}(Se);lo.Form=fo;var yo={_standard:void 0,standard:function(t){var e;return void 0===t&&(t=po.standard()),t===po.standard()&&(e=yo._standard),e||(e={Y:vo.year(),m:vo.monthOfYear(),B:vo.month(t),b:vo.shortMonth(t),d:vo.dayOfMonth(),A:vo.weekday(t),a:vo.shortWeekday(t),H:vo.hour24(),I:vo.hour12(),p:vo.period(t),M:vo.minute(),S:vo.second(),L:vo.millisecond()},t===po.standard()&&(yo._standard=e)),e}},vo=function(){function t(){}return t.prototype.format=function(t){t=lo.fromAny(t);var e=$.stringOutput();return this.writeDate(t,e),e.bind()},t.prototype.parse=function(t){for("string"==typeof t&&(t=$.stringInput(t));t.isCont()&&$.isSpace(t.head());)t=t.step();var e=this.parseDate(t,{});if(e.isDone())for(;t.isCont()&&$.isSpace(t.head());)t=t.step();return t.isCont()&&!e.isError()&&(e=ft.error(lt.unexpected(t))),e.bind()},t.prototype.parseDate=function(t,e){var r=this.parseDateTime(t,e);return r.isDone()?ft.done(lo.fromAny(r.bind())):r.isError()?r.asError():new lo.Parser(r)},t.year=function(){return t._year||(t._year=new t.Year),t._year},t.monthOfYear=function(){return t._monthOfYear||(t._monthOfYear=new t.MonthOfYear),t._monthOfYear},t.month=function(e){return void 0===e&&(e=po.standard()),e!==po.standard()?new t.Month(e):(t._month||(t._month=new t.Month(e)),t._month)},t.shortMonth=function(e){return void 0===e&&(e=po.standard()),e!==po.standard()?new t.ShortMonth(e):(t._shortMonth||(t._shortMonth=new t.ShortMonth(e)),t._shortMonth)},t.dayOfMonth=function(){return t._dayOfMonth||(t._dayOfMonth=new t.DayOfMonth),t._dayOfMonth},t.weekday=function(e){return void 0===e&&(e=po.standard()),e!==po.standard()?new t.Weekday(e):(t._weekday||(t._weekday=new t.Weekday(e)),t._weekday)},t.shortWeekday=function(e){return void 0===e&&(e=po.standard()),e!==po.standard()?new t.ShortWeekday(e):(t._shortWeekday||(t._shortWeekday=new t.ShortWeekday(e)),t._shortWeekday)},t.hour24=function(){return t._hour24||(t._hour24=new t.Hour24),t._hour24},t.hour12=function(){return t._hour12||(t._hour12=new t.Hour12),t._hour12},t.period=function(e){return void 0===e&&(e=po.standard()),e!==po.standard()?new t.Period(e):(t._period||(t._period=new t.Period(e)),t._period)},t.minute=function(){return t._minute||(t._minute=new t.Minute),t._minute},t.second=function(){return t._second||(t._second=new t.Second),t._second},t.millisecond=function(){return t._millisecond||(t._millisecond=new t.Millisecond),t._millisecond},t.pattern=function(e,r){return(!r||r instanceof po)&&(r=yo.standard(r)),new t.Pattern(e,r)},t.iso8601=function(){return t._iso8601||(t._iso8601=new t.Pattern("%Y-%m-%dT%H:%M:%S.%LZ",yo.standard())),t._iso8601},t.parseDateNumber=function(t,e,r,i,n,o,s,u){void 0===s&&(s=0),void 0===u&&(u=0);for(var a=0;u<n&&t.isCont()&&(a=t.head(),pt.isDigit(a));)t.step(),s=10*s+pt.decodeDigit(a),u+=1;return t.isEmpty()?e.cont(o||{},s,u,t):u>=i?e.bind(s,o||{},t):ft.error(lt.expected(r,t))},t.parseDateString=function(t,e,r,i,n){var o=0;for(n=n||$.stringOutput();;){if(!t.isCont()||(o=t.head(),!$.isAlpha(o))){if(!t.isEmpty())return e.bind(r,n.bind(),i||{},t);break}t.step(),n.write(o)}return e.cont(r,i||{},n,t)},t.writeDateNumber2=function(t,e){var r=48+t%10,i=48+(t/=10)%10;e=e.write(i).write(r)},t.writeDateNumber3=function(t,e){var r=48+t%10,i=48+(t/=10)%10,n=48+(t/=10)%10;e=e.write(n).write(i).write(r)},t.writeDateNumber4=function(t,e){var r=48+t%10,i=48+(t/=10)%10,n=48+(t/=10)%10,o=48+(t/=10)%10;e=e.write(o).write(n).write(i).write(r)},t}();lo.Format=vo;var _o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber4(t.year(),e)},e.prototype.parseDateTime=function(t,e){return vo.YearParser.parse(t,e)},e}(vo);vo.Year=_o;var mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.month()+1,e)},e.prototype.parseDateTime=function(t,e){return vo.MonthOfYearParser.parse(t,e)},e}(vo);vo.MonthOfYear=mo;var wo=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return _(e,t),e.prototype.writeDate=function(t,e){e.write(this.locale.months[t.month()])},e.prototype.parseDateTime=function(t,e){return vo.MonthParser.parse(t,this.locale,e)},e}(vo);vo.Month=wo;var go=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return _(e,t),e.prototype.writeDate=function(t,e){e.write(this.locale.shortMonths[t.month()])},e.prototype.parseDateTime=function(t,e){return vo.ShortMonthParser.parse(t,this.locale,e)},e}(vo);vo.ShortMonth=go;var bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.day(),e)},e.prototype.parseDateTime=function(t,e){return vo.DayOfMonthParser.parse(t,e)},e}(vo);vo.DayOfMonth=bo;var xo=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return _(e,t),e.prototype.writeDate=function(t,e){e.write(this.locale.weekdays[t.weekday()])},e.prototype.parseDateTime=function(t,e){return vo.WeekdayParser.parse(t,this.locale,e)},e}(vo);vo.Weekday=xo;var Co=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return _(e,t),e.prototype.writeDate=function(t,e){e.write(this.locale.shortWeekdays[t.weekday()])},e.prototype.parseDateTime=function(t,e){return vo.ShortWeekdayParser.parse(t,this.locale,e)},e}(vo);vo.ShortWeekday=Co;var So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.hour(),e)},e.prototype.parseDateTime=function(t,e){return vo.Hour24Parser.parse(t,e)},e}(vo);vo.Hour24=So;var Ao=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.hour()%12||12,e)},e.prototype.parseDateTime=function(t,e){return vo.Hour12Parser.parse(t,e)},e}(vo);vo.Hour12=Ao;var ko=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return _(e,t),e.prototype.writeDate=function(t,e){e.write(this.locale.periods[+(t.hour()>=12)])},e.prototype.parseDateTime=function(t,e){return vo.PeriodParser.parse(t,this.locale,e)},e}(vo);vo.Period=ko;var Eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.minute(),e)},e.prototype.parseDateTime=function(t,e){return vo.MinuteParser.parse(t,e)},e}(vo);vo.Minute=Eo;var Oo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber2(t.second(),e)},e.prototype.parseDateTime=function(t,e){return vo.SecondParser.parse(t,e)},e}(vo);vo.Second=Oo;var Vo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.writeDate=function(t,e){vo.writeDateNumber3(t.millisecond(),e)},e.prototype.parseDateTime=function(t,e){return vo.MillisecondParser.parse(t,e)},e}(vo);vo.Millisecond=Vo;var Po=function(t){function e(e,r){var i=t.call(this)||this;return i.pattern=e,i.specifiers=r,i}return _(e,t),e.prototype.writeDate=function(t,e){for(var r=this.pattern,i=this.specifiers,n=0,o=0,s=r.length;o<s;)if(37===r.charCodeAt(o)){n!==o&&e.write(r.slice(n,o));var u=i[r.charAt(o+1)];u&&u.writeDate(t,e),n=o+=2}else o+=1;n!==o&&e.write(r.slice(n,o))},e.prototype.parseDateTime=function(t,e){return vo.PatternParser.parse(t,this.pattern,this.specifiers,e)},e}(vo);vo.Pattern=Po;var Do=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.year=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.year,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"full year",4,4,r,i,n)},e.bind=function(t,e){return e.year=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.YearParser=Do;var Mo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.month=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.month,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"month number",2,2,r,i,n)},e.bind=function(t,e){return e.month=t-1,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.MonthOfYearParser=Mo;var To=function(t){function e(e,r,i){var n=t.call(this)||this;return n.locale=e,n.date=r,n.output=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,i,n){return vo.parseDateString(t,e,r,i,n)},e.bind=function(t,e,r,i){var n=t.months.indexOf(e);return n>=0?(r.month=n,ft.done(r)):ft.error(lt.message("expected month, but found "+e,i))},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.MonthParser=To;var Ro=function(t){function e(e,r,i){var n=t.call(this)||this;return n.locale=e,n.date=r,n.output=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,i,n){return vo.parseDateString(t,e,r,i,n)},e.bind=function(t,e,r,i){var n=t.shortMonths.indexOf(e);return n>=0?(r.month=n,ft.done(r)):ft.error(lt.message("expected short month, but found "+e,i))},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.ShortMonthParser=Ro;var Io=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.day=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.day,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"day of month",2,2,r,i,n)},e.bind=function(t,e){return e.day=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.DayOfMonthParser=Io;var Fo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.locale=e,n.date=r,n.output=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,i,n){return vo.parseDateString(t,e,r,i,n)},e.bind=function(t,e,r,i){return t.weekdays.indexOf(e)>=0?ft.done(r):ft.error(lt.message("expected weekday, but found "+e,i))},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.WeekdayParser=Fo;var Lo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.locale=e,n.date=r,n.output=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,i,n){return vo.parseDateString(t,e,r,i,n)},e.bind=function(t,e,r,i){return t.shortWeekdays.indexOf(e)>=0?ft.done(r):ft.error(lt.message("expected short weekday, but found "+e,i))},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.ShortWeekdayParser=Lo;var Uo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.hour=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"hour (24)",2,2,r,i,n)},e.bind=function(t,e){return e.hour=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.Hour24Parser=Uo;var No=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.hour=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"hour (12)",2,2,r,i,n)},e.bind=function(t,e){return e.hour=(e.hour||0)+t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.Hour12Parser=No;var zo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.locale=e,n.date=r,n.output=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,i,n){return vo.parseDateString(t,e,r,i,n)},e.bind=function(t,e,r,i){var n=t.months.indexOf(e);return n>=0?(r.hour=(r.hour||0)+12*n,ft.done(r)):ft.error(lt.message("expected period of day, but found "+e,i))},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.PeriodParser=zo;var jo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.minute=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.minute,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"minute",2,2,r,i,n)},e.bind=function(t,e){return e.minute=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.MinuteParser=jo;var Wo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.second=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.second,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"second",2,2,r,i,n)},e.bind=function(t,e){return e.second=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.SecondParser=Wo;var qo=function(t){function e(e,r,i){var n=t.call(this)||this;return n.date=e,n.millisecond=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.millisecond,this.step)},e.parse=function(t,r,i,n){return vo.parseDateNumber(t,e,"millisecond",1,3,r,i,n)},e.bind=function(t,e){return e.millisecond=t,ft.done(e)},e.cont=function(t,r,i){return new e(t,r,i)},e}(ft);vo.MillisecondParser=qo;var Bo=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.pattern=e,s.specifiers=r,s.date=i,s.dateParser=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.pattern,this.specifiers,this.date,this.dateParser,this.step)},e.parse=function(t,r,i,n,o,s){void 0===n&&(n={}),void 0===s&&(s=0);for(var u=r.length;s<u;){var a=r.charCodeAt(s);if(37===a){if(o)o=o.feed(t);else{var h=r.charAt(s+1),p=i[h];if(!p)return ft.error(lt.message("unknown format specifier: "+h,t));o=p.parseDateTime(t,n)}if(o.isDone()){n=o.bind(),o=void 0,s+=2;continue}if(o.isError())return o.asError()}else{if(t.isCont()){if(t.head()===a){t.step(),s+=1;continue}return ft.error(lt.expected(a,t))}if(!t.isEmpty())return ft.error(lt.unexpected(t))}break}return s===u?ft.done(n):new e(r,i,n,o,s)},e}(ft);vo.PatternParser=Bo;var Ko=function(){function t(){}return t.prototype.next=function(t,e){return this.floor(this.offset(t,e))},t.prototype.ceil=function(t){return t=t instanceof lo?t.time(t.time()-1):lo.time(t)-1,this.next(this.floor(t),1)},t.prototype.round=function(t){t=lo.fromAny(t);var e=this.floor(t),r=this.ceil(t);return t.time()-e.time()<r.time()-t.time()?e:r},t.prototype.range=function(t,e,r){t=this.ceil(t),e=lo.time(e);var i=[];if((r="number"==typeof r?Math.floor(r):1)>0)for(;t.time()<e;)i.push(t),t=this.next(t,r);return i},t.prototype.filter=function(e){return new t.Filter(this,e)},t.year=function(e){return t._year||(t._year=new t.Year),void 0===e?t._year:t._year.every(e)},t.month=function(e){return t._month||(t._month=new t.Month),void 0===e?t._month:t._month.every(e)},t.week=function(){return t._week||(t._week=new t.Week),t._week},t.day=function(e){return t._day||(t._day=new t.Day),void 0===e?t._day:t._day.every(e)},t.hour=function(e){return t._hour||(t._hour=new t.Hour),void 0===e?t._hour:t._hour.every(e)},t.minute=function(e){return t._minute||(t._minute=new t.Minute),void 0===e?t._minute:t._minute.every(e)},t.second=function(e){return t._second||(t._second=new t.Second),void 0===e?t._second:t._second.every(e)},t.millisecond=function(e){return t._millisecond||(t._millisecond=new t.Millisecond),void 0===e?t._millisecond:t._millisecond.every(e)},t.years=function(e,r,i){return t.year().range(e,r,i)},t.months=function(e,r,i){return t.month().range(e,r,i)},t.weeks=function(e,r,i){return t.week().range(e,r,i)},t.days=function(e,r,i){return t.day().range(e,r,i)},t.hours=function(e,r,i){return t.hour().range(e,r,i)},t.minutes=function(e,r,i){return t.minute().range(e,r,i)},t.seconds=function(e,r,i){return t.second().range(e,r,i)},t.milliseconds=function(e,r,i){return t.millisecond().range(e,r,i)},t}(),Ho=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(Ko),Go=function(t){function e(e,r){var i=t.call(this)||this;return i.unit=e,i.predicate=r,i}return _(e,t),e.prototype.offset=function(t,e){for(t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);e<0;){do{t=this.unit.offset(t,-1)}while(!this.predicate(t));e+=1}for(;e>0;){do{t=this.unit.offset(t,1)}while(!this.predicate(t));e-=1}return t},e.prototype.floor=function(t){for(t=lo.fromAny(t);t=this.unit.floor(t),!this.predicate(t);)t=t.time(t.time()-1);return t},e}(Ko);Ko.Filter=Go;var Xo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t=t.year(t.year()+e)},e.prototype.next=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.year(t.year()+e).month(0,1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=lo.fromAny(t)).month(0,1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=lo.fromAny(t)).time(t.time()-1)).month(0,1).hour(0,0,0,0)).year(t.year()+1)).month(0,1).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Years(t);throw new Error(""+t)},e}(Ho);Ko.Year=Xo;var Yo=function(t){function e(e){var r=t.call(this)||this;return r.stride=e||1,r}return _(e,t),e.prototype.offset=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.year(t.year()+e*this.stride)},e.prototype.next=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.year(Math.floor((t.year()+e*this.stride)/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=(t=lo.fromAny(t)).year(Math.floor(t.year()/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=(t=lo.fromAny(t)).time(t.time()-1)).year(Math.floor(t.year()/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)).year(Math.floor((t.year()+this.stride)/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e}(Ko);Ko.Years=Yo;var Zo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.month(t.month()+e)},e.prototype.next=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.month(t.month()+e)).day(1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=lo.fromAny(t)).day(1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=lo.fromAny(t)).time(t.time()-1)).day(1).hour(0,0,0,0)).month(t.month()+1)).day(1).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Filter(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){return e.month()%t==0},e}(Ho);Ko.Month=Zo;var Qo=function(t){function e(e){void 0===e&&(e=0);var r=t.call(this)||this;return r.day=e,r}return _(e,t),e.prototype.offset=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.day(t.day()+7*e)},e.prototype.next=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=(t=t.day(t.day()+7*e)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=(t=lo.fromAny(t)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=(t=lo.fromAny(t)).time(t.time()-1)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)).day(t.day()+7)).hour(0,0,0,0)},e}(Ko);Ko.Week=Qo;var $o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.day(t.day()+e)},e.prototype.next=function(t,e){return t=lo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.day(t.day()+e)).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=lo.fromAny(t)).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=lo.fromAny(t)).time(t.time()-1)).hour(0,0,0,0)).day(t.day()+1)).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Filter(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){return e.day()%t==0},e}(Ho);Ko.Day=$o;var Jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new lo(t+=36e5*e,r)},e.prototype.next=function(t,e){var r=lo.zone(t);t=lo.time(t),t+=36e5*(e=Math.max(1,"number"==typeof e?Math.floor(e):1));var i=6e4*r.offset()%36e5;return i<0&&(i+=36e5),t=36e5*Math.floor((t-i)/36e5)+i,new lo(t,r)},e.prototype.floor=function(t){var e=lo.zone(t);t=lo.time(t);var r=6e4*e.offset()%36e5;return r<0&&(r+=36e5),t=36e5*Math.floor((t-r)/36e5)+r,new lo(t,e)},e.prototype.ceil=function(t){var e=lo.zone(t);t=lo.time(t),t-=1;var r=6e4*e.offset()%36e5;return r<0&&(r+=36e5),t=36e5*Math.floor((t-r)/36e5)+r+36e5,t=36e5*Math.floor((t-r)/36e5)+r,new lo(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Filter(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){return e.hour()%t==0},e}(Ho);Ko.Hour=Jo;var ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new lo(t+=6e4*e,r)},e.prototype.next=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t=6e4*Math.floor((t+6e4*e)/6e4),new lo(t,r)},e.prototype.floor=function(t){var e=lo.zone(t);return t=lo.time(t),t=6e4*Math.floor(t/6e4),new lo(t,e)},e.prototype.ceil=function(t){var e=lo.zone(t);return t=lo.time(t),t=6e4*Math.floor((6e4*Math.floor((t-1)/6e4)+6e4)/6e4),new lo(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Filter(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){return e.minute()%t==0},e}(Ho);Ko.Minute=ts;var es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new lo(t+=1e3*e,r)},e.prototype.next=function(t,e){var r=lo.zone(t);return t=lo.time(t),t+=1e3*(e=Math.max(1,"number"==typeof e?Math.floor(e):1)),t=1e3*Math.floor(t/1e3),new lo(t,r)},e.prototype.floor=function(t){var e=lo.zone(t);return t=lo.time(t),t=1e3*Math.floor(t/1e3),new lo(t,e)},e.prototype.ceil=function(t){var e=lo.zone(t);return t=lo.time(t),t=1e3*Math.floor((1e3*Math.floor((t-1)/1e3)+1e3)/1e3),new lo(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Filter(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){return e.second()%t==0},e}(Ho);Ko.Second=es;var rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.offset=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new lo(t+=e,r)},e.prototype.next=function(t,e){var r=lo.zone(t);return t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new lo(t+=e,r)},e.prototype.floor=function(t){return lo.fromAny(t)},e.prototype.ceil=function(t){return lo.fromAny(t)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ko.Milliseconds(t);throw new Error(""+t)},e}(Ho);Ko.Millisecond=rs;var is=function(t){function e(e){var r=t.call(this)||this;return"number"==typeof e&&isFinite(e)&&!isNaN(e)||(e=1),r.stride=e,r}return _(e,t),e.prototype.offset=function(t,e){var r=lo.zone(t);return t=lo.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*this.stride,new lo(t,r)},e.prototype.next=function(t,e){var r=lo.zone(t);t=lo.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);var i=this.stride;return t=Math.floor((t+e*i)/i)*i,new lo(t,r)},e.prototype.floor=function(t){var e=lo.zone(t);t=lo.time(t);var r=this.stride;return t=Math.floor(t/r)*r,new lo(t,e)},e.prototype.ceil=function(t){var e=lo.zone(t);t=lo.time(t);var r=this.stride;return t=Math.floor((Math.floor((t-1)/r)*r+r)/r)*r,new lo(t,e)},e}(Ko);Ko.Milliseconds=is;var ns=function(t){function e(r){var i=t.call(this,r instanceof lt?r.message()||void 0:r)||this;return r instanceof lt&&(i.diagnostic=r),i.__proto__=e.prototype,i}return _(e,t),e.prototype.toString=function(){return this.diagnostic?this.diagnostic.toString():t.prototype.toString.call(this)},e}(Error),os=function(){function t(t,e,r,i,n){this._scheme=t,this._authority=e,this._path=r,this._query=i,this._fragment=n}return t.prototype.isDefined=function(){return this._scheme.isDefined()||this._authority.isDefined()||this._path.isDefined()||this._query.isDefined()||this._fragment.isDefined()},t.prototype.isEmpty=function(){return!this._scheme.isDefined()&&!this._authority.isDefined()&&this._path.isEmpty()&&!this._query.isDefined()&&!this._fragment.isDefined()},t.prototype.scheme=function(e){return void 0===e?this._scheme:(e=t.Scheme.fromAny(e))!==this._scheme?this.copy(e,this._authority,this._path,this._query,this._fragment):this},t.prototype.schemePart=function(e){return void 0===e?this._scheme.toString():this.scheme(t.Scheme.parse(e))},t.prototype.schemeName=function(e){return void 0===e?this._scheme.name():this.scheme(t.Scheme.from(e))},t.prototype.authority=function(e){return void 0===e?this._authority:(e=t.Authority.fromAny(e))!==this._authority?this.copy(this._scheme,e,this._path,this._query,this._fragment):this},t.prototype.authorityPart=function(e){return void 0===e?this._authority.toString():this.authority(t.Authority.parse(e))},t.prototype.user=function(t){return void 0===t?this._authority.user():this.authority(this._authority.user(t))},t.prototype.userPart=function(t){return void 0===t?this._authority.userPart():this.authority(this._authority.userPart(t))},t.prototype.username=function(t,e){return void 0===t?this._authority.username():this.authority(this._authority.username(t,e))},t.prototype.password=function(t){return void 0===t?this._authority.password():this.authority(this._authority.password(t))},t.prototype.host=function(t){return void 0===t?this._authority.host():this.authority(this._authority.host(t))},t.prototype.hostPart=function(t){return void 0===t?this._authority.hostPart():this.authority(this._authority.hostPart(t))},t.prototype.hostAddress=function(){return this._authority.hostAddress()},t.prototype.hostName=function(t){return void 0===t?this._authority.hostName():this.authority(this._authority.hostName(t))},t.prototype.hostIPv4=function(t){return void 0===t?this._authority.hostIPv4():this.authority(this._authority.hostIPv4(t))},t.prototype.hostIPv6=function(t){return void 0===t?this._authority.hostIPv6():this.authority(this._authority.hostIPv6(t))},t.prototype.port=function(t){return void 0===t?this._authority.port():this.authority(this._authority.port(t))},t.prototype.portPart=function(t){return void 0===t?this._authority.portPart():this.authority(this._authority.portPart(t))},t.prototype.portNumber=function(t){return void 0===t?this._authority.portNumber():this.authority(this._authority.portNumber(t))},t.prototype.path=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(0===arguments.length)return this._path;var i=t.Path.from.apply(void 0,e);return i!==this._path?this.copy(this._scheme,this._authority,i,this._query,this._fragment):this},t.prototype.pathPart=function(e){return void 0===e?this._path.toString():this.path(t.Path.parse(e))},t.prototype.pathName=function(t){return void 0===t?this._path.name():this.path(this._path.name(t))},t.prototype.parentPath=function(){return this._path.parent()},t.prototype.basePath=function(){return this._path.base()},t.prototype.parent=function(){return t.from(this._scheme,this._authority,this._path.parent())},t.prototype.base=function(){return t.from(this._scheme,this._authority,this._path.base())},t.prototype.appendedPath=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.path(this._path.appended.apply(this._path,arguments))},t.prototype.appendedSlash=function(){return this.path(this._path.appendedSlash())},t.prototype.appendedSegment=function(t){return this.path(this._path.appendedSegment(t))},t.prototype.prependedPath=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.path(this._path.prepended.apply(this._path,arguments))},t.prototype.prependedSlash=function(){return this.path(this._path.prependedSlash())},t.prototype.prependedSegment=function(t){return this.path(this._path.prependedSegment(t))},t.prototype.query=function(e){return void 0===e?this._query:(e=t.Query.fromAny(e))!==this._query?this.copy(this._scheme,this._authority,this._path,e,this._fragment):this},t.prototype.queryPart=function(e){return void 0===e?this._query.toString():this.query(t.Query.parse(e))},t.prototype.updatedQuery=function(t,e){return this.query(this._query.updated(t,e))},t.prototype.removedQuery=function(t){return this.query(this._query.removed(t))},t.prototype.appendedQuery=function(t,e){return this.query(this._query.appended(t,e))},t.prototype.prependedQuery=function(t,e){return this.query(this._query.prepended(t,e))},t.prototype.fragment=function(e){return void 0===e?this._fragment:(e=t.Fragment.fromAny(e))!==this._fragment?t.from(this._scheme,this._authority,this._path,this._query,e):this},t.prototype.fragmentPart=function(e){return void 0===e?this._fragment.toString():this.fragment(t.Fragment.parse(e))},t.prototype.fragmentIdentifier=function(e){return void 0===e?this._fragment.identifier():this.fragment(t.Fragment.from(e))},t.prototype.endpoint=function(){return this._path.isDefined()||this._query.isDefined()||this._fragment.isDefined()?t.from(this._scheme,this._authority):this},t.prototype.resolve=function(e){return(e=t.fromAny(e))._scheme.isDefined()?this.copy(e._scheme,e._authority,e._path.removeDotSegments(),e._query,e._fragment):e._authority.isDefined()?this.copy(this._scheme,e._authority,e._path.removeDotSegments(),e._query,e._fragment):e._path.isEmpty()?this.copy(this._scheme,this._authority,this._path,e._query.isDefined()?e._query:this._query,e._fragment):e._path.isAbsolute()?this.copy(this._scheme,this._authority,e._path.removeDotSegments(),e._query,e._fragment):this.copy(this._scheme,this._authority,this.merge(e._path).removeDotSegments(),e._query,e._fragment)},t.prototype.merge=function(t){return this._authority.isDefined()&&this._path.isEmpty()?t.prependedSlash():this._path.isEmpty()?t:this._path.merge(t)},t.prototype.unresolve=function(e){return e=t.fromAny(e),this._scheme.equals(e._scheme)&&this._authority.equals(e._authority)?t.from(t.Scheme.undefined(),t.Authority.undefined(),this._path.unmerge(e._path),e._query,e._fragment):e},t.prototype.copy=function(e,r,i,n,o){return t.from(e,r,i,n,o)},t.prototype.toAny=function(){var t={};return t.scheme=this._scheme.toAny(),this._authority.toAny(t),t.path=this._path.toAny(),t.query=this._query.toAny(),t.fragment=this._fragment.toAny(),t},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this.toString())),this._hashCode},t.prototype.debug=function(t){t=t.write("Uri").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("empty").write(40).write(41)},t.prototype.display=function(t){null!=this._string?t=t.write(this._string):(this._scheme.isDefined()&&t.display(this._scheme).write(58),this._authority.isDefined()&&(t=t.write(47).write(47).display(this._authority)),t.display(this._path),this._query.isDefined()&&(t=t.write(63).display(this._query)),this._fragment.isDefined()&&(t=t.write(35).display(this._fragment)))},t.prototype.toString=function(){return void 0===this._string&&(this._string=J.display(this)),this._string},t.empty=function(){return void 0===t._empty&&(t._empty=new t(t.Scheme.undefined(),t.Authority.undefined(),t.Path.empty(),t.Query.undefined(),t.Fragment.undefined())),t._empty},t.from=function(e,r,i,n,o){return void 0===e&&(e=t.Scheme.undefined()),void 0===r&&(r=t.Authority.undefined()),void 0===i&&(i=t.Path.empty()),void 0===n&&(n=t.Query.undefined()),void 0===o&&(o=t.Fragment.undefined()),e.isDefined()||r.isDefined()||i.isDefined()||n.isDefined()||o.isDefined()?new t(e,r,i,n,o):t.empty()},t.fromAny=function(e){if(null==e)return t.empty();if(e instanceof t)return e;if("object"==typeof e){var r=t.Scheme.fromAny(e.scheme),i=t.Authority.fromAny(e.authority||e),n=t.Path.fromAny(e.path),o=t.Query.fromAny(e.query),s=t.Fragment.fromAny(e.fragment);return r.isDefined()||i.isDefined()||n.isDefined()||o.isDefined()||s.isDefined()?new t(r,i,n,o,s):t.empty()}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.scheme=function(e){return e=t.Scheme.fromAny(e),t.from(e,void 0,void 0,void 0,void 0)},t.schemePart=function(e){var r=t.Scheme.parse(e);return t.from(r,void 0,void 0,void 0,void 0)},t.schemeName=function(e){var r=t.Scheme.from(e);return t.from(r,void 0,void 0,void 0,void 0)},t.authority=function(e){return e=t.Authority.fromAny(e),t.from(void 0,e,void 0,void 0,void 0)},t.authorityPart=function(e){var r=t.Authority.parse(e);return t.from(void 0,r,void 0,void 0,void 0)},t.user=function(e){var r=t.Authority.user(e);return t.from(void 0,r,void 0,void 0,void 0)},t.userPart=function(e){var r=t.Authority.userPart(e);return t.from(void 0,r,void 0,void 0,void 0)},t.username=function(e,r){var i=t.Authority.username(e,r);return t.from(void 0,i,void 0,void 0,void 0)},t.password=function(e){var r=t.Authority.password(e);return t.from(void 0,r,void 0,void 0,void 0)},t.host=function(e){var r=t.Authority.host(e);return t.from(void 0,r,void 0,void 0,void 0)},t.hostPart=function(e){var r=t.Authority.hostPart(e);return t.from(void 0,r,void 0,void 0,void 0)},t.hostName=function(e){var r=t.Authority.hostName(e);return t.from(void 0,r,void 0,void 0,void 0)},t.hostIPv4=function(e){var r=t.Authority.hostIPv4(e);return t.from(void 0,r,void 0,void 0,void 0)},t.hostIPv6=function(e){var r=t.Authority.hostIPv6(e);return t.from(void 0,r,void 0,void 0,void 0)},t.port=function(e){var r=t.Authority.port(e);return t.from(void 0,r,void 0,void 0,void 0)},t.portPart=function(e){var r=t.Authority.portPart(e);return t.from(void 0,r,void 0,void 0,void 0)},t.portNumber=function(e){var r=t.Authority.portNumber(e);return t.from(void 0,r,void 0,void 0,void 0)},t.path=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.Path.from.apply(void 0,e);return t.from(void 0,void 0,i,void 0,void 0)},t.pathPart=function(e){var r=t.Path.parse(e);return t.from(void 0,void 0,r,void 0,void 0)},t.query=function(e){return e=t.Query.fromAny(e),t.from(void 0,void 0,void 0,e,void 0)},t.queryPart=function(e){var r=t.Query.parse(e);return t.from(void 0,void 0,void 0,r,void 0)},t.fragment=function(e){return e=t.Fragment.fromAny(e),t.from(void 0,void 0,void 0,void 0,e)},t.fragmentPart=function(e){var r=t.Fragment.parse(e);return t.from(void 0,void 0,void 0,void 0,r)},t.fragmentIdentifier=function(e){var r=t.Fragment.from(e);return t.from(void 0,void 0,void 0,void 0,r)},t.standardParser=function(){return this._standardParser||(this._standardParser=new t.Parser),this._standardParser},t.parse=function(e){return t.standardParser().parseAbsoluteString(e)},t.isUnreservedChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||45===t||46===t||95===t||126===t},t.isSubDelimChar=function(t){return 33===t||36===t||38===t||40===t||41===t||42===t||43===t||44===t||59===t||61===t||39===t},t.isSchemeChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||43===t||45===t||46===t},t.isUserInfoChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e},t.isUserChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isHostChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isPathChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e||64===e},t.isQueryChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.isParamChar=function(e){return t.isUnreservedChar(e)||33===e||36===e||40===e||41===e||42===e||43===e||44===e||47===e||58===e||59===e||63===e||64===e||39===e},t.isFragmentChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.toLowerCase=function(t){return t>=65&&t<=90?t+32:t},t.writeScheme=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);if(!(i>0&&t.isSchemeChar(o)||0===i&&t.isAlpha(o)))throw new ns("Invalid scheme: "+e);r=r.write(o)}},t.writeUserInfo=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isUserInfoChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeUser=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isUserChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeHost=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isHostChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeHostLiteral=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isHostChar(o)||58===o?r=r.write(o):t.writeEncoded(o,r)}},t.writePathSegment=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isPathChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeQuery=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isQueryChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeParam=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isParamChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeFragment=function(e,r){for(var i=0,n=e.length;i<n;i+=1){var o=e.charCodeAt(i);t.isFragmentChar(o)?r=r.write(o):t.writeEncoded(o,r)}},t.writeEncoded=function(e,r){0===e?(t.writePctEncoded(192,r),t.writePctEncoded(128,r)):e>=0&&e<=127?t.writePctEncoded(e,r):e>=128&&e<=2047?(t.writePctEncoded(192|e>>>6,r),t.writePctEncoded(128|63&e,r)):e>=2048&&e<=65535||e>=57344&&e<=65535?(t.writePctEncoded(224|e>>>12,r),t.writePctEncoded(128|e>>>6&63,r),t.writePctEncoded(128|63&e,r)):e>=65536&&e<=1114111?(t.writePctEncoded(240|e>>>18,r),t.writePctEncoded(128|e>>>12&63,r),t.writePctEncoded(128|e>>>6&63,r),t.writePctEncoded(128|63&e,r)):(t.writePctEncoded(239,r),t.writePctEncoded(191,r),t.writePctEncoded(189,r))},t.writePctEncoded=function(t,e){e=e.write(37).write(xt.lowercase().encodeDigit(t>>>4&15)).write(xt.lowercase().encodeDigit(15&t))},t.form=function(){return t._form||(t._form=new t.Form(t.empty())),t._form},t}(),ss=function(){function t(t){this._name=t}return t.prototype.isDefined=function(){return 0!==this._name.length},t.prototype.name=function(){return this._name},t.prototype.toAny=function(){return 0!==this._name.length?this._name:void 0},t.prototype.compareTo=function(t){var e=this._name.localeCompare(t._name);return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this._name===e._name},t.prototype.hashCode=function(){return c.hash(this._name)},t.prototype.debug=function(t){t=t.write("UriScheme").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){os.writeScheme(this._name,t)},t.prototype.toString=function(){return this._name},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new t("")),t._undefined},t.from=function(e){var r=t.cache(),i=r.get(e);return i||r.put(e,new t(e))},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parseSchemeString(t)},t.cache=function(){if(void 0===t._cache){t._cache=new k(4)}return t._cache},t}();os.Scheme=ss;var us=function(){function t(t,e,r){this._user=t,this._host=e,this._port=r}return t.prototype.isDefined=function(){return this._user.isDefined()||this._host.isDefined()||this._port.isDefined()},t.prototype.user=function(t){return void 0===t?this._user:(t=os.User.fromAny(t))!==this._user?this.copy(t,this._host,this._port):this},t.prototype.userPart=function(t){return void 0===t?this._user.toString():this.user(os.User.parse(t))},t.prototype.username=function(t,e){return void 0===t?this._user._username||"":void 0===e?this.user(this._user.username(t)):this.user(os.User.from(t,e))},t.prototype.password=function(t){return void 0===t?this._user.password():this.user(this._user.password(t))},t.prototype.host=function(t){return void 0===t?this._host:(t=os.Host.fromAny(t))!==this._host?this.copy(this._user,t,this._port):this},t.prototype.hostPart=function(t){return void 0===t?this._host.toString():this.host(os.Host.parse(t))},t.prototype.hostAddress=function(){return this._host.address()},t.prototype.hostName=function(t){return void 0===t?this._host.name():this.host(os.Host.from(t))},t.prototype.hostIPv4=function(t){return void 0===t?this._host.ipv4():this.host(os.Host.ipv4(t))},t.prototype.hostIPv6=function(t){return void 0===t?this._host.ipv6():this.host(os.Host.ipv6(t))},t.prototype.port=function(t){return void 0===t?this._port:(t=os.Port.fromAny(t))!==this._port?this.copy(this._user,this._host,t):this},t.prototype.portPart=function(t){return void 0===t?this._port.toString():this.port(os.Port.parse(t))},t.prototype.portNumber=function(t){return void 0===t?this._port.number():this.port(os.Port.from(t))},t.prototype.copy=function(e,r,i){return t.from(e,r,i)},t.prototype.toAny=function(t){return this.isDefined()&&(t=t||{},this._user.toAny(t),this._host.isDefined()&&(t.host=this._host.toAny()),this._port.isDefined()&&(t.port=this._port.toAny())),t},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this.toString())),this._hashCode},t.prototype.debug=function(t){t=t.write("UriAuthority").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){void 0!==this._string?t=t.write(this._string):(this._user.isDefined()&&t.display(this._user).write(64),t.display(this._host),this._port.isDefined()&&(t=t.write(58).display(this._port)))},t.prototype.toString=function(){return void 0===this._string&&(this._string=J.display(this)),this._string},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new t(os.User.undefined(),os.Host.undefined(),os.Port.undefined())),t._undefined},t.from=function(e,r,i){return void 0===e&&(e=os.User.undefined()),void 0===r&&(r=os.Host.undefined()),void 0===i&&(i=os.Port.undefined()),e.isDefined()||r.isDefined()||i.isDefined()?new t(e,r,i):t.undefined()},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e){var r=os.User.fromAny(e.user||e),i=os.Host.fromAny(e.host),n=os.Port.fromAny(e.port);return t.from(r,i,n)}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.user=function(e){return e=os.User.fromAny(e),t.from(e,void 0,void 0)},t.userPart=function(e){var r=os.User.parse(e);return t.from(r,void 0,void 0)},t.username=function(e,r){var i=os.User.from(e,r);return t.from(i,void 0,void 0)},t.password=function(e){var r=os.User.from("",e);return t.from(r,void 0,void 0)},t.host=function(e){return e=os.Host.fromAny(e),t.from(void 0,e,void 0)},t.hostPart=function(e){var r=os.Host.parse(e);return t.from(void 0,r,void 0)},t.hostName=function(e){var r=os.Host.from(e);return t.from(void 0,r,void 0)},t.hostIPv4=function(e){var r=os.Host.ipv4(e);return t.from(void 0,r,void 0)},t.hostIPv6=function(e){var r=os.Host.ipv6(e);return t.from(void 0,r,void 0)},t.port=function(e){return e=os.Port.fromAny(e),t.from(void 0,void 0,e)},t.portPart=function(e){var r=os.Port.parse(e);return t.from(void 0,void 0,r)},t.portNumber=function(e){var r=os.Port.from(e);return t.from(void 0,void 0,r)},t.parse=function(t){return os.standardParser().parseAuthorityString(t)},t}();os.Authority=us;var as=function(){function t(t,e){this._username=t,this._password=e}return t.prototype.isDefined=function(){return null!==this._username},t.prototype.username=function(t){return void 0===t?this._username||"":t!==this._username?this.copy(t,this._password):this},t.prototype.password=function(t){return void 0===t?this._password:t!==this._password?this.copy(this._username,t):this},t.prototype.copy=function(e,r){return t.from(e,r)},t.prototype.toAny=function(t){return null!==this._username&&((t=t||{}).username=this._username,null!==this._password&&(t.password=this._password)),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._username===e._username&&this._password===e._password)},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(c.mix(t._hashSeed,c.hash(this._username)),c.hash(this._password)))},t.prototype.debug=function(t){t=t.write("UriUser").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){null!=this._username&&(os.writeUser(this._username,t),null!=this._password&&(t=t.write(58),os.writeUser(this._password,t)))},t.prototype.toString=function(){return J.display(this)},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new t(null,null)),t._undefined},t.from=function(e,r){return void 0===r&&(r=null),null!==e||null!==r?new t(e||"",r):t.undefined()},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e){var r="string"==typeof e.username?e.username:null,i="string"==typeof e.password?e.password:null;return t.from(r,i)}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parseUserString(t)},t}();os.User=as;var hs=function(){function t(){}return t.prototype.isDefined=function(){return!0},t.prototype.name=function(){return null},t.prototype.ipv4=function(){return null},t.prototype.ipv6=function(){return null},t.prototype.toAny=function(){return this.toString()},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this.toString())),this._hashCode},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new os.HostUndefined),t._undefined},t.from=function(e){var r=t.cache(),i=r.get(e);return i instanceof os.HostName?i:r.put(e,new os.HostName(e))},t.ipv4=function(e){var r=t.cache(),i=r.get(e);return i instanceof os.HostIPv4?i:r.put(e,new os.HostIPv4(e))},t.ipv6=function(e){var r=t.cache(),i=r.get(e);return i instanceof os.HostIPv6?i:r.put(e,new os.HostIPv6(e))},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parseHostString(t)},t.cache=function(){if(void 0===t._cache){t._cache=new k(16)}return t._cache},t}();os.Host=hs;var ps=function(t){function e(e){var r=t.call(this)||this;return r._address=e,r}return _(e,t),e.prototype.address=function(){return this._address},e.prototype.name=function(){return this._address},e.prototype.debug=function(t){t=t.write("UriHost").write(46).write("from").write(40).debug(this._address).write(41)},e.prototype.display=function(t){os.writeHost(this._address,t)},e.prototype.toString=function(){return this._address},e}(hs);os.HostName=ps;var ls=function(t){function e(e){var r=t.call(this)||this;return r._address=e,r}return _(e,t),e.prototype.address=function(){return this._address},e.prototype.ipv4=function(){return this._address},e.prototype.debug=function(t){t=t.write("UriHost").write(46).write("ipv4").write(40).debug(this._address).write(41)},e.prototype.display=function(t){os.writeHost(this._address,t)},e.prototype.toString=function(){return this._address},e}(hs);os.HostIPv4=ls;var cs=function(t){function e(e){var r=t.call(this)||this;return r._address=e,r}return _(e,t),e.prototype.address=function(){return this._address},e.prototype.ipv6=function(){return this._address},e.prototype.debug=function(t){t=t.write("UriHost").write(46).write("ipv6").write(40).debug(this._address).write(41)},e.prototype.display=function(t){null!=this._string?t=t.write(this._string):(t=t.write(91),os.writeHostLiteral(this._address,t),t=t.write(93))},e.prototype.toString=function(){return null==this._string&&(this._string="["+this.address+"]"),this._string},e}(hs);os.HostIPv6=cs;var fs=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!1},e.prototype.address=function(){return""},e.prototype.debug=function(t){t=t.write("UriHost").write(46).write("undefined").write(40).write(41)},e.prototype.display=function(t){},e.prototype.toString=function(){return""},e}(hs);os.HostUndefined=fs;var ds=function(){function t(t){this._number=t}return t.prototype.isDefined=function(){return 0!==this._number},t.prototype.number=function(){return this._number},t.prototype.valueOf=function(){return this._number},t.prototype.toAny=function(){return this._number},t.prototype.compareTo=function(t){return this._number<t._number?-1:this._number>t._number?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this._number===e._number},t.prototype.hashCode=function(){return void 0===t._hashSeed&&(t._hashSeed=c.seed(t)),c.mash(c.mix(t._hashSeed,this._number))},t.prototype.debug=function(t){t=t.write("UriPort").write(46),this.isDefined()?(t=t.write("from").write(40),J.displayNumber(this._number,t),t=t.write(41)):t=t.write("undefined").write(40).write(41)},t.prototype.display=function(t){J.displayNumber(this._number,t)},t.prototype.toString=function(){return""+this._number},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new t(0)),t._undefined},t.from=function(e){if(e>0){var r=t.cache(),i=r.get(e);return void 0!==i?i:r.put(e,new t(e))}if(0===e)return t.undefined();throw new TypeError(""+e)},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("number"==typeof e)return t.from(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parsePortString(t)},t.cache=function(){if(void 0===t._cache){t._cache=new k(4)}return t._cache},t}();os.Port=ds;var ys=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!0,configurable:!0}),t.prototype.get=function(t){for(var e=0,r=this;!r.isEmpty();){if(!(e<t))return r.head();e+=1,r=r.tail()}},t.prototype.name=function(t){if(void 0!==t){var e=new os.PathBuilder;return e.addPath(this.base()),e.addSegment(t),e.bind()}if(this.isEmpty())return"";for(var r=this;;){var i=r.tail();if(i.isEmpty())return r.isRelative()?r.head():"";r=i}},t.prototype.foot=function(){if(this.isEmpty())return this;for(var t=this;;){var e=t.tail();if(e.isEmpty())return t;t=e}},t.prototype.isSubpathOf=function(e){e=t.fromAny(e);for(var r=this;!r.isEmpty()&&!e.isEmpty();){if(r.head()!==e.head())return!1;r=r.tail(),e=e.tail()}return e.isEmpty()},t.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>0){var r=new os.PathBuilder;return r.addPath(this),r.push.apply(r,arguments),r.bind()}return this},t.prototype.appendedSlash=function(){var t=new os.PathBuilder;return t.addPath(this),t.addSlash(),t.bind()},t.prototype.appendedSegment=function(t){var e=new os.PathBuilder;return e.addPath(this),e.addSegment(t),e.bind()},t.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>0){var r=new os.PathBuilder;return r.push.apply(r,arguments),r.addPath(this),r.bind()}return this},t.prototype.prependedSlash=function(){return t.slash(this)},t.prototype.prependedSegment=function(e){return this.isEmpty()||this.isAbsolute()?t.segment(e,this):t.segment(e,t.slash(this))},t.prototype.resolve=function(t){return t.isEmpty()?this:t.isAbsolute()||this.isEmpty()?t.removeDotSegments():this.merge(t).removeDotSegments()},t.prototype.removeDotSegments=function(){for(var e=this,r=new os.PathBuilder;!e.isEmpty();){var i=e.head();if("."===i||".."===i)(e=e.tail()).isEmpty()||(e=e.tail());else if(e.isAbsolute()){var n=e.tail();if(n.isEmpty())r.push(e.head()),e=e.tail();else{var o=n.head();"."===o?(e=n.tail()).isEmpty()&&(e=t.slash()):".."===o?((e=n.tail()).isEmpty()&&(e=t.slash()),r.isEmpty()||r.pop().isAbsolute()||r.isEmpty()||r.pop()):(r.push(i,o),e=n.tail())}}else r.push(e.head()),e=e.tail()}return r.bind()},t.prototype.merge=function(t){if(this.isEmpty())return t;for(var e=new os.PathBuilder,r=this;;){var i=r.tail();if(i.isEmpty()){r.isAbsolute()&&e.addSlash();break}r.isAbsolute()?e.addSlash():e.addSegment(r.head()),r=i}return e.addPath(t),e.bind()},t.prototype.unmerge=function(e,r){void 0===r&&(r=e);for(var i=this;;){if(i.isEmpty())return e.isEmpty()||e.tail().isEmpty()?e:e.tail();if(i.isRelative())return e;if(e.isRelative())return t.slash(e);var n=i.tail(),o=e.tail();if(!n.isEmpty()&&o.isEmpty())return t.slash();if(n.isEmpty()||o.isEmpty()||n.head()!==o.head())return o;if(n=n.tail(),o=o.tail(),!n.isEmpty()&&o.isEmpty())return r;i=n,e=o}},t.prototype.toAny=function(){for(var t=[],e=this;!e.isEmpty();)t.push(e.head()),e=e.tail();return t},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this.toString())),this._hashCode},t.prototype.display=function(t){for(var e=this;!e.isEmpty();)e.isAbsolute()?t=t.write(47):os.writePathSegment(e.head(),t),e=e.tail()},t.builder=function(){return new os.PathBuilder},t.empty=function(){return void 0===t._empty&&(t._empty=new os.PathEmpty),t._empty},t.slash=function(e){return void 0===e&&(e=t.empty()),e===t.empty()?(void 0===t._slash&&(t._slash=new os.PathSlash(e)),t._slash):new os.PathSlash(e)},t.segment=function(e,r){return void 0===r&&(r=t.empty()),e=this.cacheSegment(e),new os.PathSegment(e,r)},t.from=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=new os.PathBuilder;return r.push.apply(r,arguments),r.bind()},t.fromAny=function(e){if(null==e)return t.empty();if(e instanceof t)return e;if(Array.isArray(e))return t.from.apply(void 0,arguments);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parsePathString(t)},t.segmentCache=function(){if(void 0===t._segmentCache){t._segmentCache=new O(64)}return t._segmentCache},t.cacheSegment=function(t){return t.length<=32?this.segmentCache().put(t):t},t.pathForm=function(){return t._pathForm||(t._pathForm=new os.PathForm(t.empty())),t._pathForm},t}();os.Path=ys;var vs=function(t){function e(e,r){var i=t.call(this)||this;return i._head=e,i._tail=r,i}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return this._head},e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){t.isAbsolute()?this._tail=t:this._tail=ys.slash(t)},e.prototype.dealias=function(){return new e(this._head,this._tail)},e.prototype.parent=function(){var t=this._tail;return t.isEmpty()||t.tail().isEmpty()?ys.empty():new e(this._head,t.parent())},e.prototype.base=function(){var t=this._tail;return t.isEmpty()?ys.empty():new e(this._head,t.base())},e.prototype.prependedSegment=function(t){return ys.segment(t,ys.slash(this))},e.prototype.debug=function(t){t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){void 0!==this._string?e=e.write(this._string):t.prototype.display.call(this,e)},e.prototype.toString=function(){return void 0===this._string&&(this._string=J.display(this)),this._string},e}(ys);os.PathSegment=vs;var _s=function(t){function e(e){var r=t.call(this)||this;return r._tail=e,r}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!0},e.prototype.isRelative=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return"/"},e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){this._tail=t},e.prototype.dealias=function(){return new e(this._tail)},e.prototype.parent=function(){var t=this._tail;return t.isEmpty()?ys.empty():t.tail().isEmpty()?ys.slash():new e(t.parent())},e.prototype.base=function(){var t=this._tail;return t.isEmpty()?this:new e(t.base())},e.prototype.prependedSegment=function(t){return ys.segment(t,this)},e.prototype.debug=function(t){t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){void 0!==this._string?e=e.write(this._string):t.prototype.display.call(this,e)},e.prototype.toString=function(){return void 0===this._string&&(this._string=J.display(this)),this._string},e}(ys);os.PathSlash=_s;var ms=function(t){function e(){return t.call(this)||this}return _(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("Empty UriPath")},e.prototype.tail=function(){throw new Error("Empty UriPath")},e.prototype.setTail=function(t){throw new Error("Empty UriPath")},e.prototype.dealias=function(){return this},e.prototype.parent=function(){return this},e.prototype.base=function(){return this},e.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ys.from.apply(void 0,arguments)},e.prototype.appendedSlash=function(){return ys.slash()},e.prototype.appendedSegment=function(t){return ys.segment(t)},e.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ys.from.apply(void 0,arguments)},e.prototype.prependedSlash=function(){return ys.slash()},e.prototype.prependedSegment=function(t){return ys.segment(t)},e.prototype.merge=function(t){return t},e.prototype.debug=function(t){t=t.write("UriPath").write(46).write("empty").write(40).write(41)},e.prototype.display=function(t){},e.prototype.toString=function(){return""},e}(ys);os.PathEmpty=ms;var ws=function(){function t(){this._first=os.Path.empty(),this._last=null,this._size=0,this._aliased=0}return t.prototype.isEmpty=function(){return 0===this._size},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r+=1){var i=t[r];i instanceof os.Path?this.addPath(i):Array.isArray(i)?this.push.apply(this,i):"/"===i?this.addSlash():this.addSegment(i)}},t.prototype.bind=function(){return this._aliased=0,this._first},t.prototype.addSlash=function(){var t=os.Path.slash().dealias(),e=this._size;0===e?this._first=t:this.dealias(e-1).setTail(t),this._last=t,this._size=e+1,this._aliased+=1},t.prototype.addSegment=function(t){var e=os.Path.segment(t,os.Path.empty()),r=this._size;0===r?this._first=e:this.dealias(r-1).setTail(e),this._last=e,this._size=r+1,this._aliased+=1},t.prototype.addPath=function(t){if(!t.isEmpty()){var e=this._size;for(0===e?this._first=t:this.dealias(e-1).setTail(t),e+=1;;){var r=t.tail();if(r.isEmpty())break;t=r,e+=1}this._last=t,this._size=e}},t.prototype.pop=function(){var t=this._size,e=this._aliased;if(0===t)throw new Error("Empty UriPath");if(1===t){var r=this._first;return this._first=r.tail(),r.tail().isEmpty()&&(this._last=null),this._size=t-1,e>0&&(this._aliased=e-1),r}var i=this.dealias(t-2);return i.setTail(os.Path.empty()),this._last=i,this._size=t-1,this._aliased=e-1,i.tail()},t.prototype.dealias=function(t){var e=0,r=null,i=this._first;if(this._aliased<=t){for(;e<this._aliased;)r=i,i=i.tail(),e+=1;for(;e<=t;){var n=i.dealias();0===e?this._first=n:r.setTail(n),r=n,i=i.tail(),e+=1}e===this._size&&(this._last=r),this._aliased=e}else if(0===t)r=this._first;else if(t===this._size-1)r=this._last;else for(;e<=t;)r=i,i=i.tail(),e+=1;return r},t}();os.PathBuilder=ws;var gs=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!0,configurable:!0}),t.prototype.has=function(t){for(var e=this;!e.isEmpty();){if(t===e.key())return!0;e=e.tail()}return!1},t.prototype.get=function(t){for(var e=this;!e.isEmpty();){if(t===e.key())return e.value();e=e.tail()}},t.prototype.updated=function(t,e){for(var r=this,i=new os.QueryBuilder,n=!1;!r.isEmpty();)t===r.key()?(i.addParam(t,e),n=!0):i.addParam(r.key(),r.value()),r=r.tail();return n||i.addParam(t,e),i.bind()},t.prototype.removed=function(t){for(var e=this,r=new os.QueryBuilder,i=!1;!e.isEmpty();)t===e.key()?i=!0:r.addParam(e.key(),e.value()),e=e.tail();return i?r.bind():this},t.prototype.appended=function(t,e){var r=new os.QueryBuilder;return r.addQuery(this),r.add(t,e),r.bind()},t.prototype.prepended=function(t,e){var r=new os.QueryBuilder;return r.add(t,e),r.addQuery(this),r.bind()},t.prototype.toAny=function(t){if(this.isDefined()){t=t||{};for(var e=this,r=0;!e.isEmpty();){var i=e.key();null!==i?t[i]=e.value():t["$"+r]=e.value(),e=e.tail(),r+=1}}return t},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return void 0===this._hashCode&&(this._hashCode=c.hash(this.toString())),this._hashCode},t.prototype.display=function(t){for(var e=this,r=!0;!e.isEmpty();){r?r=!1:t=t.write(38);var i=e.key();null!==i&&(os.writeParam(i,t),t=t.write(61)),os.writeQuery(e.value(),t),e=e.tail()}},t.builder=function(){return new os.QueryBuilder},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new os.QueryUndefined),t._undefined},t.param=function(e,r,i){return void 0===i?(i=r,r=e,e=null):null!==e&&(e=this.cacheKey(e)),void 0===i&&(i=t.undefined()),new os.QueryParam(e,r,i)},t.from=function(t,e){var r=new os.QueryBuilder;return r.add(t,e),r.bind()},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e){var r=new os.QueryBuilder;return r.add(e),r.bind()}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parseQueryString(t)},t.keyCache=function(){if(void 0===t._keyCache){t._keyCache=new O(64)}return t._keyCache},t.cacheKey=function(e){return e.length<=32?t.keyCache().put(e):e},t}();os.Query=gs;var bs=function(t){function e(e,r,i){var n=t.call(this)||this;return n._key=e,n._value=r,n._tail=i,n}return _(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return[this._key,this._value]},e.prototype.key=function(){return this._key},e.prototype.value=function(){return this._value},e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){this._tail=t},e.prototype.dealias=function(){return new e(this._key,this._value,this._tail)},e.prototype.debug=function(t){t=t.write("UriQuery").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){void 0!==this._string?e=e.write(this._string):t.prototype.display.call(this,e)},e.prototype.toString=function(){return void 0===this._string&&(this._string=J.display(this)),this._string},e}(gs);os.QueryParam=bs;var xs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("Undefined Query")},e.prototype.key=function(){throw new Error("Undefined Query")},e.prototype.value=function(){throw new Error("Undefined Query")},e.prototype.tail=function(){throw new Error("Undefined Query")},e.prototype.setTail=function(t){throw new Error("Undefined Query")},e.prototype.dealias=function(){return this},e.prototype.updated=function(t,e){return gs.param(t,e,this)},e.prototype.removed=function(t){return this},e.prototype.appended=function(t,e){return gs.from(t,e)},e.prototype.prepended=function(t,e){return gs.from(t,e)},e.prototype.debug=function(t){t=t.write("UriQuery").write(46).write("undefined").write(40).write(41)},e.prototype.display=function(t){},e.prototype.toString=function(){return""},e}(gs);os.QueryUndefined=xs;var Cs=function(){function t(){this._first=os.Query.undefined(),this._last=null,this._size=0,this._aliased=0}return t.prototype.isEmpty=function(){return 0===this._size},t.prototype.add=function(t,e){if(void 0!==e)this.addParam(t,e);else if("string"==typeof t)this.addParam(null,t);else if(t instanceof os.Query)this.addQuery(t);else{var r=t;for(var i in r){var n=i,o=r[i];36===i.charCodeAt(0)&&(n=null),this.addParam(n,o)}}},t.prototype.bind=function(){return this._aliased=0,this._first},t.prototype.addParam=function(t,e){void 0===e&&(e=t,t=null);var r=os.Query.param(t,e,os.Query.undefined()),i=this._size;0===i?this._first=r:this.dealias(i-1).setTail(r),this._last=r,this._size=i+1,this._aliased+=1},t.prototype.addQuery=function(t){if(!t.isEmpty()){var e=this._size;for(0===e?this._first=t:this.dealias(e-1).setTail(t),e+=1;;){var r=t.tail();if(r.isEmpty())break;t=r,e+=1}this._last=t,this._size=e}},t.prototype.dealias=function(t){var e=0,r=null,i=this._first;if(this._aliased<=t){for(;e<this._aliased;)r=i,i=i.tail(),e+=1;for(;e<=t;){var n=i.dealias();0===e?this._first=n:r.setTail(n),r=n,i=i.tail(),e+=1}e===this._size&&(this._last=r),this._aliased=e}else if(0===t)r=this._first;else if(t===this._size-1)r=this._last;else for(;e<=t;)r=i,i=i.tail(),e+=1;return r},t}();os.QueryBuilder=Cs;var Ss=function(){function t(t){this._identifier=t}return t.prototype.isDefined=function(){return null!==this._identifier},t.prototype.identifier=function(){return this._identifier},t.prototype.toAny=function(){return null!==this._identifier?this._identifier:void 0},t.prototype.compareTo=function(t){var e=this.toString().localeCompare(t.toString());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&this._identifier===e._identifier},t.prototype.hashCode=function(){return c.hash(this._identifier)},t.prototype.debug=function(t){t=t.write("UriFragment").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){void 0!==this._string?t=t.write(this._string):null!==this._identifier&&os.writeFragment(this._identifier,t)},t.prototype.toString=function(){return null==this._string&&(this._string=J.display(this)),this._string},t.undefined=function(){return void 0===t._undefined&&(t._undefined=new t(null)),t._undefined},t.from=function(e){if(null!==e){var r=t.cache(),i=r.get(e);return i||r.put(e,new t(e))}return t.undefined()},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return os.standardParser().parseFragmentString(t)},t.cache=function(){if(void 0===t._cache){t._cache=new k(32)}return t._cache},t}();os.Fragment=Ss;var As=function(){function t(){}return t.prototype.absolute=function(t,e,r,i,n){return os.from(t,e,r,i,n)},t.prototype.scheme=function(t){return os.Scheme.from(t)},t.prototype.authority=function(t,e,r){return os.Authority.from(t,e,r)},t.prototype.user=function(t,e){return os.User.from(t,e)},t.prototype.hostName=function(t){return os.Host.from(t)},t.prototype.hostIPv4=function(t){return os.Host.ipv4(t)},t.prototype.hostIPv6=function(t){return os.Host.ipv6(t)},t.prototype.port=function(t){return os.Port.from(t)},t.prototype.pathEmpty=function(){return os.Path.empty()},t.prototype.pathBuilder=function(){return new os.PathBuilder},t.prototype.queryBuilder=function(){return new os.QueryBuilder},t.prototype.fragment=function(t){return os.Fragment.from(t)},t.prototype.absoluteParser=function(){return new t.AbsoluteParser(this)},t.prototype.parseAbsolute=function(e){return t.AbsoluteParser.parse(e,this)},t.prototype.parseAbsoluteString=function(t){var e=$.stringInput(t),r=this.parseAbsolute(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.schemeParser=function(){return new t.SchemeParser(this)},t.prototype.parseScheme=function(e){return t.SchemeParser.parse(e,this)},t.prototype.parseSchemeString=function(t){var e=$.stringInput(t),r=this.parseScheme(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.authorityParser=function(){return new t.AuthorityParser(this)},t.prototype.parseAuthority=function(e){return t.AuthorityParser.parse(e,this)},t.prototype.parseAuthorityString=function(t){var e=$.stringInput(t),r=this.parseAuthority(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.userParser=function(){return new t.UserParser(this)},t.prototype.parseUser=function(e){return t.UserParser.parse(e,this)},t.prototype.parseUserString=function(t){var e=$.stringInput(t),r=this.parseUser(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.hostParser=function(){return new t.HostParser(this)},t.prototype.parseHost=function(e){return t.HostParser.parse(e,this)},t.prototype.parseHostString=function(t){var e=$.stringInput(t),r=this.parseHost(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.hostAddressParser=function(){return new t.HostAddressParser(this)},t.prototype.parseHostAddress=function(e){return t.HostAddressParser.parse(e,this)},t.prototype.hostLiteralParser=function(){return new t.HostLiteralParser(this)},t.prototype.parseHostLiteral=function(e){return t.HostLiteralParser.parse(e,this)},t.prototype.portParser=function(){return new t.PortParser(this)},t.prototype.parsePort=function(e){return t.PortParser.parse(e,this)},t.prototype.parsePortString=function(t){var e=$.stringInput(t),r=this.parsePort(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.pathParser=function(e){return new t.PathParser(this,e)},t.prototype.parsePath=function(e,r){return t.PathParser.parse(e,this,r)},t.prototype.parsePathString=function(t){var e=$.stringInput(t),r=this.parsePath(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.queryParser=function(e){return new t.QueryParser(this,e)},t.prototype.parseQuery=function(e,r){return t.QueryParser.parse(e,this,r)},t.prototype.parseQueryString=function(t){var e=$.stringInput(t),r=this.parseQuery(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t.prototype.fragmentParser=function(){return new t.FragmentParser(this)},t.prototype.parseFragment=function(e){return t.FragmentParser.parse(e,this)},t.prototype.parseFragmentString=function(t){var e=$.stringInput(t),r=this.parseFragment(e);return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},t}();os.Parser=As;var ks=function(t){function e(e,r,i,n,o,s,u){var a=t.call(this)||this;return a.uri=e,a.schemeParser=r,a.authorityParser=i,a.pathParser=n,a.queryParser=o,a.fragmentParser=s,a.step=u,a}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)},e.parse=function(t,r,i,n,o,s,u,a){void 0===a&&(a=1);var h=0;if(1===a)if(t.isCont()){for(var p=t.clone();p.isCont()&&(h=p.head(),os.isSchemeChar(h));)p.step();a=p.isCont()&&58===h?2:3}else t.isDone()&&(a=3);if(2===a)if((i=i?i.feed(t):r.parseScheme(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),a=3;else if(!t.isEmpty())return ft.error(lt.expected(58,t))}else if(i.isError())return i.asError();if(3===a)if(t.isCont())47===(h=t.head())?(t=t.step(),a=4):63===h?(t=t.step(),a=7):35===h?(t=t.step(),a=8):a=6;else if(t.isDone())return ft.done(r.absolute(i&&i.bind()));if(4===a)if(t.isCont()&&47===t.head())t=t.step(),a=5;else if(t.isCont()){var l=r.pathBuilder();l.addSlash(),o=r.parsePath(t,l),a=6}else if(t.isDone())return ft.done(r.absolute(i&&i.bind(),void 0,os.Path.slash()));if(5===a)if((n=n?n.feed(t):r.parseAuthority(t)).isDone()){if(t.isCont())63===(h=t.head())?(t=t.step(),a=7):35===h?(t=t.step(),a=8):a=6;else if(t.isDone())return ft.done(r.absolute(i&&i.bind(),n&&n.bind()))}else if(n.isError())return n.asError();if(6===a)if((o=o?o.feed(t):r.parsePath(t)).isDone()){if(t.isCont()&&63===t.head())t=t.step(),a=7;else if(t.isCont()&&35===t.head())t=t.step(),a=8;else if(!t.isEmpty())return ft.done(r.absolute(i&&i.bind(),n&&n.bind(),o.bind()))}else if(o.isError())return o.asError();if(7===a)if((s=s?s.feed(t):r.parseQuery(t)).isDone()){if(t.isCont()&&35===t.head())t=t.step(),a=8;else if(!t.isEmpty())return ft.done(r.absolute(i&&i.bind(),n&&n.bind(),o&&o.bind(),s.bind()))}else if(s.isError())return s.asError();if(8===a){if((u=u?u.feed(t):r.parseFragment(t)).isDone())return ft.done(r.absolute(i&&i.bind(),n&&n.bind(),o&&o.bind(),s&&s.bind(),u.bind()));if(u.isError())return u.asError()}return new e(r,i,n,o,s,u,a)},e}(ft);As.AbsoluteParser=ks;var Es=function(t){function e(e,r,i){var n=t.call(this)||this;return n.uri=e,n.output=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont()&&(o=t.head(),os.isAlpha(o)))t=t.step(),i=(i=i||At.decodedString()).write(os.toLowerCase(o)),n=2;else if(!t.isEmpty())return ft.error(lt.expected("scheme",t));if(2===n){for(;t.isCont()&&(o=t.head(),os.isSchemeChar(o));)t=t.step(),i.write(os.toLowerCase(o));if(!t.isEmpty())return ft.done(r.scheme(i.bind()))}return new e(r,i,n)},e}(ft);As.SchemeParser=Es;var Os=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.uri=e,s.userParser=r,s.hostParser=i,s.portParser=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.userParser,this.hostParser,this.portParser,this.step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){for(var a=t.clone();a.isCont()&&(64!==(u=a.head())&&47!==u);)a.step();s=a.isCont()&&64===u?2:3}else t.isDone()&&(s=3);if(2===s)if((i=i?i.feed(t):r.parseUser(t)).isDone()){if(t.isCont()&&64===t.head())t=t.step(),s=3;else if(!t.isEmpty())return ft.error(lt.expected(64,t))}else if(i.isError())return i.asError();if(3===s)if((n=n?n.feed(t):r.parseHost(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),s=4;else if(!t.isEmpty())return ft.done(r.authority(i&&i.bind(),n.bind()))}else if(n.isError())return n.asError();if(4===s){if((o=o?o.feed(t):r.parsePort(t)).isDone())return ft.done(r.authority(i&&i.bind(),n.bind(),o.bind()));if(o.isError())return o.asError()}return new e(r,i,n,o,s)},e}(ft);As.AuthorityParser=Os;var Vs=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.uri=e,s.usernameOutput=r,s.passwordOutput=i,s.c1=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.usernameOutput,this.passwordOutput,this.c1,this.step)},e.parse=function(t,r,i,n,o,s){void 0===o&&(o=0),void 0===s&&(s=1);for(var u=0;;){if(1===s){for(i=i||At.decodedString();t.isCont()&&(u=t.head(),os.isUserChar(u));)t=t.step(),i.write(u);if(t.isCont()&&58===u)t=t.step(),s=4;else if(t.isCont()&&37===u)t=t.step(),s=2;else if(!t.isEmpty())return ft.done(r.user(i.bind()))}if(2===s)if(t.isCont()&&(u=t.head(),xt.isDigit(u)))t=t.step(),o=u,s=3;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(3===s){if(t.isCont()&&(u=t.head(),xt.isDigit(u))){t=t.step(),i.write(xt.decodeDigit(o)<<4|xt.decodeDigit(u)),o=0,s=1;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}if(4===s){for(n=n||At.decodedString();t.isCont()&&(u=t.head(),os.isUserInfoChar(u));)t=t.step(),n.write(u);if(t.isCont()&&37===u)t=t.step(),s=5;else if(!t.isEmpty())return ft.done(r.user(i.bind(),n.bind()))}if(5===s)if(t.isCont()&&(u=t.head(),xt.isDigit(u)))t=t.step(),o=u,s=6;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(6===s){if(t.isCont()&&(u=t.head(),xt.isDigit(u))){t=t.step(),n.write(xt.decodeDigit(o)<<4|xt.decodeDigit(u)),o=0,s=4;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}break}return new e(r,i,n,o,s)},e}(ft);As.UserParser=Vs;var Ps=function(t){function e(e){var r=t.call(this)||this;return r.uri=e,r}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri)},e.parse=function(t,r){return t.isCont()?91===t.head()?r.parseHostLiteral(t):r.parseHostAddress(t):t.isDone()?ft.done(r.hostName("")):new e(r)},e}(ft);As.HostParser=Ps;var Ds=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.uri=e,s.output=r,s.c1=i,s.x=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.c1,this.x,this.step)},e.parse=function(t,r,i,n,o,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=0;for(i=i||At.decodedString();s<=4;){for(;t.isCont()&&(u=t.head(),pt.isDigit(u));)t=t.step(),i=i.write(u),o=10*o+pt.decodeDigit(u);if(!t.isCont()){if(t.isEmpty())break;return 4===s&&o<=255?ft.done(r.hostIPv4(i.bind())):ft.done(r.hostName(i.bind()))}if(!(46===u&&s<4&&o<=255)){if(!os.isHostChar(u)&&37!==u&&4===s&&o<=255)return ft.done(r.hostIPv4(i.bind()));o=0,s=5;break}t=t.step(),i=i.write(u),o=0,s+=1}for(;;){if(5===s){for(;t.isCont()&&(u=t.head(),os.isHostChar(u));)t=t.step(),i.write(os.toLowerCase(u));if(t.isCont()&&37===u)t=t.step(),s=6;else if(!t.isEmpty())return ft.done(r.hostName(i.bind()))}if(6===s)if(t.isCont()&&(u=t.head(),xt.isDigit(u)))t=t.step(),n=u,s=7;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(7===s){if(t.isCont()&&(u=t.head(),xt.isDigit(u))){t=t.step(),i.write(xt.decodeDigit(n)<<4|xt.decodeDigit(u)),n=0,s=5;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}break}return new e(r,i,n,o,s)},e}(ft);As.HostAddressParser=Ds;var Ms=function(t){function e(e,r,i){var n=t.call(this)||this;return n.uri=e,n.output=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n)if(t.isCont()&&91===t.head())t=t.step(),n=2;else if(!t.isEmpty())return ft.error(lt.expected(91,t));if(2===n){for(i=i||At.decodedString();t.isCont()&&(o=t.head(),os.isHostChar(o)||58===o);)t=t.step(),i=i.write(os.toLowerCase(o));if(t.isCont()&&93===o)return t=t.step(),ft.done(r.hostIPv6(i.bind()));if(!t.isEmpty())return ft.error(lt.expected(93,t))}return new e(r,i,n)},e}(ft);As.HostLiteralParser=Ms;var Ts=function(t){function e(e,r){var i=t.call(this)||this;return i.uri=e,i.number=r,i}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.number)},e.parse=function(t,r,i){void 0===i&&(i=0);for(var n=0;t.isCont()&&(n=t.head(),pt.isDigit(n));)t=t.step(),i=10*i+pt.decodeDigit(n);return t.isEmpty()?new e(r,i):ft.done(r.port(i))},e}(ft);As.PortParser=Ts;var Rs=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.uri=e,s.builder=r,s.output=i,s.c1=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.builder,this.output,this.c1,this.step)},e.parse=function(t,r,i,n,o,s){void 0===o&&(o=0),void 0===s&&(s=1);for(var u=0;;){if(1===s){for(;t.isCont()&&(u=t.head(),os.isPathChar(u));)n=n||At.decodedString(),t=t.step(),n=n.write(u);if(t.isCont()&&47===u){t=t.step(),i=i||r.pathBuilder(),n&&(i.addSegment(n.bind()),n=void 0),i.addSlash();continue}if(t.isCont()&&37===u)t=t.step(),s=2;else if(!t.isEmpty())return n&&(i=i||r.pathBuilder()).addSegment(n.bind()),i?ft.done(i.bind()):ft.done(r.pathEmpty())}if(2===s)if(t.isCont()&&(u=t.head(),xt.isDigit(u)))t=t.step(),o=u,s=3;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(3===s){if(t.isCont()&&(u=t.head(),xt.isDigit(u))){n=n||At.decodedString(),t=t.step(),n=n.write(xt.decodeDigit(o)<<4|xt.decodeDigit(u)),o=0,s=1;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}break}return new e(r,i,n,o,s)},e}(ft);As.PathParser=Rs;var Is=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u.uri=e,u.builder=r,u.keyOutput=i,u.valueOutput=n,u.c1=o,u.step=s,u}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.builder,this.keyOutput,this.valueOutput,this.c1,this.step)},e.parse=function(t,r,i,n,o,s,u){void 0===s&&(s=0),void 0===u&&(u=1);for(var a=0;;){if(1===u){for(n=n||At.decodedString();t.isCont()&&(a=t.head(),os.isParamChar(a));)t=t.step(),n.write(a);if(t.isCont()&&61===a)t=t.step(),u=4;else{if(t.isCont()&&38===a){t=t.step(),(i=i||r.queryBuilder()).addParam(n.bind()),n=void 0;continue}if(t.isCont()&&37===a)t=t.step(),u=2;else if(!t.isEmpty())return(i=i||r.queryBuilder()).addParam(n.bind()),ft.done(i.bind())}}if(2===u)if(t.isCont()&&(a=t.head(),xt.isDigit(a)))t=t.step(),s=a,u=3;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(3===u){if(t.isCont()&&(a=t.head(),xt.isDigit(a))){t=t.step(),n.write(xt.decodeDigit(s)<<4|xt.decodeDigit(a)),s=0,u=1;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}if(4===u){for(o=o||At.decodedString();t.isCont()&&(a=t.head(),os.isParamChar(a)||61===a);)t=t.step(),o.write(a);if(t.isCont()&&38===a){t=t.step(),(i=i||r.queryBuilder()).addParam(n.bind(),o.bind()),n=void 0,o=void 0,u=1;continue}if(t.isCont()&&38===a)t=t.step(),u=5;else if(!t.isEmpty())return(i=i||r.queryBuilder()).addParam(n.bind(),o.bind()),ft.done(i.bind())}if(5===u)if(t.isCont()&&(a=t.head(),xt.isDigit(a)))t=t.step(),s=a,u=6;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(6===u){if(t.isCont()&&(a=t.head(),xt.isDigit(a))){t=t.step(),o.write(xt.decodeDigit(s)<<4|xt.decodeDigit(a)),s=0,u=4;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}break}return new e(r,i,n,o,s,u)},e}(ft);As.QueryParser=Is;var Fs=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.uri=e,o.output=r,o.c1=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.c1,this.step)},e.parse=function(t,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=1);var s=0;for(i=i||At.decodedString();;){if(1===o){for(;t.isCont()&&(s=t.head(),os.isFragmentChar(s));)t=t.step(),i=i.write(s);if(t.isCont()&&37===s)t=t.step(),o=2;else if(!t.isEmpty())return ft.done(r.fragment(i.bind()))}if(2===o)if(t.isCont()&&(s=t.head(),xt.isDigit(s)))t=t.step(),n=s,o=3;else if(!t.isEmpty())return ft.error(lt.expected("hex digit",t));if(3===o){if(t.isCont()&&(s=t.head(),xt.isDigit(s))){t=t.step(),i=i.write(xt.decodeDigit(n)<<4|xt.decodeDigit(s)),n=0,o=1;continue}if(!t.isEmpty())return ft.error(lt.expected("hex digit",t))}break}return new e(r,i,n,o)},e}(ft);As.FragmentParser=Fs;var Ls=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t,e){return void 0===e?de.from(t.toString()):e.concat(de.from(t.toString()))},e.prototype.cast=function(t,e){var r=t.target();try{var i=r.stringValue();if("string"==typeof i)return os.parse(i)}catch(t){}},e}(Se);os.Form=Ls;var Us=function(){function t(t,e){void 0===e&&(e=32),this._base=t,this._resolveCache=new k(e),this._unresolveCache=new k(e)}return t.prototype.resolve=function(t){t=os.fromAny(t);var e=this._resolveCache.get(t);return void 0===e&&(e=this._base.resolve(t),this._resolveCache.put(t,e)),e},t.prototype.unresolve=function(t){t=os.fromAny(t);var e=this._unresolveCache.get(t);return void 0===e&&(e=this._base.unresolve(t),this._unresolveCache.put(t,e)),e},t}(),Ns=function(){function t(){}return t.prototype.tag=function(){return this.constructor.tag()},t.prototype.prio=function(t){return void 0===t?0:this},t.prototype.rate=function(t){return void 0===t?0:this},t.prototype.toRecon=function(){return to.toString(this.toValue())},t.prototype.toString=function(){return J.debug(this)},t.tag=function(){},t.fromValue=function(e){switch(e.tag()){case"event":return t.EventMessage.fromValue(e);case"command":return t.CommandMessage.fromValue(e);case"link":return t.LinkRequest.fromValue(e);case"linked":return t.LinkedResponse.fromValue(e);case"sync":return t.SyncRequest.fromValue(e);case"synced":return t.SyncedResponse.fromValue(e);case"unlink":return t.UnlinkRequest.fromValue(e);case"unlinked":return t.UnlinkedResponse.fromValue(e);case"auth":return t.AuthRequest.fromValue(e);case"authed":return t.AuthedResponse.fromValue(e);case"deauth":return t.DeauthRequest.fromValue(e);case"deauthed":return t.DeauthedResponse.fromValue(e);default:return}},t.parseRecon=function(e){return t.fromValue(to.parse(e))},t}(),zs=function(t){function e(e){var r=t.call(this)||this;return r._body=e,r}return _(e,t),e.prototype.node=function(t){return void 0===t?os.empty():this},e.prototype.lane=function(t){return void 0===t?os.empty():this},e.prototype.body=function(t){return void 0===t?this._body:(t=se.fromAny(t),this.copy(t))},e.prototype.equals=function(t){return this===t||t instanceof e&&this.__proto__.constructor===t.__proto__.constructor&&this._body.equals(t._body)},e.prototype.hashCode=function(){return c.mash(c.mix(c.seed(this.__proto__),this._body.hashCode()))},e.prototype.debug=function(t){t=t.write(this.__proto__.constructor.name).write(46).write("of").write(40),this._body.isDefined()&&(t=t.debug(this._body)),t=t.write(41)},e.prototype.toValue=function(){return ie.of(this.tag()).concat(this._body)},e.fromValue=function(t,e){if(t.header(e.tag()).isDefined())return new e(t.body())},e}(Ns),js=function(t){function e(e,r,i){var n=t.call(this)||this;return n._node=e,n._lane=r,n._body=i,n}return _(e,t),e.prototype.node=function(t){return void 0===t?this._node:(t=os.fromAny(t),this.copy(t,this._lane,this._body))},e.prototype.lane=function(t){return void 0===t?this._lane:(t=os.fromAny(t),this.copy(this._node,t,this._body))},e.prototype.body=function(t){return void 0===t?this._body:(t=se.fromAny(t),this.copy(this._node,this._lane,t))},e.prototype.toValue=function(){var t=ae.create(2).slot("node",this._node.toString()).slot("lane",this._lane.toString());return ie.of(this.tag(),t).concat(this._body)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.__proto__.constructor===t.__proto__.constructor&&(this._node.equals(t._node)&&this._lane.equals(t._lane)&&this._body.equals(t._body))},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.seed(this.__proto__),this._node.hashCode()),this._lane.hashCode()),this._body.hashCode()))},e.prototype.debug=function(t){t=t.write(this.__proto__.constructor.name).write(46).write("of").write(40).debug(this._node.toString()).write(", ").debug(this._lane.toString()),this._body.isDefined()&&(t=t.write(", ").debug(this._body)),t=t.write(41)},e.fromValue=function(t,e){var r,i;if(t.header(e.tag()).forEach((function(t,e){var n=t.key.stringValue(void 0);void 0!==n?"node"===n?r=os.parse(t.toValue().stringValue("")):"lane"===n&&(i=os.parse(t.toValue().stringValue(""))):t instanceof se&&(0===e?r=os.parse(t.stringValue("")):1===e&&(i=os.parse(t.stringValue(""))))})),r&&i){var n=t.body();return new e(r,i,n)}},e}(Ns),Ws=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._node=e,s._lane=r,s._prio=i,s._rate=n,s._body=o,s}return _(e,t),e.prototype.node=function(t){return void 0===t?this._node:(t=os.fromAny(t),this.copy(t,this._lane,this._prio,this._rate,this._body))},e.prototype.lane=function(t){return void 0===t?this._lane:(t=os.fromAny(t),this.copy(this._node,t,this._prio,this._rate,this._body))},e.prototype.prio=function(t){return void 0===t?this._prio:this.copy(this._node,this._lane,t,this._rate,this._body)},e.prototype.rate=function(t){return void 0===t?this._rate:this.copy(this._node,this._lane,this._prio,t,this._body)},e.prototype.body=function(t){return void 0===t?this._body:(t=se.fromAny(t),this.copy(this._node,this._lane,this._prio,this._rate,t))},e.prototype.equals=function(t){return this===t||t instanceof e&&this.__proto__.constructor===t.__proto__.constructor&&(this._node.equals(t._node)&&this._lane.equals(t._lane)&&this._prio===t._prio&&this._rate===t._rate&&this._body.equals(t._body))},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(c.mix(c.seed(this.__proto__),this._node.hashCode()),this._lane.hashCode()),c.hash(this._prio)),c.hash(this._rate)),this._body.hashCode()))},e.prototype.debug=function(t){t=t.write(this.__proto__.constructor.name).write(46).write("of").write(40).debug(this._node.toString()).write(", ").debug(this._lane.toString()),(this._prio||this._rate)&&(t=t.write(", ").debug(this._prio).write(", ").debug(this._rate)),this._body.isDefined()&&(t=t.write(", ").debug(this._body)),t=t.write(41)},e.prototype.toValue=function(){var t=ae.create(4).slot("node",this._node.toString()).slot("lane",this._lane.toString());return this._prio&&t.slot("prio",this._prio),this._rate&&t.slot("rate",this._rate),ie.of(this.tag(),t).concat(this._body)},e.fromValue=function(t,e){var r,i,n=0,o=0;if(t.header(e.tag()).forEach((function(t,e){var s=t.key.stringValue(void 0);void 0!==s?"node"===s?r=os.parse(t.toValue().stringValue("")):"lane"===s?i=os.parse(t.toValue().stringValue("")):"prio"===s?n=t.numberValue(n):"rate"===s&&(o=t.numberValue(o)):t instanceof se&&(0===e?r=os.parse(t.stringValue("")):1===e&&(i=os.parse(t.stringValue(""))))})),r&&i){var s=t.body();return new e(r,i,n,o,s)}},e}(Ns),qs=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.copy=function(t,r,i){return new e(t,r,i)},e.tag=function(){return"event"},e.fromValue=function(t){return js.fromValue(t,e)},e.of=function(t,r,i){return void 0===i&&(i=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i=se.fromAny(i))},e}(js);Ns.EventMessage=qs;var Bs=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.copy=function(t,r,i){return new e(t,r,i)},e.tag=function(){return"command"},e.fromValue=function(t){return js.fromValue(t,e)},e.of=function(t,r,i){return void 0===i&&(i=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i=se.fromAny(i))},e}(js);Ns.CommandMessage=Bs;var Ks=function(t){function e(e,r,i,n,o){return t.call(this,e,r,i,n,o)||this}return _(e,t),e.prototype.copy=function(t,r,i,n,o){return new e(t,r,i,n,o)},e.tag=function(){return"link"},e.fromValue=function(t){return Ws.fromValue(t,e)},e.of=function(t,r,i,n,o){return void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i,n,o=se.fromAny(o))},e}(Ws);Ns.LinkRequest=Ks;var Hs=function(t){function e(e,r,i,n,o){return t.call(this,e,r,i,n,o)||this}return _(e,t),e.prototype.copy=function(t,r,i,n,o){return new e(t,r,i,n,o)},e.tag=function(){return"linked"},e.fromValue=function(t){return Ws.fromValue(t,e)},e.of=function(t,r,i,n,o){return void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i,n,o=se.fromAny(o))},e}(Ws);Ns.LinkedResponse=Hs;var Gs=function(t){function e(e,r,i,n,o){return t.call(this,e,r,i,n,o)||this}return _(e,t),e.prototype.copy=function(t,r,i,n,o){return new e(t,r,i,n,o)},e.tag=function(){return"sync"},e.fromValue=function(t){return Ws.fromValue(t,e)},e.of=function(t,r,i,n,o){return void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i,n,o=se.fromAny(o))},e}(Ws);Ns.SyncRequest=Gs;var Xs=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.copy=function(t,r,i){return new e(t,r,i)},e.tag=function(){return"synced"},e.fromValue=function(t){return js.fromValue(t,e)},e.of=function(t,r,i){return void 0===i&&(i=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i=se.fromAny(i))},e}(js);Ns.SyncedResponse=Xs;var Ys=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.copy=function(t,r,i){return new e(t,r,i)},e.tag=function(){return"unlink"},e.fromValue=function(t){return js.fromValue(t,e)},e.of=function(t,r,i){return void 0===i&&(i=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i=se.fromAny(i))},e}(js);Ns.UnlinkRequest=Ys;var Zs=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return _(e,t),e.prototype.copy=function(t,r,i){return new e(t,r,i)},e.tag=function(){return"unlinked"},e.fromValue=function(t){return js.fromValue(t,e)},e.of=function(t,r,i){return void 0===i&&(i=se.absent()),new e(t=os.fromAny(t),r=os.fromAny(r),i=se.fromAny(i))},e}(js);Ns.UnlinkedResponse=Zs;var Qs=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.copy=function(t){return new e(t)},e.tag=function(){return"auth"},e.fromValue=function(t){return zs.fromValue(t,e)},e.of=function(t){return void 0===t&&(t=se.absent()),new e(t=se.fromAny(t))},e}(zs);Ns.AuthRequest=Qs;var $s=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.copy=function(t){return new e(t)},e.tag=function(){return"authed"},e.fromValue=function(t){return zs.fromValue(t,e)},e.of=function(t){return void 0===t&&(t=se.absent()),new e(t=se.fromAny(t))},e}(zs);Ns.AuthedResponse=$s;var Js=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.copy=function(t){return new e(t)},e.tag=function(){return"deauth"},e.fromValue=function(t){return zs.fromValue(t,e)},e.of=function(t){return void 0===t&&(t=se.absent()),new e(t=se.fromAny(t))},e}(zs);Ns.DeauthRequest=Js;var tu=function(t){function e(e){return t.call(this,e)||this}return _(e,t),e.prototype.copy=function(t){return new e(t)},e.tag=function(){return"deauthed"},e.fromValue=function(t){return zs.fromValue(t,e)},e.of=function(t){return void 0===t&&(t=se.absent()),new e(t=se.fromAny(t))},e}(zs);Ns.DeauthedResponse=tu;var eu,ru=function(){},iu=function(t){function e(e,r,i){void 0===i&&(i={});var n=t.call(this)||this;return n._context=e,n._hostUri=r,n._options=i,n._downlinks=new jt,n._downlinkCount=0,n._authenticated=!1,n._session=se.absent(),n._uriCache=new Us(r),n._sendBuffer=[],n._reconnectTimer=0,n._reconnectTimeout=0,n._idleTimer=0,n}return _(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.credentials=function(){return this._options.credentials||se.absent()},e.prototype.unlinkDelay=function(){var t=this._options.unlinkDelay;return"number"==typeof t?t:0},e.prototype.maxReconnectTimeout=function(){return this._options.maxReconnectTimeout||3e4},e.prototype.idleTimeout=function(){return this._options.idleTimeout||1e3},e.prototype.sendBufferSize=function(){return this._options.sendBufferSize||1024},e.prototype.isAuthenticated=function(){return this._authenticated},e.prototype.session=function(){return this._session},e.prototype.isIdle=function(){return!this._sendBuffer.length&&!this._downlinkCount},e.prototype.resolve=function(t){return this._uriCache.resolve(t)},e.prototype.unresolve=function(t){return this._uriCache.unresolve(t)},e.prototype.authenticate=function(t){if(!(t=se.fromAny(t)).equals(this._options.credentials))if(this._options.credentials=t,this.isConnected()){var e=Qs.of(t);this.push(e)}else this.open()},e.prototype.openDownlink=function(t){this.clearIdle();var e=this.resolve(t.nodeUri()),r=t.laneUri();this._downlinkCount||this.open();var i=this._downlinks.get(e);if(i||(i=new jt,this._downlinks.set(e,i)),i.get(r))throw new Error("duplicate downlink");i.set(r,t),this._downlinkCount+=1,t.openUp(this),this.isConnected()&&t.hostDidConnect(this)},e.prototype.unlinkDownlink=function(t){var e=this.resolve(t.nodeUri()),r=t.laneUri(),i=this._downlinks.get(e);if(i&&i.get(r)&&this.isConnected()){var n=Ys.of(this.unresolve(e),r);t.onUnlinkRequest(n,this),this.push(n)}},e.prototype.closeDownlink=function(t){var e=this.resolve(t.nodeUri()),r=t.laneUri(),i=this._downlinks.get(e);i&&i.get(r)&&(this._downlinkCount-=1,i.delete(r),i.isEmpty()&&this._downlinks.delete(e),this._downlinkCount||this.watchIdle(),t.closeUp(this))},e.prototype.command=function(t,e,r){t=os.fromAny(t),t=this.resolve(t),e=os.fromAny(e),r=se.fromAny(r);var i=Bs.of(this.unresolve(t),e,r);this.push(i)},e.prototype.onEnvelope=function(t){t instanceof qs?this.onEventMessage(t):t instanceof Bs?this.onCommandMessage(t):t instanceof Ks?this.onLinkRequest(t):t instanceof Hs?this.onLinkedResponse(t):t instanceof Gs?this.onSyncRequest(t):t instanceof Xs?this.onSyncedResponse(t):t instanceof Ys?this.onUnlinkRequest(t):t instanceof Zs?this.onUnlinkedResponse(t):t instanceof Qs?this.onAuthRequest(t):t instanceof $s?this.onAuthedResponse(t):t instanceof Js?this.onDeauthRequest(t):t instanceof tu?this.onDeauthedResponse(t):this.onUnknownEnvelope(t)},e.prototype.onEventMessage=function(t){var e=this.resolve(t.node()),r=t.lane(),i=this._downlinks.get(e);if(i){var n=i.get(r);if(n){var o=t.node(e);n.onEventMessage(o,this)}}},e.prototype.onCommandMessage=function(t){},e.prototype.onLinkRequest=function(t){},e.prototype.onLinkedResponse=function(t){var e=this.resolve(t.node()),r=t.lane(),i=this._downlinks.get(e);if(i){var n=i.get(r);if(n){var o=t.node(e);n.onLinkedResponse(o,this)}}},e.prototype.onSyncRequest=function(t){},e.prototype.onSyncedResponse=function(t){var e=this.resolve(t.node()),r=t.lane(),i=this._downlinks.get(e);if(i){var n=i.get(r);if(n){var o=t.node(e);n.onSyncedResponse(o,this)}}},e.prototype.onUnlinkRequest=function(t){},e.prototype.onUnlinkedResponse=function(t){var e=this.resolve(t.node()),r=t.lane(),i=this._downlinks.get(e);if(i){var n=i.get(r);if(n){var o=t.node(e);n.onUnlinkedResponse(o,this)}}},e.prototype.onAuthRequest=function(t){},e.prototype.onAuthedResponse=function(t){this._authenticated=!0,this._session=t.body(),this._context.hostDidAuthenticate(t.body(),this)},e.prototype.onDeauthRequest=function(t){},e.prototype.onDeauthedResponse=function(t){this._authenticated=!1,this._session=se.absent(),this._context.hostDidDeauthenticate(t.body(),this)},e.prototype.onUnknownEnvelope=function(t){},e.prototype.onConnect=function(){this._reconnectTimeout=0,this._context.hostDidConnect(this),this._downlinks.forEach((function(t,e){e.forEach((function(t,e){e.hostDidConnect(this)}),this)}),this)},e.prototype.onDisconnect=function(){this._authenticated=!1,this._session=se.absent(),this._context.hostDidDisconnect(this),this._downlinks.forEach((function(t,e){e.forEach((function(t,e){e.hostDidDisconnect(this)}),this)}),this)},e.prototype.onError=function(t){this._context.hostDidFail(t,this),this._downlinks.forEach((function(e,r){r.forEach((function(e,r){r.hostDidFail(t,this)}),this)}),this)},e.prototype.reconnect=function(){this._reconnectTimer||(this._reconnectTimeout?this._reconnectTimeout=Math.min(Math.floor(1.8*this._reconnectTimeout),this.maxReconnectTimeout()):this._reconnectTimeout=Math.floor(500+1e3*Math.random()),this._reconnectTimer=setTimeout(this.open.bind(this),this._reconnectTimeout))},e.prototype.clearReconnect=function(){this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=0)},e.prototype.watchIdle=function(){!this._idleTimer&&this.isConnected()&&this.isIdle()&&(this._idleTimer=setTimeout(this.checkIdle.bind(this),this.idleTimeout()))},e.prototype.clearIdle=function(){this._idleTimer&&(clearTimeout(this._idleTimer),this._idleTimer=0)},e.prototype.checkIdle=function(){this.isConnected()&&this.isIdle()&&this.close()},e.prototype.close=function(){this._context.closeHost(this)},e.prototype.closeUp=function(){this._downlinks.forEach((function(t,e){e.forEach((function(t,e){e.closeUp(this)}),this)}),this)},e}(ru),nu=function(t){function e(e,r,i){return void 0===i&&(i={}),t.call(this,e,r,i)||this}return _(e,t),Object.defineProperty(e.prototype,"WebSocket",{get:function(){return this._options.WebSocket||"undefined"!=typeof WebSocket&&WebSocket||"function"==typeof require&&require("ws")||void 0},enumerable:!0,configurable:!0}),e.prototype.isConnected=function(){return!!this._socket&&this._socket.readyState===this._socket.OPEN},e.prototype.open=function(){if(this.clearReconnect(),!this._socket){var t=this.WebSocket;if(!t)throw new Error("WebSocket undefined");var e=this._hostUri,r=e.schemeName();"warp"===r||"swim"===r?e=e.scheme("ws"):"warps"!==r&&"swims"!==r||(e=e.scheme("wss")),this._options.protocols?this._socket=new t(e.toString(),this._options.protocols):this._socket=new t(e.toString()),this._socket.onopen=this.onWebSocketOpen.bind(this),this._socket.onmessage=this.onWebSocketMessage.bind(this),this._socket.onclose=this.onWebSocketClose.bind(this),this._socket.onerror=this.onWebSocketError.bind(this)}},e.prototype.close=function(){this.clearReconnect(),this.clearIdle(),this._socket?(this._socket.close(),this._context.isOnline()||this.onWebSocketClose()):t.prototype.close.call(this)},e.prototype.push=function(t){if(this.isConnected()){this.clearIdle();var e=t.toRecon();this._socket.send(e),this.watchIdle()}else if(t instanceof Bs){if(!(this._sendBuffer.length<this.sendBufferSize()))throw new Error("send buffer overflow");this._sendBuffer.push(t),this.open()}},e.prototype.onWebSocketOpen=function(){if(this.isConnected()){var t=this.credentials();if(t.isDefined()){var e=new Qs(t);this.push(e)}this.onConnect();for(var r=void 0;(r=this._sendBuffer.shift())&&this.isConnected();)this.push(r);this.watchIdle()}else this.close()},e.prototype.onWebSocketMessage=function(t){var e=t.data;if("string"==typeof e){var r=Ns.parseRecon(e);r?this.onEnvelope(r):this.onUnknownEnvelope(e)}},e.prototype.onWebSocketClose=function(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=void 0),this.onDisconnect(),this.clearIdle(),this.isIdle()?this.close():this._context.isOnline()&&this.reconnect()},e.prototype.onWebSocketError=function(){this._socket&&(this._socket.close(),this._context.isOnline()?this.onError():this.onWebSocketClose())},e}(iu),ou=function(){function t(t,e,r,i,n,o,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=se.absent()),this._context=t,this._hostUri=e,this._nodeUri=r,this._laneUri=i,this._prio=n,this._rate=o,this._body=s,this._views=[],this._host=null,this._status=0}return t.prototype.hostUri=function(){return this._hostUri},t.prototype.nodeUri=function(){return this._nodeUri},t.prototype.laneUri=function(){return this._laneUri},t.prototype.prio=function(){return this._prio},t.prototype.rate=function(){return this._rate},t.prototype.body=function(){return this._body},t.prototype.keepLinked=function(){for(var t=0;t<this._views.length;t+=1)if(this._views[t].keepLinked())return!0;return!1},t.prototype.keepSynced=function(){for(var t=0;t<this._views.length;t+=1)if(this._views[t].keepSynced())return!0;return!1},t.prototype.unlinkDelay=function(){return this._host?this._host.unlinkDelay():0},t.prototype.isConnected=function(){return!(!this._host||!this._host.isConnected())},t.prototype.isAuthenticated=function(){return!(!this._host||!this._host.isAuthenticated())},t.prototype.isLinked=function(){return 0!=(2&this._status)},t.prototype.isSynced=function(){return 0!=(8&this._status)},t.prototype.session=function(){return this._host?this._host.session():se.absent()},t.prototype.addDownlink=function(t){this._views.push(t)},t.prototype.removeDownlink=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e]===t&&(this._views.splice(e,1),t.closeUp());if(0===this._views.length){var r=this.unlinkDelay();r<0?this.unlink():setTimeout(this.doUnlink.bind(this),r)}},t.prototype.onEventMessage=function(t,e){for(var r=0;r<this._views.length;r+=1)this._views[r].onEventMessage(t)},t.prototype.onCommandMessage=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].onCommandMessage(t)},t.prototype.onLinkRequest=function(t){this._status|=1;for(var e=0;e<this._views.length;e+=1)this._views[e].onLinkRequest(t)},t.prototype.onLinkedResponse=function(t,e){this._status=-2&this._status|2;for(var r=0;r<this._views.length;r+=1)this._views[r].onLinkedResponse(t)},t.prototype.onSyncRequest=function(t){this._status|=4;for(var e=0;e<this._views.length;e+=1)this._views[e].onSyncRequest(t)},t.prototype.onSyncedResponse=function(t,e){this._status=-5&this._status|8;for(var r=0;r<this._views.length;r+=1)this._views[r].onSyncedResponse(t)},t.prototype.onUnlinkRequest=function(t,e){this._status=-6&this._status|16;for(var r=0;r<this._views.length;r+=1)this._views[r].onUnlinkRequest(t)},t.prototype.onUnlinkedResponse=function(t,e){if(this._status&=-17,0===this._views.length||0!==this._status){for(var r=0;r<this._views.length;r+=1)this._views[r].onUnlinkedResponse(t);this.close()}else this.keepSynced()?this.sync():this.link()},t.prototype.hostDidConnect=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].hostDidConnect();this.keepSynced()?this.sync():this.link()},t.prototype.hostDidDisconnect=function(t){this._status=0;for(var e=!1,r=0;r<this._views.length;r+=1){var i=this._views[r];i.hostDidDisconnect(),e=e||i.keepLinked()}e||this.close()},t.prototype.hostDidFail=function(t,e){for(var r=0;r<this._views.length;r+=1)this._views[r].hostDidFail(t)},t.prototype.command=function(t){t=se.fromAny(t),this.onCommandMessage(t),this._host.command(this._nodeUri,this._laneUri,t)},t.prototype.sync=function(){var t=this._host.unresolve(this._nodeUri),e=Gs.of(t,this._laneUri,this._prio,this._rate,this._body);this.onSyncRequest(e),this._host.push(e)},t.prototype.link=function(){var t=this._host.unresolve(this._nodeUri),e=Ks.of(t,this._laneUri,this._prio,this._rate,this._body);this.onLinkRequest(e),this._host.push(e)},t.prototype.unlink=function(){this._status=16,this._context.unlinkDownlink(this)},t.prototype.doUnlink=function(){0===this._views.length&&this.unlink()},t.prototype.close=function(){this._context.closeDownlink(this)},t.prototype.openUp=function(t){this._host=t;for(var e=0;e<this._views.length;e+=1)this._views[e].openUp(t)},t.prototype.closeUp=function(){var t=this._views;this._views=[];for(var e=0;e<t.length;e+=1)t[e].closeUp()},t}();(eu=t.DownlinkFlags||(t.DownlinkFlags={}))[eu.KeepLinked=1]="KeepLinked",eu[eu.KeepSynced=2]="KeepSynced",eu[eu.KeepLinkedSynced=3]="KeepLinkedSynced";var su=function(){function t(t,e,r,i,n,o,s,u,a,h,p){var l;void 0===i&&(i=os.empty()),void 0===n&&(n=os.empty()),void 0===o&&(o=os.empty()),void 0===s&&(s=0),void 0===u&&(u=0),void 0===a&&(a=se.absent()),void 0===h&&(h=0),void 0===p&&(p=null),p?Array.isArray(p)||(p=[l=p]):p=[],r&&(l=l||{},p=p?p.concat(l):[l],i=void 0!==r.hostUri?os.fromAny(r.hostUri):i,n=void 0!==r.nodeUri?os.fromAny(r.nodeUri):n,o=void 0!==r.laneUri?os.fromAny(r.laneUri):o,s=void 0!==r.prio?r.prio:s,u=void 0!==r.rate?r.rate:u,a=void 0!==r.body?se.fromAny(r.body):a,l.onEvent=r.onEvent||l.onEvent,l.onCommand=r.onCommand||l.onCommand,l.willLink=r.willLink||l.willLink,l.didLink=r.didLink||l.didLink,l.willSync=r.willSync||l.willSync,l.didSync=r.didSync||l.didSync,l.willUnlink=r.willUnlink||l.willUnlink,l.didUnlink=r.didUnlink||l.didUnlink,l.didConnect=r.didConnect||l.didConnect,l.didDisconnect=r.didDisconnect||l.didDisconnect,l.didClose=r.didClose||l.didClose,l.didFail=r.didFail||l.didFail),this._context=t,this._owner=e,this._hostUri=i,this._nodeUri=n,this._laneUri=o,this._prio=s,this._rate=u,this._body=a,this._flags=h,this._model=null,this._observers=p}return t.prototype.hostUri=function(t){return void 0===t?this._hostUri:(t=os.fromAny(t),this.copy(this._context,this._owner,t,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers))},t.prototype.nodeUri=function(t){return void 0===t?this._nodeUri:(t=os.fromAny(t),this.copy(this._context,this._owner,this._hostUri,t,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers))},t.prototype.laneUri=function(t){return void 0===t?this._laneUri:(t=os.fromAny(t),this.copy(this._context,this._owner,this._hostUri,this._nodeUri,t,this._prio,this._rate,this._body,this._flags,this._observers))},t.prototype.prio=function(t){return void 0===t?this._prio:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,t,this._rate,this._body,this._flags,this._observers)},t.prototype.rate=function(t){return void 0===t?this._rate:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,t,this._body,this._flags,this._observers)},t.prototype.body=function(t){return void 0===t?this._body:(t=se.fromAny(t),this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,t,this._flags,this._observers))},t.prototype.keepLinked=function(t){if(void 0===t)return 0!=(1&this._flags);var e=t?1|this._flags:-2&this._flags;return this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,e,this._observers)},t.prototype.keepSynced=function(t){if(void 0===t)return 0!=(2&this._flags);var e=t?2|this._flags:-3&this._flags;return this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,e,this._observers)},t.prototype.observe=function(t){for(var e=this._observers,r=e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];return i[r]=t,this._observers=i,this},t.prototype.unobserve=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i],o=n===t;if(!o)for(var s in n)if(n[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<i;a+=1)u[a]=e[a];for(a=i+1;a<r;a+=1)u[a-1]=e[a];this._observers=u}else this._observers=null;break}}return this},t.prototype.onEvent=function(t){return this.observe({onEvent:t})},t.prototype.onCommand=function(t){return this.observe({onCommand:t})},t.prototype.willLink=function(t){return this.observe({willLink:t})},t.prototype.didLink=function(t){return this.observe({didLink:t})},t.prototype.willSync=function(t){return this.observe({willSync:t})},t.prototype.didSync=function(t){return this.observe({didSync:t})},t.prototype.willUnlink=function(t){return this.observe({willUnlink:t})},t.prototype.didUnlink=function(t){return this.observe({didUnlink:t})},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didClose=function(t){return this.observe({didClose:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.isConnected=function(){return!!this._model&&this._model.isConnected()},t.prototype.isAuthenticated=function(){return!!this._model&&this._model.isAuthenticated()},t.prototype.isLinked=function(){return!!this._model&&this._model.isLinked()},t.prototype.isSynced=function(){return!!this._model&&this._model.isSynced()},t.prototype.session=function(){return this._model?this._model.session():se.absent()},t.prototype.onEventMessage=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.onEvent&&n.onEvent(t.body(),this)}},t.prototype.onCommandMessage=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.onCommand&&n.onCommand(t,this)}},t.prototype.onLinkRequest=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willLink&&n.willLink(this)}},t.prototype.onLinkedResponse=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didLink&&n.didLink(this)}},t.prototype.onSyncRequest=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willSync&&n.willSync(this)}},t.prototype.onSyncedResponse=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didSync&&n.didSync(this)}},t.prototype.onUnlinkRequest=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willUnlink&&n.willUnlink(this)}},t.prototype.onUnlinkedResponse=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didUnlink&&n.didUnlink(this)}},t.prototype.hostDidConnect=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.didConnect&&i.didConnect(this)}},t.prototype.hostDidDisconnect=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.didDisconnect&&i.didDisconnect(this)}},t.prototype.hostDidFail=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didFail&&n.didFail(t,this)}},t.prototype.command=function(t){this._model.command(t)},t.prototype.close=function(){this._owner&&this._owner.removeDownlink(this),this._model&&this._model.removeDownlink(this)},t.prototype.openUp=function(t){},t.prototype.closeUp=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.didClose&&i.didClose(this)}},t.initForm=function(){return t._initForm||(t._initForm=new uu),t._initForm},t}(),uu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.tag=function(e){return 0===arguments.length?"link":void 0!==e?t.prototype.tag.call(this,e):this},e.prototype.mold=function(t){if(t){var e=ae.create();return void 0!==t.hostUri&&e.slot("host",os.fromAny(t.hostUri).toString()),void 0!==t.nodeUri&&e.slot("node",os.fromAny(t.nodeUri).toString()),void 0!==t.laneUri&&e.slot("lane",os.fromAny(t.laneUri).toString()),void 0!==t.prio&&e.slot("prio",t.prio),void 0!==t.rate&&e.slot("rate",t.rate),void 0!==t.body&&e.slot("body",t.body),void 0!==t.type&&e.slot("type",t.type),ae.of(ie.of("link",e))}return $t.extant()},e.prototype.cast=function(t){var e=t.toValue().get("link");if(e.isDefined()){var r={},i=e.get("host");i.isDefined()&&(r.hostUri=i.cast(os.form()));var n=e.get("node");n.isDefined()&&(r.nodeUri=n.cast(os.form()));var o=e.get("lane");o.isDefined()&&(r.laneUri=o.cast(os.form()));var s=e.get("prio");s.isDefined()&&(r.prio=s.numberValue());var u=e.get("rate");u.isDefined()&&(r.rate=u.numberValue());var a=e.get("body");a.isDefined()&&(r.body=a);var h=e.get("type");return h.isDefined()&&(r.type=h.stringValue()),r}},e}(Se),au=function(t){function e(e,r,i,n,o,s,u){return t.call(this,e,r,i,n,o,s,u)||this}return _(e,t),e.prototype.type=function(){return"event"},e}(ou),hu=function(t){function e(e,r,i,n,o,s,u,a,h,p,l){return void 0===p&&(p=1),t.call(this,e,r,i,n,o,s,u,a,h,p,l)||this}return _(e,t),e.prototype.copy=function(t,r,i,n,o,s,u,a,h,p){return new e(t,r,void 0,i,n,o,s,u,a,h,p)},e.prototype.type=function(){return"event"},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var r=this._hostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var i=this._context.getDownlink(r,e,t);if(i){if(!(i instanceof au))throw new Error("downlink type mismatch");i.addDownlink(this)}else(i=new au(this._context,r,e,t,this._prio,this._rate,this._body)).addDownlink(this),this._context.openDownlink(i);return this._model=i,this._owner&&this._owner.addDownlink(this),this},e}(su),pu=function(t){function e(e,r,i,n,o,s,u,a){void 0===a&&(a=new Gt);var h=t.call(this,e,r,i,n,o,s,u)||this;return h._state=a,h}return _(e,t),e.prototype.type=function(){return"list"},e.prototype.isEmpty=function(){return this._state.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._state.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t,e){return this._state.get(t,e)||se.absent()},e.prototype.getEntry=function(t,e){return this._state.getEntry(t,e)},e.prototype.set=function(t,e,r){if(void 0!==r&&(t=this._state.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this._state.length)throw new RangeError(""+t);e=this.listWillUpdate(t,e);var i=this._state.getEntry(t);this._state.set(t,e),this.listDidUpdate(t,e,i[1]);var n=ae.create(2).slot("key",i[0]).slot("index",t);return this.command(ie.of("update",n).concat(e)),this},e.prototype.insert=function(t,e,r){if(t<0||t>this._state.length)throw new RangeError(""+t);e=this.listWillUpdate(t,e),this._state.insert(t,e,r);var i=this._state.getEntry(t);this.listDidUpdate(t,e,se.absent());var n=ae.create(2).slot("key",i[0]).slot("index",t);return this.command(ie.of("update",n).concat(e)),this},e.prototype.remove=function(t,e){if(void 0!==e&&(t=this._state.lookup(e,t))<0)throw new RangeError(""+e);if(t<0||t>this._state.length)throw new RangeError(""+t);this.listWillRemove(t);var r=this._state.getEntry(t);this._state.remove(t),this.listDidRemove(t,r[1]);var i=ae.create(2).slot("key",r[0]).slot("index",t);return this.command(ae.create(1).attr("remove",i)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r+=1){var i=this._state.length+r,n=this.listWillUpdate(i,t[r]);this._state.insert(i,n);var o=this._state.getEntry(i);this.listDidUpdate(i,n,se.absent());var s=ae.create(2).slot("key",o[0]).slot("index",i);this.command(ie.of("update",s).concat(n))}return this._state.length},e.prototype.pop=function(){var t=this._state.length-1;if(t>=0){this.listWillRemove(t);var e=this._state.getEntry(t);this._state.remove(t),this.listDidRemove(t,e[1]);var r=ae.create(2).slot("key",e[0]).slot("index",t);return this.command(ae.create(1).attr("remove",r)),e[1]}return se.absent()},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1;r>=0;r-=1){var i=this.listWillUpdate(0,t[r]);this._state.insert(0,i);var n=this._state.getEntry(0);this.listDidUpdate(0,i,se.absent());var o=ae.create(2).slot("key",n[0]).slot("index",0);this.command(ie.of("update",o).concat(i))}return this._state.length},e.prototype.shift=function(){if(this._state.length>0){this.listWillRemove(0);var t=this._state.getEntry(0);this._state.remove(0),this.listDidRemove(0,t[1]);var e=ae.create(2).slot("key",t[0]).slot("index",0);return this.command(ae.create(1).attr("remove",e)),t[1]}return se.absent()},e.prototype.move=function(t,e,r){if(void 0!==r&&(t=this._state.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this._state.length)throw new RangeError(""+t);if(e<0||e>=this._state.length)throw new RangeError(""+e);if(t!==e){var i=this._state.getEntry(t);this.listWillMove(t,e,i[1]),this._state.remove(t).insert(e,i[1],i[0]),this.listDidMove(t,e,i[1]);var n=ae.create(2).slot("key",i[0]).slot("from",t).slot("to",e);this.command(ae.create(1).attr("move",n))}return this},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];t<0&&(t=this._state.length+t),t=Math.min(Math.max(0,t),this._state.length),void 0===e&&(e=this._state.length-t);for(var n=[],o=t,s=t+e;o<s;o+=1){this.listWillRemove(t);var u=this._state.getEntry(t);n.push(u[1]),this._state.remove(t),this.listDidRemove(t,u[1]);var a=ae.create(2).slot("key",u[0]).slot("index",t);this.command(ae.create(1).attr("remove",a))}for(o=0;o<r.length;o+=1){var h=t+o,p=this.listWillUpdate(h,r[o]);this._state.insert(h,p);var l=this._state.getEntry(h);this.listDidUpdate(h,p,se.absent());a=ae.create(2).slot("key",l[0]).slot("index",h);this.command(ie.of("update",a).concat(p))}return n},e.prototype.clear=function(){this.listWillClear(),this._state.clear(),this.listDidClear(),this.command(ae.create(1).attr("clear"))},e.prototype.forEach=function(t,e){return this._state.forEach((function(r,i,n,o){return t.call(e,r,i,this,o)}),this)},e.prototype.values=function(){return this._state.values()},e.prototype.keys=function(){return this._state.keys()},e.prototype.entries=function(){return this._state.entries()},e.prototype.snapshot=function(){return this._state.clone()},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r);var i=e.body(),n=i.tag();if("update"===n){var o=i.head().toValue();(s=this._state.lookup(o.get("key"),o.get("index").numberValue()))>=0?this.onUpdateEvent(s,i.body(),o.get("key")):this.onInsertEvent(o.get("index").numberValue(0),i.body(),o.get("key"))}else if("move"===n){o=i.head().toValue();(s=this._state.lookup(o.get("key"),o.get("from").numberValue()))>=0&&this.onMoveEvent(s,o.get("to").numberValue(0),o.get("key"))}else if("remove"===n){var s;o=i.head().toValue();(s=this._state.lookup(o.get("key"),o.get("index").numberValue()))>=0&&this.onRemoveEvent(s,o.get("key"))}else if("drop"===n){o=i.head();this.onDropEvent(o.numberValue(0))}else if("take"===n){o=i.head();this.onTakeEvent(o.numberValue(0))}else"clear"===n&&this.onClearEvent()},e.prototype.onInsertEvent=function(t,e,r){e=this.listWillUpdate(t,e),this._state.insert(t,e,r),this.listDidUpdate(t,e,se.absent())},e.prototype.onUpdateEvent=function(t,e,r){e=this.listWillUpdate(t,e);var i=this._state.get(t)||se.absent();this._state.set(t,e),this.listDidUpdate(t,e,i)},e.prototype.onMoveEvent=function(t,e,r){if(t!==(e=Math.min(Math.max(0,e),this._state.length))){var i=this._state.get(t)||se.absent();this.listWillMove(t,e,i),this._state.remove(t).insert(e,i,r),this.listDidMove(t,e,i)}},e.prototype.onRemoveEvent=function(t,e){this.listWillRemove(t);var r=this._state.get(t)||se.absent();this._state.remove(t),this.listDidRemove(t,r)},e.prototype.onDropEvent=function(t){this.listWillDrop(t),this._state.drop(t),this.listDidDrop(t)},e.prototype.onTakeEvent=function(t){this.listWillTake(t),this._state.take(t),this.listDidTake(t)},e.prototype.onClearEvent=function(){this.listWillClear(),this._state.clear(),this.listDidClear()},e.prototype.listWillUpdate=function(t,e){for(var r=0;r<this._views.length;r+=1)e=this._views[r].listWillUpdate(t,e);return e},e.prototype.listDidUpdate=function(t,e,r){for(var i=0;i<this._views.length;i+=1)this._views[i].listDidUpdate(t,e,r)},e.prototype.listWillMove=function(t,e,r){for(var i=0;i<this._views.length;i+=1)this._views[i].listWillMove(t,e,r)},e.prototype.listDidMove=function(t,e,r){for(var i=0;i<this._views.length;i+=1)this._views[i].listDidMove(t,e,r)},e.prototype.listWillRemove=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillRemove(t)},e.prototype.listDidRemove=function(t,e){for(var r=0;r<this._views.length;r+=1)this._views[r].listDidRemove(t,e)},e.prototype.listWillDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillDrop(t)},e.prototype.listDidDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listDidDrop(t)},e.prototype.listWillTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillTake(t)},e.prototype.listDidTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listDidTake(t)},e.prototype.listWillClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].listWillClear()},e.prototype.listDidClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].listDidClear()},e}(ou),lu=function(t){function e(e,r,i,n,o,s,u,a,h,p,l,c,f){void 0===p&&(p=3);var d=t.call(this,e,r,i,n,o,s,u,a,h,p,l)||this;if(i){var y=d._observers[d._observers.length-1];y.willUpdate=i.willUpdate||y.willUpdate,y.didUpdate=i.didUpdate||y.didUpdate,y.willMove=i.willMove||y.willMove,y.didMove=i.didMove||y.didMove,y.willRemove=i.willRemove||y.willRemove,y.didRemove=i.didRemove||y.didRemove,y.willDrop=i.willDrop||y.willDrop,y.didDrop=i.didDrop||y.didDrop,y.willTake=i.willTake||y.willTake,y.didTake=i.didTake||y.didTake,y.willClear=i.willClear||y.willClear,y.didClear=i.didClear||y.didClear,c=i.valueForm?i.valueForm:c}return d._valueForm=c||Se.forValue(),d._state0=f,d}return _(e,t),e.prototype.copy=function(t,r,i,n,o,s,u,a,h,p,l,c){return 10===arguments.length&&(l=this._valueForm,c=this._state0),new e(t,r,void 0,i,n,o,s,u,a,h,p,l,c)},e.prototype.type=function(){return"list"},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,t,this._state0)},e.prototype.isEmpty=function(){return this._model.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._model.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t,e){return this._model.get(t,e).coerce(this._valueForm)},e.prototype.getEntry=function(t,e){var r=this._model.getEntry(t,e);if(r)return[r[0].coerce(this._valueForm),r[1]]},e.prototype.set=function(t,e,r){var i=this._valueForm.mold(e);return this._model.set(t,i,r),this},e.prototype.insert=function(t,e,r){var i=this._valueForm.mold(e);return this._model.insert(t,i,r),this},e.prototype.remove=function(t,e){return this._model.remove(t,e),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=new Array(t.length),i=0;i<t.length;i+=1)r[i]=this._valueForm.mold(t[i]);return this._model.push.apply(this._model,r)},e.prototype.pop=function(){return this._model.pop().coerce(this._valueForm)},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=new Array(t.length),i=0;i<t.length;i+=1)r[i]=this._valueForm.mold(t[i]);return this._model.unshift.apply(this._model,r)},e.prototype.shift=function(){return this._model.shift().coerce(this._valueForm)},e.prototype.move=function(t,e,r){return this._model.move(t,e,r),this},e.prototype.splice=function(t,e){for(var r,i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var o=new Array(i.length),s=0;s<i.length;s+=1)o[s]=this._valueForm.mold(i[s]);var u=(r=this._model).splice.apply(r,w([t,e],o)),a=new Array(u.length);for(s=0;s<u.length;s+=1)a[s]=u[s].coerce(this._valueForm);return a},e.prototype.clear=function(){this._model.clear()},e.prototype.forEach=function(t,e){return this._valueForm===Se.forValue()?this._model._state.forEach(t,e):this._model._state.forEach((function(r,i,n,o){var s=r.coerce(this._valueForm);return t.call(e,s,i,this,o)}),this)},e.prototype.values=function(){var t=this._model.values();return this._valueForm===Se.forValue()?t:new Er(t,this._valueForm)},e.prototype.keys=function(){return this._model.keys()},e.prototype.entries=function(){var t=this._model.entries();return this._valueForm===Se.forValue()?t:new Or(t,Se.forValue(),this._valueForm)},e.prototype.snapshot=function(){return this._model.snapshot()},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willUpdate=function(t){return this.observe({willUpdate:t})},e.prototype.didUpdate=function(t){return this.observe({didUpdate:t})},e.prototype.willMove=function(t){return this.observe({willMove:t})},e.prototype.didMove=function(t){return this.observe({didMove:t})},e.prototype.willRemove=function(t){return this.observe({willRemove:t})},e.prototype.didRemove=function(t){return this.observe({didRemove:t})},e.prototype.willDrop=function(t){return this.observe({willDrop:t})},e.prototype.didDrop=function(t){return this.observe({didDrop:t})},e.prototype.willTake=function(t){return this.observe({willTake:t})},e.prototype.didTake=function(t){return this.observe({didTake:t})},e.prototype.willClear=function(t){return this.observe({willClear:t})},e.prototype.didClear=function(t){return this.observe({didClear:t})},e.prototype.listWillUpdate=function(t,e){for(var r,i=this._observers,n=i?i.length:0,o=0;o<n;o+=1){var s=i[o];if(s.willUpdate){void 0===r&&(r=e.coerce(this._valueForm));var u=s.willUpdate(t,r,this);void 0!==u&&(r=u,e=this._valueForm.mold(r))}}return e},e.prototype.listDidUpdate=function(t,e,r){for(var i,n,o=this._observers,s=o?o.length:0,u=0;u<s;u+=1){var a=o[u];a.didUpdate&&(void 0===i&&(i=e.coerce(this._valueForm)),void 0===n&&(n=r.coerce(this._valueForm)),a.didUpdate(t,i,n,this))}},e.prototype.listWillMove=function(t,e,r){for(var i,n=this._observers,o=n?n.length:0,s=0;s<o;s+=1){var u=n[s];u.willMove&&(void 0===i&&(i=r.coerce(this._valueForm)),u.willMove(t,e,i,this))}},e.prototype.listDidMove=function(t,e,r){for(var i,n=this._observers,o=n?n.length:0,s=0;s<o;s+=1){var u=n[s];u.didMove&&(void 0===i&&(i=r.coerce(this._valueForm)),u.didMove(t,e,i,this))}},e.prototype.listWillRemove=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willRemove&&n.willRemove(t,this)}},e.prototype.listDidRemove=function(t,e){for(var r,i=this._observers,n=i?i.length:0,o=0;o<n;o+=1){var s=i[o];s.didRemove&&(void 0===r&&(r=e.coerce(this._valueForm)),s.didRemove(t,r,this))}},e.prototype.listWillDrop=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willDrop&&n.willDrop(t,this)}},e.prototype.listDidDrop=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didDrop&&n.didDrop(t,this)}},e.prototype.listWillTake=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willTake&&n.willTake(t,this)}},e.prototype.listDidTake=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didTake&&n.didTake(t,this)}},e.prototype.listWillClear=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.willClear&&i.willClear(this)}},e.prototype.listDidClear=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.didClear&&i.didClear(this)}},e.prototype.initialState=function(t){return void 0===t?this._state0||null:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,this._valueForm,t||void 0)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this._model._state.forEach((function(t,e){this.listDidUpdate(e,t,se.absent())}),this),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var r=this._hostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var i=this._context.getDownlink(r,e,t);if(i){if(!(i instanceof pu))throw new Error("downlink type mismatch");i.addDownlink(this),this._model=i,setTimeout(this.didAliasModel.bind(this))}else(i=new pu(this._context,r,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(i),this._model=i;return this._owner&&this._owner.addDownlink(this),this},e}(su),cu=function(t){function e(e,r,i,n,o,s,u,a){void 0===a&&(a=new jt);var h=t.call(this,e,r,i,n,o,s,u)||this;return h._state=a,h}return _(e,t),e.prototype.type=function(){return"map"},Object.defineProperty(e.prototype,"size",{get:function(){return this._state.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._state.isEmpty()},e.prototype.has=function(t){return this._state.has(t)},e.prototype.get=function(t){return this._state.get(t)||se.absent()},e.prototype.getEntry=function(t){return this._state.getEntry(t)},e.prototype.set=function(t,e){e=this.mapWillUpdate(t,e);var r=this._state.get(t)||se.absent();this._state.set(t,e),this.mapDidUpdate(t,e,r);var i=ae.create(1).slot("key",t);return this.command(ie.of("update",i).concat(e)),this},e.prototype.delete=function(t){if(this._state.has(t)){this.mapWillRemove(t);var e=this._state.get(t)||se.absent();this._state.delete(t),this.mapDidRemove(t,e);var r=ae.create(1).slot("key",t);return this.command(ae.create(1).attr("remove",r)),!0}return!1},e.prototype.drop=function(t){return this.mapWillDrop(t),this._state.drop(t),this.mapDidDrop(t),this.command(ae.create(1).attr("drop",t)),this},e.prototype.take=function(t){return this.mapWillTake(t),this._state.take(t),this.mapDidTake(t),this.command(ae.create(1).attr("take",t)),this},e.prototype.clear=function(){this.mapWillClear(),this._state.clear(),this.mapDidClear(),this.command(ae.create(1).attr("clear"))},e.prototype.forEach=function(t,e){return this._state.forEach((function(r,i){return t.call(e,r,i,this)}),this)},e.prototype.keys=function(){return this._state.keys()},e.prototype.values=function(){return this._state.values()},e.prototype.entries=function(){return this._state.entries()},e.prototype.snapshot=function(){return this._state.clone()},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r);var i=e.body(),n=i.tag();if("update"===n){var o=i.head().toValue();this.onUpdateEvent(o.get("key"),i.body())}else if("remove"===n){o=i.head().toValue();this.onRemoveEvent(o.get("key"))}else if("drop"===n){o=i.head().toValue();this.onDropEvent(o.numberValue(0))}else if("take"===n){o=i.head().toValue();this.onTakeEvent(o.numberValue(0))}else"clear"===n&&this.onClearEvent()},e.prototype.onUpdateEvent=function(t,e){e=this.mapWillUpdate(t,e);var r=this._state.get(t)||se.absent();this._state.set(t,e),this.mapDidUpdate(t,e,r)},e.prototype.onRemoveEvent=function(t){this.mapWillRemove(t);var e=this._state.get(t)||se.absent();this._state.delete(t),this.mapDidRemove(t,e)},e.prototype.onDropEvent=function(t){this.mapWillDrop(t),this._state.drop(t),this.mapDidDrop(t)},e.prototype.onTakeEvent=function(t){this.mapWillTake(t),this._state.take(t),this.mapDidTake(t)},e.prototype.onClearEvent=function(){this.mapWillClear(),this._state.clear(),this.mapDidClear()},e.prototype.mapWillUpdate=function(t,e){for(var r=0;r<this._views.length;r+=1)e=this._views[r].mapWillUpdate(t,e);return e},e.prototype.mapDidUpdate=function(t,e,r){for(var i=0;i<this._views.length;i+=1)this._views[i].mapDidUpdate(t,e,r)},e.prototype.mapWillRemove=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillRemove(t)},e.prototype.mapDidRemove=function(t,e){for(var r=0;r<this._views.length;r+=1)this._views[r].mapDidRemove(t,e)},e.prototype.mapWillDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillDrop(t)},e.prototype.mapDidDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapDidDrop(t)},e.prototype.mapWillTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillTake(t)},e.prototype.mapDidTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapDidTake(t)},e.prototype.mapWillClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].mapWillClear()},e.prototype.mapDidClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].mapDidClear()},e}(ou),fu=function(t){function e(e,r,i,n,o,s,u,a,h,p,l,c,f,d){void 0===p&&(p=3);var y=t.call(this,e,r,i,n,o,s,u,a,h,p,l)||this;if(i){var v=y._observers[y._observers.length-1];v.willUpdate=i.willUpdate||v.willUpdate,v.didUpdate=i.didUpdate||v.didUpdate,v.willRemove=i.willRemove||v.willRemove,v.didRemove=i.didRemove||v.didRemove,v.willDrop=i.willDrop||v.willDrop,v.didDrop=i.didDrop||v.didDrop,v.willTake=i.willTake||v.willTake,v.didTake=i.didTake||v.didTake,v.willClear=i.willClear||v.willClear,v.didClear=i.didClear||v.didClear,c=i.keyForm?i.keyForm:c,f=i.valueForm?i.valueForm:f}return y._keyForm=c||Se.forValue(),y._valueForm=f||Se.forValue(),y._state0=d,y._input=null,y._effects=new jt,y._outlets=new jt,y._outputs=null,y._version=-1,y}return _(e,t),e.prototype.copy=function(t,r,i,n,o,s,u,a,h,p,l,c,f){return 10===arguments.length&&(f=this._state0,l=this._keyForm,c=this._valueForm),new e(t,r,void 0,i,n,o,s,u,a,h,p,l,c,f)},e.prototype.type=function(){return"map"},e.prototype.keyForm=function(t){return void 0===t?this._keyForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,t,this._valueForm,this._state0)},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,this._keyForm,t,this._state0)},Object.defineProperty(e.prototype,"size",{get:function(){return this._model.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._model.isEmpty()},e.prototype.has=function(t){var e=this._keyForm.mold(t);return this._model.has(e)},e.prototype.get=function(t){if(void 0===t)return this;var e=this._keyForm.mold(t);return this._model.get(e).coerce(this._valueForm)},e.prototype.getEntry=function(t){var e=this._model.getEntry(t);if(e)return[e[0].coerce(this._keyForm),e[1].coerce(this._valueForm)]},e.prototype.firstKey=function(){var t=this._model._state.firstKey();if(void 0!==t){var e=this._keyForm.cast(t);if(void 0!==e)return e}return this._keyForm.unit()},e.prototype.firstValue=function(){var t=this._model._state.firstValue();if(void 0!==t){var e=this._valueForm.cast(t);if(void 0!==e)return e}return this._valueForm.unit()},e.prototype.firstEntry=function(){var t=this._model._state.firstEntry();if(void 0!==t)return[this._keyForm.cast(t[0]),this._valueForm.cast(t[1])]},e.prototype.lastKey=function(){var t=this._model._state.lastKey();if(void 0!==t){var e=this._keyForm.cast(t);if(void 0!==e)return e}return this._keyForm.unit()},e.prototype.lastValue=function(){var t=this._model._state.lastValue();if(void 0!==t){var e=this._valueForm.cast(t);if(void 0!==e)return e}return this._valueForm.unit()},e.prototype.lastEntry=function(){var t=this._model._state.lastEntry();if(void 0!==t)return[this._keyForm.cast(t[0]),this._valueForm.cast(t[1])]},e.prototype.nextKey=function(t){var e=this._keyForm.mold(t),r=this._model._state.nextKey(e);if(void 0!==r){var i=this._keyForm.cast(r);if(void 0!==i)return i}return this._keyForm.unit()},e.prototype.nextValue=function(t){var e=this._keyForm.mold(t),r=this._model._state.nextValue(e);if(void 0!==r){var i=this._valueForm.cast(r);if(void 0!==i)return i}return this._valueForm.unit()},e.prototype.nextEntry=function(t){var e=this._keyForm.mold(t),r=this._model._state.nextEntry(e);if(void 0!==r)return[this._keyForm.cast(r[0]),this._valueForm.cast(r[1])]},e.prototype.previousKey=function(t){var e=this._keyForm.mold(t),r=this._model._state.previousKey(e);if(void 0!==r){var i=this._keyForm.cast(r);if(void 0!==i)return i}return this._keyForm.unit()},e.prototype.previousValue=function(t){var e=this._keyForm.mold(t),r=this._model._state.previousValue(e);if(void 0!==r){var i=this._valueForm.cast(r);if(void 0!==i)return i}return this._valueForm.unit()},e.prototype.previousEntry=function(t){var e=this._keyForm.mold(t),r=this._model._state.previousEntry(e);if(void 0!==r)return[this._keyForm.cast(r[0]),this._valueForm.cast(r[1])]},e.prototype.set=function(t,e){var r=this._keyForm.mold(t),i=this._valueForm.mold(e);return this._model.set(r,i),this},e.prototype.delete=function(t){var e=this._keyForm.mold(t);return this._model.delete(e)},e.prototype.drop=function(t){return this._model.drop(t),this},e.prototype.take=function(t){return this._model.take(t),this},e.prototype.clear=function(){this._model.clear()},e.prototype.forEach=function(t,e){return this._keyForm===Se.forValue()&&this._valueForm===Se.forValue()?this._model._state.forEach(t,e):this._model._state.forEach((function(r,i){var n=r.coerce(this._keyForm),o=i.coerce(this._valueForm);return t.call(e,n,o,this)}),this)},e.prototype.keys=function(){var t=this._model.keys();return this._keyForm===Se.forValue()?t:new Er(t,this._keyForm)},e.prototype.values=function(){var t=this._model.values();return this._valueForm===Se.forValue()?t:new Er(t,this._valueForm)},e.prototype.entries=function(){var t=this._model.entries();return this._keyForm===Se.forValue()&&this._valueForm===Se.forValue()?t:new Or(t,this._keyForm,this._valueForm)},e.prototype.snapshot=function(){return this._model.snapshot()},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willUpdate=function(t){return this.observe({willUpdate:t})},e.prototype.didUpdate=function(t){return this.observe({didUpdate:t})},e.prototype.willRemove=function(t){return this.observe({willRemove:t})},e.prototype.didRemove=function(t){return this.observe({didRemove:t})},e.prototype.willDrop=function(t){return this.observe({willDrop:t})},e.prototype.didDrop=function(t){return this.observe({didDrop:t})},e.prototype.willTake=function(t){return this.observe({willTake:t})},e.prototype.didTake=function(t){return this.observe({didTake:t})},e.prototype.willClear=function(t){return this.observe({willClear:t})},e.prototype.didClear=function(t){return this.observe({didClear:t})},e.prototype.mapWillUpdate=function(t,e){for(var r,i,n=this._observers,o=n?n.length:0,s=0;s<o;s+=1){var u=n[s];if(u.willUpdate){void 0===r&&(r=t.coerce(this._keyForm)),void 0===i&&(i=e.coerce(this._valueForm));var a=u.willUpdate(r,i,this);void 0!==a&&(i=a,e=this._valueForm.mold(i))}}return e},e.prototype.mapDidUpdate=function(t,e,r){for(var i,n,o=this._observers,s=o?o.length:0,u=t.coerce(this._keyForm),a=0;a<s;a+=1){var h=o[a];h.didUpdate&&(void 0===i&&(i=e.coerce(this._valueForm)),void 0===n&&(n=r.coerce(this._valueForm)),h.didUpdate(u,i,n,this))}this.decohereInputKey(u,0),this.recohereInput(0)},e.prototype.mapWillRemove=function(t){for(var e,r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.willRemove&&(void 0===e&&(e=t.coerce(this._keyForm)),o.willRemove(e,this))}},e.prototype.mapDidRemove=function(t,e){for(var r,i=this._observers,n=i?i.length:0,o=t.coerce(this._keyForm),s=0;s<n;s+=1){var u=i[s];u.didRemove&&(void 0===r&&(r=e.coerce(this._valueForm)),u.didRemove(o,r,this))}this.decohereInputKey(o,1),this.recohereInput(0)},e.prototype.mapWillDrop=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willDrop&&n.willDrop(t,this)}},e.prototype.mapDidDrop=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didDrop&&n.didDrop(t,this)}},e.prototype.mapWillTake=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.willTake&&n.willTake(t,this)}},e.prototype.mapDidTake=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didTake&&n.didTake(t,this)}},e.prototype.mapWillClear=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.willClear&&i.willClear(this)}},e.prototype.mapDidClear=function(){for(var t=this._observers,e=t?t.length:0,r=0;r<e;r+=1){var i=t[r];i.didClear&&i.didClear(this)}},e.prototype.initialState=function(t){return void 0===t?this._state0||null:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,this._keyForm,this._valueForm,t||void 0)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this._model._state.forEach((function(t,e){this.mapDidUpdate(t,e,se.absent())}),this),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var r=this._hostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var i=this._context.getDownlink(r,e,t);if(i){if(!(i instanceof cu))throw new Error("downlink type mismatch");i.addDownlink(this),this._model=i,setTimeout(this.didAliasModel.bind(this))}else(i=new cu(this._context,r,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(i),this._model=i;return this._owner&&this._owner.addDownlink(this),this},e.prototype.keyIterator=function(){return this.keys()},e.prototype.input=function(){return this._input},e.prototype.bindInput=function(t){if(!Mr.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},e.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},e.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},e.prototype.outlet=function(t){var e=this._outlets.get(t);return void 0===e&&(e=new Ur(this,t),this._outlets=this._outlets.updated(t,e)),e},e.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},e.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},e.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},e.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1)t[e].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new jt,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var r=0,i=e.length;r<i;r+=1){var n=e[r];n.unbindInput(),n.disconnectOutputs()}}},e.prototype.decohereOutputKey=function(t,e){this.decohereKey(t,e)},e.prototype.decohereInputKey=function(t,e){this.decohereKey(t,e)},e.prototype.decohereKey=function(t,e){var r=this._effects;if(r.get(t)!==e){this.willDecohereKey(t,e),this._effects=r.updated(t,e),this._version=-1,this.onDecohereKey(t,e);for(var i=null!==this._outputs?this._outputs.length:0,n=0;n<i;n+=1){var o=this._outputs[n];Dr.is(o)?o.decohereOutputKey(t,e):o.decohereOutput()}var s=this._outlets.get(t);void 0!==s&&s.decohereInput(),this.didDecohereKey(t,e)}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this._outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},e.prototype.recohereOutputKey=function(t,e){this.recohereKey(t,e)},e.prototype.recohereInputKey=function(t,e){this.recohereKey(t,e)},e.prototype.recohereKey=function(t,e){if(this._version<0){var r=this._effects,i=r.get(t);if(void 0!==i){this.willRecohereKey(t,i,e),this._effects=r.removed(t),null!==this._input&&this._input.recohereInputKey(t,e),this.onRecohereKey(t,i,e);for(var n=0,o=null!==this._outputs?this._outputs.length:0;n<o;n+=1){var s=this._outputs[n];Dr.is(s)&&s.recohereOutputKey(t,e)}var u=this._outlets.get(t);void 0!==u&&u.recohereInput(e),this.didRecohereKey(t,i,e)}}},e.prototype.recohereOutput=function(t){this.recohere(t)},e.prototype.recohereInput=function(t){this.recohere(t)},e.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._effects.forEach((function(e){this.recohereKey(e,t)}),this),this._version=t,this.onRecohere(t);for(var e=0,r=null!==this._outputs?this._outputs.length:0;e<r;e+=1)this._outputs[e].recohereOutput(t);this.didRecohere(t)}},e.prototype.willDecohereKey=function(t,e){},e.prototype.onDecohereKey=function(t,e){},e.prototype.didDecohereKey=function(t,e){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohereKey=function(t,e,r){},e.prototype.onRecohereKey=function(t,e,r){if(0===e){if(null!==this._input){var i=this._input.get(t);void 0!==i?this.set(t,i):this.delete(t)}}else 1===e&&this.delete(t)},e.prototype.didRecohereKey=function(t,e,r){},e.prototype.willRecohere=function(t){},e.prototype.onRecohere=function(t){},e.prototype.didRecohere=function(t){},e.prototype.memoize=function(){return this},e.prototype.filter=function(t){var e=new Jr(t);return e.bindInput(this),e},e.prototype.map=function(t){var e;return 1===t.length?((e=new ei(t)).bindInput(this),e):((e=new ii(t)).bindInput(this),e)},e.prototype.reduce=function(t,e,r){var i=new oi(t,e,r);return i.bindInput(this),i},e.prototype.watch=function(t){return 1===t.length?(new ui(t).bindInput(this),this):(new hi(t).bindInput(this),this)},e}(su),du=function(t){function e(e,r,i,n,o,s,u,a){void 0===a&&(a=se.absent());var h=t.call(this,e,r,i,n,o,s,u)||this;return h._state=a,h}return _(e,t),e.prototype.type=function(){return"value"},e.prototype.get=function(){return this._state},e.prototype.set=function(t){t=this.valueWillSet(t);var e=this._state;this.setState(t),this.valueDidSet(t,e),this.command(t)},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r),this.onSetEvent(e.body())},e.prototype.onSetEvent=function(t){t=this.valueWillSet(t);var e=this._state;this.setState(t),this.valueDidSet(t,e)},e.prototype.valueWillSet=function(t){for(var e=0;e<this._views.length;e+=1)t=this._views[e].valueWillSet(t);return t},e.prototype.valueDidSet=function(t,e){for(var r=0;r<this._views.length;r+=1)this._views[r].valueDidSet(t,e)},e}(ou),yu=function(t){function e(e,r,i,n,o,s,u,a,h,p,l,c,f){void 0===p&&(p=3),void 0===f&&(f=se.absent());var d=t.call(this,e,r,i,n,o,s,u,a,h,p,l)||this;if(i){var y=d._observers[d._observers.length-1];y.willSet=i.willSet||y.willSet,y.didSet=i.didSet||y.didSet,c=i.valueForm?i.valueForm:c}return d._valueForm=c||Se.forValue(),d._state0=f,d._input=null,d._outputs=null,d._version=-1,d}return _(e,t),e.prototype.copy=function(t,r,i,n,o,s,u,a,h,p,l,c){return 10===arguments.length&&(c=this._state0,l=this._valueForm),new e(t,r,void 0,i,n,o,s,u,a,h,p,l,c)},e.prototype.type=function(){return"value"},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,t,this._state0)},e.prototype.get=function(){return this._model.get().coerce(this._valueForm)},e.prototype.set=function(t){var e=this._valueForm.mold(t);this._model.set(e)},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willSet=function(t){return this.observe({willSet:t})},e.prototype.didSet=function(t){return this.observe({didSet:t})},e.prototype.valueWillSet=function(t){for(var e,r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];if(o.willSet){void 0===e&&(e=t.coerce(this._valueForm));var s=o.willSet(e,this);void 0!==s&&(e=s,t=this._valueForm.mold(e))}}return t},e.prototype.valueDidSet=function(t,e){for(var r,i,n=this._observers,o=n?n.length:0,s=0;s<o;s+=1){var u=n[s];u.didSet&&(void 0===r&&(r=t.coerce(this._valueForm)),void 0===i&&(i=e.coerce(this._valueForm)),u.didSet(r,i,this))}this.decohere(),this.recohere(0)},e.prototype.initialState=function(t){return void 0===t?this._state0:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this._observers,this._valueForm,t)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this.valueDidSet(this._model.get(),se.absent()),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var r=this._hostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var i=this._context.getDownlink(r,e,t);if(i){if(!(i instanceof du))throw new Error("downlink type mismatch");i.addDownlink(this),this._model=i,setTimeout(this.didAliasModel.bind(this))}else(i=new du(this._context,r,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(i),this._model=i;return this._owner&&this._owner.addDownlink(this),this},e.prototype.input=function(){return this._input},e.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},e.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},e.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},e.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},e.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},e.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},e.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1)t[e].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){var i=t[e];i.unbindInput(),i.disconnectOutputs()}}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this.didDecohere()}},e.prototype.recohereOutput=function(t){this.recohere(t)},e.prototype.recohereInput=function(t){this.recohere(t)},e.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._version=t,null!==this._input&&this._input.recohereInput(t),this.onRecohere(t);for(var e=null!==this._outputs?this._outputs.length:0,r=0;r<e;r+=1)this._outputs[r].recohereOutput(t);this.didRecohere(t)}},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohere=function(t){},e.prototype.onRecohere=function(t){if(null!==this._input){var e=this._input.get();void 0!==e&&this.set(e)}},e.prototype.didRecohere=function(t){},e.prototype.memoize=function(){return this},e.prototype.map=function(t){var e=new ei(t);return e.bindInput(this),e},e.prototype.watch=function(t){return new ui(t).bindInput(this),this},e}(su),vu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(gi),_u=function(t){function e(e){var r=t.call(this)||this;return r._downlink=e,r}return _(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._downlink.isEmpty()},e.prototype.isArray=function(){return!0},e.prototype.isObject=function(){return this._downlink.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._downlink.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._downlink.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return void 0===t?this:se.absent()},e.prototype.getAttr=function(t){return se.absent()},e.prototype.getSlot=function(t){return se.absent()},e.prototype.getItem=function(t){t instanceof ye&&(t=t.value);var e=this._downlink.length;return t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0?this._downlink.get(t):$t.absent()},e.prototype.set=function(t,e){throw new Error("unsupported")},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){t instanceof ye&&(t=t.value);var r=this._downlink.length;return t<0&&(t=r+t),(t=Math.min(Math.max(0,t),r-1))>=0&&this._downlink.set(t,se.fromAny(e)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._downlink.push.apply(this._downlink,arguments)},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return this._downlink.splice.apply(this._downlink,arguments)},e.prototype.delete=function(t){return $t.absent()},e.prototype.clear=function(){this._downlink.clear()},e.prototype.forEach=function(t,e){return this._downlink.forEach((function(r,i){return t.call(e,r,i)}))},e.prototype.keyIterator=function(){return y.empty()},e}(vu),mu=function(t){function e(e){var r=t.call(this)||this;return r._downlink=e,r._downlink.observe(r),r}return _(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._downlink.isEmpty()},e.prototype.isArray=function(){return this._downlink.isEmpty()},e.prototype.isObject=function(){return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this._downlink.size},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._downlink.has(t)},e.prototype.get=function(t){return void 0===t?this:this._downlink.get(t)},e.prototype.getAttr=function(t){return se.absent()},e.prototype.getSlot=function(t){return this.get(t)},e.prototype.getItem=function(t){t instanceof ye&&(t=t.value);var e=this._downlink.size;if(t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0){var r=this._downlink.getEntry(t);return ne.of(r[0],r[1])}return $t.absent()},e.prototype.set=function(t,e){return this._downlink.set(t,e),this},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){return this.set(t,e)},e.prototype.setItem=function(t,e){throw new Error("unsupported")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];throw new Error("unsupported")},e.prototype.delete=function(t){t=se.fromAny(t);var e=this._downlink.get(t);return this._downlink.delete(t)?ne.of(t,e):$t.absent()},e.prototype.clear=function(){this._downlink.clear()},e.prototype.forEach=function(t,e){var r=0;return this._downlink.forEach((function(i,n){var o=t.call(e,ne.of(i,n),r);return r+=1,o}))},e.prototype.keyIterator=function(){return this._downlink.keys()},e.prototype.didUpdate=function(t,e,r){this.decohereInputKey(t,0),this.recohereInput(0)},e.prototype.didRemove=function(t,e){this.decohereInputKey(t,1),this.recohereInput(0)},e.prototype.didDrop=function(t){},e.prototype.didTake=function(t){},e.prototype.didClear=function(){},e}(vu),wu=function(t){function e(e){var r=t.call(this)||this;return r._downlink=e,r._downlink.observe(r),r}return _(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){var t=this._downlink.get();return t instanceof ae?t.isEmpty():!t.isDefined()},e.prototype.isArray=function(){var t=this._downlink.get();return!(t instanceof ae)||t.isArray()},e.prototype.isObject=function(){var t=this._downlink.get();return t instanceof ae?t.isObject():!t.isDefined()},Object.defineProperty(e.prototype,"length",{get:function(){var t=this._downlink.get();return t instanceof ae?t.length:t.isDefined()?1:0},enumerable:!0,configurable:!0}),e.prototype.has=function(t){var e=this._downlink.get();return e instanceof ae&&e.has(t)},e.prototype.get=function(t){if(void 0===t)return this;var e=this._downlink.get();return e instanceof ae?e.get(t):se.absent()},e.prototype.getAttr=function(t){var e=this._downlink.get();return e instanceof ae?e.getAttr(t):se.absent()},e.prototype.getSlot=function(t){var e=this._downlink.get();return e instanceof ae?e.getSlot(t):se.absent()},e.prototype.getField=function(t){var e=this._downlink.get();return e instanceof ae?e.getField(t):void 0},e.prototype.getItem=function(t){var e=this._downlink.get();return e instanceof ae?e.getItem(t):e},e.prototype.set=function(t,e){var r=this._downlink.get();if(!(r instanceof ae))throw new Error("unsupported");return r.set(t,e),this},e.prototype.setAttr=function(t,e){var r=this._downlink.get();if(!(r instanceof ae))throw new Error("unsupported");return r.setAttr(t,e),this},e.prototype.setSlot=function(t,e){var r=this._downlink.get();if(!(r instanceof ae))throw new Error("unsupported");return r.setSlot(t,e),this},e.prototype.setItem=function(t,e){var r=this._downlink.get();return r instanceof ae?r.setItem(t,e):this._downlink.set($t.fromAny(e).toValue()),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this._downlink.get();if(r instanceof ae)return r.push.apply(r,arguments);throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this._downlink.get();if(n instanceof ae)return n.splice.apply(n,arguments);throw new Error("unsupported")},e.prototype.delete=function(t){var e=this._downlink.get();return e instanceof ae?e.delete(t):se.absent()},e.prototype.clear=function(){var t=this._downlink.get();if(!(t instanceof ae))throw new Error("unsupported");t.clear()},e.prototype.forEach=function(t,e){return this._downlink.get().forEach(t,e)},e.prototype.keyIterator=function(){if(this._downlink.get()instanceof ae)throw new Error;return y.empty()},e.prototype.didSet=function(t,e){this.decohereInput(),this.recohereInput(0)},e}(vu),gu=function(t){function e(e){var r=t.call(this)||this;return r.warp=e,r}return _(e,t),e.prototype.reify=function(t){return t instanceof Jt?this.reifyField(t):this.reifyValue(t)},e.prototype.reifyField=function(t){var e=t.value,r=this.reifyValue(e);return e!==r?t.updatedValue(r):t},e.prototype.reifyValue=function(t){return t instanceof Ai?this.reifyModel(t):t},e.prototype.reifyModel=function(t){if("link"===t.tag()){var e=new bu(this.warp,t);return e.compile(),e}return t},e}(Si),bu=function(t){function e(e,r){var i=t.call(this,r)||this;return i.hostUri=i.inoutlet(),i.nodeUri=i.inoutlet(),i.laneUri=i.inoutlet(),i.prio=i.inoutlet(),i.rate=i.inoutlet(),i.bodyValue=i.inoutlet(),i.type=i.inoutlet(),i.warp=e,i}return _(e,t),e.prototype.getOutput=function(t){if((t=this.outlet(t))===this.state){if(this.downlink instanceof yu)return this.downlink.get();if(this.downlinkRecord)return this.downlinkRecord}},e.prototype.onRecohere=function(t){var e=this.castInput(this.hostUri,Se.forString()),r=this.castInput(this.nodeUri,Se.forString()),i=this.castInput(this.laneUri,Se.forString()),n=this.castInput(this.prio,Se.forNumber(),0),o=this.castInput(this.rate,Se.forNumber(),0),s=this.getInput(this.bodyValue),u=this.castInput(this.type,Se.forString(),void 0);if(e!==this.inputHostUri||r!==this.inputNodeUri||i!==this.inputLaneUri||n!==this.inputPrio||o!==this.inputRate||(void 0===s?void 0!==this.inputBody:!s.equals(this.inputBody))||u!==this.inputType){this.downlink&&(this.downlink.close(),this.downlink=void 0,this.downlinkRecord=void 0),this.inputHostUri=e,this.inputNodeUri=r,this.inputLaneUri=i,this.inputPrio=n,this.inputRate=o,this.inputBody=s,this.inputType=u;var a=this.warp||Eu;if("map"===u){var h=a.downlinkMap();void 0!==e&&(h=h.hostUri(e)),void 0!==r&&(h=h.nodeUri(r)),void 0!==i&&(h=h.laneUri(i)),0!==n&&(h=h.prio(n)),0!==o&&(h=h.rate(o)),void 0!==s&&(h=h.body(s)),h=h.open(),this.state=h,this.downlink=h,this.downlinkRecord=new mu(h)}else if("value"===u){h=a.downlinkValue();void 0!==e&&(h=h.hostUri(e)),void 0!==r&&(h=h.nodeUri(r)),void 0!==i&&(h=h.laneUri(i)),void 0!==n&&(h=h.prio(n)),void 0!==o&&(h=h.rate(o)),void 0!==s&&(h=h.body(s)),h=h.open(),this.state=h,this.downlink=h}}},e.reifier=function(t){return void 0===t?(e._reifier||(e._reifier=new gu),e._reifier):new gu(t)},m([mi],e.prototype,"hostUri",void 0),m([mi],e.prototype,"nodeUri",void 0),m([mi],e.prototype,"laneUri",void 0),m([mi],e.prototype,"prio",void 0),m([mi],e.prototype,"rate",void 0),m([mi("body")],e.prototype,"bodyValue",void 0),m([mi],e.prototype,"type",void 0),m([_i],e.prototype,"state",void 0),e}(xi),xu=function(){function t(t){this._context=t,this._host=void 0,this._downlinks=[],this._observers=null}return t.prototype.isConnected=function(){return!!this._host&&this._host.isConnected()},t.prototype.isAuthenticated=function(){return!!this._host&&this._host.isAuthenticated()},t.prototype.session=function(){return this._host?this._host.session():se.absent()},t.prototype.authenticate=function(t){this._context.authenticate(this.hostUri(),t)},t.prototype.addDownlink=function(t){0===this._downlinks.length&&this.open(),this._downlinks.push(t)},t.prototype.removeDownlink=function(t){var e=this._downlinks.indexOf(t);e>=0&&(this._downlinks.splice(e,1),0===this._downlinks.length&&this.close())},t.prototype.open=function(){this._context.openRef(this)},t.prototype.close=function(){this._context.closeRef(this)},t.prototype.closeUp=function(){var t=this._downlinks;this._downlinks=[];for(var e=0,r=t.length;e<r;e+=1)t[e].close()},t.prototype.observe=function(t){for(var e=this._observers,r=e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];return i[r]=t,this._observers=i,this},t.prototype.unobserve=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i],o=n===t;if(!o)for(var s in n)if(n[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<i;a+=1)u[a]=e[a];for(a=i+1;a<r;a+=1)u[a-1]=e[a];this._observers=u}else this._observers=null;break}}return this},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didAuthenticate=function(t){return this.observe({didAuthenticate:t})},t.prototype.didDeauthenticate=function(t){return this.observe({didDeauthenticate:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.hostDidConnect=function(t){this._host=t;for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didConnect&&n.didConnect(t,this)}},t.prototype.hostDidAuthenticate=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didAuthenticate&&o.didAuthenticate(t,e,this)}},t.prototype.hostDidDeauthenticate=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didDeauthenticate&&o.didDeauthenticate(t,e,this)}},t.prototype.hostDidDisconnect=function(t){this._host=void 0;for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didDisconnect&&n.didDisconnect(t,this)}},t.prototype.hostDidFail=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didFail&&o.didFail(t,e,this)}},t}(),Cu=function(t){function e(e,r,i,n){var o=t.call(this,e)||this;return o._hostUri=r,o._nodeUri=i,o._laneUri=n,o}return _(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.nodeUri=function(){return this._nodeUri},e.prototype.laneUri=function(){return this._laneUri},e.prototype.hostRef=function(t){return t=os.fromAny(t),new Au(this._context,t)},e.prototype.nodeRef=function(t){return t=os.fromAny(t),new Su(this._context,this._hostUri,t)},e.prototype.laneRef=function(t){return t=os.fromAny(t),new e(this._context,this._hostUri,this._nodeUri,t)},e.prototype.downlink=function(t){return new hu(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkList=function(t){return new lu(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkMap=function(t){return new fu(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkValue=function(t){return new yu(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.command=function(t){this._context.command(this._hostUri,this._nodeUri,this._laneUri,t)},e}(xu),Su=function(t){function e(e,r,i){var n=t.call(this,e)||this;return n._hostUri=r,n._nodeUri=i,n}return _(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.nodeUri=function(){return this._nodeUri},e.prototype.hostRef=function(t){return t=os.fromAny(t),new Au(this._context,t)},e.prototype.nodeRef=function(t){return t=os.fromAny(t),new e(this._context,this._hostUri,t)},e.prototype.laneRef=function(t){return t=os.fromAny(t),new Cu(this._context,this._hostUri,this._nodeUri,t)},e.prototype.downlink=function(t){return new hu(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkList=function(t){return new lu(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkMap=function(t){return new fu(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkValue=function(t){return new yu(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.command=function(t,e){this._context.command(this._hostUri,this._nodeUri,t,e)},e}(xu),Au=function(t){function e(e,r){var i=t.call(this,e)||this;return i._hostUri=r,i}return _(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.hostRef=function(t){return t=os.fromAny(t),new e(this._context,t)},e.prototype.nodeRef=function(t){return t=os.fromAny(t),new Su(this._context,this._hostUri,t)},e.prototype.laneRef=function(t,e){return t=os.fromAny(t),e=os.fromAny(e),new Cu(this._context,this._hostUri,t,e)},e.prototype.downlink=function(t){return new hu(this._context,this,t,this._hostUri)},e.prototype.downlinkList=function(t){return new lu(this._context,this,t,this._hostUri)},e.prototype.downlinkMap=function(t){return new fu(this._context,this,t,this._hostUri)},e.prototype.downlinkValue=function(t){return new yu(this._context,this,t,this._hostUri)},e.prototype.command=function(t,e,r){this._context.command(this._hostUri,t,e,r)},e}(xu),ku=function(){function t(t){void 0===t&&(t={}),void 0===t.keepOnline&&(t.keepOnline=!0),this._options=t,this._hosts=new jt,this._downlinks=new jt,this._downlinkCount=0,this._refs=[],this._online=!0,this._observers=null,this.onOnline=this.onOnline.bind(this),this.onOffline=this.onOffline.bind(this),this.watchOnline(!!t.keepOnline)}return t.prototype.isOnline=function(t){return void 0===t?this._online:(this._online!==t&&(this._online=t,t&&this._hosts.forEach((function(t,e){e.open()}),this)),this)},t.prototype.keepOnline=function(t){return void 0===t?!!this._options.keepOnline:(this._options.keepOnline!==t&&(this._options.keepOnline=t,this.watchOnline(t)),this)},t.prototype.watchOnline=function(t){"object"==typeof window&&(t?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline)))},t.prototype.onOnline=function(t){this.isOnline(!0)},t.prototype.onOffline=function(t){this.isOnline(!1)},t.prototype.getHost=function(t){return t=os.fromAny(t),this._hosts.get(t)},t.prototype.openHost=function(t){t=os.fromAny(t);var e=this._hosts.get(t);return e||(e=new nu(this,t,this._options),this._hosts.set(t,e)),e},t.prototype.closeHost=function(t){this._hosts.get(t.hostUri())&&(this._hosts.delete(t.hostUri()),t.closeUp())},t.prototype.getDownlink=function(t,e,r){var i=this._downlinks.get(t);if(i){var n=i.get(e);if(n)return n.get(r)}},t.prototype.openDownlink=function(t){var e=t.hostUri(),r=t.nodeUri(),i=t.laneUri(),n=this._downlinks.get(e);n||(n=new jt,this._downlinks.set(e,n));var o=n.get(r);if(o||(o=new jt,n.set(r,o)),o.has(i))throw new Error("duplicate downlink");o.set(i,t),this._downlinkCount+=1,this.openHost(e).openDownlink(t)},t.prototype.unlinkDownlink=function(t){var e=t.hostUri(),r=this.getHost(e);r&&r.unlinkDownlink(t)},t.prototype.closeDownlink=function(t){var e=t.hostUri(),r=t.nodeUri(),i=t.laneUri(),n=this._downlinks.get(e);if(n){var o=n.get(r);if(o&&o.get(i)){this._downlinkCount-=1,o.delete(i),o.isEmpty()&&(n.delete(r),n.isEmpty()&&this._downlinks.delete(e));var s=this.getHost(e);s&&s.closeDownlink(t)}}},t.prototype.downlink=function(t){return new hu(this,void 0,t)},t.prototype.downlinkList=function(t){return new lu(this,void 0,t)},t.prototype.downlinkMap=function(t){return new fu(this,void 0,t)},t.prototype.downlinkValue=function(t){return new yu(this,void 0,t)},t.prototype.openRef=function(t){this._refs.push(t)},t.prototype.closeRef=function(t){var e=this._refs.indexOf(t);e>=0&&(this._refs.splice(e,1),t.closeUp())},t.prototype.hostRef=function(t){return t=os.fromAny(t),new Au(this,t)},t.prototype.nodeRef=function(t,e){return t=os.fromAny(t),void 0===e?(t=(e=t).endpoint(),e=t.unresolve(e)):e=os.fromAny(e),new Su(this,t,e)},t.prototype.laneRef=function(t,e,r){return t=os.fromAny(t),e=os.fromAny(e),void 0===r?(r=e,t=(e=t).endpoint(),e=t.unresolve(e)):r=os.fromAny(r),new Cu(this,t,e,r)},t.prototype.authenticate=function(t,e){t=os.fromAny(t),e=se.fromAny(e),this.openHost(t).authenticate(e)},t.prototype.command=function(t,e,r,i){t=os.fromAny(t),e=os.fromAny(e),3===arguments.length?(i=r,r=e,t=(e=t).endpoint(),e=t.unresolve(e)):r=os.fromAny(r),i=se.fromAny(i);var n=this.openHost(t);n.command(e,r,i)},t.prototype.close=function(){var t=this._refs;this._refs=[];for(var e=0;e<t.length;e+=1)t[e].closeUp();var r=this._downlinks.clone();this._downlinks.clear(),this._downlinkCount=0,r.forEach((function(t,e){e.forEach((function(e,r){r.forEach((function(e,r){r.closeUp();var i=this.getHost(t);i&&i.closeDownlink(r)}),this)}),this)}),this);var i=this._hosts.clone();this._hosts.clear(),i.forEach((function(t,e){e.closeUp()}),this)},t.prototype.observe=function(t){for(var e=this._observers,r=e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];return i[r]=t,this._observers=i,this},t.prototype.unobserve=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i],o=n===t;if(!o)for(var s in n)if(n[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<i;a+=1)u[a]=e[a];for(a=i+1;a<r;a+=1)u[a-1]=e[a];this._observers=u}else this._observers=null;break}}return this},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didAuthenticate=function(t){return this.observe({didAuthenticate:t})},t.prototype.didDeauthenticate=function(t){return this.observe({didDeauthenticate:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.hostDidConnect=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didConnect&&n.didConnect(t,this)}for(i=0;i<this._refs.length;i+=1){var o=this._refs[i];o.hostUri().equals(t.hostUri())&&o.hostDidConnect(t)}},t.prototype.hostDidAuthenticate=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didAuthenticate&&o.didAuthenticate(t,e,this)}for(n=0;n<this._refs.length;n+=1){var s=this._refs[n];s.hostUri().equals(e.hostUri())&&s.hostDidAuthenticate(t,e)}},t.prototype.hostDidDeauthenticate=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didDeauthenticate&&o.didDeauthenticate(t,e,this)}for(n=0;n<this._refs.length;n+=1){var s=this._refs[n];s.hostUri().equals(e.hostUri())&&s.hostDidDeauthenticate(t,e)}},t.prototype.hostDidDisconnect=function(t){for(var e=this._observers,r=e?e.length:0,i=0;i<r;i+=1){var n=e[i];n.didDisconnect&&n.didDisconnect(t,this)}for(i=0;i<this._refs.length;i+=1){var o=this._refs[i];o.hostUri().equals(t.hostUri())&&o.hostDidDisconnect(t)}},t.prototype.hostDidFail=function(t,e){for(var r=this._observers,i=r?r.length:0,n=0;n<i;n+=1){var o=r[n];o.didFail&&o.didFail(t,e,this)}for(n=0;n<this._refs.length;n+=1){var s=this._refs[n];s.hostUri().equals(e.hostUri())&&s.hostDidFail(t,e)}},t}(),Eu=new ku,Ou=Eu.isOnline.bind(Eu),Vu=Eu.keepOnline.bind(Eu),Pu=Eu.downlink.bind(Eu),Du=Eu.downlinkList.bind(Eu),Mu=Eu.downlinkMap.bind(Eu),Tu=Eu.downlinkValue.bind(Eu),Ru=Eu.hostRef.bind(Eu),Iu=Eu.nodeRef.bind(Eu),Fu=Eu.laneRef.bind(Eu),Lu=Eu.authenticate.bind(Eu),Uu=Eu.command.bind(Eu),Nu=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value()},t.prototype.plus=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)+t.fromAny(e).toValue(r),r)},t.prototype.opposite=function(e){return void 0===e&&(e=this.units()),t.from(-this.toValue(e),e)},t.prototype.minus=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)-t.fromAny(e).toValue(r),r)},t.prototype.times=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)*e,r)},t.prototype.divide=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)/e,r)},t.prototype.norm=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)/t.fromAny(e).toValue(r),r)},t.prototype.deg=function(){return t.deg(this.degValue())},t.prototype.rad=function(){return t.rad(this.radValue())},t.prototype.grad=function(){return t.grad(this.gradValue())},t.prototype.turn=function(){return t.turn(this.turnValue())},t.prototype.toValue=function(t){switch(t){case"deg":return this.degValue();case"grad":return this.gradValue();case"rad":return this.radValue();case"turn":return this.turnValue();default:throw new Error("unknown angle units: "+t)}},t.prototype.to=function(t){switch(t){case"deg":return this.deg();case"grad":return this.grad();case"rad":return this.rad();case"turn":return this.turn();default:throw new Error("unknown angle units: "+t)}},t.zero=function(e){return void 0===e&&(e="rad"),t.from(0,e)},t.deg=function(e){return new t.Deg(e)},t.rad=function(e){return new t.Rad(e)},t.grad=function(e){return new t.Grad(e)},t.turn=function(e){return new t.Turn(e)},t.from=function(e,r){switch(void 0===r&&(r="rad"),r){case"deg":return t.deg(e);case"rad":return t.rad(e);case"grad":return t.grad(e);case"turn":return t.turn(e);default:throw new Error("unknown angle units: "+r)}},t.fromAny=function(e,r){if(e instanceof t)return e;if("number"==typeof e)return t.from(e,r);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){if(2===e.length){var r=e.getItem(0).numberValue(),i=e.getItem(1);if(void 0!==r&&isFinite(r)&&i instanceof ie&&i.toValue()===se.extant())switch(i.key.value){case"deg":return t.deg(r);case"rad":return t.rad(r);case"grad":return t.grad(r);case"turn":return t.turn(r)}}},t.parse=function(e,r){for(var i=$.stringInput(e);i.isCont()&&$.isWhitespace(i.head());)i=i.step();var n=t.Parser.parse(i,r);if(n.isDone())for(;i.isCont()&&$.isWhitespace(i.head());)i=i.step();return i.isCont()&&!n.isError()&&(n=ft.error(lt.unexpected(i))),n.bind()},t.form=function(e,r){return void 0!==r&&(r=t.fromAny(r)),void 0!==e||void 0!==r?new t.Form(e,r):(t._form||(t._form=new t.Form),t._form)},t.PI=Math.PI,t.TAU=2*t.PI,t}(),zu=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"deg"},e.prototype.degValue=function(){return this._value},e.prototype.gradValue=function(){return 10*this._value/9},e.prototype.radValue=function(){return this._value*Nu.PI/180},e.prototype.turnValue=function(){return this._value/360},e.prototype.deg=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("deg").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"deg"},e}(Nu);Nu.Deg=zu;var ju=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"rad"},e.prototype.degValue=function(){return 180*this._value/Nu.PI},e.prototype.gradValue=function(){return 200*this._value/Nu.PI},e.prototype.radValue=function(){return this._value},e.prototype.turnValue=function(){return this._value/Nu.TAU},e.prototype.rad=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("rad").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"rad"},e}(Nu);Nu.Rad=ju;var Wu=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"grad"},e.prototype.degValue=function(){return.9*this._value},e.prototype.gradValue=function(){return this._value},e.prototype.radValue=function(){return this._value*Nu.PI/200},e.prototype.turnValue=function(){return this._value/400},e.prototype.grad=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("grad").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"grad"},e}(Nu);Nu.Grad=Wu;var qu=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"turn"},e.prototype.degValue=function(){return 360*this._value},e.prototype.gradValue=function(){return 400*this._value},e.prototype.radValue=function(){return this._value*Nu.TAU},e.prototype.turnValue=function(){return this._value},e.prototype.turn=function(){return this},e.prototype.equals=function(t){return t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Angle").write(46).write("turn").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return this._value+"turn"},e}(Nu);Nu.Turn=qu;var Bu=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._defaultUnits=e,o._valueParser=r,o._unitsOutput=i,o._step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._defaultUnits,this._valueParser,this._unitsOutput,this._step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if((i=i?i.feed(t):pt.parseDecimal(t)).isDone())o=2;else if(i.isError())return i.asError();if(2===o){for(n=n||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s));)t=t.step(),n.push(s);if(!t.isEmpty()){var u=i.bind(),a=n.bind()||r;switch(a){case"deg":return ft.done(Nu.deg(u));case"":case"rad":return ft.done(Nu.rad(u));case"grad":return ft.done(Nu.grad(u));case"turn":return ft.done(Nu.turn(u));default:return ft.error(lt.message("unknown units: "+a,t))}}}return new e(r,i,n,o)},e}(ft);Nu.Parser=Bu;var Ku=function(t){function e(e,r){var i=t.call(this)||this;return i._defaultUnits=e,i._unit=r,i}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?void 0!==this._unit?this._unit:Nu.zero(this._defaultUnits):new e(this._defaultUnits,t)},e.prototype.mold=function(t){return t=Nu.fromAny(t,this._defaultUnits),de.from(t.toString())},e.prototype.cast=function(t){var e,r=t.toValue();try{if(!(e=Nu.fromValue(r))){var i=r.stringValue(void 0);void 0!==i&&(e=Nu.parse(i,this._defaultUnits))}}catch(t){}return e},e}(Se);Nu.Form=Ku;var Hu=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value()},t.prototype.plus=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)+t.fromAny(e).toValue(r),r)},t.prototype.opposite=function(e){return void 0===e&&(e=this.units()),t.from(-this.toValue(e),e)},t.prototype.minus=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)-t.fromAny(e).toValue(r),r)},t.prototype.times=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)*e,r)},t.prototype.divide=function(e,r){return void 0===r&&(r=this.units()),t.from(this.toValue(r)/e,r)},t.prototype.emValue=function(){return this.pxValue()/t.emUnit(this.node())},t.prototype.remValue=function(){return this.pxValue()/t.remUnit()},t.prototype.pctValue=function(){return this.px().value()/this.unitValue()},t.prototype.px=function(e){return t.px(this.pxValue(e),this.node())},t.prototype.em=function(){return t.em(this.emValue(),this.node())},t.prototype.rem=function(){return t.rem(this.remValue(),this.node())},t.prototype.pct=function(){return t.pct(this.pctValue(),this.node())},t.prototype.toValue=function(t){switch(t){case"px":return this.pxValue();case"em":return this.emValue();case"rem":return this.remValue();case"%":return this.pctValue();default:throw new Error("unknown length units: "+t)}},t.prototype.to=function(t){switch(t){case"px":return this.px();case"em":return this.em();case"rem":return this.rem();case"%":return this.pct();default:throw new Error("unknown length units: "+t)}},t.zero=function(e,r){return t.from(0,e,r)},t.px=function(e,r){return new t.Px(e,r)},t.em=function(e,r){return new t.Em(e,r)},t.rem=function(e,r){return new t.Rem(e,r)},t.pct=function(e,r){return new t.Pct(e,r)},t.unitless=function(e,r){return new t.Unitless(e,r)},t.from=function(e,r,i){switch("string"!=typeof r&&(i=r,r="px"),r){case"px":return t.px(e,i);case"em":return t.em(e,i);case"rem":return t.rem(e,i);case"%":return t.pct(e,i);case"":return t.unitless(e,i);default:throw new Error("unknown length units: "+r)}},t.fromAny=function(e,r,i){if("string"!=typeof r&&(i=r,r=void 0),e instanceof t)return e;if("number"==typeof e)return t.from(e,r,i);if("string"==typeof e&&"string"!=typeof r)return t.parse(e,r,i);throw new TypeError(""+e)},t.fromValue=function(e,r){if(2===e.length){var i=e.getItem(0).numberValue(void 0),n=e.getItem(1);if(void 0!==i&&isFinite(i)&&n instanceof ie&&n.toValue()===se.extant())switch(n.key.value){case"px":return t.px(i,r);case"em":return t.em(i,r);case"rem":return t.rem(i,r);case"pct":return t.pct(i,r)}}},t.parse=function(e,r,i){"string"!=typeof r&&(i=r,r=void 0);for(var n=$.stringInput(e);n.isCont()&&$.isWhitespace(n.head());)n=n.step();var o=t.Parser.parse(n,r,i);if(o.isDone())for(;n.isCont()&&$.isWhitespace(n.head());)n=n.step();return n.isCont()&&!o.isError()&&(o=ft.error(lt.unexpected(n))),o.bind()},t.form=function(e,r,i){return void 0!==i&&(i=t.fromAny(i)),void 0!==e||r||void 0!==i?new t.Form(e,r,i):(t._form||(t._form=new t.Form),t._form)},t.widthUnit=function(t){for(;t;){if(t instanceof HTMLElement&&t.offsetParent instanceof HTMLElement)return t.offsetParent.offsetWidth;t=t.parentNode||void 0}return 0},t.emUnit=function(t){for(;t;){if(t instanceof Element){var e=getComputedStyle(t).fontSize;if(null!==e)return parseFloat(e)}t=t.parentNode||void 0}return 0},t.remUnit=function(){var t=getComputedStyle(document.documentElement).fontSize;return null!==t?parseFloat(t):0},t}(),Gu=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._node=r,i}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"px"},e.prototype.unitValue=function(){return 1},e.prototype.node=function(){return this._node},e.prototype.pxValue=function(){return this._value},e.prototype.px=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("px").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"px"},e}(Hu);Hu.Px=Gu;var Xu=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._node=r,i}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"em"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return Hu.emUnit(this._node)},e.prototype.pxValue=function(){return this.unitValue()*this._value},e.prototype.em=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("em").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"em"},e}(Hu);Hu.Em=Xu;var Yu=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._node=r,i}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"rem"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return Hu.remUnit()},e.prototype.pxValue=function(){return this.unitValue()*this._value},e.prototype.rem=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("rem").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"rem"},e}(Hu);Hu.Rem=Yu;var Zu=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._node=r,i}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return"%"},e.prototype.node=function(){return this._node},e.prototype.unitValue=function(){return Hu.widthUnit(this._node)},e.prototype.pxValue=function(t){return void 0===t&&(t=this.unitValue()),t*this._value/100},e.prototype.pct=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("pct").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+"%"},e}(Hu);Hu.Pct=Zu;var Qu=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._node=r,i}return _(e,t),e.prototype.value=function(){return this._value},e.prototype.units=function(){return""},e.prototype.unitValue=function(){return 0},e.prototype.node=function(){return this._node},e.prototype.pxValue=function(){return this._value},e.prototype.equals=function(t){return t instanceof e&&(this._value===t._value&&this._node===t._node)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,c.hash(this._value)))},e.prototype.debug=function(t){t=t.write("Length").write(46).write("unitless").write(40).debug(this._value),this._node&&(t=t.write(", ").debug(this._node)),t=t.write(41)},e.prototype.toString=function(){return this._value+""},e}(Hu);Hu.Unitless=Qu;var $u=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s._defaultUnits=e,s._node=r,s._valueParser=i,s._unitsOutput=n,s._step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._defaultUnits,this._node,this._valueParser,this._unitsOutput,this._step)},e.parse=function(t,r,i,n,o,s){void 0===s&&(s=1);var u=0;if(1===s)if((n=n?n.feed(t):pt.parseDecimal(t)).isDone())s=2;else if(n.isError())return n.asError();if(2===s){for(o=o||$.stringOutput();t.isCont()&&(u=t.head(),$.isAlpha(u)||37===u);)t=t.step(),o.push(u);if(!t.isEmpty()){var a=n.bind(),h=o.bind()||r;switch(h){case"px":return ft.done(Hu.px(a,i));case"em":return ft.done(Hu.em(a,i));case"rem":return ft.done(Hu.rem(a,i));case"%":return ft.done(Hu.pct(a,i));case"":case void 0:return ft.done(Hu.unitless(a,i));default:return ft.error(lt.message("unknown units: "+h,t))}}}return new e(r,i,n,o,s)},e}(ft);Hu.Parser=$u;var Ju=function(t){function e(e,r,i){var n=t.call(this)||this;return n._defaultUnits=e,n._node=r,n._unit=i,n}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?void 0!==this._unit?this._unit:Hu.zero(this._defaultUnits,this._node):new e(this._defaultUnits,this._node,t)},e.prototype.mold=function(t){return t=Hu.fromAny(t,this._defaultUnits),de.from(t.toString())},e.prototype.cast=function(t){var e,r=t.toValue();try{if(!(e=Hu.fromValue(r,this._node))){var i=r.stringValue(void 0);void 0!==i&&(e=Hu.parse(i,this._defaultUnits,this._node))}}catch(t){}return e},e}(Se);Hu.Form=Ju;var ta=function(){function t(){}return t.prototype.contrast=function(t){return this.lightness()<.67?this.brighter(t):this.darker(t)},t.transparent=function(e){return t.Rgb.transparent(e)},t.black=function(){return t.Rgb.black()},t.white=function(){return t.Rgb.white()},t.rgb=function(e,r,i,n){return 1===arguments.length?t.fromAny(e).rgb():new t.Rgb(e,r,i,n)},t.hsl=function(e,r,i,n){return 1===arguments.length?t.fromAny(e).hsl():(e="number"==typeof e?e:Nu.fromAny(e).degValue(),new t.Hsl(e,r,i,n))},t.fromName=function(e){switch(e){case"transparent":return t.transparent();case"black":return t.black();case"white":return t.white();default:return}},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);if(e&&"object"==typeof e){var r=e;if(void 0!==r.r&&void 0!==r.g&&void 0!==r.b)return new t.Rgb(r.r,r.g,r.b,r.a);var i=e;if(void 0!==i.h&&void 0!==i.s&&void 0!==i.l){var n="number"==typeof i.h?i.h:Nu.fromAny(i.h).degValue();return new t.Hsl(n,i.s,i.l,i.a)}}throw new TypeError(""+e)},t.fromValue=function(e){var r;return(r=t.Rgb.fromValue(e))||(r=t.Hsl.fromValue(e)),r},t.parse=function(e){for(var r=$.stringInput(e);r.isCont()&&$.isWhitespace(r.head());)r=r.step();var i=t.Parser.parse(r);if(i.isDone())for(;r.isCont()&&$.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=ft.error(lt.unexpected(r))),i.bind()},t.isInit=function(e){return t.Rgb.isInit(e)||t.Hsl.isInit(e)},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),e!==t.transparent()?new t.Form(e):(t._form||(t._form=new t.Form(t.transparent())),t._form)},t}(),ea=function(t){function e(e,r,i,n){void 0===n&&(n=1);var o=t.call(this)||this;return o.r=e,o.g=r,o.b=i,o.a=n,o}return _(e,t),e.prototype.isDefined=function(){return 0!==this.r||0!==this.g||0!==this.b||1!==this.a},e.prototype.alpha=function(t){return void 0===t?this.a:this.a!==t?new e(this.r,this.g,this.b,t):this},e.prototype.lightness=function(){var t=this.r/255,e=this.g/255,r=this.b/255,i=Math.min(t,e,r);return(Math.max(t,e,r)+i)/2},e.prototype.brighter=function(t){return 1!==(t=void 0===t?1/.7:Math.pow(1/.7,t))?new e(this.r*t,this.g*t,this.b*t,this.a):this},e.prototype.darker=function(t){return 1!==(t=void 0===t?.7:Math.pow(.7,t))?new e(this.r*t,this.g*t,this.b*t,this.a):this},e.prototype.rgb=function(){return this},e.prototype.hsl=function(){var t=this.r/255,e=this.g/255,r=this.b/255,i=Math.min(t,e,r),n=Math.max(t,e,r),o=NaN,s=n-i,u=(n+i)/2;return s?(o=t===n?(e-r)/s+6*+(e<r):e===n?(r-t)/s+2:(t-e)/s+4,s/=u<.5?n+i:2-(n+i),o*=60):s=u>0&&u<1?0:o,new ta.Hsl(o,s,u,this.a)},e.prototype.equals=function(t){return t instanceof e&&(this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this.r)),c.hash(this.g)),c.hash(this.b)),c.hash(this.a)))},e.prototype.debug=function(t){t=t.write("Color").write(46).write("rgb").write(40).debug(this.r).write(", ").debug(this.g).write(", ").debug(this.b),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)},e.prototype.toHexString=function(){var t=Math.min(Math.max(0,Math.round(this.r||0)),255),e=Math.min(Math.max(0,Math.round(this.g||0)),255),r=Math.min(Math.max(0,Math.round(this.b||0)),255),i="#",n=xt.lowercase().alphabet();return i+=n.charAt(t>>>4&15),i+=n.charAt(15&t),i+=n.charAt(e>>>4&15),i+=n.charAt(15&e),i+=n.charAt(r>>>4&15),i+=n.charAt(15&r)},e.prototype.toString=function(){var t=this.a;if(1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1))))return this.toHexString();var e=1===t?"rgb":"rgba";return e+="(",e+=Math.max(0,Math.min(Math.round(this.r)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.g)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.b)||0,255)),1!==t&&(e+=",",e+=t),e+=")"},e.transparent=function(t){return void 0===t&&(t=0),new e(0,0,0,t)},e.black=function(){return new e(0,0,0,1)},e.white=function(){return new e(255,255,255,1)},e.fromValue=function(t){var e,r,i,n,o,s=t.tag();if("rgb"===s||"rgba"===s?(t=t.header(s),e=!0):e=!1,t.forEach((function(t,s){var u=t.key.stringValue();void 0!==u?"r"===u?r=t.toValue().numberValue(r):"g"===u?i=t.toValue().numberValue(i):"b"===u?n=t.toValue().numberValue(n):"a"===u&&(o=t.toValue().numberValue(o)):t instanceof se&&e&&(0===s?r=t.numberValue(r):1===s?i=t.numberValue(i):2===s?n=t.numberValue(n):3===s&&(o=t.numberValue(o)))})),void 0!==r&&void 0!==i&&void 0!==n)return ta.rgb(r,i,n,o)},e.parse=function(t){return ta.parse(t).rgb()},e.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.r&&void 0!==e.g&&void 0!==e.b}return!1},e}(ta);ta.Rgb=ea;var ra=function(t){function e(e,r,i,n){void 0===n&&(n=1);var o=t.call(this)||this;return o.h=e,o.s=r,o.l=i,o.a=n,o}return _(e,t),e.prototype.isDefined=function(){return 0!==this.h||0!==this.s||0!==this.l||1!==this.a},e.prototype.alpha=function(t){return void 0===t?this.a:this.a!==t?new e(this.h,this.s,this.l,t):this},e.prototype.lightness=function(){return this.l},e.prototype.brighter=function(t){return 1!==(t=void 0===t?1/.7:Math.pow(1/.7,t))?new e(this.h,this.s,this.l*t,this.a):this},e.prototype.darker=function(t){return 1!==(t=void 0===t?.7:Math.pow(.7,t))?new e(this.h,this.s,this.l*t,this.a):this},e.toRgb=function(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)},e.prototype.rgb=function(){var t=this.h%360+360*+(this.h<0),r=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*r,o=2*i-n;return new ta.Rgb(e.toRgb(t>=240?t-240:t+120,o,n),e.toRgb(t,o,n),e.toRgb(t<120?t+240:t-120,o,n),this.a)},e.prototype.hsl=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this.h===t.h&&this.s===t.s&&this.l===t.l&&this.a===t.a)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this.h)),c.hash(this.s)),c.hash(this.l)),c.hash(this.a)))},e.prototype.debug=function(t){t=t.write("Color").write(46).write("hsl").write(40).debug(this.h).write(", ").debug(this.s).write(", ").debug(this.l),1!==this.a&&(t=t.write(", ").debug(this.a)),t=t.write(41)},e.prototype.toHexString=function(){return this.rgb().toHexString()},e.prototype.toString=function(){var t=this.a,e=1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1)))?"hsl":"hsla";return e+="(",e+=Math.max(0,Math.min(Math.round(this.h)||0,360)),e+=",",e+=Math.max(0,Math.min(100*Math.round(this.s)||0,100))+"%",e+=",",e+=Math.max(0,Math.min(100*Math.round(this.l)||0,100))+"%",1!==t&&(e+=",",e+=t),e+=")"},e.transparent=function(t){return void 0===t&&(t=0),new e(0,0,0,t)},e.black=function(){return new e(0,0,0,1)},e.white=function(){return new e(0,1,1,1)},e.fromValue=function(t){var e,r,i,n,o,s=t.tag();if("hsl"===s||"hsla"===s?(t=t.header(s),e=!0):e=!1,t.forEach((function(t,s){var u=t.key.stringValue();void 0!==u?"h"===u?r=t.toValue().cast(Nu.form(),r):"s"===u?i=t.toValue().numberValue(i):"l"===u?n=t.toValue().numberValue(n):"a"===u&&(o=t.toValue().numberValue(o)):t instanceof se&&e&&(0===s?r=t.cast(Nu.form(),r):1===s?i=t.numberValue(i):2===s?n=t.numberValue(n):3===s&&(o=t.numberValue(o)))})),void 0!==r&&void 0!==i&&void 0!==n)return ta.hsl(r,i,n,o)},e.parse=function(t){return ta.parse(t).hsl()},e.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.h&&void 0!==e.s&&void 0!==e.l}return!1},e}(ta);ta.Hsl=ra;var ia=function(){function t(t,e){void 0===e&&(e=""),this.value=t,this.units=e}return t.prototype.scale=function(t){return"%"===this.units?this.value*t/100:this.value},t}(),na=function(t){function e(e,r){var i=t.call(this)||this;return i.valueParser=e,i.step=r,i}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.valueParser,this.step)},e.parse=function(t,r,i){if(void 0===i&&(i=1),1===i)if((r=r?r.feed(t):pt.parseNumber(t)).isDone())i=2;else if(r.isError())return r.asError();if(2===i){if(t.isCont()&&37===t.head())return t=t.step(),ft.done(new ia(r.bind(),"%"));if(!t.isEmpty())return ft.done(new ia(r.bind()))}return new e(r,i)},e}(ft);ia.Parser=na;var oa=function(t){function e(e,r){var i=t.call(this)||this;return i._value=e,i._step=r,i}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this._value,this._step)},e.parse=function(t,r,i){void 0===r&&(r=0),void 0===i&&(i=1);var n=0;if(1===i)if(t.isCont()&&35===t.head())t=t.step(),i=2;else if(!t.isEmpty())return ft.error(lt.expected("#",t));if(i>=2){for(;i<=9&&t.isCont()&&(n=t.head(),xt.isDigit(n));)t=t.step(),r=r<<4|xt.decodeDigit(n),i+=1;if(!t.isEmpty())return 5===i?ft.done(new ea(r>>8&15|r>>4&240,r>>4&15|240&r,r<<4&240|15&r)):6===i?ft.done(new ea(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|240&r,(r<<4&240|15&r)/255)):8===i?ft.done(new ea(r>>16&255,r>>8&255,255&r)):10===i?ft.done(new ea(r>>24&255,r>>16&255,r>>8&255,(255&r)/255)):ft.error(lt.unexpected(t))}return new e(r,i)},e}(ft);ta.HexParser=oa;var sa=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.rParser=e,s.gParser=r,s.bParser=i,s.aParser=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.rParser,this.gParser,this.bParser,this.aParser,this.step)},e.parse=function(t,r,i,n,o,s){var u=0;if(1===s)if(t.isCont()&&114===t.head())t=t.step(),s=2;else if(!t.isEmpty())return ft.error(lt.expected("r",t));if(2===s)if(t.isCont()&&103===t.head())t=t.step(),s=3;else if(!t.isEmpty())return ft.error(lt.expected("g",t));if(3===s)if(t.isCont()&&98===t.head())t=t.step(),s=4;else if(!t.isEmpty())return ft.error(lt.expected("b",t));if(4===s&&(t.isCont()&&97===t.head()?(t=t.step(),s=5):t.isEmpty()||(s=5)),5===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()&&40===u)t=t.step(),s=6;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(6===s){if(r)r=r.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(r=na.parse(t))}if(r)if(r.isDone())s=7;else if(r.isError())return r.asError()}if(7===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),s=8;else if(t.isDone())return ft.error(lt.unexpected(t))}if(8===s){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(i=na.parse(t))}if(i)if(i.isDone())s=9;else if(i.isError())return i.asError()}if(9===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),s=10;else if(t.isDone())return ft.error(lt.unexpected(t))}if(10===s){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(n=na.parse(t))}if(n)if(n.isDone())s=11;else if(n.isError())return n.asError()}if(11===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()){if(41===u)return t=t.step(),ft.done(new ea(r.bind().scale(255),i.bind().scale(255),n.bind().scale(255)));44!==u&&47!==u||(t=t.step()),s=12}else if(t.isDone())return ft.error(lt.unexpected(t))}if(12===s){if(o)o=o.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(o=na.parse(t))}if(o)if(o.isDone())s=13;else if(o.isError())return o.asError()}if(13===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()&&41===u)return t=t.step(),ft.done(new ea(r.bind().scale(255),i.bind().scale(255),n.bind().scale(255),o.bind().scale(1)));if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n,o,s)},e.parseRest=function(t){return e.parse(t,void 0,void 0,void 0,void 0,5)},e}(ft);ta.RgbParser=sa;var ua=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.hParser=e,s.sParser=r,s.lParser=i,s.aParser=n,s.step=o,s}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.hParser,this.sParser,this.lParser,this.aParser,this.step)},e.parse=function(t,r,i,n,o,s){var u=0;if(1===s)if(t.isCont()&&104===t.head())t=t.step(),s=2;else if(!t.isEmpty())return ft.error(lt.expected("h",t));if(2===s)if(t.isCont()&&115===t.head())t=t.step(),s=3;else if(!t.isEmpty())return ft.error(lt.expected("s",t));if(3===s)if(t.isCont()&&108===t.head())t=t.step(),s=4;else if(!t.isEmpty())return ft.error(lt.expected("l",t));if(4===s&&(t.isCont()&&97===t.head()?(t=t.step(),s=5):t.isEmpty()||(s=5)),5===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()&&40===u)t=t.step(),s=6;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(6===s){if(r)r=r.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(r=Bu.parse(t,"deg"))}if(r)if(r.isDone())s=7;else if(r.isError())return r.asError()}if(7===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),s=8;else if(t.isDone())return ft.error(lt.unexpected(t))}if(8===s){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(i=na.parse(t))}if(i)if(i.isDone()){if("%"!==i.bind().units)return ft.error(lt.expected("%",t));s=9}else if(i.isError())return i.asError()}if(9===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont())44===u&&(t=t.step()),s=10;else if(t.isDone())return ft.error(lt.unexpected(t))}if(10===s){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isCont()&&(n=na.parse(t))}if(n)if(n.isDone()){if("%"!==n.bind().units)return ft.error(lt.expected("%",t));s=11}else if(n.isError())return n.asError()}if(11===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()){if(41===u)return t=t.step(),ft.done(new ra(r.bind().degValue(),i.bind().scale(1),n.bind().scale(1)));44!==u&&47!==u||(t=t.step()),s=12}else if(t.isDone())return ft.error(lt.unexpected(t))}if(12===s){if(o)o=o.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t=t.step();t.isEmpty()||(o=na.parse(t))}if(o)if(o.isDone())s=13;else if(o.isError())return o.asError()}if(13===s){for(;t.isCont()&&(u=t.head(),$.isSpace(u));)t=t.step();if(t.isCont()&&41===u)return t=t.step(),ft.done(new ra(r.bind().degValue(),i.bind().scale(1),n.bind().scale(1),o.bind().scale(1)));if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n,o,s)},e.parseRest=function(t){return e.parse(t,void 0,void 0,void 0,void 0,5)},e}(ft);ta.HslParser=ua;var aa=function(t){function e(e,r){var i=t.call(this)||this;return i.identOutput=e,i.step=r,i}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i)if(t.isCont()){if(35===t.head())return oa.parse(t);i=2}else if(t.isDone())return ft.error(lt.unexpected(t));if(2===i){for(r=r||$.stringOutput();t.isCont()&&(n=t.head(),$.isAlpha(n));)t=t.step(),r.write(n);if(!t.isEmpty()){var o=r.bind();switch(o){case"rgb":case"rgba":return sa.parseRest(t);case"hsl":case"hsla":return ua.parseRest(t);default:var s=ta.fromName(o);return void 0!==s?ft.done(s):ft.error(lt.message("unknown color: "+o,t))}}}return new e(r,i)},e}(ft);ta.Parser=aa;var ha=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return t=ta.fromAny(t),de.from(t.toString())},e.prototype.cast=function(t){var e,r=t.toValue();try{if(!(e=ta.fromValue(r))){var i=r.stringValue(void 0);void 0!==i&&(e=ta.parse(i))}}catch(t){}return e},e}(Se);ta.Form=ha;var pa={fromAny:function(t){return"string"!=typeof t||"large"!==t&&"larger"!==t&&"medium"!==t&&"small"!==t&&"smaller"!==t&&"x-large"!==t&&"x-small"!==t&&"xx-large"!==t&&"xx-small"!==t?Hu.fromAny(t):t},fromValue:function(t){var e=t.stringValue(void 0);return void 0!==e?pa.fromAny(e):Hu.form().cast(t)}},la={fromAny:function(t){return"string"==typeof t&&"normal"===t?t:Hu.fromAny(t)},fromValue:function(t){var e=t.stringValue(void 0);return void 0!==e?la.fromAny(e):Hu.form().cast(t)}},ca={fromValue:function(t){var e;return t.forEach((function(t){if(t instanceof se){var r=t.stringValue(void 0);void 0!==r&&(void 0===e?e=r:"string"==typeof e?e=[e,r]:e.push(r))}})),e},format:function(t){var e,r=t.length;if(r>0){e=$.isAlpha(t.charCodeAt(0));for(var i=t.offsetByCodePoints(0,1);e&&i<r;i=t.offsetByCodePoints(i,1)){var n=t.charCodeAt(i);e=$.isAlpha(n)||45===n}}else e=!1;if(e)return t;var o=$.stringOutput();o.write(34);for(i=0;i<r;i=t.offsetByCodePoints(i,1)){if(10===(n=t.charCodeAt(i))||34===n||39===n)o.write(92).write(n);else if(n>=32)o.write(n);else{var s=xt.uppercase();o.write(92).write(s.encodeDigit(n>>>20&15)).write(s.encodeDigit(n>>>16&15)).write(s.encodeDigit(n>>>12&15)).write(s.encodeDigit(n>>>8&15)).write(s.encodeDigit(n>>>4&15)).write(s.encodeDigit(15&n))}}return o.write(34),o.toString()}},fa=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.output=e,o.quote=r,o.code=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.quote,this.code,this.step)},e.parse=function(t,r,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t=t.step();if(t.isCont())if($.isAlpha(s))r=r||$.stringOutput(),o=2;else{if(34!==s&&(39!==s||i!==s&&0!==i))return ft.error(lt.expected("font family",t));t=t.step(),r=r||$.stringOutput(),i=s,o=3}else if(t.isDone())return ft.error(lt.expected("font family",t))}if(2===o){for(;t.isCont()&&(s=t.head(),$.isAlpha(s)||45===s);)t=t.step(),r.write(s);if(!t.isEmpty())return ft.done(r.bind())}t:for(;;){if(3===o){for(;t.isCont()&&(s=t.head())>=32&&s!==i&&92!==s;)t=t.step(),r.write(s);if(t.isCont()){if(s===i)return t=t.step(),ft.done(r.bind());if(92!==s)return ft.error(lt.expected(i,t));t=t.step(),o=4}else if(t.isDone())return ft.error(lt.expected(i,t))}if(4===o)if(t.isCont()){if(s=t.head(),!xt.isDigit(s)){if(10===s){t.step(),o=3;continue}t.step(),r.write(s),o=3;continue}o=5}else if(t.isDone())return ft.error(lt.expected("escape character",t));if(o>=5)for(;;){if(t.isCont()&&(s=t.head(),xt.isDigit(s))){if(t=t.step(),n=16*n+xt.decodeDigit(s),o<=11){o+=1;continue}if(0===n)return ft.error(lt.message("zero escape",t));r.write(n),n=0,o=3;continue t}if(!t.isEmpty())return ft.error(lt.unexpected(t));break}break}return new e(r,i,n,o)},e}(ft),da=function(){function t(t,e,r,i,n,o,s){this._style=t,this._variant=e,this._weight=r,this._stretch=i,this._size=n,this._height=o,this._family=s}return t.prototype.style=function(e){return void 0===e?this._style:this._style===e?this:new t(e,this._variant,this._weight,this._stretch,this._size,this._height,this._family)},t.prototype.variant=function(e){return void 0===e?this._variant:this._variant===e?this:new t(this._style,e,this._weight,this._stretch,this._size,this._height,this._family)},t.prototype.weight=function(e){return void 0===e?this._weight:this._weight===e?this:new t(this._style,this._variant,e,this._stretch,this._size,this._height,this._family)},t.prototype.stretch=function(e){return void 0===e?this._stretch:this._stretch===e?this:new t(this._style,this._variant,this._weight,e,this._size,this._height,this._family)},t.prototype.size=function(e){return void 0===e?this._size:(e=null!==e?pa.fromAny(e):null,f.equal(this._size,e)?this:new t(this._style,this._variant,this._weight,this._stretch,e,this._height,this._family))},t.prototype.height=function(e){return void 0===e?this._height:(e=null!==e?la.fromAny(e):null,f.equal(this._height,e)?this:new t(this._style,this._variant,this._weight,this._stretch,this._size,e,this._family))},t.prototype.family=function(e){return void 0===e?Array.isArray(this._family)?this._family.slice(0):this._family:f.equal(this._family,e)?this:(Array.isArray(e)&&1===e.length&&(e=e[0]),new t(this._style,this._variant,this._weight,this._stretch,this._size,this._height,e))},t.prototype.toAny=function(){return{style:this._style,variant:this._variant,weight:this._weight,stretch:this._stretch,size:this._size,height:this._height,family:Array.isArray(this._family)?this._family.slice(0):this._family}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._style===e._style&&this._variant===e._variant&&this._weight===e._weight&&this._stretch===e._stretch&&f.equal(this._size,e._size)&&f.equal(this._height,e._height)&&f.equal(this._family,e._family))},t.prototype.debug=function(t){if(t=t.write("Font").write(46).write("family").write(40).write(41),"string"==typeof this._family)t=t.debug(this._family);else if(Array.isArray(this._family)&&this._family.length){t=t.debug(this._family[0]);for(var e=1;e<this._family.length;e+=1)t=t.write(", ").debug(this._family[e])}t=t.write(41),null!==this._style&&(t=t.write(46).write("style").write(40).debug(this._style).write(41)),null!==this._variant&&(t=t.write(46).write("variant").write(40).debug(this._variant).write(41)),null!==this._weight&&(t=t.write(46).write("weight").write(40).debug(this._weight).write(41)),null!==this._stretch&&(t=t.write(46).write("stretch").write(40).debug(this._stretch).write(41)),null!==this._size&&(t=t.write(46).write("size").write(40).debug(this._size).write(41)),null!==this._height&&(t=t.write(46).write("height").write(40).debug(this._height).write(41))},t.prototype.toString=function(){var t="";if(null===this._style&&"normal"!==this._variant&&"normal"!==this._weight&&"normal"!==this._stretch||(t+=this._style||"normal"),null===this._variant&&"normal"!==this._weight&&"normal"!==this._stretch||(t&&(t+=" "),t+=this._variant||"normal"),null===this._weight&&"normal"!==this._stretch||(t&&(t+=" "),t+=this._weight||"normal"),null!==this._stretch&&(t&&(t+=" "),t+=this._stretch),null!==this._size&&(t&&(t+=" "),t+=this._size.toString(),null!==this._height&&(t+="/",t+=this._height.toString())),"string"==typeof this._family)t&&(t+=" "),t+=ca.format(this._family);else if(Array.isArray(this._family)&&this._family.length){t&&(t+=" "),t+=ca.format(this._family[0]);for(var e=1;e<this._family.length;e+=1)t+=", ",t+=ca.format(this._family[e])}return t},t.style=function(e,r){return Array.isArray(r)&&1===r.length&&(r=r[0]),new t(e,null,null,null,null,null,r)},t.variant=function(e,r){return Array.isArray(r)&&1===r.length&&(r=r[0]),new t(null,e,null,null,null,null,r)},t.weight=function(e,r){return Array.isArray(r)&&1===r.length&&(r=r[0]),new t(null,null,e,null,null,null,r)},t.stretch=function(e,r){return Array.isArray(r)&&1===r.length&&(r=r[0]),new t(null,null,null,e,null,null,r)},t.size=function(e,r){return e=null!==e?pa.fromAny(e):null,Array.isArray(r)&&1===r.length&&(r=r[0]),new t(null,null,null,null,e,null,r)},t.family=function(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),new t(null,null,null,null,null,null,e)},t.from=function(e,r,i,n,o,s,u){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),o=null!==o?pa.fromAny(o):null,s=null!==s?la.fromAny(s):null,Array.isArray(u)&&1===u.length&&(u=u[0]),new t(e,r,i,n,o,s,u)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.style,e.variant,e.weight,e.stretch,e.size,e.height,e.family);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.header("font");if(r){var i=r.get("style").stringValue(null),n=r.get("variant").stringValue(null),o=r.get("weight").stringValue(null),s=r.get("stretch").stringValue(null),u=pa.fromValue(r.get("size")),a=la.fromValue(r.get("height")),h=ca.fromValue(r.get("family"));if(void 0!==h)return t.from(i,n,o,s,u,a,h)}},t.parse=function(e){for(var r=$.stringInput(e);r.isCont()&&$.isWhitespace(r.head());)r=r.step();var i=t.Parser.parse(r);if(i.isDone())for(;r.isCont()&&$.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=ft.error(lt.unexpected(r))),i.bind()},t.isInit=function(t){return!(!t||"object"!=typeof t)&&void 0!==t.family},t.form=function(e){return void 0!==e?(e=t.fromAny(e),new t.Form(e)):(t._form||(t._form=new t.Form),t._form)},t}(),ya=function(t){function e(e,r,i,n,o,s,u,a,h,p,l){var c=t.call(this)||this;return c.style=e,c.variant=r,c.weight=i,c.stretch=n,c.size=o,c.height=s,c.family=u,c.identOutput=a,c.lengthParser=h,c.familyParser=p,c.step=l,c}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.style,this.variant,this.weight,this.stretch,this.size,this.height,this.family,this.identOutput,this.lengthParser,this.familyParser,this.step)},e.parse=function(t,r,i,n,o,s,u,a,h,p,l,c){void 0===c&&(c=1);for(var f=0;;){if(1===c){for(;t.isCont()&&(f=t.head(),$.isSpace(f));)t.step();if(t.isCont())c=$.isAlpha(f)?2:34===f||39===f?11:4;else if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(2===c){for(h=h||$.stringOutput();t.isCont()&&(f=t.head(),$.isAlpha(f)||45===f);)t=t.step(),h.write(f);if(!t.isEmpty()){var d=h.bind();switch(h=void 0,d){case"italic":case"oblique":if(void 0!==r)return ft.error(lt.message("reapeated font style: "+d,t));r=d,c=3;break;case"small-caps":if(void 0!==i)return ft.error(lt.message("reapeated font variant: "+d,t));i=d,c=3;break;case"bold":case"bolder":case"lighter":if(void 0!==n)return ft.error(lt.message("reapeated font weight: "+d,t));n=d,c=3;break;case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":if(void 0!==o)return ft.error(lt.message("reapeated font stretch: "+d,t));o=d,c=3;break;case"normal":if(void 0===r)r=d;else if(void 0===i)i=d;else if(void 0===n)n=d;else{if(void 0!==o)return ft.error(lt.message("reapeated font property: "+d,t));o=d}c=3;break;case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":s=d,c=5;break;default:a=d,c=12}}}if(3===c){if(t.isCont()){if(f=t.head(),$.isSpace(f)){t.step(),c=1;continue}return ft.error(lt.expected("font property, size, or family",t))}if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(4===c)if((p=p?p.feed(t):$u.parse(t)).isDone()){var y=p.bind();if(""===y.units()){var v=y.value();switch(v){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:if(void 0!==n)return ft.error(lt.message("reapeated font weight: "+v,t));n=String(v);break;default:return ft.error(lt.message("unknown font property: "+v,t))}c=3;continue}s=y,p=void 0,c=5}else if(p.isError())return p.asError();if(5===c)if(t.isCont())if(f=t.head(),$.isSpace(f))t.step(),c=6;else{if(47!==f)return ft.error(lt.expected("font family",t));t.step(),c=7}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(6===c){for(;t.isCont()&&(f=t.head(),$.isSpace(f));)t.step();if(t.isCont())47===f?(t.step(),c=7):c=11;else if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(7===c){for(;t.isCont()&&(f=t.head(),$.isSpace(f));)t.step();if(t.isCont())c=$.isAlpha(f)?8:9;else if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(8===c){for(h=h||$.stringOutput();t.isCont()&&(f=t.head(),$.isAlpha(f));)t=t.step(),h.write(f);if(!t.isEmpty()){d=h.bind();switch(h=void 0,d){case"normal":u=d,c=10;break;default:return ft.error(lt.message("unknown line height: "+d,t))}}}if(9===c)if((p=p?p.feed(t):$u.parse(t)).isDone())u=p.bind(),p=void 0,c=10;else if(p.isError())return p.asError();if(10===c)if(t.isCont()){if(f=t.head(),!$.isSpace(f))return ft.error(lt.expected("font family",t));t.step(),c=11}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(11===c)if((l=l?l.feed(t):fa.parse(t)).isDone())Array.isArray(a)?a.push(l.bind()):a=void 0!==a?[a,l.bind()]:l.bind(),l=void 0,c=12;else if(l.isError())return l.asError();if(12===c){for(;t.isCont()&&(f=t.head(),$.isSpace(f));)t.step();if(t.isCont()&&44===f){t.step(),c=11;continue}if(!t.isEmpty())return ft.done(da.from(r,i,n,o,s,u,a))}break}return new e(r,i,n,o,s,u,a,h,p,l,c)},e.parseRest=function(t,r,i,n,o,s,u,a){var h=void 0!==a?12:void 0!==s?5:3;return e.parse(t,r,i,n,o,s,u,a,void 0,void 0,void 0,h)},e}(ft);da.Parser=ya;var va=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){t=da.fromAny(t);var e=ae.create(7);if(null!==t._style&&e.slot("style",t._style),null!==t._variant&&e.slot("variant",t._variant),null!==t._weight&&e.slot("weight",t._weight),null!==t._stretch&&e.slot("stretch",t._stretch),t._size instanceof Hu?e.slot("size",Hu.form().mold(t._size)):null!==t._size&&e.slot("size",t._size),t._height instanceof Hu?e.slot("height",Hu.form().mold(t._height)):null!==t._height&&e.slot("height",t._height),Array.isArray(t._family)){for(var r=ae.create(t._family.length),i=0;i<t._family.length;i+=1)r.push(t._family[i]);e.slot("family",r)}else e.slot("family",t._family);return ae.of(ie.of("font",e))},e.prototype.cast=function(t){var e,r=t.toValue();try{if(!(e=da.fromValue(r))){var i=r.stringValue();void 0!==i&&(e=da.parse(i))}}catch(t){}return e},e}(Se);da.Form=va;var _a=function(){function t(){}return t.prototype.translate=function(e,r){return this.transform(t.translate(e,r))},t.prototype.translateX=function(e){return this.transform(t.translateX(e))},t.prototype.translateY=function(e){return this.transform(t.translateY(e))},t.prototype.scale=function(e,r){return this.transform(t.scale(e,r))},t.prototype.scaleX=function(e){return this.transform(t.scaleX(e))},t.prototype.scaleY=function(e){return this.transform(t.scaleY(e))},t.prototype.rotate=function(e){return this.transform(t.rotate(e))},t.prototype.skew=function(e,r){return this.transform(t.skew(e,r))},t.prototype.skewX=function(e){return this.transform(t.skewX(e))},t.prototype.skewY=function(e){return this.transform(t.skewY(e))},t.prototype.toAttributeString=function(){return this.toString()},t.identity=function(){return t._identity||(t._identity=new t.Identity),t._identity},t.translate=function(e,r){return new t.Translate(e,r)},t.translateX=function(e){return new t.Translate(e,0)},t.translateY=function(e){return new t.Translate(0,e)},t.scale=function(e,r){return new t.Scale(e,r)},t.scaleX=function(e){return new t.Scale(e,1)},t.scaleY=function(e){return new t.Scale(1,e)},t.rotate=function(e){return new t.Rotate(e)},t.skew=function(e,r){return new t.Skew(e,r)},t.skewX=function(e){return new t.Skew(e,0)},t.skewY=function(e){return new t.Skew(0,e)},t.affine=function(e,r,i,n,o,s){return new t.Affine(e,r,i,n,o,s)},t.list=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t.List(e)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){switch(e.tag()){case"identity":return t.Identity.fromValue(e);case"translate":return t.Translate.fromValue(e);case"scale":return t.Scale.fromValue(e);case"rotate":return t.Rotate.fromValue(e);case"skew":return t.Skew.fromValue(e);case"matrix":return t.Affine.fromValue(e);default:return t.List.fromValue(e)}},t.parse=function(e){for(var r=$.stringInput(e);r.isCont()&&$.isWhitespace(r.head());)r=r.step();var i=t.ListParser.parse(r);if(i.isDone())for(;r.isCont()&&$.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=ft.error(lt.unexpected(r))),i.bind()},t.form=function(e){return void 0!==e?new t.Form(t.fromAny(e)):(t._form||(t._form=new t.Form),t._form)},t}(),ma=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.transform=function(t,e){return t instanceof _a?t:(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t,e]:[t=Hu.fromAny(t),e=Hu.fromAny(e)])},e.prototype.transformX=function(t,e){return t},e.prototype.transformY=function(t,e){return e},e.prototype.inverse=function(){return this},e.prototype.toAffine=function(){return new _a.Affine(1,0,0,1,0,0)},e.prototype.toValue=function(){return ae.of(ie.of("identity"))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),e._hashSeed},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("identity").write(40).write(41)},e.prototype.toString=function(){return"none"},e.fromValue=function(t){if("identity"===t.tag())return _a.identity()},e}(_a);_a.Identity=ma;var wa=function(t){function e(e,r){var i=t.call(this)||this;return i._x=Hu.fromAny(e),i._y=Hu.fromAny(r),i}return _(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){return t instanceof _a?t instanceof _a.Identity?this:new _a.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t+this._x.pxValue(),e+this._y.pxValue()]:(t=Hu.fromAny(t),e=Hu.fromAny(e),[t.plus(this._x),e.plus(this._y)]))},e.prototype.transformX=function(t,e){return t+this._x.pxValue()},e.prototype.transformY=function(t,e){return e+this._y.pxValue()},e.prototype.inverse=function(){return new e(this._x.opposite(),this._y.opposite())},e.prototype.toAffine=function(){return new _a.Affine(1,0,0,1,this._x.pxValue(),this._y.pxValue())},e.prototype.toValue=function(){return ae.of(ie.of("translate",ae.of(ne.of("x",this._x.toString()),ne.of("y",this._y.toString()))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this._x.equals(t._x)&&this._y.equals(t._y))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._x.hashCode()),this._y.hashCode()))},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("translate"),t=this._x.isDefined()&&!this._y.isDefined()?t.write("X").write(40).debug(this._x).write(41):!this._x.isDefined()&&this._y.isDefined()?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},e.prototype.toString=function(){return this._x.isDefined()&&!this._y.isDefined()?"translate("+this._x+",0)":!this._x.isDefined()&&this._y.isDefined()?"translate(0,"+this._y+")":"translate("+this._x+","+this._y+")"},e.prototype.toAttributeString=function(){return this._x.isDefined()&&!this._y.isDefined()?"translate("+this._x.pxValue()+",0)":!this._x.isDefined()&&this._y.isDefined()?"translate(0,"+this._y.pxValue()+")":"translate("+this._x.pxValue()+","+this._y.pxValue()+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("translate");if(r.isDefined()){var i=Hu.zero(),n=Hu.zero();return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?i=t.toValue().cast(Hu.form(),i):"y"===r&&(n=t.toValue().cast(Hu.form(),n)):t instanceof se&&(0===e?i=t.cast(Hu.form(),i):1===e&&(n=t.cast(Hu.form(),n)))}),this),new e(i,n)}},e.parse=function(t){for(var e=$.stringInput(t);e.isCont()&&$.isWhitespace(e.head());)e=e.step();var r=_a.TranslateParser.parse(e);if(r.isDone())for(;e.isCont()&&$.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},e}(_a);_a.Translate=wa;var ga=function(t){function e(e,r){var i=t.call(this)||this;return i._x=+e,i._y=+r,i}return _(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){return t instanceof _a?t instanceof _a.Identity?this:new _a.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),"number"==typeof t&&"number"==typeof e?[t*this._x,e*this._y]:(t=Hu.fromAny(t),e=Hu.fromAny(e),[t.times(this._x),e.times(this._y)]))},e.prototype.transformX=function(t,e){return t*this._x},e.prototype.transformY=function(t,e){return e*this._y},e.prototype.inverse=function(){return new e(1/(this._x||1),1/(this._y||1))},e.prototype.toAffine=function(){return new _a.Affine(this._x,0,0,this._y,0,0)},e.prototype.toValue=function(){return ae.of(ie.of("scale",ae.of(ne.of("x",this._x),ne.of("y",this._y))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this._x===t._x&&this._y===t._y)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,c.hash(this._x)),c.hash(this._y)))},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("scale"),t=this._x&&!this._y?t.write("X").write(40).debug(this._x).write(41):!this._x&&this._y?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},e.prototype.toString=function(){return this._x&&!this._y?"scaleX("+this._x+")":!this._x&&this._y?"scaleY("+this._y+")":"scale("+this._x+","+this._y+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("scale");if(r.isDefined()){var i=0,n=0;return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?i=t.toValue().numberValue(i):"y"===r&&(n=t.toValue().numberValue(n)):t instanceof se&&(0===e?i=t.numberValue(i):1===e&&(n=t.numberValue(n)))}),this),new e(i,n)}},e.parse=function(t){for(var e=$.stringInput(t);e.isCont()&&$.isWhitespace(e.head());)e=e.step();var r=_a.ScaleParser.parse(e);if(r.isDone())for(;e.isCont()&&$.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},e}(_a);_a.Scale=ga;var ba=function(t){function e(e){var r=t.call(this)||this;return r._a=Nu.fromAny(e,"deg"),r}return _(e,t),Object.defineProperty(e.prototype,"angle",{get:function(){return this._a},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){if(t instanceof _a)return t instanceof _a.Identity?this:new _a.List([this,t]);Array.isArray(t)&&(e=t[1],t=t[0]),t=Hu.fromAny(t),e=Hu.fromAny(e);var r=this._a.radValue(),i=Math.cos(r),n=Math.sin(r);return"number"==typeof t&&"number"==typeof e?[t*i-e*n,t*n+e*i]:[t.times(i).minus(e.times(n)),t.times(n).plus(e.times(i))]},e.prototype.transformX=function(t,e){var r=this._a.radValue();return t*Math.cos(r)-e*Math.sin(r)},e.prototype.transformY=function(t,e){var r=this._a.radValue();return t*Math.sin(r)+e*Math.cos(r)},e.prototype.inverse=function(){return new e(this._a.opposite())},e.prototype.toAffine=function(){var t=this._a.radValue();return new _a.Affine(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0)},e.prototype.toValue=function(){return ae.of(ie.of("rotate",this._a.toString()))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&this._a.equals(t._a)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(e._hashSeed,this._a.hashCode()))},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("rotate").write(40).debug(this._a).write(41)},e.prototype.toString=function(){return"rotate("+this._a+")"},e.prototype.toAttributeString=function(){return"rotate("+this._a.degValue()+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("rotate");if(r.isDefined()){var i=Nu.zero();return r.forEach((function(t,e){"a"===t.key.stringValue()?i=t.toValue().cast(Nu.form(),i):t instanceof se&&0===e&&(i=t.cast(Nu.form(),i))}),this),new e(i)}},e.parse=function(t){for(var e=$.stringInput(t);e.isCont()&&$.isWhitespace(e.head());)e=e.step();var r=_a.RotateParser.parse(e);if(r.isDone())for(;e.isCont()&&$.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},e}(_a);_a.Rotate=ba;var xa=function(t){function e(e,r){var i=t.call(this)||this;return i._x=Nu.fromAny(e,"deg"),i._y=Nu.fromAny(r,"deg"),i}return _(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){return t instanceof _a?t instanceof _a.Identity?this:new _a.List([this,t]):(Array.isArray(t)&&(e=t[1],t=t[0]),t=Hu.fromAny(t),e=Hu.fromAny(e),"number"==typeof t&&"number"==typeof e?[t+e*Math.tan(this._x.radValue()),t*Math.tan(this._y.radValue())+e]:[t.plus(e.times(Math.tan(this._x.radValue()))),t.times(Math.tan(this._y.radValue())).plus(e)])},e.prototype.transformX=function(t,e){return t+e*Math.tan(this._x.radValue())},e.prototype.transformY=function(t,e){return t*Math.tan(this._y.radValue())+e},e.prototype.inverse=function(){return new e(this._x.opposite(),this._y.opposite())},e.prototype.toAffine=function(){var t=this._x.radValue(),e=this._y.radValue();return new _a.Affine(1,Math.tan(e),Math.tan(t),1,0,0)},e.prototype.toValue=function(){return ae.of(ie.of("skew",ae.of(ne.of("x",this._x.toString()),ne.of("y",this._y.toString()))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this._x.equals(t._x)&&this._y.equals(t._y))},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(e._hashSeed,this._x.hashCode()),this._y.hashCode()))},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("skew"),t=this._x.isDefined()&&!this._y.isDefined()?t.write("X").write(40).debug(this._x).write(41):!this._x.isDefined()&&this._y.isDefined()?t.write("Y").write(40).debug(this._y).write(41):t.write(40).debug(this._x).write(", ").debug(this._y).write(41)},e.prototype.toString=function(){return this._x.isDefined()&&!this._y.isDefined()?"skewX("+this._x+")":!this._x.isDefined()&&this._y.isDefined()?"skewY("+this._y+")":"skew("+this._x+","+this._y+")"},e.prototype.toAttributeString=function(){return this._x.isDefined()&&!this._y.isDefined()?"skewX("+this._x.degValue()+")":!this._x.isDefined()&&this._y.isDefined()?"skewY("+this._y.degValue()+")":"skew("+this._x.degValue()+","+this._y.degValue()+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("skew");if(r.isDefined()){var i=Nu.zero(),n=Nu.zero();return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?i=t.toValue().cast(Nu.form(),i):"y"===r&&(n=t.toValue().cast(Nu.form(),n)):t instanceof se&&(0===e?i=t.cast(Nu.form(),i):1===e&&(n=t.cast(Nu.form(),n)))}),this),new e(i,n)}},e.parse=function(t){for(var e=$.stringInput(t);e.isCont()&&$.isWhitespace(e.head());)e=e.step();var r=_a.SkewParser.parse(e);if(r.isDone())for(;e.isCont()&&$.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},e}(_a);_a.Skew=xa;var Ca=function(t){function e(e,r,i,n,o,s){void 0===e&&(e=1),void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===s&&(s=0);var u=t.call(this)||this;return u._x0=+e,u._y0=+r,u._x1=+i,u._y1=+n,u._tx=+o,u._ty=+s,u}return _(e,t),Object.defineProperty(e.prototype,"x0",{get:function(){return this._x0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y0",{get:function(){return this._y0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x1",{get:function(){return this._x1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y1",{get:function(){return this._y1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tx",{get:function(){return this._tx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ty",{get:function(){return this._ty},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){return t instanceof _a?t instanceof _a.Identity?this:this.multiply(t.toAffine()):(Array.isArray(t)&&(e=t[1],t=t[0]),t=Hu.fromAny(t),e=Hu.fromAny(e),"number"==typeof t&&"number"==typeof e?[t*this._x0+e*this._x1+this._tx,t*this._y0+e*this._y1+this._ty]:[t.times(this._x0).plus(e.times(this._x1)).plus(this._tx),t.times(this._y0).plus(e.times(this._y1)).plus(this._ty)])},e.prototype.transformX=function(t,e){return t*this._x0+e*this._x1+this._tx},e.prototype.transformY=function(t,e){return t*this._y0+e*this._y1+this._ty},e.prototype.inverse=function(){var t=this._x0,r=this._y0,i=this._x1,n=this._y1,o=this._tx,s=this._ty,u=t*n-i*r;if(Math.abs(u)>=Number.MIN_VALUE)return new e(n/u,-r/u,-i/u,t/u,(i*s-n*o)/u,(r*o-t*s)/u);throw new Error("non-invertible affine transform with determinant "+u)},e.prototype.multiply=function(t){return new e(this._x0*t._x0+this._x1*t._y0,this._y0*t._x0+this._y1*t._y0,this._x0*t._x1+this._x1*t._y1,this._y0*t._x1+this._y1*t._y1,this._x0*t._tx+this._x1*t._ty,this._y0*t._tx+this._y1*t._ty)},e.prototype.toAffine=function(){return this},e.prototype.toValue=function(){return ae.of(ie.of("matrix",ae.of(this._x0,this._y0,this._x1,this._y1,this._tx,this._ty)))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this._x0===t._x0&&this._y0===t._y0&&this._x1===t._x1&&this._y1===t._y1&&this._tx===t._tx&&this._ty===t._ty)},e.prototype.hashCode=function(){return void 0===e._hashSeed&&(e._hashSeed=c.seed(e)),c.mash(c.mix(c.mix(c.mix(c.mix(c.mix(c.mix(e._hashSeed,c.hash(this._x0)),c.hash(this._y0)),c.hash(this._x1)),c.hash(this._y1)),c.hash(this._tx)),c.hash(this._ty)))},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("affine").write(40).debug(this._x0).write(", ").debug(this._y0).write(", ").debug(this._x1).write(", ").debug(this._y1).write(", ").debug(this._tx).write(", ").debug(this._ty).write(41)},e.prototype.toString=function(){return"matrix("+this._x0+","+this._y0+","+this._x1+","+this._y1+","+this._tx+","+this._ty+")"},e.identity=function(){return e._identityMatrix||(e._identityMatrix=new e),e._identityMatrix},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("matrix");if(r.isDefined()){var i=0,n=0,o=0,s=0,u=0,a=0;return r.forEach((function(t,e){var r=t.key.stringValue();if(void 0!==r)"x0"===r?i=t.toValue().numberValue(i):"y0"===r?n=t.toValue().numberValue(n):"x1"===r?o=t.toValue().numberValue(o):"y1"===r?s=t.toValue().numberValue(s):"tx"===r?u=t.toValue().numberValue(u):"ty"===r&&(a=t.toValue().numberValue(a));else if(t instanceof se)switch(e){case 0:i=t.numberValue(i);break;case 1:n=t.numberValue(n);break;case 2:o=t.numberValue(o);break;case 3:s=t.numberValue(s);break;case 4:u=t.numberValue(u);break;case 5:a=t.numberValue(a)}}),this),new e(i,n,o,s,u,a)}},e.parse=function(t){for(var e=$.stringInput(t);e.isCont()&&$.isWhitespace(e.head());)e=e.step();var r=_a.AffineParser.parse(e);if(r.isDone())for(;e.isCont()&&$.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=ft.error(lt.unexpected(e))),r.bind()},e}(_a);_a.Affine=Ca;var Sa=function(t){function e(r){for(var i=t.call(this)||this,n=[],o=0;o<r.length;o+=1){var s=_a.fromAny(r[o]);s instanceof e?n.push.apply(n,s._transforms):!s||s instanceof _a.Identity||n.push(s)}return i._transforms=n,i}return _(e,t),Object.defineProperty(e.prototype,"transforms",{get:function(){return this._transforms},enumerable:!0,configurable:!0}),e.prototype.transform=function(t,e){if(t instanceof _a)return t instanceof _a.Identity?this:new _a.List([this,t]);Array.isArray(t)&&(e=t[1],t=t[0]);var r=this._transforms;if("number"==typeof t&&"number"==typeof e){for(var i=[t,e],n=0,o=r.length;n<o;n+=1)i=r[n].transform(i);return i}for(i=[Hu.fromAny(t),Hu.fromAny(e)],n=0,o=r.length;n<o;n+=1)i=r[n].transform(i);return i},e.prototype.transformX=function(t,e){for(var r=this._transforms,i=0,n=r.length;i<n;i+=1)t=r[i].transformX(t,e),e=r[i].transformX(t,e);return t},e.prototype.transformY=function(t,e){for(var r=this._transforms,i=0,n=r.length;i<n;i+=1)t=r[i].transformX(t,e),e=r[i].transformX(t,e);return e},e.prototype.inverse=function(){for(var t=this._transforms,r=t.length,i=new Array(r),n=0;n<r;n+=1)i[n]=t[r-n-1].inverse();return new e(i)},e.prototype.toAffine=function(){for(var t=Ca.identity(),e=this._transforms,r=0,i=e.length;r<i;r+=1)t=t.multiply(e[r].toAffine());return t},e.prototype.toValue=function(){for(var t=this._transforms,e=t.length,r=ae.create(e),i=0;i<e;i+=1)r.push(t[i].toValue());return r},e.prototype.conformsTo=function(t){if(t instanceof e){var r=this._transforms.length;if(r===t._transforms.length){for(var i=0;i<r;i+=1)if(!this._transforms[i].conformsTo(t._transforms[i]))return!1;return!0}}return!1},e.prototype.equals=function(t){if(t instanceof e){var r=this._transforms.length;if(r===t._transforms.length){for(var i=0;i<r;i+=1)if(!this._transforms[i].equals(t._transforms[i]))return!1;return!0}}return!1},e.prototype.hashCode=function(){void 0===e._hashSeed&&(e._hashSeed=c.seed(e));for(var t=e._hashSeed,r=this._transforms,i=0,n=r.length;i<n;i+=1)t=c.mix(t,r[i].hashCode());return c.mash(t)},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("list").write(40);var e=this._transforms,r=e.length;if(r>0){t=t.debug(e[0]);for(var i=1;i<r;i+=1)t=t.write(", ").debug(e[i])}t=t.write(41)},e.prototype.toString=function(){var t=this._transforms,e=t.length;if(e>0){for(var r=t[0].toString(),i=1;i<e;i+=1)r=r+" "+t[i].toString();return r}return""},e.prototype.toAttributeString=function(){var t=this._transforms,e=t.length;if(e>0){for(var r=t[0].toAttributeString(),i=1;i<e;i+=1)r=r+" "+t[i].toAttributeString();return r}return""},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=[];if(t.forEach((function(t){var e=_a.fromValue(t.toValue());e&&r.push(e)}),this),r.length)return new e(r)},e.parse=function(t){var r=_a.parse(t);return r instanceof e?r:new e([r])},e}(_a);_a.List=Sa;var Aa=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=r,o.yParser=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"translateX":case"translateY":case"translate":o=2;break;default:return ft.error(lt.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(3===o){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(i=$u.parse(t,"px"))}if(i)if(i.isDone())o=4;else if(i.isError())return i.asError()}if(4===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();if(t.isCont())if(41===(s=t.head())){switch(t.step(),u=r.bind()){case"translateX":return ft.done(_a.translateX(i.bind()));case"translateY":return ft.done(_a.translateY(i.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}}else{if(44!==s)return ft.error(lt.expected(",",t));t.step(),o=5}else if(t.isDone())return ft.error(lt.unexpected(t))}if(5===o){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(n=$u.parse(t,"px"))}if(n)if(n.isDone())o=6;else if(n.isError())return n.asError()}if(6===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"translate":return ft.done(_a.translate(i.bind(),n.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(ft);_a.TranslateParser=Aa;var ka=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=r,o.yParser=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"scaleX":case"scaleY":case"scale":o=2;break;default:return ft.error(lt.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(3===o){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(i=pt.parseNumber(t))}if(i)if(i.isDone())o=4;else if(i.isError())return i.asError()}if(4===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();if(t.isCont())if(41===(s=t.head())){switch(t.step(),u=r.bind()){case"scaleX":return ft.done(_a.scaleX(i.bind()));case"scaleY":return ft.done(_a.scaleY(i.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}}else{if(44!==s)return ft.error(lt.expected(",",t));t.step(),o=5}else if(t.isDone())return ft.error(lt.unexpected(t))}if(5===o){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(n=pt.parseNumber(t))}if(n)if(n.isDone())o=6;else if(n.isError())return n.asError()}if(6===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"scale":return ft.done(_a.scale(i.bind(),n.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(ft);_a.ScaleParser=ka;var Ea=function(t){function e(e,r,i){var n=t.call(this)||this;return n.identOutput=e,n.aParser=r,n.step=i,n}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.aParser,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n){for(r=r||$.stringOutput();t.isCont()&&(o=t.head(),$.isAlpha(o));)t=t.step(),r.write(o);if(!t.isEmpty())switch(s=r.bind()){case"rotate":n=2;break;default:return ft.error(lt.message("unknown transform function: "+s,t))}}if(2===n){for(;t.isCont()&&(o=t.head(),$.isSpace(o));)t=t.step();if(t.isCont()&&40===o)t.step(),n=3;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(3===n){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(i=Bu.parse(t,"deg"))}if(i)if(i.isDone())n=4;else if(i.isError())return i.asError()}if(4===n){for(;t.isCont()&&$.isSpace(t.head());)t.step();var s;if(t.isCont()&&41===t.head())switch(t.step(),s=r.bind()){case"rotate":return ft.done(_a.rotate(i.bind()));default:return ft.error(lt.message("unknown transform function: "+s,t))}else if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n)},e.parseRest=function(t,r){return e.parse(t,r,void 0,2)},e}(ft);_a.RotateParser=Ea;var Oa=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.identOutput=e,o.xParser=r,o.yParser=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"skewX":case"skewY":case"skew":o=2;break;default:return ft.error(lt.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}if(3===o){if(i)i=i.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(i=Bu.parse(t,"deg"))}if(i)if(i.isDone())o=4;else if(i.isError())return i.asError()}if(4===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();if(t.isCont())if(41===(s=t.head())){switch(t.step(),u=r.bind()){case"skewX":return ft.done(_a.skewX(i.bind()));case"skewY":return ft.done(_a.skewY(i.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}}else{if(44!==s)return ft.error(lt.expected(",",t));t.step(),o=5}else if(t.isDone())return ft.error(lt.unexpected(t))}if(5===o){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(n=Bu.parse(t,"deg"))}if(n)if(n.isDone())o=6;else if(n.isError())return n.asError()}if(6===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())switch(t.step(),u=r.bind()){case"skew":return ft.done(_a.skew(i.bind(),n.bind()));default:return ft.error(lt.message("unknown transform function: "+u,t))}else if(!t.isEmpty())return ft.error(lt.expected(")",t))}return new e(r,i,n,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(ft);_a.SkewParser=Oa;var Va=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.identOutput=e,o.entries=r,o.entryParser=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.entries,this.entryParser,this.step)},e.parse=function(t,r,i,n,o){void 0===i&&(i=[]),void 0===o&&(o=1);var s=0;if(1===o){for(r=r||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"matrix":o=2;break;default:return ft.error(lt.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return ft.error(lt.expected("(",t))}for(;;){if(3===o){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(n=pt.parseNumber(t))}if(n)if(n.isDone())i.push(n.bind()),n=void 0,o=4;else if(n.isError())return n.asError()}if(4===o){for(;t.isCont()&&$.isSpace(t.head());)t.step();if(t.isCont()){if(41!==(s=t.head())){if(i.length>=6)return ft.error(lt.expected(")",t));if(44===s){t.step(),o=3;continue}return ft.error(lt.expected(",",t))}var u;switch(t.step(),u=r.bind()){case"matrix":return ft.done(_a.affine.apply(_a,i));default:return ft.error(lt.message("unknown transform function: "+u,t))}}else if(t.isDone())return ft.error(lt.unexpected(t))}break}return new e(r,i,n,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(ft);_a.AffineParser=Va;var Pa=function(t){function e(e,r){var i=t.call(this)||this;return i.transform=e,i.transformParser=r,i}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.transform,this.transformParser)},e.parse=function(t,r,i){for(void 0===r&&(r=_a.identity());;){if(!i){for(;t.isCont()&&$.isSpace(t.head());)t.step();if(t.isCont())i=_a.Parser.parse(t);else if(t.isDone())return ft.done(r)}if(i){if((i=i.feed(t)).isDone()){r=r.transform(i.bind()),i=void 0;continue}if(i.isError())return i.asError()}break}return new e(r,i)},e}(ft);_a.ListParser=Pa;var Da=function(t){function e(e){var r=t.call(this)||this;return r.identOutput=e,r}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput)},e.parse=function(t,r){var i=0;for(r=r||$.stringOutput();t.isCont()&&(i=t.head(),$.isAlpha(i));)t=t.step(),r.write(i);if(!t.isEmpty()){var n=r.bind();switch(n){case"translateX":case"translateY":case"translate":return _a.TranslateParser.parseRest(t,r);case"scaleX":case"scaleY":case"scale":return _a.ScaleParser.parseRest(t,r);case"rotate":return _a.RotateParser.parseRest(t,r);case"skewX":case"skewY":case"skew":return _a.SkewParser.parseRest(t,r);case"matrix":return _a.AffineParser.parseRest(t,r);case"none":return ft.done(_a.identity());default:return ft.error(lt.message("unknown transform function: "+n,t))}}return new e(r)},e}(ft);_a.Parser=Da;var Ma=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return(t=_a.fromAny(t)).toValue()},e.prototype.cast=function(t){var e=t.toValue();try{if(e instanceof ae)return _a.fromValue(e);var r=e.stringValue(void 0);if(void 0!==r)return _a.parse(r)}catch(t){}},e}(Se);_a.Form=Ma;var Ta=function(){function t(){}return t.prototype.map=function(e){return new t.Map(this,e)},t.step=function(e,r){return new t.Step(e,r)},t.number=function(e,r){return new t.Number(e,r)},t.time=function(e,r){return new t.DateTime(e,r)},t.angle=function(e,r){return new t.Angle(e,r)},t.len=function(e,r){return new t.Length(e,r)},t.array=function(e,r){return new t.Array(e,r)},t.map=function(e,r,i){return new t.Map(t.from(e,r),i)},t.interpolator=function(e,r){return new t.Interpolator(e,r)},t.from=function(e,r){return e instanceof ro||r instanceof ro?t.shape(e,r):e instanceof lo||e instanceof Date||r instanceof lo||r instanceof Date?t.time(e,r):e instanceof Nu||r instanceof Nu?t.angle(e,r):e instanceof Hu||r instanceof Hu?t.len(e,r):e instanceof ta||r instanceof ta?t.color(e,r):e instanceof _a||r instanceof _a?t.transform(e,r):e instanceof $t||r instanceof $t?t.structure(e,r):"number"==typeof e||"number"==typeof r?t.number(e,r):Array.isArray(e)||Array.isArray(r)?t.array(e,r):e instanceof t&&r instanceof t?t.interpolator(e,r):t.step(e,r)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)switch(e){case"step":return t.step();case"number":return t.number();case"shape":return t.shape();case"time":return t.time();case"angle":return t.angle();case"length":return t.len();case"transform":return t.transform();case"color":return t.color();case"array":return t.array()}throw new TypeError(""+e)},t.form=function(e,r){return void 0===e&&(e=t.valueForm()),e!==t.valueForm()||void 0!==r?new t.Form(e,void 0!==r?t.fromAny(r):void 0):(t._form||(t._form=new t.Form(e)),t._form)},t.valueForm=function(){throw new Error},t}(),Ra=function(t){function e(e,r){var i=t.call(this)||this;return void 0===r?r=e:void 0===e&&(e=r),i.y0=e,i.y1=r,i}return _(e,t),e.prototype.interpolate=function(t){var e=t<1?this.y0:this.y1;if(void 0===e)throw new TypeError;return e},e.prototype.deinterpolate=function(t){return t===this.y1?1:0},e.prototype.range=function(t,r){if(void 0===t){if(void 0===this.y0||void 0===this.y1)throw new TypeError;return[this.y0,this.y1]}return void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.y1===t.y1)},e}(Ta);Ta.Step=Ra;var Ia=function(t){function e(e,r){var i=t.call(this)||this;return void 0===e&&void 0===r?r=e=0:void 0===r?r=e:void 0===e&&(e=r),i.y0=+e,i.dy=+r-i.y0,i}return _(e,t),e.prototype.interpolate=function(t){return this.y0+this.dy*t},e.prototype.deinterpolate=function(t){return this.dy?(+t-this.y0)/this.dy:this.dy},e.prototype.range=function(t,r){return void 0===t?[this.y0,this.y0+this.dy]:void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(Ta);Ta.Number=Ia;var Fa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,Ta.shape(t[0],t[1])):Ta.shape(t,e)},e.shape=function(t,r){if(void 0===t&&void 0===r)return new e.Identity;if(void 0!==t&&(t=eo.fromAny(t)),void 0!==r&&(r=eo.fromAny(r)),t||r?r?t||(t=r):r=t:r=t=no.origin(),t instanceof no&&r instanceof no)return new e.PointR2(t,r);if(t instanceof oo&&r instanceof oo)return new e.SegmentR2(t,r);if(t instanceof uo&&r instanceof uo)return new e.BoxR2(t,r);if(t instanceof so&&r instanceof so)return new e.CircleR2(t,r);if(t instanceof ro&&r instanceof ro)return t instanceof uo||(t=new uo(t.xMin,t.yMin,t.xMax,t.yMax)),r instanceof uo||(r=new uo(r.xMin,r.yMin,r.xMax,r.yMax)),new e.BoxR2(t,r);throw new TypeError(t+", "+r)},e}(Ta);Ta.Shape=Fa,Ta.shape=Fa.shape;var La=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.interpolate=function(t){return no.origin()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(Fa);Fa.Identity=La;var Ua=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=eo.fromAny(e)),void 0!==r&&(r=eo.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=no.origin(),i.x=e.x,i.dx=r.x-i.x,i.y=e.y,i.dy=r.y-i.y,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.x+this.dx*t,r=this.y+this.dy*t;return new no(e,r)},e.prototype.deinterpolate=function(t){if((t=eo.fromAny(t))instanceof no){var e=t.x-this.x,r=t.y-this.y,i=e*this.dx+r*this.dy,n=Math.sqrt(e*e+r*r);return n?i/n:n}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x===t.x&&this.dx===t.dx&&this.y===t.y&&this.dy===t.dy)},e}(Fa);Fa.PointR2=Ua;var Na=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=eo.fromAny(e)),void 0!==r&&(r=eo.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=new oo(0,0,0,0),i.x0=e.x0,i.dx0=r.x0-i.x0,i.y0=e.y0,i.dy0=r.y0-i.y0,i.x1=e.x1,i.dx1=r.x1-i.x1,i.y1=e.y1,i.dy1=r.y1-i.y1,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.x0+this.dx0*t,r=this.y0+this.dy0*t,i=this.x1+this.dx1*t,n=this.y1+this.dy1*t;return new oo(e,r,i,n)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx0===t.dx0&&this.y0===t.y0&&this.dy0===t.dy0&&this.x1===t.x1&&this.dx1===t.dx1&&this.y1===t.y1&&this.dy1===t.dy1)},e}(Fa);Fa.SegmentR2=Na;var za=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=eo.fromAny(e)),void 0!==r&&(r=eo.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=new uo(0,0,0,0),i.xMin=e.xMin,i.dxMin=r.xMin-i.xMin,i.yMin=e.yMin,i.dyMin=r.yMin-i.yMin,i.xMax=e.xMax,i.dxMax=r.xMax-i.xMax,i.yMax=e.yMax,i.dyMax=r.yMax-i.yMax,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.xMin+this.dxMin*t,r=this.yMin+this.dyMin*t,i=this.xMax+this.dxMax*t,n=this.yMax+this.dyMax*t;return new uo(e,r,i,n)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.xMin===t.xMin&&this.dxMin===t.dxMin&&this.yMin===t.yMin&&this.dyMin===t.dyMin&&this.xMax===t.xMax&&this.dxMax===t.dxMax&&this.yMax===t.yMax&&this.dyMax===t.dyMax)},e}(Fa);Fa.BoxR2=za;var ja=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=eo.fromAny(e)),void 0!==r&&(r=eo.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=new so(0,0,0),i.cx=e.cx,i.dcx=r.cx-i.cx,i.cy=e.cy,i.dcy=r.cy-i.cy,i.r=e.r,i.dr=r.r-i.r,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.cx+this.dcx*t,r=this.cy+this.dcy*t,i=this.r+this.dr*t;return new so(e,r,i)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.cx===t.cx&&this.dcx===t.dcx&&this.cy===t.cy&&this.dcy===t.dcy&&this.r===t.r&&this.dr===t.dr)},e}(Fa);Fa.CircleR2=ja;var Wa=function(t){function e(e,r,i){var n=t.call(this)||this;return void 0===e&&void 0===r?r=e=0:void 0===r?r=e:void 0===e&&(e=r),e=lo.fromAny(e),r=lo.fromAny(r),n.t0=e.time(),n.dt=r.time()-n.t0,n.zone=i||e.zone(),n}return _(e,t),e.prototype.interpolate=function(t){return new lo(this.t0+this.dt*t,this.zone)},e.prototype.deinterpolate=function(t){return t=lo.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.range=function(t,r){return void 0===t?[new lo(this.t0,this.zone),new lo(this.t0+this.dt,this.zone)]:void 0===r?new e((t=t)[0],t[1],this.zone):new e(t,r,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt)},e}(Ta);Ta.DateTime=Wa;var qa=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=Nu.fromAny(e)),void 0!==r&&(r=Nu.fromAny(r)),e||r?r?e=e?e.to(r.units()):r:r=e:r=e=Nu.zero(),i.v0=e.value(),i.dv=r.value()-i.v0,i.units=r.units(),i}return _(e,t),e.prototype.interpolate=function(t){return Nu.from(this.v0+this.dv*t,this.units)},e.prototype.deinterpolate=function(t){var e=Nu.fromAny(t).toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,r){return void 0===t?[Nu.from(this.v0,this.units),Nu.from(this.v0+this.dv,this.units)]:void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Ta);Ta.Angle=qa;var Ba=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=Hu.fromAny(e)),void 0!==r&&(r=Hu.fromAny(r)),r||r?r?e=e?e.to(r.units()):r:r=e:r=e=Hu.zero(),i.v0=e.value(),i.dv=r.value()-i.v0,i.units=r.units(),i}return _(e,t),e.prototype.interpolate=function(t){return Hu.from(this.v0+this.dv*t,this.units)},e.prototype.deinterpolate=function(t){var e=Hu.fromAny(t).toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,r){return void 0===t?[Hu.from(this.v0,this.units),Hu.from(this.v0+this.dv,this.units)]:void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Ta);Ta.Length=Ba;var Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,Ta.color(t[0],t[1])):Ta.color(t,e)},e.color=function(t,r){return void 0===t&&void 0===r?new e.Identity:(void 0!==t&&(t=ta.fromAny(t)),void 0!==r&&(r=ta.fromAny(r)),t||r?r?t||(t=r):r=t:r=t=ta.transparent(),t instanceof ra&&r instanceof ra?e.hsl(t,r):e.rgb(t.rgb(),r.rgb()))},e.rgb=function(t,r){return new e.Rgb(t,r)},e.hsl=function(t,r){return new e.Hsl(t,r)},e}(Ta);Ta.Color=Ka,Ta.color=Ka.color;var Ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.interpolate=function(t){return ta.transparent()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(Ka);Ka.Identity=Ha;var Ga=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=ta.rgb(e)),void 0!==r&&(r=ta.rgb(r)),e||r?r?e||(e=r):r=e:r=e=ea.transparent(),i.r0=e.r,i.dr=r.r-i.r0,i.g0=e.g,i.dg=r.g-i.g0,i.b0=e.b,i.db=r.b-i.b0,i.a0=e.a,i.da=r.a-i.a0,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.r0+this.dr*t,r=this.g0+this.dg*t,i=this.b0+this.db*t,n=this.a0+this.da*t;return new ea(e,r,i,n)},e.prototype.deinterpolate=function(t){var e=(t=ta.rgb(t)).r-this.r0,r=t.g-this.g0,i=t.b-this.b0,n=t.a-this.a0,o=e*this.dr+r*this.dg+i*this.db+n*this.da,s=Math.sqrt(e*e+r*r+i*i+n*n);return s?o/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.r0===t.r0&&this.dr===t.dr&&this.g0===t.g0&&this.dg===t.dg&&this.b0===t.b0&&this.db===t.db&&this.a0===t.a0&&this.da===t.da)},e}(Ka);Ka.Rgb=Ga;var Xa=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=ta.hsl(e)),void 0!==r&&(r=ta.hsl(r)),e||r?r?e||(e=r):r=e:r=e=ra.transparent(),i.h0=e.h,i.dh=r.h-i.h0,i.s0=e.s,i.ds=r.s-i.s0,i.l0=e.l,i.dl=r.l-i.l0,i.a0=e.a,i.da=r.a-i.a0,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.h0+this.dh*t,r=this.s0+this.ds*t,i=this.l0+this.dl*t,n=this.a0+this.da*t;return new ra(e,r,i,n)},e.prototype.deinterpolate=function(t){var e=(t=ta.hsl(t)).h-this.h0,r=t.s-this.s0,i=t.l-this.l0,n=t.a-this.a0,o=e*this.dh+r*this.ds+i*this.dl+n*this.da,s=Math.sqrt(e*e+r*r+i*i+n*n);return s?o/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.h0===t.h0&&this.dh===t.dh&&this.s0===t.s0&&this.ds===t.ds&&this.l0===t.l0&&this.dl===t.dl&&this.a0===t.a0&&this.da===t.da)},e}(Ka);Ka.Hsl=Xa;var Ya=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,Ta.transform(t[0],t[1])):Ta.transform(t,e)},e.transform=function(t,r){return void 0===t&&void 0===r?new e.Identity:(void 0!==t&&(t=_a.fromAny(t)),void 0!==r&&(r=_a.fromAny(r)),t||r?r?t||(t=r):r=t:r=t=_a.identity(),t instanceof wa&&r instanceof wa?new e.Translate(t,r):t instanceof ga&&r instanceof ga?new e.Scale(t,r):t instanceof ba&&r instanceof ba?new e.Rotate(t,r):t instanceof xa&&r instanceof xa?new e.Skew(t,r):t instanceof Sa&&r instanceof Sa&&t.conformsTo(r)?new e.List(t,r):new e.Affine(t.toAffine(),r.toAffine()))},e}(Ta);Ta.Transform=Ya,Ta.transform=Ya.transform;var Za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.interpolate=function(t){return _a.identity()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(Ya);Ya.Identity=Za;var Qa=function(t){function e(e,r){var i,n,o,s,u=t.call(this)||this;return void 0!==e?(i=(e=wa.fromAny(e)).x,n=e.y):(i=void 0,n=void 0),void 0!==r?(o=(r=wa.fromAny(r)).x,s=r.y):(o=void 0,s=void 0),i||o?o?i=i?i.to(o.units()):o:o=i:o=i=Hu.zero(),n||s?s?n=n?n.to(s.units()):s:s=n:s=n=Hu.zero(),u.x0=i.value(),u.dx=o.value()-u.x0,u.xUnits=o.units(),u.y0=n.value(),u.dy=s.value()-u.y0,u.yUnits=s.units(),u}return _(e,t),e.prototype.interpolate=function(t){var e=Hu.from(this.x0+this.dx*t,this.xUnits),r=Hu.from(this.y0+this.dy*t,this.yUnits);return new wa(e,r)},e.prototype.deinterpolate=function(t){if((t=_a.fromAny(t))instanceof wa){var e=t.x.units(),r=Hu.fromAny(this.x0,this.xUnits).toValue(e),i=Hu.fromAny(this.y0,this.yUnits).toValue(e),n=Hu.fromAny(this.dx,this.xUnits).toValue(e),o=Hu.fromAny(this.dy,this.yUnits).toValue(e),s=t.x.toValue(e)-r,u=t.y.toValue(e)-i,a=s*n+u*o,h=Math.sqrt(s*s+u*u);return h?a/h:h}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(Ya);Ya.Translate=Qa;var $a=function(t){function e(e,r){var i,n,o,s,u=t.call(this)||this;return void 0!==e?(i=(e=ga.fromAny(e)).x,n=e.y):(i=void 0,n=void 0),void 0!==r?(o=(r=ga.fromAny(r)).x,s=r.y):(o=void 0,s=void 0),void 0!==i||o?void 0===o?o=i:void 0===i&&(i=o):o=i=1,void 0===n&&void 0===s?s=n=1:void 0===s?s=n:void 0===n&&(n=s),u.x0=i,u.dx=o-u.x0,u.y0=n,u.dy=s-u.y0,u}return _(e,t),e.prototype.interpolate=function(t){var e=this.x0+this.dx*t,r=this.y0+this.dy*t;return new ga(e,r)},e.prototype.deinterpolate=function(t){if((t=_a.fromAny(t))instanceof ga){var e=t.x-this.x0,r=t.y-this.y0,i=e*this.dx+r*this.dy,n=Math.sqrt(e*e+r*r);return n?i/n:n}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.y0===t.y0&&this.dy===t.dy)},e}(Ya);Ya.Scale=$a;var Ja=function(t){function e(e,r){var i,n,o=t.call(this)||this;return i=void 0!==e?(e=ba.fromAny(e)).angle:void 0,n=void 0!==r?(r=ba.fromAny(r)).angle:void 0,i||n?n?i=i?i.to(n.units()):n:n=i:n=i=Nu.zero(),o.v0=i.value(),o.dv=n.value()-o.v0,o.units=n.units(),o}return _(e,t),e.prototype.interpolate=function(t){var e=Nu.from(this.v0+this.dv*t,this.units);return new ba(e)},e.prototype.deinterpolate=function(t){if((t=_a.fromAny(t))instanceof ba){var e=t.angle.toValue(this.units);return this.dv?(e-this.v0)/this.dv:this.dv}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Ya);Ya.Rotate=Ja;var th=function(t){function e(e,r){var i,n,o,s,u=t.call(this)||this;return void 0!==e?(i=(e=xa.fromAny(e)).x,n=e.y):(i=void 0,n=void 0),void 0!==r?(o=(r=xa.fromAny(r)).x,s=r.y):(o=void 0,s=void 0),i||o?o?i=i?i.to(o.units()):o:o=i:o=i=Nu.zero(),n||s?s?n=n?n.to(s.units()):s:s=n:s=n=Nu.zero(),u.x0=i.value(),u.dx=o.value()-u.x0,u.xUnits=o.units(),u.y0=n.value(),u.dy=s.value()-u.y0,u.yUnits=s.units(),u}return _(e,t),e.prototype.interpolate=function(t){var e=Nu.from(this.x0+this.dx*t,this.xUnits),r=Nu.from(this.y0+this.dy*t,this.yUnits);return new xa(e,r)},e.prototype.deinterpolate=function(t){if((t=_a.fromAny(t))instanceof xa){var e=t.x.units(),r=Nu.fromAny(this.x0,this.xUnits).toValue(e),i=Nu.fromAny(this.y0,this.yUnits).toValue(e),n=Nu.fromAny(this.dx,this.xUnits).toValue(e),o=Nu.fromAny(this.dy,this.yUnits).toValue(e),s=t.x.toValue(e)-r,u=t.y.toValue(e)-i,a=s*n+u*o,h=Math.sqrt(s*s+u*u);return h?a/h:h}return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(Ya);Ya.Skew=th;var eh=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=Ca.fromAny(e)),void 0!==r&&(r=Ca.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=new Ca,i.f0=e,i.f1=r,i}return _(e,t),e.prototype.interpolate=function(t){return this.f1},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.f0.equals(t.f0)&&this.f1.equals(t.f1))},e}(Ya);Ya.Affine=eh;var rh=function(t){function e(e,r){var i=t.call(this)||this;void 0!==e&&(e=Sa.fromAny(e)),void 0!==r&&(r=Sa.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=new Sa([]),i.interpolators=[];for(var n=Math.min(e.transforms.length,r.transforms.length),o=0;o<n;o+=1)i.interpolators.push(Ta.transform(e.transforms[o],r.transforms[o]));return i}return _(e,t),e.prototype.interpolate=function(t){for(var e=[],r=0;r<this.interpolators.length;r+=1)e.push(this.interpolators[r].interpolate(t));return new Sa(e)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var r=this.interpolators.length;if(r===t.interpolators.length){for(var i=0;i<r;i+=1)if(!this.interpolators[i].equals(t.interpolators[i]))return!1;return!0}}return!1},e}(Ya);Ya.List=rh;var ih=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,Ta.structure(t[0],t[1])):Ta.structure(t,e)},e.structure=function(t,r){if(void 0===t&&void 0===r)return new e.Absent;if(void 0!==t&&(t=$t.fromAny(t)),void 0!==r&&(r=$t.fromAny(r)),t||r?r?t||(t=r):r=t:r=t=$t.absent(),t instanceof Jt&&r instanceof Jt)return t instanceof ie&&r instanceof ie||t instanceof ie&&r.key instanceof Text||r instanceof ie&&t.key instanceof Text?new e.Attr(t,r):new e.Slot(t,r);var i=t.toValue(),n=r.toValue();return i instanceof ae&&n instanceof ae?new e.Record(i,n):i instanceof ye&&n instanceof ye?new e.Num(i,n):i instanceof Ae&&n instanceof Ae?new e.BinaryOperator(i,n):i instanceof ke&&n instanceof ke?new e.UnaryOperator(i,n):i instanceof Xe&&n instanceof Xe?new e.InvokeOperator(i,n):new e.Value(i,n)},e}(Ta);Ta.Structure=ih,Ta.structure=ih.structure;var nh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;if(r?e||(e=r):r=e,!(e.key instanceof de))throw new TypeError(""+e.key);if(!(r.key instanceof de))throw new TypeError(""+r.key);return e.commit(),r.commit(),i.keyInterpolator=Ta.structure(e.key,r.key),i.valueInterpolator=Ta.structure(e.value,r.value),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.keyInterpolator.interpolate(t),r=this.valueInterpolator.interpolate(t);return ie.of(e,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(ih);ih.Attr=nh;var oh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;return r?e||(e=r):r=e,e.commit(),r.commit(),i.keyInterpolator=Ta.structure(e.key,r.key),i.valueInterpolator=Ta.structure(e.value,r.value),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.keyInterpolator.interpolate(t),r=this.valueInterpolator.interpolate(t);return ne.of(e,r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(ih);ih.Slot=oh;var sh=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=se.fromAny(e)),void 0!==r&&(r=se.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=se.absent(),i.v0=e.commit(),i.v1=r.commit(),i}return _(e,t),e.prototype.interpolate=function(t){return t<1?this.v0:this.v1},e.prototype.deinterpolate=function(t){return(t=$t.fromAny(t)).equals(this.v1)?1:0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0.equals(t.v0)&&this.v1.equals(t.v1))},e}(ih);ih.Value=sh;var uh=function(t){function e(e,r){var i=t.call(this)||this;void 0!==e&&(e=ae.fromAny(e)),void 0!==r&&(r=ae.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=ae.empty(),e.commit(),r.commit(),i.interpolators=[];for(var n=Math.min(e.length,r.length),o=0;o<n;o+=1)i.interpolators.push(Ta.structure(e.getItem(o),r.getItem(o)));return i}return _(e,t),e.prototype.interpolate=function(t){for(var e=this.interpolators.length,r=ae.create(e),i=0;i<e;i+=1)r.push(this.interpolators[i].interpolate(t));return r},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var r=this.interpolators.length;if(r===t.interpolators.length){for(var i=0;i<r;i+=1)if(!this.interpolators[i].equals(t.interpolators[i]))return!1;return!0}}return!1},e}(ih);ih.Record=uh;var ah=function(t){function e(e,r){var i=t.call(this)||this;return void 0===e&&void 0===r?r=e=0:void 0===r?r=e:void 0===e&&(e=r),i.y0=+e,i.dy=+r-i.y0,i}return _(e,t),e.prototype.interpolate=function(t){return ye.from(this.y0+this.dy*t)},e.prototype.deinterpolate=function(t){return(t=$t.fromAny(t))instanceof ye?this.dy?(t.value-this.y0)/this.dy:this.dy:0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(ih);ih.Num=ah;var hh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;return r?e||(e=r):r=e,e.commit(),r.commit(),i.ifTermInterpolator=Ta.structure(e.ifTerm(),r.ifTerm()),i.thenTermInterpolator=Ta.structure(e.thenTerm(),r.thenTerm()),i.elseTermInterpolator=Ta.structure(e.elseTerm(),r.elseTerm()),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.ifTermInterpolator.interpolate(t),r=this.thenTermInterpolator.interpolate(t),i=this.elseTermInterpolator.interpolate(t);return e.conditional(r,i)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.ifTermInterpolator.equals(t.ifTermInterpolator)&&this.thenTermInterpolator.equals(t.thenTermInterpolator)&&this.elseTermInterpolator.equals(t.elseTermInterpolator))},e}(ih);ih.ConditionalOperator=hh;var ph=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;if(r?e||(e=r):r=e,i.operator=e.operator(),i.operator!==r.operator())throw new Error(r.operator());return e.commit(),r.commit(),i.operand1Interpolator=Ta.structure(e.operand1(),r.operand1()),i.operand2Interpolator=Ta.structure(e.operand2(),r.operand2()),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.operand1Interpolator.interpolate(t),r=this.operand2Interpolator.interpolate(t);switch(this.operator){case"||":return e.or(r);case"&&":return e.and(r);case"|":return e.bitwiseOr(r);case"^":return e.bitwiseXor(r);case"&":return e.bitwiseAnd(r);case"<":return e.lt(r);case"<=":return e.le(r);case"==":return e.eq(r);case"!=":return e.ne(r);case">=":return e.ge(r);case">":return e.gt(r);case"+":return e.plus(r);case"-":return e.minus(r);case"*":return e.times(r);case"/":return e.divide(r);case"%":return e.modulo(r);default:throw new Error(this.operator)}},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1Interpolator.equals(t.operand1Interpolator)&&this.operator===t.operator&&this.operand2Interpolator.equals(t.operand2Interpolator))},e}(ih);ih.BinaryOperator=ph;var lh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;if(r?e||(e=r):r=e,i.operator=e.operator(),i.operator!==r.operator())throw new Error(r.operator());return e.commit(),r.commit(),i.operandInterpolator=Ta.structure(e.operand(),r.operand()),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.operandInterpolator.interpolate(t);switch(this.operator){case"!":return e.not();case"~":return e.bitwiseNot();case"-":return e.negative();default:throw new Error(this.operator)}},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operator===t.operator&&this.operandInterpolator.equals(t.operandInterpolator))},e}(ih);ih.UnaryOperator=lh;var ch=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new TypeError;return r?e||(e=r):r=e,e.commit(),r.commit(),i.funcInterpolator=Ta.structure(e.func(),r.func()),i.argsInterpolator=Ta.structure(e.args(),r.args()),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.funcInterpolator.interpolate(t),r=this.argsInterpolator.interpolate(t);return we.literal(e).invoke(r)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.funcInterpolator.equals(t.funcInterpolator)&&this.argsInterpolator.equals(t.argsInterpolator))},e}(ih);ih.InvokeOperator=ch;var fh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.interpolate=function(t){return $t.absent()},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e},e}(ih);ih.Absent=fh;var dh=function(t){function e(e,r){var i=t.call(this)||this;e||r?r?e||(e=r):r=e:r=e=[],i.interpolators=[];for(var n=Math.min(e.length,r.length),o=0;o<n;o+=1)i.interpolators.push(Ta.from(e[o],r[o]));return i}return _(e,t),e.prototype.interpolate=function(t){for(var e=this.interpolators.length,r=new Array(e),i=0;i<this.interpolators.length;i+=1)r[i]=this.interpolators[i].interpolate(t);return r},e.prototype.deinterpolate=function(t){return 0},e.prototype.range=function(t,r){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var r=this.interpolators.length;if(r===t.interpolators.length){for(var i=0;i<r;i+=1)if(!this.interpolators[i].equals(t.interpolators[i]))return!1;return!0}}return!1},e}(Ta);Ta.Array=dh;var yh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new Error;return r?e||(e=r):r=e,i.i0=e,i.i1=r,i.i00=i.i1.range(i.i0.interpolate(0),i.i1.interpolate(0)),i.i11=i.i1.range(i.i0.interpolate(1),i.i1.interpolate(1)),i}return _(e,t),e.prototype.interpolate=function(t){return 0===t?this.i0:1===t?this.i1:this.i1.range(this.i00.interpolate(t),this.i11.interpolate(t))},e.prototype.deinterpolate=function(t){return 0},e.prototype.range=function(t,r){return void 0===t?[this.i0,this.i1]:void 0===r?(t=t,new e(Ta.fromAny(t[0]),Ta.fromAny(t[1]))):(t=t,new e(Ta.fromAny(t),Ta.fromAny(r)))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.i0.equals(t.i0)&&this.i1.equals(t.i1))},e}(Ta);Ta.Interpolator=yh;var vh=function(t){function e(e,r){var i=t.call(this)||this;return i._interpolator=e,i._transform=r,i}return _(e,t),e.prototype.interpolate=function(t){return this._transform(this._interpolator.interpolate(t))},e.prototype.deinterpolate=function(t){return 0},e.prototype.range=function(t,e){if(void 0===t){var r=this._interpolator.range();return[this._transform(r[0]),this._transform(r[1])]}return this},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._interpolator.equals(t._interpolator)&&this._transform===t._transform)},e}(Ta);Ta.Map=vh;var _h=function(t){function e(e,r){var i=t.call(this)||this;return i._valueForm=e,i._unit=r,i}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(this._valueForm,t)},e.prototype.mold=function(t){if(void 0!==t){t=Ta.fromAny(t);var e=this._valueForm.mold(t.interpolate(0)),r=this._valueForm.mold(t.interpolate(1));if(e.isDefined()&&r.isDefined())return ae.of(ie.of("interpolate",ae.of(e,r)))}return $t.extant()},e.prototype.cast=function(t){var e=t.toValue().header("interpolate");if(e.length>=2){var r=this._valueForm.cast(e.getItem(0).toValue()),i=this._valueForm.cast(e.getItem(1).toValue());if(void 0!==r&&void 0!==i)return Ta.from(r,i)}},e}(Se);Ta.Form=_h;var mh=function(){function t(){}return t.linear=function(e,r,i,n){return Array.isArray(e)?Array.isArray(r)?(r=r,new t.Linear(e[0],e[1],Ta.from(r[0],r[1]))):(r=r,new t.Linear(e[0],e[1],Ta.fromAny(r))):(e=e,r=r,void 0===n?(i=i,new t.Linear(e,r,Ta.fromAny(i))):(i=i,n=n,new t.Linear(e,r,Ta.from(i,n))))},t.time=function(e,r,i,n){return Array.isArray(e)?Array.isArray(r)?(r=r,new t.Time(e[0],e[1],Ta.from(r[0],r[1]))):new t.Time(e[0],e[1],Ta.fromAny(r)):(e=e,r=r,void 0===n?(i=i,new t.Time(e,r,Ta.fromAny(i))):(i=i,n=n,new t.Time(e,r,Ta.from(i,n))))},t.from=function(e,r,i,n){if("time"===e){n=i,i=r;var o=lo.current();r=o,e=o.time(o.time()-864e5)}else"linear"===e&&(n=i,i=r,r=1,e=0);if(e instanceof lo||e instanceof Date||r instanceof lo||r instanceof Date)return void 0===n?(i=i,new t.Time(e,r,Ta.fromAny(i))):new t.Time(e,r,Ta.from(i,n));if("number"==typeof e&&"number"==typeof r)return void 0===n?(i=i,new t.Linear(e,r,Ta.fromAny(i))):new t.Linear(e,r,Ta.from(i,n));throw new TypeError(""+arguments)},t.form=function(e,r,i){return void 0===e&&(e=t.domainForm()),void 0===r&&(r=t.interpolatorForm()),e!==t.domainForm()||r!==t.interpolatorForm()||void 0!==i?new t.Form(e,r,i):(t._form||(t._form=new t.Form(e,r)),t._form)},t.domainForm=function(){throw new Error},t.interpolatorForm=function(){throw new Error},t}(),wh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(mh);mh.Continuous=wh;var gh=function(t){function e(e,r,i){var n=t.call(this)||this;return n.x0=e,n.dx=r-n.x0,n.fx=i,n}return _(e,t),e.prototype.norm=function(t){return this.dx?(t-this.x0)/this.dx:this.dx},e.prototype.scale=function(t){var e=this.norm(t);return this.fx.interpolate(e)},e.prototype.unscale=function(t){var e=this.fx.deinterpolate(t);return this.x0+this.dx*e},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.fx.interpolate(e)},e.prototype.domain=function(t,r){if(void 0===t)return[this.x0,this.x0+this.dx];void 0===r&&(r=t[1],t=t[0]);var i=r-t;return t===this.x0&&i===this.dx?this:new e(t,r,this.fx)},e.prototype.range=function(t,r){return void 0===t?this.fx.range():void 0===r?(t=t,new e(this.x0,this.x0+this.dx,this.fx.range(t))):(t=t,new e(this.x0,this.x0+this.dx,this.fx.range(t,r)))},e.prototype.interpolator=function(t){return void 0===t?this.fx:(t=Ta.fromAny(t),new e(this.x0,this.x0+this.dx,t))},e.prototype.clampDomain=function(t,r,i,n,o){var s=this.x0,u=this.x0+this.dx;void 0!==t&&(s<u&&s<t?s=t:u<s&&u<t&&(u=t)),void 0!==r&&(s<u&&u>r||u<s&&s>r)&&(u=r);var a=+this.scale(s),h=+this.scale(u)-a,p=Math.abs(h/(u-s));if(void 0!==i&&p<1/i){var l=h*i;s=((c=s+u)-l)/2,u=(c+l)/2}else if(void 0!==n&&p>1/n){var c,f=h*n;s=((c=s+u)-f)/2,u=(c+f)/2}var d=u-s;return void 0===o&&(o=1e-12),Math.abs(s-this.x0)<o&&Math.abs(d-this.dx)<o?this:new e(s,u,this.fx)},e.prototype.solveDomain=function(t,r,i,n,o){var s,u=this.fx.range(),a=+u[0],h=+u[1],p=+r-(s=void 0===i||void 0===n||t===i||r===n?(h-a)/(this.dx||1):(+n-+r)/(i-t))*t,l=(a-p)/s,c=(h-p)/s,f=c-l;return void 0===o&&(o=1e-12),Math.abs(l-this.x0)<o&&Math.abs(f-this.dx)<o?this:new e(l,c,this.fx)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.fx.equals(t.fx))},e}(wh);mh.Linear=gh;var bh=function(t){function e(e,r,i,n){var o=t.call(this)||this;return e=lo.fromAny(e),r=lo.fromAny(r),o.t0=e.time(),o.dt=r.time()-o.t0,o.zone=n||e.zone(),o.ft=i,o}return _(e,t),e.prototype.norm=function(t){return t=lo.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.scale=function(t){var e=this.norm(t);return this.ft.interpolate(e)},e.prototype.unscale=function(t){var e=this.ft.deinterpolate(t);return new lo(this.t0+this.dt*e)},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.ft.interpolate(e)},e.prototype.domain=function(t,r){if(void 0===t)return[new lo(this.t0,this.zone),new lo(this.t0+this.dt,this.zone)];void 0===r&&(r=t[1],t=t[0]),t=lo.time(t);var i=(r=lo.time(r))-t;return t===this.t0&&i===this.dt?this:new e(t,r,this.ft,this.zone)},e.prototype.range=function(t,r){return void 0===t?this.ft.range():void 0===r?(t=t,new e(this.t0,this.t0+this.dt,this.ft.range(t),this.zone)):(t=t,new e(this.t0,this.t0+this.dt,this.ft.range(t,r),this.zone))},e.prototype.interpolator=function(t){return void 0===t?this.ft:(t=Ta.fromAny(t),new e(this.t0,this.t0+this.dt,t,this.zone))},e.prototype.clampDomain=function(t,r,i,n,o){var s=this.t0,u=this.t0+this.dt;void 0!==t&&(t=lo.time(t),s<u&&s<t?s=t:u<s&&u<t&&(u=t)),void 0!==r&&(r=lo.time(r),(s<u&&u>r||u<s&&s>r)&&(u=r));var a=+this.scale(s),h=+this.scale(u)-a,p=Math.abs(h/(u-s));if(void 0!==i&&p<1/i){var l=h*i;s=((c=s+u)-l)/2,u=(c+l)/2}else if(void 0!==n&&p>1/n){var c,f=h*n;s=((c=s+u)-f)/2,u=(c+f)/2}var d=u-s;return void 0===o&&(o=1e-12),Math.abs(s-this.t0)<o&&Math.abs(d-this.dt)<o?this:new e(s,u,this.ft,this.zone)},e.prototype.solveDomain=function(t,r,i,n,o){t=lo.time(t),i=void 0!==i?lo.time(i):i;var s,u=this.ft.range(),a=+u[0],h=+u[1],p=+r-(s=void 0===i||void 0===n||t===i||r===n?(h-a)/(this.dt||1):(+n-+r)/(i-t))*t,l=(a-p)/s,c=(h-p)/s,f=c-l;return void 0===o&&(o=1e-12),Math.abs(l-this.t0)<o&&Math.abs(f-this.dt)<o?this:new e(l,c,this.ft,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt&&this.ft.equals(t.ft))},e}(wh);mh.Time=bh;var xh=function(t){function e(e,r,i){var n=t.call(this)||this;return n._domainForm=e,n._interpolatorForm=r,n._unit=i,n}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(this._domainForm,this._interpolatorForm,t)},e.prototype.mold=function(t){if(t instanceof wh){var e=t.domain(),r=this._domainForm.mold(e[0]),i=this._domainForm.mold(e[1]),n=ae.of(r,i),o=ae.of(ie.of("scale",n)),s=this._interpolatorForm.mold(t.interpolator());return s.isDefined()&&(o=o.concat(s)),o}return $t.extant()},e.prototype.cast=function(t){var e=t.toValue(),r=e.header("scale");if(r.length>=2){var i,n;r.forEach((function(t,e){t instanceof se&&(0===e?i=t.cast(this._domainForm,i):1===e&&(n=t.cast(this._domainForm,n)))}),this);var o=this._interpolatorForm.cast(e.body());if(void 0!==i&&void 0!==n&&o)return mh.from(i,n,o)}},e}(Se);mh.Form=xh;var Ch=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.range=function(t,e){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===e?(t=t,Ta.scale(t[0],t[1])):(t=t,Ta.scale(t,e))},e.scale=function(t,r){if(!t&&!r)throw new Error;if(r?t||(t=r):r=t,t instanceof gh&&r instanceof gh)return new e.Linear(t,r);if(t instanceof bh&&r instanceof bh)return new e.Time(t,r);throw new TypeError(t+", "+r)},e}(Ta);Ta.scale=Ch.scale;var Sh=Ta.from;Ta.from=function(t,e){return t instanceof wh||e instanceof wh?Ta.scale(t,e):Sh(t,e)};var Ah=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new Error;return r?e||(e=r):r=e,i.x0=new Ia(e.x0,r.x0),i.dx=new Ia(e.dx,r.dx),i.fx=new yh(e.fx,r.fx),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.x0.interpolate(t),r=this.dx.interpolate(t),i=this.fx.interpolate(t);return new gh(e,e+r,i)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0.equals(t.x0)&&this.dx.equals(t.dx)&&this.fx.equals(t.fx))},e}(Ch);Ch.Linear=Ah;var kh=function(t){function e(e,r){var i=t.call(this)||this;if(!e&&!r)throw new Error;return r?e||(e=r):r=e,i.t0=new Ia(e.t0,r.t0),i.dt=new Ia(e.dt,r.dt),i.ft=new yh(e.ft,r.ft),i}return _(e,t),e.prototype.interpolate=function(t){var e=this.t0.interpolate(t),r=this.dt.interpolate(t),i=this.ft.interpolate(t);return new bh(e,e+r,i)},e.prototype.deinterpolate=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0.equals(t.t0)&&this.dt.equals(t.dt)&&this.ft.equals(t.ft))},e}(Ch);function Eh(t){return t}function Oh(t){return t*t}function Vh(t){return t*(2-t)}function Ph(t){return(t*=2)<=1?t*=t:(t-=1,t*=2-t,t+=1),t/=2}function Dh(t){return t*t*t}function Mh(t){return t-=1,t*=t*t,t+=1}function Th(t){return(t*=2)<=1?t*=t*t:(t-=2,t*=t*t,t+=2),t/=2}function Rh(t){return t*t*t*t}function Ih(t){return 1-(t-=1)*t*t*t}function Fh(t){var e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e}function Lh(t){return 0===t?0:Math.pow(2,10*(t-1))}function Uh(t){return 1===t?1:1-Math.pow(2,-10*t)}function Nh(t){return 1===t||0===t?t:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}function zh(t){return-1*(Math.sqrt(1-t/1*t)-1)}function jh(t){return t-=1,Math.sqrt(1-t*t)}function Wh(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);var e=t-2;return.5*(Math.sqrt(1-e*e)+1)}function qh(t){var e=1.70158;return t*t*((e+1)*t-e)}function Bh(t){var e=t/1-1;return e*e*6.2985344964+1}function Kh(t){var e=2.5949095;if((t*=2)<1)return.5*t*t*((e+1)*t-e);var r=t-2;return.5*(r*r*((e+1)*r+e)+2)}function Hh(t){if(0===t||1===t)return t;var e=t/1-1,r=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*e)*Math.sin(2*(e-r)*Math.PI/(1-.7))}function Gh(t){if(0===t||1===t)return t;var e=(1-.7)/(2*Math.PI)*Math.asin(1);return t*=2,Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/(1-.7))+1}function Xh(t){if(0===t||1===t)return t;var e=.35/(2*Math.PI)*Math.asin(1),r=2*t,i=r-1;return r<1?Math.pow(2,10*i)*Math.sin(2*(i-e)*Math.PI/.35)*-.5:Math.pow(2,-10*i)*Math.sin(2*(i-e)*Math.PI/.35)*.5+1}function Yh(t){var e=7.5625;return(t=1-t)<1/2.75?1-e*t*t:t<2/2.75?1-(e*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(e*(t-=2.25/2.75)*t+.9375):1-(e*(t-=2.625/2.75)*t+.984375)}function Zh(t){var e=7.5625;return t<1/2.75?e*t*t:t<2/2.75?e*(t-=1.5/2.75)*t+.75:t<2.5/2.75?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375}function Qh(t){var e=t<.5,r=7.5625;return(t=e?1-2*t:2*t-1)<1/2.75?t*=r*t:t=t<2/2.75?r*(t-=1.5/2.75)*t+.75:t<2.5/2.75?r*(t-=2.25/2.75)*t+.9375:r*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}Ch.Time=kh,Eh.type="linear",Oh.type="quad-in",Vh.type="quad-out",Ph.type="quad-in-out",Dh.type="cubic-in",Mh.type="cubic-out",Th.type="cubic-in-out",Rh.type="quart-in",Ih.type="quart-out",Fh.type="quart-in-out",Lh.type="expo-in",Uh.type="expo-out",Nh.type="expo-in-out",zh.type="circ-in",jh.type="circ-out",Wh.type="circ-in-out",qh.type="back-in",Bh.type="back-out",Kh.type="back-in-out",Hh.type="elastic-in",Gh.type="elastic-out",Xh.type="elastic-in-out",Yh.type="bounce-in",Zh.type="bounce-out",Qh.type="bounce-in-out";var $h={linear:Eh,quadIn:Oh,quadOut:Vh,quadInOut:Ph,cubicIn:Dh,cubicOut:Mh,cubicInOut:Th,quartIn:Rh,quartOut:Ih,quartInOut:Fh,expoIn:Lh,expoOut:Uh,expoInOut:Nh,circIn:zh,circOut:jh,circInOut:Wh,backIn:qh,backOut:Bh,backInOut:Kh,elasticIn:Hh,elasticOut:Gh,elasticInOut:Xh,bounceIn:Yh,bounceOut:Zh,bounceInOut:Qh,fromAny:function(t){if("function"==typeof t)return t;if("string"==typeof t)switch(t){case"linear":return $h.linear;case"quad-in":return $h.quadIn;case"quad-out":return $h.quadOut;case"quad-in-out":return $h.quadInOut;case"cubic-in":return $h.cubicIn;case"cubic-out":return $h.cubicOut;case"cubic-in-out":return $h.cubicInOut;case"quart-in":return $h.quartIn;case"quart-out":return $h.quartOut;case"quart-in-out":return $h.quartInOut;case"expo-in":return $h.expoIn;case"expo-out":return $h.expoOut;case"expo-in-out":return $h.expoInOut;case"circ-in":return $h.circIn;case"circ-out":return $h.circOut;case"circ-in-out":return $h.circInOut;case"back-in":return $h.backIn;case"back-out":return $h.backOut;case"back-in-out":return $h.backInOut;case"elastic-in":return $h.elasticIn;case"elastic-out":return $h.elasticOut;case"elastic-in-out":return $h.elasticInOut;case"bounce-in":return $h.bounceIn;case"bounce-out":return $h.bounceOut;case"bounce-in-out":return $h.bounceInOut}throw new Error(t)},_form:void 0,form:function(t){return void 0!==t&&(t=$h.fromAny(t)),t!==$h.linear?new $h.Form(t):($h._form||($h._form=new $h.Form($h.linear)),$h._form)},Form:void 0},Jh=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){return"string"==typeof(t=$h.fromAny(t)).type?de.from(t.type):$t.extant()},e.prototype.cast=function(t){var e=t.toValue().stringValue(void 0);if(void 0!==e)try{return $h.fromAny(e)}catch(t){}},e}(Se);$h.Form=Jh;var tp=function(){function t(t,e,r,i,n,o){this._duration=t,this._ease=e,this._interpolator=r,this._onStart=i,this._onEnd=n,this._onInterrupt=o}return t.prototype.duration=function(e){return void 0===e?this._duration:new t(e,this._ease,this._interpolator,this._onStart,this._onEnd,this._onInterrupt)},t.prototype.ease=function(e){return void 0===e?this._ease:(e=null!==e?$h.fromAny(e):null,new t(this._duration,e,this._interpolator,this._onStart,this._onEnd,this._onInterrupt))},t.prototype.interpolator=function(e){return void 0===e?this._interpolator:(e=null!==e?Ta.fromAny(e):null,new t(this._duration,this._ease,e,this._onStart,this._onEnd,this._onInterrupt))},t.prototype.range=function(e,r){if(void 0===e)return this._interpolator?this._interpolator.range():null;var i=void 0;return i=this._interpolator?this._interpolator.range(e,r):Ta.from(e,r),new t(this._duration,this._ease,i,this._onStart,this._onEnd,this._onInterrupt)},t.prototype.onStart=function(e){return void 0===e?this._onStart:new t(this._duration,this._ease,this._interpolator,e,this._onEnd,this._onInterrupt)},t.prototype.onEnd=function(e){return void 0===e?this._onEnd:new t(this._duration,this._ease,this._interpolator,this._onStart,e,this._onInterrupt)},t.prototype.onInterrupt=function(e){return void 0===e?this._onInterrupt:new t(this._duration,this._ease,this._interpolator,this._onStart,this._onEnd,e)},t.prototype.toAny=function(){var t={};return null!==this._duration&&(t.duration=this._duration),null!==this._ease&&(t.ease=this._ease),null!==this._interpolator&&(t.interpolator=this._interpolator),null!==this._onStart&&(t.onStart=this._onStart),null!==this._onEnd&&(t.onEnd=this._onEnd),null!==this._onInterrupt&&(t.onInterrupt=this._onInterrupt),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._duration===e._duration&&this._ease===e._ease&&f.equal(this._interpolator,e._interpolator))},t.duration=function(e,r,i){return void 0===r&&(r=null),void 0===i&&(i=null),new t(e,r=null!==r?$h.fromAny(r):null,i=null!==i?Ta.fromAny(i):null,null,null,null)},t.ease=function(e,r){return void 0===r&&(r=null),new t(null,e=$h.fromAny(e),r=null!==r?Ta.fromAny(r):null,null,null,null)},t.interpolator=function(e){return new t(null,null,e=Ta.fromAny(e),null,null,null)},t.range=function(e,r){var i;return void 0===r&&Array.isArray(e)?(e=e,i=Ta.from(e[0],e[1])):i=Ta.from(e,r),new t(null,null,i,null,null,null)},t.from=function(e,r,i,n,o,s){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=null),new t(e,r=null!==r?$h.fromAny(r):null,i=null!==i?Ta.fromAny(i):null,n,o,s)},t.fromAny=function(e,r,i,n){return void 0===i&&(i=null),void 0===n&&(n=null),e instanceof t?e:"object"==typeof e&&e?t.from(e.duration,e.ease,e.interpolator,e.onStart,e.onEnd,e.onInterrupt):!0===e?t.from(i,n,Ta.from(r)):void 0},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.duration||void 0!==e.ease||void 0!==e.interpolator}return!1},t.form=function(e,r){return void 0===e&&(e=t.interpolatorForm()),e!==t.interpolatorForm()||void 0!==r?(r=void 0!==r?t.fromAny(r):r,new t.Form(e,r)):(t._form||(t._form=new t.Form(e)),t._form)},t.interpolatorForm=function(){throw new Error},t}(),ep=function(t){function e(e,r){var i=t.call(this)||this;return i._interpolatorForm=e,i._unit=r,i}return _(e,t),e.prototype.unit=function(t){return void 0===t?this._unit:(t=tp.fromAny(t),new e(this._interpolatorForm,t))},e.prototype.mold=function(t){if(void 0!==t){t=tp.fromAny(t);var e=ae.create();null!==t._duration&&e.slot("duration",t._duration),null!==t._ease&&e.slot("ease",$h.form().mold(t._ease));var r=ae.of(ie.of("transition",e));if(null!==t._interpolator){var i=this._interpolatorForm.mold(t._interpolator);i.isDefined()&&(r=r.concat(i))}return r}return $t.extant()},e.prototype.cast=function(t){var e=t.toValue(),r=e.header("transition");if(r.length>=2){var i=null,n=null;r.forEach((function(t,e){var r=t.key.stringValue(void 0);void 0!==r?"duration"===r?i=t.toValue().numberValue(i):"ease"===r&&(n=t.toValue().cast($h.form(),n)):t instanceof se&&(0===e?i=t.numberValue(i):1===e&&(n=t.cast($h.form(),n)))}),this);var o=this._interpolatorForm.cast(e.body());return tp.from(i,n,o)}},e}(Se);tp.Form=ep;var rp,ip=function(){},np=function(t){function e(){var e=t.call(this)||this;return e._animationFrame=0,e._disabled=!1,e}return _(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._disabled},enumerable:!0,configurable:!0}),e.prototype.setEnabled=function(t){t&&this._disabled?(this._disabled=!1,this.didSetEnabled(!1)):t||this._disabled||(this._disabled=!0,this.didSetEnabled(!0))},e.prototype.didSetEnabled=function(t){t?this.animate():this.cancel()},e.prototype.animate=function(t){this._animationFrame||this._disabled||(this.hasOwnProperty("onAnimationFrame")||(this.onAnimationFrame=this.onAnimationFrame.bind(this)),this._animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=0)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.onFrame(t)},e}(ip),op=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.animate=function(t){void 0===t&&(t=this);var e=this.parent;e&&e.animate(t)},e}(ip);(rp=t.TweenState||(t.TweenState={}))[rp.Quiesced=0]="Quiesced",rp[rp.Diverged=1]="Diverged",rp[rp.Tracking=2]="Tracking",rp[rp.Converged=3]="Converged",rp[rp.Interrupt=4]="Interrupt";var sp=function(t){function e(e,r){var i=t.call(this)||this;return r?(i._duration=null!==r._duration?r._duration:0,i._ease=null!==r._ease?r._ease:$h.linear,i._interpolator=r._interpolator,i._onStart=r._onStart,i._onEnd=r._onEnd,i._onInterrupt=r._onInterrupt):(i._duration=0,i._ease=$h.linear,i._interpolator=null,i._onStart=null,i._onEnd=null,i._onInterrupt=null),i._interrupt=null,i._value=e,i._state=e,i._startTime=0,i._tweenState=0,i._disabled=!1,i._input=null,i._outputs=null,i._version=-1,i}return _(e,t),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._disabled},enumerable:!0,configurable:!0}),e.prototype.setEnabled=function(t){t&&this._disabled?(this._disabled=!1,this.didSetEnabled(!1)):t||this._disabled||(this._disabled=!0,this.didSetEnabled(!0))},e.prototype.didSetEnabled=function(t){t?this.animate():this.cancel()},e.prototype.duration=function(t){return void 0===t?this._duration:(this._duration=Math.max(0,t),this)},e.prototype.ease=function(t){return void 0===t?this._ease:(this._ease=$h.fromAny(t),this)},e.prototype.interpolator=function(t,e){return void 0===t?this._interpolator:(1===arguments.length?this._interpolator=t:null!==this._interpolator&&null!=t?this._interpolator=this._interpolator.range(t,e):this._interpolator=Ta.from(t,e),this)},e.prototype.transition=function(t){return void 0===t?new tp(this._duration,this._ease,this._interpolator,null,null,null):(null!==(t=tp.fromAny(t))._duration&&(this._duration=t._duration),null!==t._ease&&(this._ease=t._ease),null!==t._interpolator&&(this._interpolator=t._interpolator),this._onStart=t._onStart,this._onEnd=t._onEnd,this._onInterrupt=t._onInterrupt,this)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){var r=this._onInterrupt;if(this._onInterrupt=null,e instanceof tp||"object"==typeof e&&e?this.transition(e):e||(this._duration=0,this._onStart=null,this._onEnd=null,this._onInterrupt=null,this.cancel()),this._interrupt=r,null!=t)0===this._tweenState&&f.equal(this._state,t)||(this.interpolator(this.value,t),this._state=t,this._startTime=0,2===this._tweenState?this._tweenState=4:this._tweenState=1,e?this.animate():this.onFrame(0));else{if(this._state=t,this._startTime=0,2===this._tweenState){this.onInterrupt(this._value);var i=this._interrupt;i&&(this._interrupt=null,i(this._value))}this._tweenState=0,this._value=t,void 0===this._value&&(this._interpolator=null,this.delete())}},e.prototype.onFrame=function(t){if(0!==this._tweenState&&!this._disabled){if(4===this._tweenState){this.onInterrupt(this._value);var e=this._interrupt;e&&(this._interrupt=null,e(this._value)),this._tweenState=1}if(1===this._tweenState)if(f.equal(this._value,this._state))this.tween(1);else{this._startTime=t,this.onStart(this._value);var r=this._onStart;r&&(this._onStart=null,r(this._value)),this._tweenState=2}if(2===this._tweenState){var i=this._duration?Math.min(Math.max(0,(t-this._startTime)/this._duration),1):1;this.tween(i)}if(3===this._tweenState){this._onInterrupt=null,this._startTime=0,this._tweenState=0,this.onEnd(this._value);var n=this._onEnd;n&&(this._onEnd=null,n(this._value))}else this.animate()}},e.prototype.interpolate=function(t){return this._interpolator?this._interpolator.interpolate(t):this._state},e.prototype.tween=function(t){t=this._ease(t);var e=this._value,r=this.interpolate(t);this._value=r,this.update(r,e),1===t&&(this._tweenState=3)},e.prototype.onStart=function(t){},e.prototype.onEnd=function(t){},e.prototype.onInterrupt=function(t){},e.prototype.get=function(){var t=this.state;return null===t&&(t=void 0),t},e.prototype.input=function(){return this._input},e.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},e.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},e.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},e.prototype.outputIterator=function(){return null!==this._outputs?y.array(this._outputs):y.empty()},e.prototype.bindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=new Array(r+1),n=0;n<r;n+=1)i[n]=e[n];i[r]=t,this._outputs=i},e.prototype.unbindOutput=function(t){for(var e=this._outputs,r=null!==e?e.length:0,i=0;i<r;i+=1)if(e[i]===t){if(r>1){for(var n=new Array(r-1),o=0;o<i;o+=1)n[o]=e[o];for(o=i;o<r-1;o+=1)n[o]=e[o+1];this._outputs=n}else this._outputs=null;break}},e.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}}},e.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var e=0,r=t.length;e<r;e+=1){var i=t[e];i.unbindInput(),i.disconnectOutputs()}}}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this._version>=0){this.willDecohere(),this._version=-1,this.onDecohere();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].decohereOutput();this.didDecohere()}},e.prototype.recohereOutput=function(t){this.recohere(t)},e.prototype.recohereInput=function(t){this.recohere(t)},e.prototype.recohere=function(t){if(this._version<0){this.willRecohere(t),this._version=t,null!==this._input&&this._input.recohereInput(t),this.onRecohere(t);for(var e=null!==this._outputs?this._outputs.length:0,r=0;r<e;r+=1)this._outputs[r].recohereOutput(t);this.didRecohere(t)}},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohere=function(t){},e.prototype.onRecohere=function(t){if(null!==this._input){var e=this._input.get();void 0!==e&&this.setState(e,!0)}},e.prototype.didRecohere=function(t){},e.prototype.memoize=function(){return this},e.prototype.map=function(t){var e=new ei(t);return e.bindInput(this),e},e.prototype.watch=function(t){return new ui(t).bindInput(this),this},e}(ip),up=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i._animationFrame=0,i}return _(e,t),e.prototype.animate=function(){this._animationFrame||this._disabled||(this.hasOwnProperty("onAnimationFrame")||(this.onAnimationFrame=this.onAnimationFrame.bind(this)),this._animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=0)},e.prototype.onAnimationFrame=function(t){this._animationFrame=0,this.onFrame(t)},e}(sp),ap=function(t){function e(e,r,i){void 0===i&&(i=null);var n=t.call(this,r,i)||this;return n.parent=e,n}return _(e,t),e.prototype.animate=function(t){void 0===t&&(t=this);var e=this.parent;e&&!this._disabled&&e.animate(t)},e.prototype.cancel=function(){},e.prototype.update=function(t,e){},e.prototype.delete=function(){},e}(sp),hp=function(t){function e(e,r,i,n){void 0===n&&(n=null);var o=t.call(this,i,n)||this;return o.target=e,o.key=r,o}return _(e,t),e.prototype.update=function(t,e){f.equal(e,t)||(this.willUpdate(t,e),this.target[this.key]=t,this.didUpdate(t,e))},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){delete this.target[this.key]},e}(up),pp=function(t,e){void 0===e&&(e={});var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles||!1,e.cancelable||!1,e.detail),r.__proto__=this.__proto__,r};"undefined"!=typeof Event&&(pp.prototype=Event.prototype);var lp=function(){function t(t){this.callback=t,this.observationTargets=[],this.activeTargets=[],this.skippedTargets=[],_p.addObserver(this)}return t.prototype.observe=function(t){for(var e=0;e<this.observationTargets.length;e+=1)if(t===this.observationTargets[e].target)return;var r=new dp(t);this.observationTargets.push(r),_p.redetect()},t.prototype.unobserve=function(t){for(var e=0;e<this.observationTargets.length;e+=1)t===this.observationTargets[e].target&&this.observationTargets.splice(e,1);this.observationTargets.length||_p.removeObserver(this)},t.prototype.gatherActive=function(t){this.clearActive(),this.clearSkipped();for(var e=0;e<this.observationTargets.length;e+=1){var r=this.observationTargets[e];if(r.isActive())mp(r.target)>t?this.activeTargets.push(r):this.skippedTargets.push(r)}},t.prototype.broadcastActive=function(t){if(this.hasActive()){for(var e=[],r=0;r<this.activeTargets.length;r+=1){var i=this.observationTargets[r],n=new fp(i.target);e.push(n),i.broadcastWidth=n.contentRect.width,i.broadcastHeight=n.contentRect.height;var o=mp(i.target);o<t&&(t=o)}this.callback(e,this),this.clearActive()}return t},t.prototype.hasActive=function(){return this.activeTargets.length>0},t.prototype.hasSkipped=function(){return this.skippedTargets.length>0},t.prototype.clearActive=function(){this.activeTargets.length=0},t.prototype.clearSkipped=function(){this.skippedTargets.length=0},t.prototype.disconnect=function(){this.clearActive(),this.observationTargets.length=0,_p.removeObserver(this)},t}(),cp="undefined"!=typeof window&&void 0!==window.ResizeObserver?window.ResizeObserver:lp,fp=function(t,e){this.target=t,this.contentRect=e||wp(t)},dp=function(){function t(t){this.target=t,this.broadcastWidth=0,this.broadcastHeight=0}return t.prototype.isActive=function(){var t=wp(this.target);return!!t&&(Math.round(t.width)!==Math.round(this.broadcastWidth)||Math.round(t.height)!==Math.round(this.broadcastHeight))},t}(),yp=function(){function t(){this.resizeObservers=[],this.mutationObserver=void 0,this.detectAnimationFrame=0,this.connected=!1,this.onResize=this.onResize.bind(this),this.onTransitionEnd=this.onTransitionEnd.bind(this),this.onMutation=this.onMutation.bind(this),this.onSubtreeModified=void 0,this.onDetectAnimationFrame=this.onDetectAnimationFrame.bind(this)}return t.prototype.addObserver=function(t){this.resizeObservers.indexOf(t)<0&&this.resizeObservers.push(t),this.connect()},t.prototype.removeObserver=function(t){var e=this.resizeObservers.indexOf(t);e>=0&&this.resizeObservers.splice(e,1),this.resizeObservers.length||this.disconnect()},t.prototype.gatherActive=function(t){for(var e=0;e<this.resizeObservers.length;e+=1)this.resizeObservers[e].gatherActive(t)},t.prototype.hasActive=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasActive())return!0;return!1},t.prototype.hasSkipped=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasSkipped())return!0;return!1},t.prototype.broadcastActive=function(){for(var t=Number.POSITIVE_INFINITY,e=0;e<this.resizeObservers.length;e+=1)t=this.resizeObservers[e].broadcastActive(t);return t},t.prototype.detect=function(){var t=0;this.gatherActive(t);do{t=this.broadcastActive(),this.gatherActive(t)}while(this.hasActive());this.hasSkipped()&&window.dispatchEvent(new ErrorEvent("ResizeObserver loop completed with undelivered notifications."))},t.prototype.redetect=function(){this.detectAnimationFrame||(this.detectAnimationFrame=requestAnimationFrame(this.onDetectAnimationFrame))},t.prototype.onDetectAnimationFrame=function(t){this.detectAnimationFrame=0,this.detect()},t.prototype.onResize=function(t){this.redetect()},t.prototype.onTransitionEnd=function(t){for(var e=!1,r=0;r<vp.length;r+=1)if(t.propertyName.indexOf(vp[r])>=0){e=!0;break}e&&this.redetect()},t.prototype.onMutation=function(t){for(var e=0;e<t.length;e+=1){var r=t[e];if("childList"===r.type&&r.addedNodes&&r.addedNodes.length>0)for(var i=0;i<r.addedNodes.length;i+=1)this.addShadows(r.addedNodes[i])}this.redetect()},t.prototype.addShadows=function(t){if(t instanceof Element){for(var e=0;e<t.childNodes.length;e+=1)this.addShadows(t.childNodes[e]);t.shadowRoot&&(this.observe(t.shadowRoot),this.addShadows(t.shadowRoot))}},t.prototype.observe=function(t){this.mutationObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})},t.prototype.connect=function(){if(!this.connected){window.addEventListener("resize",this.onResize),document.addEventListener("transitionend",this.onTransitionEnd);var t="undefined"!=typeof navigator&&/Trident\/.*rv:11/.test(navigator.userAgent);"undefined"==typeof MutationObserver||t?(this.onSubtreeModified=this.onResize,document.addEventListener("DOMSubtreeModified",this.onSubtreeModified)):(this.mutationObserver=new MutationObserver(this.onMutation),this.observe(document),this.addShadows(document)),this.connected=!0}},t.prototype.disconnect=function(){this.connected&&(window.removeEventListener("resize",this.onResize),document.removeEventListener("transitionend",this.onTransitionEnd),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=void 0),this.onSubtreeModified&&(document.removeEventListener("DOMSubtreeModified",this.onSubtreeModified),this.onSubtreeModified=void 0),this.detectAnimationFrame&&(cancelAnimationFrame(this.detectAnimationFrame),this.detectAnimationFrame=0),this.connected=!1)},t}(),vp=["top","right","bottom","left","width","height","size","weight"],_p=new yp;function mp(t){for(var e=0;t.parentNode;)t=t.parentNode,e+=1;return e}function wp(t){return t instanceof HTMLElement?function(t){if(!t.clientWidth&&!t.clientHeight)return bp(0,0,0,0);var e=getComputedStyle(t),r=gp(e.getPropertyValue("padding-left")),i=gp(e.getPropertyValue("padding-top")),n=r+gp(e.getPropertyValue("padding-right")),o=i+gp(e.getPropertyValue("padding-bottom")),s=gp(e.getPropertyValue("width")),u=gp(e.getPropertyValue("height"));"border-box"===e.getPropertyValue("box-sizing")&&(Math.round(s+n)!==t.clientWidth&&(s-=n+gp(e.getPropertyValue("border-left-width"))+gp(e.getPropertyValue("border-right-width"))),Math.round(u+o)!==t.clientHeight&&(u-=o+gp(e.getPropertyValue("border-top-width"))+gp(e.getPropertyValue("border-bottom-width"))));if(t!==document.documentElement){var a=Math.round(s+n)-t.clientWidth,h=Math.round(u+o)-t.clientHeight;1!==Math.abs(a)&&(s-=a),1!==Math.abs(h)&&(u-=h)}return bp(r,i,s,u)}(t):function(t){return"undefined"!=typeof SVGGraphicsElement?t instanceof SVGGraphicsElement:t instanceof SVGElement&&"function"==typeof t.getBBox}(t)?function(t){var e=t.getBBox();return bp(0,0,e.width,e.height)}(t):bp(0,0,0,0)}function gp(t){return parseFloat(t)||0}function bp(t,e,r,i){return{x:t,y:e,width:r,height:i,top:e,right:t+r,bottom:e+i,left:t}}var xp=function(){function t(t,e,r,i,n,o,s){this.inset=t,this.offsetX=e,this.offsetY=r,this.blurRadius=i,this.spreadRadius=n,this.color=o,this.next=s}return t.prototype.isDefined=function(){return this.inset||this.offsetX.isDefined()||this.offsetY.isDefined()||this.blurRadius.isDefined()||this.spreadRadius.isDefined()||this.color.isDefined()||!!this.next&&this.next.isDefined()},t.prototype.and=function(e,r,i,n,o,s){var u=this.next?this.next.and.apply(this.next,arguments):t.of.apply(null,arguments);return new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,this.color,u)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.inset===e.inset&&this.offsetX.equals(e.offsetX)&&this.offsetY.equals(e.offsetY)&&this.blurRadius.equals(e.blurRadius)&&this.spreadRadius.equals(e.spreadRadius)&&this.color.equals(e.color)&&f.equal(this.next,e.next))},t.prototype.toString=function(){if(this.isDefined()){for(var t="",e=this;;){if(e.inset&&(t+="inset",t+=" "),t+=e.offsetX.toString(),t+=" ",t+=e.offsetY.toString(),t+=" ",t+=e.blurRadius.toString(),t+=" ",t+=e.spreadRadius.toString(),t+=" ",t+=e.color.toString(),!e.next)break;t+=", ",e=e.next}return t}return"none"},t.none=function(){return t._none||(t._none=new t(!1,Hu.zero(),Hu.zero(),Hu.zero(),Hu.zero(),ta.black(),null)),t._none},t.of=function(e,r,i,n,o,s){if(1===arguments.length)return t.fromAny(arguments[0]);if("boolean"!=typeof e){if(3===arguments.length)s=ta.fromAny(arguments[2]),o=Hu.zero(),n=Hu.zero(),i=Hu.fromAny(arguments[1]),r=Hu.fromAny(arguments[0]);else if(4===arguments.length)s=ta.fromAny(arguments[3]),o=Hu.zero(),n=Hu.fromAny(arguments[2]),i=Hu.fromAny(arguments[1]),r=Hu.fromAny(arguments[0]);else{if(5!==arguments.length)throw new TypeError(""+arguments);s=ta.fromAny(arguments[4]),o=Hu.fromAny(arguments[3]),n=Hu.fromAny(arguments[2]),i=Hu.fromAny(arguments[1]),r=Hu.fromAny(arguments[0])}e=!1}else if(4===arguments.length)s=ta.fromAny(arguments[3]),o=Hu.zero(),n=Hu.zero(),r=Hu.fromAny(arguments[1]),i=Hu.fromAny(arguments[2]);else if(5===arguments.length)s=ta.fromAny(arguments[4]),o=Hu.zero(),n=Hu.fromAny(arguments[3]),r=Hu.fromAny(arguments[1]),i=Hu.fromAny(arguments[2]);else{if(6!==arguments.length)throw new TypeError(""+arguments);s=ta.fromAny(arguments[5]),o=Hu.fromAny(arguments[4]),n=Hu.fromAny(arguments[3]),i=Hu.fromAny(arguments[2]),r=Hu.fromAny(arguments[1])}return new t(e,r,i,n,o,s,null)},t.fromAny=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if((e=0===arguments.length?t.none():1===arguments.length?arguments[0]:arguments)instanceof t)return e;if("string"==typeof e)return t.parse(e);if("object"==typeof e&&e&&void 0===e.length){var n=(e=e).inset||!1,o=void 0!==e.offsetX?Hu.fromAny(e.offsetX):Hu.zero(),s=void 0!==e.offsetY?Hu.fromAny(e.offsetY):Hu.zero(),u=void 0!==e.blurRadius?Hu.fromAny(e.blurRadius):Hu.zero(),a=void 0!==e.spreadRadius?Hu.fromAny(e.spreadRadius):Hu.zero(),h=void 0!==e.color?ta.fromAny(e.color):ta.black();return new t(n,o,s,u,a,h,null)}if("object"==typeof e&&e&&e.length>0){e=e;for(var p=t.fromAny(e[0]),l=1;l<e.length;l+=1)p=p.and(e[l]);return p}throw new TypeError(""+e)},t.fromValue=function(e){var r;return e.forEach((function(e,i){var n=e.header("boxShadow");if(n){var o,s,u,a,h,p;n.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"inset"===r?o=t.toValue().booleanValue(o):"offsetX"===r?s=t.toValue().cast(Hu.form(),s):"offsetY"===r?u=t.toValue().cast(Hu.form(),u):"blurRadius"===r?a=t.toValue().cast(Hu.form(),a):"spreadRadius"===r?h=t.toValue().cast(Hu.form(),h):"color"===r&&(p=t.toValue().cast(ta.form(),p)):t instanceof se&&(0===e&&t instanceof de&&"inset"===t.value?o=!0:0===e||1===e&&void 0!==o?s=t.cast(Hu.form(),s):1===e||2===e&&void 0!==o?u=t.cast(Hu.form(),u):2===e||3===e&&void 0!==o?void 0===(a=t.cast(Hu.form(),a))&&(p=t.cast(ta.form(),p)):(3===e||4===e&&void 0===o)&&void 0===p?void 0===(h=t.cast(Hu.form(),h))&&(p=t.cast(ta.form(),p)):(4===e||5===e&&void 0===o)&&void 0===p&&(p=t.cast(ta.form(),p)))})),o=void 0!==o&&o,s=void 0!==s?s:Hu.zero(),u=void 0!==u?u:Hu.zero(),a=void 0!==a?a:Hu.zero(),h=void 0!==h?h:Hu.zero(),p=void 0!==p?p:ta.black();var l=new t(o||!1,s,u,a,h,p,null);r=r?r.and(l):l}})),r},t.parse=function(e){for(var r=$.stringInput(e);r.isCont()&&$.isWhitespace(r.head());)r=r.step();var i=t.Parser.parse(r);if(i.isDone())for(;r.isCont()&&$.isWhitespace(r.head());)r=r.step();return r.isCont()&&!i.isError()&&(i=ft.error(lt.unexpected(r))),i.bind()},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.offsetX&&void 0!==e.offsetY&&void 0!==e.color}return!1},t.form=function(e){return void 0!==e&&(e=t.fromAny(e)),e!==t.none()?new t.Form(e):(t._form||(t._form=new t.Form(t.none())),t._form)},t}(),Cp=function(t){function e(e,r,i,n,o,s,u,a){var h=t.call(this)||this;return h.boxShadow=e,h.identOutput=r,h.offsetXParser=i,h.offsetYParser=n,h.blurRadiusParser=o,h.spreadRadiusParser=s,h.colorParser=u,h.step=a,h}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.boxShadow,this.identOutput,this.offsetXParser,this.offsetYParser,this.blurRadiusParser,this.spreadRadiusParser,this.colorParser,this.step)},e.parse=function(t,r,i,n,o,s,u,a,h){void 0===h&&(h=1);for(var p=0;;){if(1===h){for(;t.isCont()&&(p=t.head(),$.isSpace(p));)t.step();if(t.isCont())h=$.isAlpha(p)?2:4;else if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(2===h){for(i=i||$.stringOutput();t.isCont()&&(p=t.head(),$.isAlpha(p));)t=t.step(),i.write(p);if(!t.isEmpty()){var l=i.bind();switch(l){case"inset":h=3;break;case"none":return ft.done(xp.none());default:return ft.error(lt.message("unknown box-shadow: "+l,t))}}}if(3===h)if(t.isCont()){if(!$.isSpace(t.head()))return ft.error(lt.expected("space",t));t.step(),h=4}else if(t.isDone())return ft.error(lt.unexpected(t));if(4===h){if(n)n=n.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(n=$u.parse(t))}if(n)if(n.isDone())h=5;else if(n.isError())return n.asError()}if(5===h)if(t.isCont()){if(!$.isSpace(t.head()))return ft.error(lt.expected("space",t));t.step(),h=6}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(6===h){if(o)o=o.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(o=$u.parse(t))}if(o)if(o.isDone())h=7;else if(o.isError())return o.asError()}if(7===h)if(t.isCont()){if(!$.isSpace(t.head()))return ft.error(lt.expected("space",t));t.step(),h=8}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(8===h){if(s)s=s.feed(t);else{for(;t.isCont()&&(p=t.head(),$.isSpace(p));)t.step();t.isCont()&&(45===p||p>=48&&p<=57)?s=$u.parse(t):t.isEmpty()||(h=12)}if(s)if(s.isDone())h=9;else if(s.isError())return s.asError()}if(9===h)if(t.isCont()){if(!$.isSpace(t.head()))return ft.error(lt.expected("space",t));t.step(),h=10}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(10===h){if(u)u=u.feed(t);else{for(;t.isCont()&&(p=t.head(),$.isSpace(p));)t.step();t.isCont()&&(45===p||p>=48&&p<=57)?u=$u.parse(t):t.isEmpty()||(h=12)}if(u)if(u.isDone())h=11;else if(u.isError())return u.asError()}if(11===h)if(t.isCont()){if(!$.isSpace(t.head()))return ft.error(lt.expected("space",t));t.step(),h=12}else if(!t.isEmpty())return ft.error(lt.unexpected(t));if(12===h){if(a)a=a.feed(t);else{for(;t.isCont()&&$.isSpace(t.head());)t.step();t.isEmpty()||(a=aa.parse(t))}if(a)if(a.isDone()){var c=!!i&&"inset"===i.bind(),f=n.bind(),d=o.bind(),y=s?s.bind():Hu.zero(),v=u?u.bind():Hu.zero(),_=a.bind(),m=new xp(c,f,d,y,v,_,null);r=r?r.and(m):m,i=void 0,n=void 0,o=void 0,s=void 0,u=void 0,a=void 0,h=13}else if(a.isError())return a.asError()}if(13===h){for(;t.isCont()&&(p=t.head(),$.isSpace(p));)t.step();if(t.isCont()&&44===p){t.step(),h=1;continue}if(!t.isEmpty())return ft.done(r)}break}return new e(r,i,n,o,s,u,a,h)},e}(ft);xp.Parser=Cp;var Sp=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t)},e.prototype.mold=function(t){for(var e=xp.fromAny(t),r=ae.create();;){var i=ae.create(5);if(e.inset&&i.push("inset"),i.push(Hu.form().mold(e.offsetX)),i.push(Hu.form().mold(e.offsetY)),i.push(Hu.form().mold(e.blurRadius)),i.push(Hu.form().mold(e.spreadRadius)),i.push(ta.form().mold(e.color)),r.attr("boxShadow",i),!e.next)break;e=e.next}return r},e.prototype.cast=function(t){var e,r=t.toValue();try{if(!(e=xp.fromValue(r))){var i=r.stringValue();void 0!==i&&(e=xp.parse(i))}}catch(t){}return e},e}(Se);xp.Form=Sp;var Ap={fromAny:function(t){if(t instanceof lo||t instanceof Nu||t instanceof Hu||t instanceof ta||t instanceof da||t instanceof _a||t instanceof Ta||t instanceof mh||t instanceof tp||t instanceof xp||"number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Date||lo.isInit(t))return lo.fromAny(t);if(ta.isInit(t))return ta.fromAny(t);if(da.isInit(t))return da.fromAny(t);if(tp.isInit(t))return tp.fromAny(t);if(xp.isInit(t))return xp.fromAny(t);if("string"==typeof t)return Ap.parse(t);throw new TypeError(""+t)},parse:function(t){for("string"==typeof t&&(t=$.stringInput(t));t.isCont()&&$.isWhitespace(t.head());)t=t.step();var e=Ap.Parser.parse(t);if(e.isDone())for(;t.isCont()&&$.isWhitespace(t.head());)t=t.step();return t.isCont()&&!e.isError()&&(e=ft.error(lt.unexpected(t))),e.bind()},_form:void 0,form:function(t){return void 0!==t?(t=Ap.fromAny(t),new Ap.Form(t)):(Ap._form||(Ap._form=new Ap.Form),Ap._form)},Parser:void 0,Form:void 0},kp=vo.pattern("%m-%dT%H:%M:%S.%LZ"),Ep=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.identOutput=e,o.valueParser=r,o.unitsOutput=i,o.step=n,o}return _(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),$.isSpace(s));)t.step();if(t.isCont()){if(35===s)return oa.parse(t);o=$.isAlpha(s)?2:3}else if(!t.isEmpty())return ft.error(lt.unexpected(t))}if(2===o){for(r=r||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s)||45===s);)t=t.step(),r.write(s);if(!t.isEmpty()){var u=r.bind();switch(u){case"rgb":case"rgba":return sa.parseRest(t);case"hsl":case"hsla":return ua.parseRest(t);case"normal":case"italic":case"oblique":return ya.parseRest(t,u);case"small-caps":return ya.parseRest(t,void 0,u);case"bold":case"bolder":case"lighter":return ya.parseRest(t,void 0,void 0,u);case"ultra-condensed":case"extra-condensed":case"semi-condensed":case"condensed":case"expanded":case"semi-expanded":case"extra-expanded":case"ultra-expanded":return ya.parseRest(t,void 0,void 0,void 0,u);case"large":case"larger":case"medium":case"small":case"smaller":case"x-large":case"x-small":case"xx-large":case"xx-small":return ya.parseRest(t,void 0,void 0,void 0,void 0,u);case"translateX":case"translateY":case"translate":return Aa.parseRest(t,r);case"scaleX":case"scaleY":case"scale":return ka.parseRest(t,r);case"rotate":return Ea.parseRest(t,r);case"skewX":case"skewY":case"skew":return Oa.parseRest(t,r);case"matrix":return Va.parseRest(t,r);case"none":return ft.done(_a.identity());case"true":return ft.done(!0);case"false":return ft.done(!1);default:var a=ta.fromName(u);return void 0!==a?ft.done(a):ft.error(lt.message("unknown style value: "+u,t))}}}if(3===o)if((i=i?i.feed(t):pt.parseDecimal(t)).isDone())o=4;else if(i.isError())return i.asError();if(4===o){if(t.isCont()&&45===(s=t.head())){t.step();var h={};return h.year=i.bind(),kp.parseDate(t,h)}t.isEmpty()||(o=5)}if(5===o){for(n=n||$.stringOutput();t.isCont()&&(s=t.head(),$.isAlpha(s)||37===s);)t.step(),n.push(s);t.isEmpty()||(o=6)}if(6===o&&!t.isEmpty()){var p=i.bind(),l=n.bind(),c=void 0;switch(l){case"deg":c=Nu.deg(p);break;case"rad":c=Nu.rad(p);break;case"grad":c=Nu.grad(p);break;case"turn":c=Nu.turn(p);break;case"px":c=Hu.px(p);break;case"em":c=Hu.em(p);break;case"rem":c=Hu.rem(p);break;case"%":c=Hu.pct(p);break;case"":c=p;break;default:return ft.error(lt.message("unknown style units: "+l,t))}if(t.isCont()&&(s=t.head(),$.isSpace(s)||47===s)){if(c instanceof Hu)return ya.parseRest(t,void 0,void 0,void 0,void 0,c);if("number"==typeof c)switch(p){case 100:case 200:case 300:case 400:case 500:case 600:case 700:case 800:case 900:return ya.parseRest(t,void 0,void 0,String(p))}}return ft.done(c)}return new e(r,i,n,o)},e}(ft);Ap.Parser=Ep;var Op=function(t){function e(e){var r=t.call(this)||this;return r._unit=e,r}return _(e,t),e.prototype.unit=function(t){return 0===arguments.length?this._unit:new e(t=void 0!==t?Ap.fromAny(t):void 0)},e.prototype.mold=function(t){if(void 0!==t){if((t=Ap.fromAny(t))instanceof lo)return lo.form().mold(t);if(t instanceof Nu)return Nu.form().mold(t);if(t instanceof Hu)return Hu.form().mold(t);if(t instanceof ta)return ta.form().mold(t);if(t instanceof da)return da.form().mold(t);if(t instanceof _a)return _a.form().mold(t);if(t instanceof Ta)return Ta.form().mold(t);if(t instanceof mh)return mh.form().mold(t);if(t instanceof tp)return tp.form().mold(t);if(t instanceof xp)return xp.form().mold(t);if("number"==typeof t)return ye.from(t);throw new TypeError(""+t)}return $t.extant()},e.prototype.cast=function(t){var e=t.toValue();if(e instanceof ye)return e.numberValue();if(e instanceof ve)return e.booleanValue();var r=e.stringValue(void 0);if(void 0!==r)try{return Ap.parse(r)}catch(t){}if(e instanceof ae){var i=lo.fromValue(e);if(i)return i;var n=Nu.fromValue(e);if(n)return n;var o=Hu.fromValue(e);if(o)return o;var s=ta.fromValue(e);if(s)return s;var u=da.fromValue(e);if(u)return u;var a=_a.fromValue(e);if(a)return a;var h=Ta.form().cast(e);if(h)return h;var p=mh.form().cast(e);if(p)return p;var l=tp.form().cast(e);if(l)return l;var c=xp.fromValue(e);if(c)return c}},e}(Se);function Vp(t){return t&&"object"==typeof t&&"function"==typeof t.toAttributeString?t.toAttributeString():""+t}function Pp(t){return t&&"object"==typeof t&&"function"==typeof t.toStyleString?t.toStyleString():""+t}Ap.Form=Op,Ta.valueForm=Ap.form,mh.domainForm=Ap.form,mh.interpolatorForm=Ta.form,tp.interpolatorForm=Ta.form;var Dp=function(){},Mp=Math.PI,Tp=2*Mp,Rp=function(){function t(){this.x0=null,this.y0=null,this.x1=null,this.y1=null,this.d=""}return t.prototype.moveTo=function(t,e){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)},t.prototype.closePath=function(){void 0!==this.x1&&(this.x1=this.x0,this.y1=this.y0,this.d+="Z")},t.prototype.lineTo=function(t,e){this.d+="L"+(this.x1=t)+","+(this.y1=e)},t.prototype.quadraticCurveTo=function(t,e,r,i){this.d+="Q"+t+","+e+","+(this.x1=r)+","+(this.y1=i)},t.prototype.bezierCurveTo=function(t,e,r,i,n,o){this.d+="C"+t+","+e+","+r+","+i+","+(this.x1=n)+","+(this.y1=o)},t.prototype.arcTo=function(t,e,r,i,n){var o=+this.x1,s=+this.y1,u=r-t,a=i-e,h=o-t,p=s-e,l=h*h+p*p;if(n<0)throw new Error("negative radius: "+n);if(null===this.x1)this.d+="M"+(this.x1=t)+","+(this.y1=e);else if(l>1e-6)if(Math.abs(p*u-a*h)>1e-6&&n){var c=r-o,f=i-s,d=u*u+a*a,y=c*c+f*f,v=Math.sqrt(d),_=Math.sqrt(l),m=n*Math.tan((Mp-Math.acos((d+l-y)/(2*v*_)))/2),w=m/_,g=m/v;Math.abs(w-1)>1e-6&&(this.d+="L"+(t+w*h)+","+(e+w*p)),this.d+="A"+n+","+n+",0,0,"+ +(p*c>h*f)+","+(this.x1=t+g*u)+","+(this.y1=e+g*a)}else this.d+="L"+(this.x1=t)+","+(this.y1=e);else;},t.prototype.arc=function(t,e,r,i,n,o){void 0===o&&(o=!1);var s=r*Math.cos(i),u=r*Math.sin(i),a=t+s,h=e+u,p=1^+o,l=o?i-n:n-i;if(r<0)throw new Error("negative radius: "+r);null===this.x1?this.d+="M"+a+","+h:(Math.abs(+this.x1-a)>1e-6||Math.abs(+this.y1-h)>1e-6)&&(this.d+="L"+a+","+h),r&&(l<0&&(l=l%Tp+Tp),l>Tp-1e-6?this.d+="A"+r+","+r+",0,1,"+p+","+(t-s)+","+(e-u)+"A"+r+","+r+",0,1,"+p+","+(this.x1=a)+","+(this.y1=h):l>1e-6&&(this.d+="A"+r+","+r+",0,"+ +(l>=Mp)+","+p+","+(this.x1=t+r*Math.cos(n))+","+(this.y1=e+r*Math.sin(n))))},t.prototype.rect=function(t,e,r,i){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)+"h"+r+"v"+i+"h"+-r+"Z"},t.prototype.toString=function(){return this.d},t}(),Ip=function(t){function e(e){void 0===e&&(e=new Rp);var r=t.call(this)||this;return r._context=e,r}return _(e,t),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),e}(Dp),Fp=function(t){function e(e,r){void 0===r&&(r=window.devicePixelRatio||1);var i=t.call(this)||this;return i._context=e,i._pixelRatio=r,i}return _(e,t),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},enumerable:!0,configurable:!0}),e}(Dp),Lp=function(t){function e(e,r){void 0===r&&(r=window.devicePixelRatio||1);var i=t.call(this)||this;return i._context=e,i._pixelRatio=r,i}return _(e,t),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return this._pixelRatio},enumerable:!0,configurable:!0}),e}(Dp),Up=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=[]),this._index=t,this._array=e}return Object.defineProperty(t.prototype,"size",{get:function(){return this._array.length},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return 0===this._array.length},t.prototype.has=function(t){return void 0!==this._index[t.id]},t.prototype.get=function(t){var e=this._index[t.id];return void 0!==e?this._array[e][1]:void 0},t.prototype.getField=function(t){var e=this._index[t.id];return void 0!==e?this._array[e]:void 0},t.prototype.getEntry=function(t){return this._array[t]},t.prototype.set=function(t,e){var r=this._index[t.id];return void 0!==r?this._array[r][1]=e:(this._index[t.id]=this._array.length,this._array.push([t,e])),this},t.prototype.delete=function(t){var e=this._index[t.id];if(void 0!==e){delete this._index[t.id];var r=this._array[e],i=this._array.pop();return r!==i&&(this._array[e]=i,this._index[i[0].id]=e),!0}return!1},t.prototype.remove=function(t){var e=this._index[t.id];if(void 0!==e){delete this._index[t.id];var r=this._array[e],i=this._array.pop();return r!==i&&(this._array[e]=i,this._index[i[0].id]=e),r[1]}},t.prototype.clear=function(){this._index={},this._array.length=0},t.prototype.forEach=function(t,e){for(var r=this._array,i=0,n=r.length;i<n;i+=1){var o=r[i],s=t.call(e,o[0],o[1]);if(void 0!==s)return s}},t.prototype.keys=function(){},t.prototype.values=function(){},t.prototype.entries=function(){},t.prototype.clone=function(){for(var e=this._array,r=e.length,i={},n=new Array(r),o=0;o<r;o+=1){var s=e[o],u=s[0],a=s[1];n[o]=[u,a],i[u.id]=o}return new t(i,n)},t.nextId=function(){var e=t._nextId;return t._nextId=e+1,e},t._nextId=1,t}(),Np={Invalid:void 0},zp=function(){function t(){this._id=Up.nextId()}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!1},t}(),jp=function(){function t(){this._id=Up.nextId()}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!0},t.prototype.isInvalid=function(){return!1},t}(),Wp=function(){function t(){this._id=Up.nextId()}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!1},t}(),qp=function(){function t(){}return Object.defineProperty(t.prototype,"id",{get:function(){return-1},enumerable:!0,configurable:!0}),t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!0},t}();Np.Invalid=new qp;var Bp=function(){function t(){this._id=Up.nextId()}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.sum=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i=new Up,n=0,o=0,s=e.length;o<s;o+=1){var u=e[o];if("number"==typeof u)n+=u;else if(u instanceof t.Term){if(null!==(f=u.variable))void 0!==(l=i.getField(f))?l[1]+=u.coefficient:i.set(f,u.coefficient);else n+=u.constant}else{for(var a=u.terms,h=0,p=a.size;h<p;h+=1){var l,c=a.getEntry(h),f=c[0],d=c[1];void 0!==(l=i.getField(f))?l[1]+=d:i.set(f,d)}n+=u.constant}}return new t.Sum(i,n)},t.product=function(e,r){return new t.Product(e,r)},t.constant=function(e){return new t.Constant(e)},t.zero=function(){return new t.Constant(0)},t}(),Kp=function(t){function e(e,r){var i=t.call(this)||this;return i._terms=e,i._constant=r,i}return _(e,t),e.prototype.isConstant=function(){return this._terms.isEmpty()},Object.defineProperty(e.prototype,"terms",{get:function(){return this._terms},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return this._constant},enumerable:!0,configurable:!0}),e.prototype.plus=function(t){return Bp.sum(this,t)},e.prototype.opposite=function(){for(var t=this._terms,r=new Up,i=0,n=t.size;i<n;i+=1){var o=t.getEntry(i),s=o[0],u=o[1];r.set(s,-u)}return new e(r,-this._constant)},e.prototype.minus=function(t){return t="number"==typeof t?Bp.constant(t):t.opposite(),Bp.sum(this,t)},e.prototype.times=function(t){for(var r=this._terms,i=new Up,n=0,o=r.size;n<o;n+=1){var s=r.getEntry(n),u=s[0],a=s[1];i.set(u,a*t)}return new e(i,this._constant*t)},e.prototype.divide=function(t){for(var r=this._terms,i=new Up,n=0,o=r.size;n<o;n+=1){var s=r.getEntry(n),u=s[0],a=s[1];i.set(u,a/t)}return new e(i,this._constant/t)},e.prototype.debug=function(t){t=t.write("Constrain").write(46).write("sum").write(40);for(var e=this._terms.size,r=0;r<e;r+=1){var i=this._terms.getEntry(r),n=i[0],o=i[1];r>0&&(t=t.write(", ")),t=1===o?t.debug(n):t.debug(Bp.product(o,n))}0!==this._constant&&(e>0&&(t=t.write(", ")),t=t.debug(this._constant)),t=t.write(41)},e.prototype.toString=function(){return J.debug(this)},e}(Bp);Bp.Sum=Kp;var Hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(Bp);Bp.Term=Hp;var Gp=function(t){function e(e,r){var i=t.call(this)||this;return i._coefficient=e,i._variable=r,i}return _(e,t),e.prototype.isConstant=function(){return!1},Object.defineProperty(e.prototype,"coefficient",{get:function(){return this._coefficient},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"variable",{get:function(){return this._variable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){var t=new Up;return t.set(this._variable,this._coefficient),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.plus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),t instanceof e&&this._variable===t._variable?Bp.product(this._coefficient+t._coefficient,this._variable):t instanceof Bp.Variable&&this._variable===t?Bp.product(this._coefficient+1,this._variable):Bp.sum(this,t)},e.prototype.opposite=function(){return Bp.product(-this._coefficient,this._variable)},e.prototype.minus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),t instanceof e&&this._variable===t._variable?Bp.product(this._coefficient-t._coefficient,this._variable):t instanceof Bp.Variable&&this._variable===t?Bp.product(this._coefficient-1,this._variable):Bp.sum(this,t.opposite())},e.prototype.times=function(t){return Bp.product(this._coefficient*t,this._variable)},e.prototype.divide=function(t){return Bp.product(this._coefficient/t,this._variable)},e.prototype.debug=function(t){t=t.write("Constrain").write(46).write("product").write(40).debug(this._coefficient).write(", ").debug(this._variable).write(41)},e.prototype.toString=function(){return J.debug(this)},e}(Hp);Bp.Product=Gp;var Xp=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return _(e,t),e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coefficient",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"variable",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){return new Up},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.plus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),t instanceof e?Bp.constant(this._value+t._value):Bp.sum(this,t)},e.prototype.opposite=function(){return Bp.constant(-this._value)},e.prototype.minus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),t instanceof e?Bp.constant(this._value-t._value):Bp.sum(this,t.opposite())},e.prototype.times=function(t){return Bp.constant(this._value*t)},e.prototype.divide=function(t){return Bp.constant(this._value/t)},e.prototype.debug=function(t){t=t.write("Constrain").write(46).write("constant").write(40).debug(this._value).write(41)},e.prototype.toString=function(){return J.debug(this)},e}(Hp);Bp.Constant=Xp;var Yp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.isExternal=function(){return!0},e.prototype.isDummy=function(){return!1},e.prototype.isInvalid=function(){return!1},e.prototype.isConstant=function(){return!1},Object.defineProperty(e.prototype,"coefficient",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"variable",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){var t=new Up;return t.set(this,1),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.plus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),this===t?Bp.product(2,this):Bp.sum(this,t)},e.prototype.opposite=function(){return Bp.product(-1,this)},e.prototype.minus=function(t){return"number"==typeof t&&(t=Bp.constant(t)),this===t?Bp.zero():Bp.sum(this,t.opposite())},e.prototype.times=function(t){return Bp.product(t,this)},e.prototype.divide=function(t){return Bp.product(1/t,this)},e.prototype.debug=function(t){t=t.debug(this.scope).write(46).write("variable").write(40).debug(this.name).write(", ").debug(this.value).write(41)},e.prototype.toString=function(){return J.debug(this)},e}(Hp);Bp.Variable=Yp;var Zp={Required:1001001e3,Strong:1e6,Medium:1e3,Weak:1,Unbound:-1,clip:function(t){return Math.min(Math.max(0,t),Zp.Required)},fromAny:function(t){if("number"==typeof t)return Zp.clip(t);if("required"===t)return Zp.Required;if("strong"===t)return Zp.Strong;if("medium"===t)return Zp.Medium;if("weak"===t)return Zp.Weak;throw new TypeError(""+t)}},Qp=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o._scope=e,Object.defineProperty(o,"name",{value:r,enumerable:!0,configurable:!0}),o._value=i,o._state=NaN,o._strength=n,o}return _(e,t),Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.updateValue=function(t){this._value=t},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),e.prototype.setState=function(t){var e=this._state;isFinite(e)&&!isFinite(t)&&this._scope.removeVariable(this),this._state=t,isFinite(t)&&(isFinite(e)?this._scope.setVariable(this,t):this._scope.addVariable(this))},Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},enumerable:!0,configurable:!0}),e.prototype.setStrength=function(t){var e=this._state,r=this._strength;t=Zp.fromAny(t),isFinite(e)&&r!==t&&this._scope.removeVariable(this),this._strength=t,isFinite(e)&&r!==t&&this._scope.addVariable(this)},e}(Yp);Bp.Binding=Qp;var $p=function(){function t(t,e,r,i){this._id=Up.nextId(),this._scope=t,this._constrain=e,this._relation=r,this._strength=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){return this._scope},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"constrain",{get:function(){return this._constrain},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relation",{get:function(){return this._relation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strength",{get:function(){return this._strength},enumerable:!0,configurable:!0}),t.prototype.enabled=function(t){return void 0===t?this._scope.hasConstraint(this):(t?this._scope.addConstraint(this):this._scope.removeConstraint(this),this)},t.prototype.debug=function(t){t=t.debug(this._scope).write(46).write("constraint").write(40).debug(this._constrain).write(", ").debug(this._relation).write(", ").debug(void 0).write(", "),t=(t=this._strength===Zp.Required?t.debug("required"):this._strength===Zp.Strong?t.debug("strong"):this._strength===Zp.Medium?t.debug("medium"):this._strength===Zp.Weak?t.debug("weak"):t.debug(this._strength)).write(41)},t.prototype.toString=function(){return J.debug(this)},t}(),Jp=function(){function t(t,e){void 0===t&&(t=new Up),void 0===e&&(e=0),this._cells=t,this._constant=e}return t.prototype.isConstant=function(){return this._cells.isEmpty()},t.prototype.isDummy=function(){for(var t=0,e=this._cells.size;t<e;t+=1){if(!(this._cells.getEntry(t)[0]instanceof jp))return!1}return!0},t.prototype.clone=function(){return new t(this._cells.clone(),this._constant)},t.prototype.add=function(t){return this._constant+=t,this._constant},t.prototype.insertSymbol=function(t,e){void 0===e&&(e=1),e+=this._cells.get(t)||0,Math.abs(e)<1e-8?this._cells.remove(t):this._cells.set(t,e)},t.prototype.insertRow=function(t,e){this._constant+=t._constant*e;for(var r=0,i=t._cells.size;r<i;r+=1){var n=t._cells.getEntry(r),o=n[0],s=n[1];this.insertSymbol(o,s*e)}},t.prototype.removeSymbol=function(t){this._cells.remove(t)},t.prototype.negate=function(){this._constant=-this._constant;for(var t=0,e=this._cells.size;t<e;t+=1){var r=this._cells.getEntry(t);r[1]=-r[1]}},t.prototype.solveFor=function(t){var e=this._cells.remove(t);if(void 0!==e){var r=-1/e;this._constant*=r;for(var i=0,n=this._cells.size;i<n;i+=1){this._cells.getEntry(i)[1]*=r}}},t.prototype.solveForEx=function(t,e){this.insertSymbol(t,-1),this.solveFor(e)},t.prototype.coefficientFor=function(t){var e=this._cells.get(t);return void 0!==e?e:0},t.prototype.substitute=function(t,e){var r=this._cells.remove(t);void 0!==r&&this.insertRow(e,r)},t}(),tl=function(){function t(){this._constraints=new Up,this._variables=new Up,this._rows=new Up,this._infeasible=[],this._objective=new Jp,this._artificial=null}return t.prototype.variable=function(t,e,r){return void 0===e&&(e=0),r=void 0===r?Zp.Strong:Zp.fromAny(r),new Qp(this,t,e,r)},t.prototype.constraint=function(t,e,r,i){"number"==typeof t&&(t=Bp.constant(t)),"number"==typeof r&&(r=Bp.constant(r));var n=r?t.minus(r):t;return i=void 0===i?Zp.Required:Zp.fromAny(i),new $p(this,n,e,i)},t.prototype.hasConstraint=function(t){return this._constraints.has(t)},t.prototype.addConstraint=function(t){if(!this._constraints.has(t)){this.willAddConstraint(t);var e=this.createRow(t),r=e.row,i=e.tag,n=this.chooseSubject(r,i);if(n.isInvalid()&&r.isDummy()){if(!(Math.abs(r._constant)<1e-8))throw new Error("unsatisfiable constraint");n=i.marker}if(n.isInvalid()){if(!this.addWithArtificialVariable(r))throw new Error("unsatisfiable constraint")}else r.solveFor(n),this.substitute(n,r),this._rows.set(n,r);this._constraints.set(t,i),this.optimize(this._objective),this.didAddConstraint(t)}},t.prototype.willAddConstraint=function(t){},t.prototype.didAddConstraint=function(t){},t.prototype.removeConstraint=function(t){var e=this._constraints.remove(t);if(void 0!==e){this.willRemoveConstraint(t),this.removeConstraintEffects(t,e);var r=e.marker;if(void 0===this._rows.remove(r)){var i=this.getMarkerLeavingSymbol(r);if(i.isInvalid())throw new Error("failed to find leaving row");var n=this._rows.remove(i);n.solveForEx(i,r),this.substitute(r,n)}this.optimize(this._objective),this.didRemoveConstraint(t)}},t.prototype.willRemoveConstraint=function(t){},t.prototype.didRemoveConstraint=function(t){},t.prototype.hasVariable=function(t){return this._variables.has(t)},t.prototype.addVariable=function(t){if(!this._variables.has(t)){var e=Zp.clip(t.strength);if(e===Zp.Required)throw new Error("invalid variable strength");this.willAddVariable(t);var r=new $p(this,t,"eq",e);this.addConstraint(r);var i={constraint:r,tag:this._constraints.get(r),state:0};this._variables.set(t,i),this.didAddVariable(t);var n=t.state;isFinite(n)&&this.setVariable(t,n)}},t.prototype.willAddVariable=function(t){},t.prototype.didAddVariable=function(t){},t.prototype.removeVariable=function(t){var e=this._variables.remove(t);void 0!==e&&(this.willRemoveVariable(t),this.removeConstraint(e.constraint),this.didRemoveVariable(t))},t.prototype.willRemoveVariable=function(t){},t.prototype.didRemoveVariable=function(t){},t.prototype.setVariable=function(t,e){var r=this._variables.get(t);if(void 0===r)throw new Error("unknown variable");this.willSetVariable(t,e);var i=r.state;r.state=e;var n=e-i,o=r.tag.marker,s=this._rows.get(o);if(void 0!==s)return s.add(-n)<0&&this._infeasible.push(o),void this.dualOptimize();var u=r.tag.other;if(void 0!==(s=this._rows.get(u)))return s.add(n)<0&&this._infeasible.push(u),void this.dualOptimize();for(var a=0,h=this._rows.size;a<h;a+=1){var p=this._rows.getEntry(a),l=p[0],c=p[1],f=c.coefficientFor(o);0!==f&&c.add(n*f)<0&&!l.isExternal()&&this._infeasible.push(l)}this.dualOptimize(),this.didSetVariable(t,e,i)},t.prototype.willSetVariable=function(t,e){},t.prototype.didSetVariable=function(t,e,r){},t.prototype.updateVariables=function(){for(var t=0,e=this._rows.size;t<e;t+=1){var r=this._rows.getEntry(t),i=r[0],n=r[1];i instanceof Yp&&this.updateVariable(i,n._constant)}},t.prototype.updateVariable=function(t,e){this.willUpdateVariable(t,e);var r=t.value;t.updateValue(e),this.didUpdateVariable(t,e,r)},t.prototype.willUpdateVariable=function(t,e){},t.prototype.didUpdateVariable=function(t,e,r){},t.prototype.createRow=function(t){for(var e=t.constrain,r=new Jp(void 0,e.constant),i=e.terms,n=0,o=i.size;n<o;n+=1){var s=i.getEntry(n),u=s[0],a=s[1];if(null!==u&&Math.abs(a)>=1e-8){var h=this._rows.get(u);void 0!==h?r.insertRow(h,a):r.insertSymbol(u,a)}}var p=this._objective,l=t.relation,c=t.strength,f={marker:Np.Invalid,other:Np.Invalid};if("le"===l||"ge"===l){a="le"===l?1:-1;var d=new zp;if(f.marker=d,r.insertSymbol(d,a),c<Zp.Required){var y=new Wp;f.other=y,r.insertSymbol(y,-a),p.insertSymbol(y,c)}}else if(c<Zp.Required){var v=new Wp,_=new Wp;f.marker=v,f.other=_,r.insertSymbol(v,-1),r.insertSymbol(_,1),p.insertSymbol(v,c),p.insertSymbol(_,c)}else{var m=new jp;f.marker=m,r.insertSymbol(m)}return r._constant<0&&r.negate(),{row:r,tag:f}},t.prototype.chooseSubject=function(t,e){for(var r=0,i=t._cells.size;r<i;r+=1){var n=t._cells.getEntry(r)[0];if(n.isExternal())return n}return(e.marker instanceof zp||e.marker instanceof Wp)&&t.coefficientFor(e.marker)<0?e.marker:(e.other instanceof zp||e.other instanceof Wp)&&t.coefficientFor(e.other)<0?e.other:Np.Invalid},t.prototype.addWithArtificialVariable=function(t){var e=new zp;this._rows.set(e,t.clone()),this._artificial=t.clone(),this.optimize(this._artificial);var r=Math.abs(this._artificial._constant)<1e-8;this._artificial=null;var i=this._rows.remove(e);if(void 0!==i){if(i.isConstant())return r;var n=this.anyPivotableSymbol(i);if(n.isInvalid())return!1;i.solveForEx(e,n),this.substitute(n,i),this._rows.set(n,i)}for(var o=0,s=this._rows.size;o<s;o+=1)this._rows.getEntry(o)[1].removeSymbol(e);return this._objective.removeSymbol(e),r},t.prototype.substitute=function(t,e){for(var r=0,i=this._rows.size;r<i;r+=1){var n=this._rows.getEntry(r),o=n[0],s=n[1];s.substitute(t,e),s._constant<0&&!o.isExternal()&&this._infeasible.push(o)}this._objective.substitute(t,e),this._artificial&&this._artificial.substitute(t,e)},t.prototype.optimize=function(t){for(;;){var e=this.getEnteringSymbol(t);if(e.isInvalid())return;var r=this.getLeavingSymbol(e);if(r.isInvalid())throw new Error("objective is unbounded");var i=this._rows.remove(r);i.solveForEx(r,e),this.substitute(e,i),this._rows.set(e,i)}},t.prototype.dualOptimize=function(){for(var t;t=this._infeasible.pop();){var e=this._rows.get(t);if(void 0!==e&&e._constant<0){var r=this.getDualEnteringSymbol(e);if(r.isInvalid())throw new Error("dual optimize failed");this._rows.remove(t),e.solveForEx(t,r),this.substitute(r,e),this._rows.set(r,e)}}},t.prototype.getEnteringSymbol=function(t){for(var e=0,r=t._cells.size;e<r;e+=1){var i=t._cells.getEntry(e),n=i[0];if(i[1]<0&&!n.isDummy())return n}return Np.Invalid},t.prototype.getDualEnteringSymbol=function(t){for(var e=Number.MAX_VALUE,r=Np.Invalid,i=0,n=t._cells.size;i<n;i+=1){var o=t._cells.getEntry(i),s=o[0],u=o[1];if(u>0&&!s.isDummy()){var a=this._objective.coefficientFor(s)/u;a<e&&(e=a,r=s)}}return r},t.prototype.getLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=Np.Invalid,i=0,n=this._rows.size;i<n;i+=1){var o=this._rows.getEntry(i),s=o[0],u=o[1];if(!s.isExternal()){var a=u.coefficientFor(t);if(a<0){var h=-u._constant/a;h<e&&(e=h,r=s)}}}return r},t.prototype.getMarkerLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Np.Invalid,n=Np.Invalid,o=Np.Invalid,s=0,u=this._rows.size;s<u;s+=1){var a=this._rows.getEntry(s),h=a[0],p=a[1],l=p.coefficientFor(t);if(0!==l)if(h.isExternal())o=h;else if(l<0){(c=-p._constant/l)<e&&(e=c,i=h)}else{var c;(c=p._constant/l)<r&&(r=c,n=h)}}return i.isInvalid()?n.isInvalid()?o:n:i},t.prototype.removeConstraintEffects=function(t,e){e.marker instanceof Wp&&this.removeMarkerEffects(e.marker,t.strength),e.other instanceof Wp&&this.removeMarkerEffects(e.other,t.strength)},t.prototype.removeMarkerEffects=function(t,e){var r=this._rows.get(t);void 0!==r?this._objective.insertRow(r,-e):this._objective.insertSymbol(t,-e)},t.prototype.anyPivotableSymbol=function(t){for(var e=0,r=t._cells.size;e<r;e+=1){var i=t._cells.getEntry(e)[0];if(i instanceof zp||i instanceof Wp)return i}return Np.Invalid},t}(),el=function(){function t(){}return t.prototype.willSetKey=function(t){this.willObserve((function(e){e.viewWillSetKey&&e.viewWillSetKey(t,this)}))},t.prototype.onSetKey=function(t){},t.prototype.didSetKey=function(t){this.didObserve((function(e){e.viewDidSetKey&&e.viewDidSetKey(t,this)}))},t.prototype.willSetViewController=function(t){},t.prototype.onSetViewController=function(t){},t.prototype.didSetViewController=function(t){},t.prototype.willAddViewObserver=function(t){},t.prototype.onAddViewObserver=function(t){},t.prototype.didAddViewObserver=function(t){},t.prototype.willRemoveViewObserver=function(t){},t.prototype.onRemoveViewObserver=function(t){},t.prototype.didRemoveViewObserver=function(t){},t.prototype.willObserve=function(t){var e=this.viewController;e&&t.call(this,e);for(var r=this.viewObservers,i=0,n=r.length;i<n;i+=1)t.call(this,r[i])},t.prototype.didObserve=function(t){for(var e=this.viewObservers,r=0,i=e.length;r<i;r+=1)t.call(this,e[r]);var n=this.viewController;n&&t.call(this,n)},t.prototype.isMounted=function(){var t=this.parentView;return!!t&&t.isMounted()},Object.defineProperty(t.prototype,"viewport",{get:function(){var t=this.parentView;return t?t.viewport:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewIdiom",{get:function(){var t=this.parentView;return t?t.viewIdiom:"unspecified"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appView",{get:function(){var t=this.parentView;return t?t.appView:null},enumerable:!0,configurable:!0}),t.prototype.willSetParentView=function(t){this.willObserve((function(e){e.viewWillSetParentView&&e.viewWillSetParentView(t,this)}))},t.prototype.onSetParentView=function(t){t?t.isMounted()&&this.cascadeMount():this.cascadeUnmount()},t.prototype.didSetParentView=function(t){this.didObserve((function(e){e.viewDidSetParentView&&e.viewDidSetParentView(t,this)}))},t.prototype.getChildView=function(t){for(var e=this.childViews,r=e.length-1;r>=0;r-=1){var i=e[r];if(i.key()===t)return i}return null},t.prototype.willInsertChildView=function(t,e){this.willObserve((function(r){r.viewWillInsertChildView&&r.viewWillInsertChildView(t,e,this)}))},t.prototype.onInsertChildView=function(e,r){this.requireUpdate(t.NeedsLayout)},t.prototype.didInsertChildView=function(t,e){this.didObserve((function(r){r.viewDidInsertChildView&&r.viewDidInsertChildView(t,e,this)}))},t.prototype.willRemoveChildView=function(t){this.willObserve((function(e){e.viewWillRemoveChildView&&e.viewWillRemoveChildView(t,this)}))},t.prototype.onRemoveChildView=function(e){this.requireUpdate(t.NeedsLayout)},t.prototype.didRemoveChildView=function(t){this.didObserve((function(e){e.viewDidRemoveChildView&&e.viewDidRemoveChildView(t,this)}))},t.prototype.doMount=function(){this.willMount(),this.onMount(),this.didMount()},t.prototype.willMount=function(){this.willObserve((function(t){t.viewWillMount&&t.viewWillMount(this)}))},t.prototype.onMount=function(){},t.prototype.didMount=function(){this.didObserve((function(t){t.viewDidMount&&t.viewDidMount(this)}))},t.prototype.doUnmount=function(){this.willUnmount(),this.onUnmount(),this.didUnmount()},t.prototype.willUnmount=function(){this.willObserve((function(t){t.viewWillUnmount&&t.viewWillUnmount(this)}))},t.prototype.onUnmount=function(){},t.prototype.didUnmount=function(){this.didObserve((function(t){t.viewDidUnmount&&t.viewDidUnmount(this)}))},Object.defineProperty(t.prototype,"updateTime",{get:function(){var t=this.parentView;return t?t.updateTime:performance.now()},enumerable:!0,configurable:!0}),t.prototype.requireUpdate=function(t,e){void 0===e&&(e=!1);var r=this.updateFlags,i=r|t,n=i&~r;0!==n&&(this.setUpdateFlags(i),this.requestUpdate(n,e))},t.prototype.requestUpdate=function(t,e){var r=this.parentView;r&&r.requestUpdate(t,e)},t.prototype.needsUpdate=function(t,e){return t},t.prototype.willUpdate=function(t){this.willObserve((function(e){e.viewWillUpdate&&e.viewWillUpdate(t,this)}))},t.prototype.onUpdate=function(t){},t.prototype.didUpdate=function(t){this.didObserve((function(e){e.viewDidUpdate&&e.viewDidUpdate(t,this)}))},t.prototype.doCompute=function(t){this.willCompute(t),this.onCompute(t),this.didCompute(t)},t.prototype.willCompute=function(t){this.willObserve((function(e){e.viewWillCompute&&e.viewWillCompute(t,this)}))},t.prototype.onCompute=function(t){},t.prototype.didCompute=function(t){this.didObserve((function(e){e.viewDidCompute&&e.viewDidCompute(t,this)}))},t.prototype.doLayout=function(t){this.willLayout(t),this.onLayout(t),this.didLayout(t)},t.prototype.willLayout=function(t){this.willObserve((function(e){e.viewWillLayout&&e.viewWillLayout(t,this)}))},t.prototype.onLayout=function(t){},t.prototype.didLayout=function(t){this.didObserve((function(e){e.viewDidLayout&&e.viewDidLayout(t,this)}))},t.prototype.doScroll=function(t){this.willScroll(t),this.onScroll(t),this.didScroll(t)},t.prototype.willScroll=function(t){this.willObserve((function(e){e.viewWillScroll&&e.viewWillScroll(t,this)}))},t.prototype.onScroll=function(t){},t.prototype.didScroll=function(t){this.didObserve((function(e){e.viewDidScroll&&e.viewDidScroll(t,this)}))},t.prototype.doUpdateChildViews=function(t,e){this.willUpdateChildViews(e);for(var r=this.childViews,i=0;i<r.length;i+=1){var n=r[i],o=this.childViewContext(n,e);n.cascadeUpdate(t,o)}this.didUpdateChildViews(e)},t.prototype.willUpdateChildViews=function(t){this.willObserve((function(e){e.viewWillUpdateChildViews&&e.viewWillUpdateChildViews(t,this)}))},t.prototype.didUpdateChildViews=function(t){this.didObserve((function(e){e.viewDidUpdateChildViews&&e.viewDidUpdateChildViews(t,this)}))},t.prototype.childViewContext=function(t,e){return e},t.prototype.didSetViewScope=function(e,r,i){this.requireUpdate(t.NeedsCompute)},Object.defineProperty(t.prototype,"pageTransform",{get:function(){var t=this.parentView;return t?t.pageTransform.transform(this.parentTransform):_a.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageBounds",{get:function(){var t=this.clientBounds,e=this.clientTransform;return t.transform(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popoverBounds",{get:function(){return this.pageBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientTransform",{get:function(){var t,e=window.pageXOffset,r=window.pageYOffset;t=0!==e||0!==r?_a.translate(e,r):_a.identity();var i=this.pageTransform;return t.transform(i)},enumerable:!0,configurable:!0}),t.prototype.isVisible=function(){var t=this.clientBounds,e=document.documentElement.clientWidth,r=document.documentElement.clientHeight;return(t.top<=0&&0<t.bottom||0<=t.top&&t.top<r)&&(t.left<=0&&0<t.right||0<=t.left&&t.left<e)},t.fromNode=function(e){return e.view instanceof t?e.view:e instanceof Element?e instanceof HTMLElement?e instanceof HTMLCanvasElement?new t.Canvas(e):new t.Html(e):e instanceof SVGElement?new t.Svg(e):new t.Element(e):e instanceof Text?new t.Text(e):new t.Node(e)},t.create=function(e,r){if("string"==typeof e)return"svg"===e?new t.Svg(document.createElementNS(t.Svg.NS,e)):"canvas"===e?new t.Canvas(document.createElement(e)):t.fromNode(document.createElement(e));if("function"==typeof e){var i=e.NS,n=void 0;return n=new e(void 0===i?document.createElement(e.tag):document.createElementNS(i,e.tag)),void 0!==r&&(n=n.key(r)),n}throw new TypeError(""+e)},t.decorateMemberAnimator=function(t,e,r,i){var n,o,s;e&&(n=e.value,void 0!==e.transition&&null!==e.transition&&(o=tp.fromAny(e.transition)),"string"==typeof e.inherit?s=e.inherit:!0===e.inherit&&(s=i)),Object.defineProperty(r,i,{get:function(){var e=new t(this,n,o,s);return Object.defineProperty(e,"name",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,i,{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0})},t.decorateLayoutAnchor=function(t,e,r,i){var n,o;n=e&&void 0!==e.value?e.value:NaN,o=e&&void 0!==e.strength&&null!==e.strength?Zp.fromAny(e.strength):Zp.Strong;var s=!!e&&!!e.enabled,u=e?e.get:void 0,a=e?e.set:void 0;Object.defineProperty(r,i,{get:function(){var e=new t(this,i,n,o,s);return e.getState=u,e.setValue=a,Object.defineProperty(this,i,{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0})},t.decorateViewScope=function(t,e,r,i){var n,o;e&&(n=e.state,"string"==typeof e.inherit?o=e.inherit:!0===e.inherit&&(o=i)),Object.defineProperty(r,i,{get:function(){var e=new t(this,i,n,o);return Object.defineProperty(this,i,{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0})},t.NeedsCompute=1,t.NeedsAnimate=2,t.NeedsLayout=4,t.NeedsScroll=8,t.NeedsRender=16,t.UpdateFlagsMask=31,t}(),rl=function(t){var e=function(r,i,n,o){if(this instanceof e){void 0===n&&(n=null),void 0===o&&(o=null);var s=t.call(this,i,n)||this;return s._view=r,s._inherit=o,s}var u=r,a=i;if(u===Object)return el.decorateMemberAnimator.bind(void 0,e.Object,a);if(u===String)return el.decorateMemberAnimator.bind(void 0,e.String,a);if(u===Boolean)return el.decorateMemberAnimator.bind(void 0,e.Boolean,a);if(u===Number)return el.decorateMemberAnimator.bind(void 0,e.Number,a);if(u===Nu)return el.decorateMemberAnimator.bind(void 0,e.Angle,a);if(u===Hu)return el.decorateMemberAnimator.bind(void 0,e.Length,a);if(u===ta)return el.decorateMemberAnimator.bind(void 0,e.Color,a);if(u===da)return el.decorateMemberAnimator.bind(void 0,e.Font,a);if(u===_a)return el.decorateMemberAnimator.bind(void 0,e.Transform,a);if(d.is(u))return el.decorateMemberAnimator.bind(void 0,e.Any.bind(void 0,u),a);throw new TypeError(""+u)};return _(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inherit",{get:function(){return this._inherit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this._inherit;if(null!==e)for(var r=this._view.parentView;r;){var i=r[e];if(i instanceof sp){t=i.value;break}r=r.parentView}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var t=this._state;if(void 0===t){var e=this._inherit;if(null!==e)for(var r=this._view.parentView;r;){var i=r[e];if(i instanceof sp){t=i.state;break}r=r.parentView}}return t},enumerable:!0,configurable:!0}),e.prototype.animate=function(t){void 0===t&&(t=this),this._disabled&&t===this||this._view.animate(t)},e.prototype.cancel=function(){},e.prototype.update=function(t,e){},e.prototype.delete=function(){},e}(sp),il=function(t){var e=function(e,r,i,n,o){var s=function(t,e){return void 0===t?s.value:(null!==t&&(t=s._type.fromAny(t)),s.setState(t,e),s._view)};return s.__proto__=this,null!=i&&(i=e.fromAny(i)),(s=t.call(s,r,i,n,o)||s)._type=e,s};return _(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e}(rl);rl.Any=il;var nl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Object=nl;var ol=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.String=ol;var sl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:("string"==typeof t&&(t=!!t),o.setState(t,e),o._view)};return o.__proto__=this,"string"==typeof r&&(r=!!r),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Boolean=sl;var ul=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:("string"==typeof t&&(t=+t),o.setState(t,e),o._view)};return o.__proto__=this,"string"==typeof r&&(r=+r),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Number=ul;var al=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=Nu.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,null!=r&&(r=Nu.fromAny(r)),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Angle=al;var hl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=Hu.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,null!=r&&(r=Hu.fromAny(r)),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Length=hl;var pl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=ta.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,null!=r&&(r=ta.fromAny(r)),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Color=pl;var ll=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=da.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,null!=r&&(r=da.fromAny(r)),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Font=ll;var cl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=_a.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,null!=r&&(r=_a.fromAny(r)),o=t.call(o,e,r,i,n)||o};return _(e,t),e}(rl);rl.Transform=cl;var fl=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this)||this;return i._node=e,i._node.view=i,i._key=r,i._viewController=null,i._viewObservers=[],i._updateFlags=0,i.initNode(i._node),i}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},e.prototype.key=function(t){return void 0===t?this._key:(this.willSetKey(t),this._key=t,this.onSetKey(t),this.didSetKey(t),this)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.setViewController=function(t){this._viewController!==t&&(this.willSetViewController(t),this._viewController&&this._viewController.setView&&this._viewController.setView(null),this._viewController=t,this._viewController&&this._viewController.setView&&this._viewController.setView(this),this.onSetViewController(t),this.didSetViewController(t))},Object.defineProperty(e.prototype,"viewObservers",{get:function(){return this._viewObservers},enumerable:!0,configurable:!0}),e.prototype.addViewObserver=function(t){var e=this._viewObservers;e.indexOf(t)<0&&(this.willAddViewObserver(t),e.push(t),this.onAddViewObserver(t),this.didAddViewObserver(t))},e.prototype.removeViewObserver=function(t){var e=this._viewObservers,r=e.indexOf(t);r>=0&&(this.willRemoveViewObserver(t),e.splice(r,1),this.onRemoveViewObserver(t),this.didRemoveViewObserver(t))},e.prototype.isMounted=function(){for(var t=this._node;;){var e=t.parentNode;if(!e)break;if(e.nodeType===Node.DOCUMENT_NODE)return!0;t=e}return!1},Object.defineProperty(e.prototype,"parentView",{get:function(){var t=this._node.parentNode;if(t){var e=t.view;if(e instanceof el)return e}return null},enumerable:!0,configurable:!0}),e.prototype.setParentView=function(t){this.willSetParentView(t),this.onSetParentView(t),this.didSetParentView(t)},Object.defineProperty(e.prototype,"childViews",{get:function(){for(var t=this._node.childNodes,e=[],r=0,i=t.length;r<i;r+=1){var n=t[r].view;n&&e.push(n)}return e},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._node.childNodes,r=e.length-1;r>=0;r-=1){var i=e[r].view;if(i&&i.key()===t)return i}return null},e.prototype.setChildView=function(t,r){if(null!==r&&!(r instanceof e))throw new TypeError(""+r);for(var i=null,n=null,o=this._node.childNodes,s=o.length-1;s>=0;s-=1){var u=o[s].view;if(u&&u.key()===t){i=u,n=o[s+1]||null,this.removeChildView(u);break}}return r&&(r.key(t),this.insertChild(r,n)),i},e.prototype.appendChild=function(t){if(t instanceof el)this.appendChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.appendChildNode(t)}},e.prototype.appendChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var r=t._node;this.willInsertChildView(t,null),this.willInsertChildNode(r,null),this._node.appendChild(r),t.setParentView(this),this.onInsertChildNode(r,null),this.onInsertChildView(t,null),this.didInsertChildNode(r,null),this.didInsertChildView(t,null)},e.prototype.appendChildNode=function(t){var e=t.view;void 0!==e&&this.willInsertChildView(e,null),this.willInsertChildNode(t,null),this._node.appendChild(t),void 0!==e&&e.setParentView(this),this.onInsertChildNode(t,null),void 0!==e&&this.onInsertChildView(e,null),this.didInsertChildNode(t,null),void 0!==e&&this.didInsertChildView(e,null)},e.prototype.prependChild=function(t){if(t instanceof el)this.prependChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.prependChildNode(t)}},e.prototype.prependChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var r=t._node,i=this._node.firstChild,n=i?i.view:null;this.willInsertChildView(t,n),this.willInsertChildNode(r,i),this._node.insertBefore(r,i),t.setParentView(this),this.onInsertChildNode(r,i),this.onInsertChildView(t,n),this.didInsertChildNode(r,i),this.didInsertChildView(t,n)},e.prototype.prependChildNode=function(t){var e=t.view,r=this._node.firstChild,i=r?r.view:null;void 0!==e&&this.willInsertChildView(e,i),this.willInsertChildNode(t,r),this._node.insertBefore(t,r),void 0!==e&&e.setParentView(this),this.onInsertChildNode(t,r),void 0!==e&&this.onInsertChildView(e,i),this.didInsertChildNode(t,r),void 0!==e&&this.didInsertChildView(e,i)},e.prototype.insertChild=function(t,r){if(t instanceof e)if(r instanceof el)this.insertChildView(t,r);else{if(!(r instanceof Node||null===r))throw new TypeError(""+r);this.insertChildNode(t._node,r)}else{if(!(t instanceof Node))throw new TypeError(""+t);if(r instanceof e)this.insertChildNode(t,r._node);else{if(!(r instanceof Node||null===r))throw new TypeError(""+r);this.insertChildNode(t,r)}}},e.prototype.insertChildView=function(t,r){if(!(t instanceof e))throw new TypeError(""+t);if(null!==r&&!(r instanceof e))throw new TypeError(""+r);var i=t._node,n=r?r._node:null;this.willInsertChildView(t,r),this.willInsertChildNode(i,n),this._node.insertBefore(i,n),t.setParentView(this),this.onInsertChildNode(i,n),this.onInsertChildView(t,r),this.didInsertChildNode(i,n),this.didInsertChildView(t,r)},e.prototype.insertChildNode=function(t,e){var r=t.view,i=e?e.view:null;void 0!==r&&this.willInsertChildView(r,i),this.willInsertChildNode(t,e),this._node.insertBefore(t,e),void 0!==r&&r.setParentView(this),this.onInsertChildNode(t,e),void 0!==r&&this.onInsertChildView(r,i),this.didInsertChildNode(t,e),void 0!==r&&this.didInsertChildView(r,i)},e.prototype.injectChildView=function(t,e){var r=t._node,i=e?e._node:null;this.willInsertChildView(t,e),this.willInsertChildNode(r,i),t.setParentView(this),this.onInsertChildNode(r,i),this.onInsertChildView(t,e),this.didInsertChildNode(r,i),this.didInsertChildView(t,e)},e.prototype.willInsertChildNode=function(t,e){this.willObserve((function(r){r.viewWillInsertChildNode&&r.viewWillInsertChildNode(t,e,this)}))},e.prototype.onInsertChildNode=function(t,e){this.requireUpdate(el.NeedsLayout)},e.prototype.didInsertChildNode=function(t,e){this.didObserve((function(r){r.viewDidInsertChildNode&&r.viewDidInsertChildNode(t,e,this)}))},e.prototype.removeChild=function(t){if(t instanceof el)this.removeChildView(t);else{if(!(t instanceof Node))throw new TypeError(""+t);this.removeChildNode(t)}},e.prototype.removeChildView=function(t){if(!(t instanceof e))throw new TypeError(""+t);var r=t._node;this.willRemoveChildView(t),this.willRemoveChildNode(r),t.setParentView(null),this._node.removeChild(r),this.onRemoveChildNode(r),this.onRemoveChildView(t),this.didRemoveChildNode(r),this.didRemoveChildView(t)},e.prototype.removeChildNode=function(t){var e=t.view;void 0!==e&&this.willRemoveChildView(e),this.willRemoveChildNode(t),this._node.removeChild(t),void 0!==e&&e.setParentView(null),this.onRemoveChildNode(t),void 0!==e&&this.onRemoveChildView(e),this.didRemoveChildNode(t),void 0!==e&&this.didRemoveChildView(e)},e.prototype.removeAll=function(){for(;;){var t=this._node.lastChild;if(!t)break;var e=t.view;void 0!==e&&this.willRemoveChildView(e),this.willRemoveChildNode(t),this._node.removeChild(t),void 0!==e&&e.setParentView(null),this.onRemoveChildNode(t),void 0!==e&&this.onRemoveChildView(e),this.didRemoveChildNode(t),void 0!==e&&this.didRemoveChildView(e)}},e.prototype.remove=function(){var t=this._node,e=t.parentNode;if(e){var r=e.view;r?r.removeChildView(this):(e.removeChild(t),this.setParentView(null))}},e.prototype.willRemoveChildNode=function(t){this.willObserve((function(e){e.viewWillRemoveChildNode&&e.viewWillRemoveChildNode(t,this)}))},e.prototype.onRemoveChildNode=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didRemoveChildNode=function(t){this.didObserve((function(e){e.viewDidRemoveChildNode&&e.viewDidRemoveChildNode(t,this)}))},e.prototype.text=function(t){return void 0===t?this._node.textContent:(this._node.textContent=t,this)},e.prototype.cascadeMount=function(){this.doMountChildViews(),this.doMount()},e.prototype.doMountChildViews=function(){for(var t=this._node.childNodes,e=0;e<t.length;e+=1){var r=t[e].view;r&&r.cascadeMount()}},e.prototype.cascadeUnmount=function(){this._updateFlags=0,this.doUnmountChildViews(),this.doUnmount()},e.prototype.doUnmountChildViews=function(){for(var t=this._node.childNodes,e=0;e<t.length;e+=1){var r=t[e].view;r&&r.cascadeUnmount()}},Object.defineProperty(e.prototype,"updateFlags",{get:function(){return this._updateFlags},enumerable:!0,configurable:!0}),e.prototype.setUpdateFlags=function(t){this._updateFlags=t},e.prototype.cascadeUpdate=function(t,e){t|=this.updateFlags,t=this.needsUpdate(t,e),this.doUpdate(t,e)},e.prototype.doUpdate=function(t,e){this.willUpdate(e),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(e)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(e)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(e)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(e)),this.onUpdate(e),this.doUpdateChildViews(t,e),this.didUpdate(e)},e.prototype.doAnimate=function(t){this.willAnimate(t),this.onAnimate(t),this.didAnimate(t)},e.prototype.willAnimate=function(t){this.willObserve((function(e){e.viewWillAnimate&&e.viewWillAnimate(t,this)}))},e.prototype.onAnimate=function(t){},e.prototype.didAnimate=function(t){this.didObserve((function(e){e.viewDidAnimate&&e.viewDidAnimate(t,this)}))},e.prototype.doUpdateChildViews=function(t,e){this.willUpdateChildViews(e);for(var r=this._node.childNodes,i=0;i<r.length;i+=1){var n=r[i].view;n&&n.cascadeUpdate(t,e)}this.didUpdateChildViews(e)},e.prototype.animate=function(t){this.requireUpdate(el.NeedsAnimate)},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return _a.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=document.createRange();t.selectNode(this._node);var e=t.getBoundingClientRect();return t.detach(),new uo(e.left,e.top,e.right,e.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBounds",{get:function(){var t=document.createRange();t.selectNode(this._node);var e=t.getBoundingClientRect();t.detach();var r=window.pageXOffset,i=window.pageYOffset;return new uo(e.left+r,e.top+i,e.right+r,e.bottom+i)},enumerable:!0,configurable:!0}),e.prototype.dispatchEvent=function(t){return this._node.dispatchEvent(t)},e.prototype.on=function(t,e,r){return this._node.addEventListener(t,e,r),this},e.prototype.off=function(t,e,r){return this._node.removeEventListener(t,e,r),this},e}(el);el.Node=fl;var dl=function(t){function e(e,r){return void 0===r&&(r=null),t.call(this,e,r)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.getAttribute=function(t){return this._node.getAttribute(t)},e.prototype.setAttribute=function(t,e){return this.willSetAttribute(t,e),null!==e?this._node.setAttribute(t,Vp(e)):this._node.removeAttribute(t),this.onSetAttribute(t,e),this.didSetAttribute(t,e),this},e.prototype.willSetAttribute=function(t,e){this.willObserve((function(r){r.viewWillSetAttribute&&r.viewWillSetAttribute(t,e,this)}))},e.prototype.onSetAttribute=function(t,e){},e.prototype.didSetAttribute=function(t,e){this.didObserve((function(r){r.viewDidSetAttribute&&r.viewDidSetAttribute(t,e,this)}))},e.prototype.setStyle=function(t,e,r){return this.willSetStyle(t,e,r),null!==e?this._node.style.setProperty(t,Pp(e),r):this._node.style.removeProperty(t),this.onSetStyle(t,e,r),this.didSetStyle(t,e,r),this},e.prototype.willSetStyle=function(t,e,r){this.willObserve((function(i){i.viewWillSetStyle&&i.viewWillSetStyle(t,e,r,this)}))},e.prototype.onSetStyle=function(t,e,r){},e.prototype.didSetStyle=function(t,e,r){this.didObserve((function(i){i.viewDidSetStyle&&i.viewDidSetStyle(t,e,r,this)}))},e.prototype.id=function(t){return void 0===t?this.getAttribute("id"):(this.setAttribute("id",t),this)},e.prototype.className=function(t){return void 0===t?this.getAttribute("class"):(this.setAttribute("class",t),this)},Object.defineProperty(e.prototype,"classList",{get:function(){return this._node.classList},enumerable:!0,configurable:!0}),e.prototype.hasClass=function(t){return this._node.classList.contains(t)},e.prototype.addClass=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._node.classList,i=0,n=t.length;i<n;i+=1)r.add(t[i]);return this},e.prototype.removeClass=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._node.classList,i=0,n=t.length;i<n;i+=1)r.remove(t[i]);return this},e.prototype.toggleClass=function(t,e){var r=this._node.classList;return void 0===e?r.toggle(t):!0===e?r.add(t):!1===e&&r.remove(t),this},Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=this._node.getBoundingClientRect();return new uo(t.left,t.top,t.right,t.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageBounds",{get:function(){var t=this._node.getBoundingClientRect(),e=window.pageXOffset,r=window.pageYOffset;return new uo(t.left+e,t.top+r,t.right+e,t.bottom+r)},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,r){return this._node.addEventListener(t,e,r),this},e.prototype.off=function(t,e,r){return this._node.removeEventListener(t,e,r),this},e.decorateAttributeAnimator=function(t,e,r,i){Object.defineProperty(r,i,{get:function(){var r=new t(this,e);return Object.defineProperty(r,"name",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,i,{value:r,configurable:!0,enumerable:!0}),r},configurable:!0,enumerable:!0})},e.decorateStyleAnimator=function(t,e,r,i){Object.defineProperty(r,i,{get:function(){var r=new t(this,e);return Object.defineProperty(r,"name",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,i,{value:r,configurable:!0,enumerable:!0}),r},configurable:!0,enumerable:!0})},e}(fl);el.Element=dl;var yl=function(t){var e=function(r,i,n,o){if(this instanceof e){void 0===o&&(o=null);var s=t.call(this,n,o)||this;return s._view=r,s._name=i,s}var u=i;if(i=r,u===String)return dl.decorateAttributeAnimator.bind(void 0,e.String,i);if(u===Boolean)return dl.decorateAttributeAnimator.bind(void 0,e.Boolean,i);if(u===Number)return dl.decorateAttributeAnimator.bind(void 0,e.Number,i);if(u===Hu)return dl.decorateAttributeAnimator.bind(void 0,e.Length,i);if(u===ta)return dl.decorateAttributeAnimator.bind(void 0,e.Color,i);if(u===_a)return dl.decorateAttributeAnimator.bind(void 0,e.Transform,i);if(Array.isArray(u)&&2===u.length){var a=u[0],h=u[1];if(a===Number&&h===String)return dl.decorateAttributeAnimator.bind(void 0,e.NumberOrString,i);if(a===Hu&&h===String)return dl.decorateAttributeAnimator.bind(void 0,e.LengthOrString,i);if(a===ta&&h===String)return dl.decorateAttributeAnimator.bind(void 0,e.ColorOrString,i)}throw new TypeError(""+u)};return _(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._view._node},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeValue",{get:function(){return this._view._node.getAttribute(this._name)},enumerable:!0,configurable:!0}),e.prototype.update=function(t,e){f.equal(e,t)||(this.willUpdate(t,e),this._view.setAttribute(this._name,t),this.didUpdate(t,e))},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){this._view.setAttribute(this._name,null)},e}(up),vl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=e)}return t},enumerable:!0,configurable:!0}),e}(yl);yl.String=vl;var _l=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:("string"==typeof t&&(t=!!t),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=!!e)}return t},enumerable:!0,configurable:!0}),e}(yl);yl.Boolean=_l;var ml=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:("string"==typeof t&&(t=+t),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=+e)}return t},enumerable:!0,configurable:!0}),e}(yl);yl.Number=ml;var wl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=Hu.fromAny(t,o._view._node)),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=Hu.parse(e,this._view._node)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(yl);yl.Length=wl;var gl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=ta.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=ta.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(yl);yl.Color=gl;var bl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:(null!==t&&(t=_a.fromAny(t)),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=_a.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(yl);yl.Transform=bl;var xl=function(t){var e=function(e,r,i,n){var o=function(t,e){return void 0===t?o.value:("string"==typeof t&&isFinite(+t)&&(t=+t),o.setState(t,e),o._view)};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;e&&(t=isFinite(+e)?+e:e)}return t},enumerable:!0,configurable:!0}),e}(yl);yl.NumberOrString=xl;var Cl=function(t){var e=function(e,r,i,n){var o=function(t,e){if(void 0===t)return o.value;if(null!==t)if("string"==typeof t)try{t=Hu.parse(t,o._view._node)}catch(t){}else t=Hu.fromAny(t,o._view._node);return o.setState(t,e),o._view};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=Hu.parse(e,this._view._node)}catch(r){t=e}}return t},enumerable:!0,configurable:!0}),e}(yl);yl.LengthOrString=Cl;var Sl=function(t){var e=function(e,r,i,n){var o=function(t,e){if(void 0===t)return o.value;if(null!==t)if("string"==typeof t)try{t=ta.parse(t)}catch(t){}else t=ta.fromAny(t);return o.setState(t,e),o._view};return o.__proto__=this,o=t.call(o,e,r,i,n)||o};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.attributeValue;if(e)try{t=ta.parse(e)}catch(r){t=e}}return t},enumerable:!0,configurable:!0}),e}(yl);yl.ColorOrString=Sl;var Al=function(t){var e=function(r,i,n,o,s){if(this instanceof e){void 0===o&&(o=null);var u=t.call(this,n,o)||this;return u._view=r,u._names=i,u._priority=s,u}var a=i;if(i=r,a===String)return dl.decorateStyleAnimator.bind(void 0,e.String,i);if(a===Number)return dl.decorateStyleAnimator.bind(void 0,e.Number,i);if(a===Hu)return dl.decorateStyleAnimator.bind(void 0,e.Length,i);if(a===ta)return dl.decorateStyleAnimator.bind(void 0,e.Color,i);if(a===la)return dl.decorateStyleAnimator.bind(void 0,e.LineHeight,i);if(a===ca)return dl.decorateStyleAnimator.bind(void 0,e.FontFamily,i);if(a===_a)return dl.decorateStyleAnimator.bind(void 0,e.Transform,i);if(a===xp)return dl.decorateStyleAnimator.bind(void 0,e.BoxShadow,i);if(Array.isArray(a)&&2===a.length){var h=a[0],p=a[1];if(h===Number&&p===String)return dl.decorateStyleAnimator.bind(void 0,e.NumberOrString,i);if(h===Hu&&p===String)return dl.decorateStyleAnimator.bind(void 0,e.LengthOrString,i);if(h===ta&&p===String)return dl.decorateStyleAnimator.bind(void 0,e.ColorOrString,i)}throw new TypeError(""+a)};return _(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"node",{get:function(){return this._view._node},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"names",{get:function(){return this._names},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},set:function(t){this._priority=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyValue",{get:function(){var t=this._view._node.style,e=this._names;if("string"==typeof e)return t.getPropertyValue(e);for(var r=0,i=e.length;r<i;r+=1){var n=t.getPropertyValue(e[r]);if(n)return n}return""},enumerable:!0,configurable:!0}),e.prototype.setState=function(e,r,i){"string"==typeof i?this.priority=i:null===i&&(this.priority=void 0),t.prototype.setState.call(this,e,r)},e.prototype.update=function(t,e){if(!f.equal(e,t)){this.willUpdate(t,e);var r=this._names;if("string"==typeof r)this._view.setStyle(r,t,this.priority);else for(var i=0,n=r.length;i<n;i+=1)this._view.setStyle(r[i],t,this.priority);this.didUpdate(t,e)}},e.prototype.willUpdate=function(t,e){},e.prototype.didUpdate=function(t,e){},e.prototype.delete=function(){var t=this._names;if("string"==typeof t)this._view.setStyle(t,null);else for(var e=0,r=t.length;e<r;e+=1)this._view.setStyle(t[e],null)},e}(up),kl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=e)}return t},enumerable:!0,configurable:!0}),e}(Al);Al.String=kl;var El=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:("string"==typeof t&&(t=+t),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=+e)}return t},enumerable:!0,configurable:!0}),e}(Al);Al.Number=El;var Ol=function(t){var e=function(e,r,i,n,o){var s=function(t,r,i){return void 0===t?s.value:(null!==t&&(t=Hu.fromAny(t,e._node)),s.setState(t,r,i),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=Hu.parse(e,this._view._node)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.Length=Ol;var Vl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(null!==t&&(t=ta.fromAny(t)),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=ta.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.Color=Vl;var Pl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(null!==t&&(t=la.fromAny(t)),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=la.fromAny(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.LineHeight=Pl;var Dl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(null!==t&&(t=da.family(t).family()),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=da.parse(e).family()}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.FontFamily=Dl;var Ml=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(null!==t&&(t=_a.fromAny(t)),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=_a.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.Transform=Ml;var Tl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:(null!==t&&(t=xp.fromAny(t)),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=xp.parse(e)}catch(t){}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.BoxShadow=Tl;var Rl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){return void 0===t?s.value:("string"==typeof t&&isFinite(+t)&&(t=+t),s.setState(t,e,r),s._view)};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;e&&(t=isFinite(+e)?+e:e)}return t},enumerable:!0,configurable:!0}),e}(Al);Al.NumberOrString=Rl;var Il=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){if(void 0===t)return s.value;if(null!==t)if("string"==typeof t)try{t=Hu.parse(t,s._view._node)}catch(t){}else t=Hu.fromAny(t,s._view._node);return s.setState(t,e,r),s._view};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=Hu.parse(e,this._view._node)}catch(r){t=e}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.LengthOrString=Il;var Fl=function(t){var e=function(e,r,i,n,o){var s=function(t,e,r){if(void 0===t)return s.value;if(null!==t)if("string"==typeof t)try{t=ta.parse(t)}catch(t){}else t=ta.fromAny(t);return s.setState(t,e,r),s._view};return s.__proto__=this,s=t.call(s,e,r,i,n,o)||s};return _(e,t),Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;if(void 0===t){var e=this.propertyValue;if(e)try{t=ta.parse(e)}catch(r){t=e}}return t},enumerable:!0,configurable:!0}),e}(Al);Al.ColorOrString=Fl;var Ll={is:function(t){return!("object"!=typeof t||!t)&&"function"==typeof t.updateVariables}},Ul={is:function(t){return!("object"!=typeof t||!t)&&"function"==typeof t.setVariable}},Nl=function(t){function e(e){var r=t.call(this)||this;return r._manager=e,r}return _(e,t),Object.defineProperty(e.prototype,"manager",{get:function(){return this._manager},enumerable:!0,configurable:!0}),e.prototype.didAddConstraint=function(t){this._manager.didAddConstraint(t)},e.prototype.didRemoveConstraint=function(t){this._manager.didRemoveConstraint(t)},e.prototype.didAddVariable=function(t){this._manager.didAddVariable(t)},e.prototype.didRemoveVariable=function(t){this._manager.didRemoveVariable(t)},e}(tl),zl=function(t){var e=function(r,i,n,o,s){if(this instanceof e){var u=function(t){return void 0===t?u.state:(u.enabled(!0).setState(t),u._scope)};return u.__proto__=this,void 0===s&&(s=!1),(u=t.call(u,r,i,n,o)||u)._enabled=s,u}var a=r;return el.decorateLayoutAnchor.bind(void 0,e,a)};return _(e,t),e.prototype.enabled=function(t){return void 0===t?this._enabled:(this._enabled=t,this)},e.prototype.updateValue=function(t){if(this._value!==t&&(this._value=t,this._enabled)){var e=this.setValue;e&&e.call(this._scope,t)}},e.prototype.updateState=function(){if(!this._enabled){var t=this.getState;if(t){var e=this._state,r=t.call(this._scope,e);this.setState(r)}}},e}(Qp),jl=function(t){var e=function(r,i,n,o){if(this instanceof e){var s=function(t){return void 0===t?s.state:(s.setState(t),s._view)};return s.__proto__=this,void 0===n&&(n=null),void 0===o&&(o=null),(s=t.call(s)||s)._view=r,Object.defineProperty(s,"name",{value:i,enumerable:!0,configurable:!0}),s._state=n,s._inherit=o,s}var u=r;return el.decorateViewScope.bind(void 0,e,u)};return _(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var t=this._state;if(null===t){var r=this._inherit;if(null!==r)for(var i=this._view.parentView;i;){var n=i[r];if(n instanceof e){t=n.state;break}i=i.parentView}}return t},enumerable:!0,configurable:!0}),e.prototype.setState=function(t){var e=this._state;f.equal(e,t)||(this._state=t,this._view.didSetViewScope(this,t,e))},Object.defineProperty(e.prototype,"inherit",{get:function(){return this._inherit},enumerable:!0,configurable:!0}),e}(Object),Wl=function(){function t(){this._view=null}return Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!0}),t.prototype.setView=function(t){this.willSetView(t),this._view=t,this.onSetView(t),this.didSetView(t)},t.prototype.willSetView=function(t){},t.prototype.onSetView=function(t){},t.prototype.didSetView=function(t){},t.prototype.key=function(){var t=this._view;return t?t.key():null},t.prototype.viewWillSetKey=function(t,e){},t.prototype.viewDidSetKey=function(t,e){},t.prototype.isMounted=function(){var t=this._view;return!!t&&t.isMounted()},Object.defineProperty(t.prototype,"viewport",{get:function(){var t=this._view;return t?t.viewport:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewIdiom",{get:function(){var t=this._view;return t?t.viewIdiom:"unspecified"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appView",{get:function(){var t=this._view;return t?t.appView:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appViewController",{get:function(){var t=this.appView;return t?t.viewController:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentView",{get:function(){var t=this._view;return t?t.parentView:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentViewController",{get:function(){var t=this.parentView;return t?t.viewController:null},enumerable:!0,configurable:!0}),t.prototype.viewWillSetParentView=function(t,e){},t.prototype.viewDidSetParentView=function(t,e){},Object.defineProperty(t.prototype,"childViews",{get:function(){var t=this._view;return t?t.childViews:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childViewControllers",{get:function(){return this.childViews.map((function(t){return t.viewController}))},enumerable:!0,configurable:!0}),t.prototype.getChildView=function(t){var e=this._view;return e?e.getChildView(t):null},t.prototype.getChildViewController=function(t){var e=this.getChildView(t);return e?e.viewController:null},t.prototype.setChildView=function(t,e){var r=this._view;if(r)return r.setChildView(t,e);throw new Error("no view")},t.prototype.setChildViewController=function(t,e){var r=e?e.view:null;if(void 0!==r){var i=this.setChildView(t,r);return i?i.viewController:null}throw new Error("no view")},t.prototype.appendChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.appendChildView(t)},t.prototype.appendChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.appendChildView(e)},t.prototype.prependChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.prependChildView(t)},t.prototype.prependChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.prependChildView(e)},t.prototype.insertChildView=function(t,e){var r=this._view;if(!r)throw new Error("no view");r.insertChildView(t,e)},t.prototype.insertChildViewController=function(t,e){var r,i=t.view;if(r=!e||e instanceof el?e:e.view,!i||void 0===r)throw new Error("no view");this.insertChildView(i,r)},t.prototype.viewWillInsertChildView=function(t,e,r){},t.prototype.viewDidInsertChildView=function(t,e,r){},t.prototype.removeChildView=function(t){var e=this._view;if(!e)throw new Error("no view");e.removeChildView(t)},t.prototype.removeChildViewController=function(t){var e=t.view;if(!e)throw new Error("no view");this.removeChildView(e)},t.prototype.removeAll=function(){var t=this._view;if(!t)throw new Error("no view");t.removeAll()},t.prototype.remove=function(){var t=this._view;if(!t)throw new Error("no view");t.remove()},t.prototype.viewWillRemoveChildView=function(t,e){},t.prototype.viewDidRemoveChildView=function(t,e){},t.prototype.viewWillMount=function(t){},t.prototype.viewDidMount=function(t){},t.prototype.viewWillUnmount=function(t){},t.prototype.viewDidUnmount=function(t){},t.prototype.viewWillUpdate=function(t,e){},t.prototype.viewDidUpdate=function(t,e){},t.prototype.viewWillCompute=function(t,e){},t.prototype.viewDidCompute=function(t,e){},t.prototype.viewWillLayout=function(t,e){},t.prototype.viewDidLayout=function(t,e){},t.prototype.viewWillScroll=function(t,e){},t.prototype.viewDidScroll=function(t,e){},t.prototype.viewWillUpdateChildViews=function(t,e){},t.prototype.viewDidUpdateChildViews=function(t,e){},t}(),ql={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof el&&"function"==typeof e.togglePopover&&"function"==typeof e.showPopover&&"function"==typeof e.hidePopover&&"function"==typeof e.hidePopovers}return!1}};el.App=ql;var Bl={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof el&&"function"==typeof e.addConstraint&&"function"==typeof e.removeConstraint&&"function"==typeof e.updateVariables}return!1}};el.Layout=Bl;var Kl={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof el.Graphics||e instanceof el&&"function"==typeof e.animate}return!1}};el.Animated=Kl;var Hl={is:function(t){if("object"==typeof t&&t){var e=t;return Kl.is(e)&&"function"==typeof e.hitTest}return!1}};el.Rendered=Hl;var Gl={is:function(t){if("object"==typeof t&&t){return t instanceof el&&"function"==typeof t.fill}return!1}},Xl={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof el&&"function"==typeof e.stroke&&"function"==typeof e.strokeWidth}return!1}},Yl={is:function(t){if("object"==typeof t&&t){var e=t;return e instanceof el&&"function"==typeof e.font&&"function"==typeof e.textColor&&"function"==typeof e.textAlign&&"function"==typeof e.textBaseline}return!1}},Zl=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r._key=e,r._viewController=null,r._viewObservers=[],r._parentView=null,r._childViews=[],r._updateFlags=0,r._bounds=uo.empty(),r._anchor=no.origin(),r._hidden=!1,r._culled=!1,r._hover=!1,r._eventHandlers={},r}return _(e,t),e.prototype.key=function(t){return void 0===t?this._key:(this.willSetKey(t),this._key=t,this.onSetKey(t),this.didSetKey(t),this)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.setViewController=function(t){this._viewController!==t&&(this.willSetViewController(t),this._viewController&&this._viewController.setView(null),this._viewController=t,this._viewController&&this._viewController.setView(this),this.onSetViewController(t),this.didSetViewController(t))},Object.defineProperty(e.prototype,"viewObservers",{get:function(){return this._viewObservers},enumerable:!0,configurable:!0}),e.prototype.addViewObserver=function(t){var e=this._viewObservers;e.indexOf(t)<0&&(this.willAddViewObserver(t),e.push(t),this.onAddViewObserver(t),this.didAddViewObserver(t))},e.prototype.removeViewObserver=function(t){var e=this._viewObservers,r=e.indexOf(t);r>=0&&(this.willRemoveViewObserver(t),e.splice(r,1),this.onRemoveViewObserver(t),this.didRemoveViewObserver(t))},e.prototype.isMounted=function(){var t=this._parentView;return!!t&&t.isMounted()},Object.defineProperty(e.prototype,"canvasView",{get:function(){var t=this.parentView;return Hl.is(t)?t.canvasView:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentView",{get:function(){return this._parentView},enumerable:!0,configurable:!0}),e.prototype.setParentView=function(t){this.willSetParentView(t),this._parentView=t,this.onSetParentView(t),this.didSetParentView(t)},Object.defineProperty(e.prototype,"childViews",{get:function(){return this._childViews},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._childViews,r=e.length-1;r>=0;r-=1){var i=e[r];if(i.key()===t)return i}return null},e.prototype.setChildView=function(t,e){if(null!==e&&!Hl.is(e))throw new TypeError(""+e);for(var r=null,i=null,n=this._childViews,o=n.length-1;o>=0;){var s=n[o];if(s.key()===t){r=s,i=n[o+1]||null,this.willRemoveChildView(s),s.setParentView(null),n.splice(o,1),this.onRemoveChildView(s),this.didRemoveChildView(s);break}o-=1}return e&&(e.key(t),this.willInsertChildView(e,i),o>=0?n.splice(o,0,e):n.push(e),e.setParentView(this),this.onInsertChildView(e,i),this.didInsertChildView(e,i)),r},e.prototype.append=function(t){return this.appendChildView(t),t},e.prototype.appendChildView=function(t){if(!Hl.is(t))throw new TypeError(""+t);this.willInsertChildView(t,null),this._childViews.push(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null)},e.prototype.prepend=function(t){return this.prependChildView(t),t},e.prototype.prependChildView=function(t){if(!Hl.is(t))throw new TypeError(""+t);this.willInsertChildView(t,null),this._childViews.unshift(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null)},e.prototype.insert=function(t,e){return this.insertChildView(t,e),t},e.prototype.insertChildView=function(t,e){if(!Hl.is(t))throw new TypeError(""+t);if(null!==e&&!Hl.is(t))throw new TypeError(""+e);if(null!==e&&e.parentView!==this)throw new TypeError(""+e);var r=this._childViews;this.willInsertChildView(t,e);var i=e?r.indexOf(e):-1;i>=0?r.splice(i,0,t):r.push(t),t.setParentView(this),this.onInsertChildView(t,e),this.didInsertChildView(t,e)},e.prototype.removeChildView=function(t){if(!Hl.is(t))throw new TypeError(""+t);if(t.parentView!==this)throw new TypeError(""+t);var e=this._childViews;this.willRemoveChildView(t),t.setParentView(null);var r=e.indexOf(t);r>=0&&e.splice(r,1),this.onRemoveChildView(t),this.didRemoveChildView(t)},e.prototype.removeAll=function(){for(var t=this._childViews;;){var e=t.length;if(!(e>0))break;var r=t[e-1];this.willRemoveChildView(r),r.setParentView(null),t.pop(),this.onRemoveChildView(r),this.didRemoveChildView(r)}},e.prototype.remove=function(){this._parentView&&this._parentView.removeChildView(this)},e.prototype.cascadeMount=function(){this.doMountChildViews(),this.doMount()},e.prototype.doMountChildViews=function(){for(var t=this._childViews,e=0;e<t.length;e+=1){t[e].cascadeMount()}},e.prototype.cascadeUnmount=function(){this._updateFlags=0,this.doUnmountChildViews(),this.doUnmount()},e.prototype.doUnmountChildViews=function(){for(var t=this._childViews,e=0;e<t.length;e+=1){t[e].cascadeUnmount()}},Object.defineProperty(e.prototype,"renderer",{get:function(){var t=this.parentView;return Hl.is(t)?t.renderer:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateFlags",{get:function(){return this._updateFlags},enumerable:!0,configurable:!0}),e.prototype.setUpdateFlags=function(t){this._updateFlags=t},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t|=el.NeedsRender),t},e.prototype.cascadeUpdate=function(t,e){t|=this.updateFlags,t=this.needsUpdate(t,e),this.doUpdate(t,e)},e.prototype.doUpdate=function(t,e){this.willUpdate(e),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(e)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(e)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(e)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(e)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(e)),this.onUpdate(e),this.doUpdateChildViews(t,e),this.didUpdate(e)},e.prototype.doAnimate=function(t){this.parentView&&(this.willAnimate(t),this.onAnimate(t),this.didAnimate(t))},e.prototype.willAnimate=function(t){this.willObserve((function(e){e.viewWillAnimate&&e.viewWillAnimate(t,this)}))},e.prototype.onAnimate=function(t){},e.prototype.didAnimate=function(t){this.didObserve((function(e){e.viewDidAnimate&&e.viewDidAnimate(t,this)}))},e.prototype.doRender=function(t){!this.parentView||this.hidden||this.culled||(this.willRender(t),this.onRender(t),this.didRender(t))},e.prototype.willRender=function(t){this.willObserve((function(e){e.viewWillRender&&e.viewWillRender(t,this)}))},e.prototype.onRender=function(t){},e.prototype.didRender=function(t){this.didObserve((function(e){e.viewDidRender&&e.viewDidRender(t,this)}))},Object.defineProperty(e.prototype,"hidden",{get:function(){if(this._hidden)return!0;var t=this._parentView;return!!Hl.is(t)&&t.hidden},enumerable:!0,configurable:!0}),e.prototype.setHidden=function(t){var e=this.willSetHidden(t);void 0!==e&&(t=e),this._hidden!==t&&(this._hidden=t,this.onSetHidden(t)),this.didSetHidden(t)},e.prototype.willSetHidden=function(t){var e=this._viewController;if(e){var r=e.viewWillSetHidden(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetHidden&&s.viewWillSetHidden(t,this)}return t},e.prototype.onSetHidden=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didSetHidden=function(t){this.didObserve((function(e){e.viewDidSetHidden&&e.viewDidSetHidden(t,this)}))},Object.defineProperty(e.prototype,"culled",{get:function(){if(this._culled)return!0;var t=this._parentView;return!!Hl.is(t)&&t.culled},enumerable:!0,configurable:!0}),e.prototype.setCulled=function(t){var e=this.willSetCulled(t);void 0!==e&&(t=e),this._culled!==t&&(this._culled=t,this.onSetCulled(t)),this.didSetCulled(t)},e.prototype.willSetCulled=function(t){var e=this._viewController;if(e){var r=e.viewWillSetCulled(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetCulled&&s.viewWillSetCulled(t,this)}return t},e.prototype.onSetCulled=function(t){t||this.requireUpdate(el.NeedsLayout)},e.prototype.didSetCulled=function(t){this.didObserve((function(e){e.viewDidSetCulled&&e.viewDidSetCulled(t,this)}))},e.prototype.onLayout=function(e){t.prototype.onLayout.call(this,e),this.layoutChildViews(e)},e.prototype.layoutChildViews=function(t){for(var e=this._childViews,r=0;r<e.length;r+=1){var i=e[r];this.layoutChildView(i,t)}},e.prototype.layoutChildView=function(t,e){Hl.is(t)&&(t.setBounds(this._bounds),t.setAnchor(this._anchor))},e.prototype.doUpdateChildViews=function(t,e){this.willUpdateChildViews(e);for(var r=this._childViews,i=0;i<r.length;i+=1){var n=r[i],o=this.childViewContext(n,e);n.cascadeUpdate(t,o)}this.didUpdateChildViews(e)},e.prototype.childViewContext=function(t,e){return e},e.prototype.animate=function(t){this.requireUpdate(el.NeedsAnimate)},Object.defineProperty(e.prototype,"parentTransform",{get:function(){var t=this._parentView;if(Hl.is(t)){var e=t.bounds,r=this.bounds,i=r.x-e.x,n=r.y-e.y;if(0!==i||0!==n)return _a.translate(i,n)}return _a.identity()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clientBounds",{get:function(){var t=this.clientTransform.inverse();return this.bounds.transform(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverBounds",{get:function(){var t=this.pageTransform.inverse(),e=this.anchor.transform(t),r=Math.round(e.x),i=Math.round(e.y);return new uo(r,i,r,i)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),e.prototype.setBounds=function(t){var e=this.willSetBounds(t);void 0!==e&&(t=e);var r=this._bounds;this._bounds=t,this.onSetBounds(t,r),this.didSetBounds(t,r)},e.prototype.willSetBounds=function(t){var e=this._viewController;if(e){var r=e.viewWillSetBounds(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetBounds&&s.viewWillSetBounds(t,this)}},e.prototype.onSetBounds=function(t,e){t.equals(e)||this.requireUpdate(el.NeedsLayout)},e.prototype.didSetBounds=function(t,e){this.didObserve((function(r){r.viewDidSetBounds&&r.viewDidSetBounds(t,e,this)}))},Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),e.prototype.setAnchor=function(t){var e=this.willSetAnchor(t);void 0!==e&&(t=e);var r=this._anchor;this._anchor=t,this.onSetAnchor(t,r),this.didSetAnchor(t,r)},e.prototype.willSetAnchor=function(t){var e=this._viewController;if(e){var r=e.viewWillSetAnchor(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetAnchor&&s.viewWillSetAnchor(t,this)}},e.prototype.onSetAnchor=function(t,e){t.equals(e)||this.requireUpdate(el.NeedsLayout)},e.prototype.didSetAnchor=function(t,e){this.didObserve((function(r){r.viewDidSetAnchor&&r.viewDidSetAnchor(t,e,this)}))},Object.defineProperty(e.prototype,"hitBounds",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(t,e,r){for(var i=null,n=this._childViews,o=n.length-1;o>=0;o-=1){var s=n[o];if(Hl.is(s)&&!s.culled)if((s.hitBounds||s.bounds).contains(t,e)&&null!==(i=s.hitTest(t,e,r)))break}return i},e.prototype.on=function(t,e,r){var i,n=this._eventHandlers[t],o="boolean"==typeof r?r:r&&"object"==typeof r&&r.capture||!1,s=r&&"object"==typeof r&&r.passive||!1,u=r&&"object"==typeof r&&r.once||!1;if(void 0===n)n=[i={listener:e,capture:o,passive:s,once:u}],this._eventHandlers[t]=n;else{for(var a=n.length,h=0;h<a&&((i=n[h]).listener!==e||i.capture!==o);)h+=1;h<a?(i.passive=s,i.once=u):(i={listener:e,capture:o,passive:s,once:u},n.push(i))}return this},e.prototype.off=function(t,e,r){var i=this._eventHandlers[t];if(void 0!==i)for(var n="boolean"==typeof r?r:r&&"object"==typeof r&&r.capture||!1,o=i.length,s=0;s<o;){var u=i[s];if(u.listener===e&&u.capture===n){i.splice(s,1),0===i.length&&delete this._eventHandlers[t];break}s+=1}return this},e.prototype.handleEvent=function(t){var e=t.type,r=this._eventHandlers[e];if(void 0!==r){for(var i=0;i<r.length;){var n=r[i];if(!n.capture){var o=n.listener;if("function"==typeof o?o(t):o&&"object"==typeof o&&o.handleEvent(t),n.once){r.splice(i,1);continue}}i+=1}0===r.length&&delete this._eventHandlers[e]}"mouseover"===e?this.onMouseOver(t):"mouseout"===e&&this.onMouseOut(t)},e.prototype.bubbleEvent=function(t){if(this.handleEvent(t),t.bubbles&&!t.cancelBubble){var e=this._parentView;return Hl.is(e)?e.bubbleEvent(t):e}return null},e.prototype.dispatchEvent=function(t){t.targetView=this;var e=this.bubbleEvent(t);return e?e.dispatchEvent(t):!t.cancelBubble},Object.defineProperty(e.prototype,"hover",{get:function(){return this._hover},enumerable:!0,configurable:!0}),e.prototype.onMouseOver=function(t){if(!this._hover&&(this._hover=!0,void 0!==this._eventHandlers.mouseenter)){var e=new MouseEvent("mouseenter",{clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY,bubbles:!1});e.targetView=this,e.relatedTargetView=t.relatedTargetView,this.handleEvent(e)}},e.prototype.onMouseOut=function(t){if(this._hover&&(this._hover=!1,void 0!==this._eventHandlers.mouseleave)){var e=new MouseEvent("mouseleave",{clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY,bubbles:!1});e.targetView=this,e.relatedTargetView=t.relatedTargetView,this.handleEvent(e)}},e}(el);el.Graphics=Zl;var Ql=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"canvasView",{get:function(){var t=this._view;return t?t.canvasView:null},enumerable:!0,configurable:!0}),e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e.prototype.viewWillRender=function(t,e){},e.prototype.viewDidRender=function(t,e){},Object.defineProperty(e.prototype,"hidden",{get:function(){var t=this._view;return!!t&&t.hidden},enumerable:!0,configurable:!0}),e.prototype.viewWillSetHidden=function(t,e){},e.prototype.viewDidSetHidden=function(t,e){},Object.defineProperty(e.prototype,"culled",{get:function(){var t=this._view;return!!t&&t.culled},enumerable:!0,configurable:!0}),e.prototype.viewWillSetCulled=function(t,e){},e.prototype.viewDidSetCulled=function(t,e){},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this._view;return t?t.bounds:uo.empty()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetBounds=function(t,e){},e.prototype.viewDidSetBounds=function(t,e,r){},Object.defineProperty(e.prototype,"anchor",{get:function(){var t=this._view;return t?t.anchor:no.origin()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetAnchor=function(t,e){},e.prototype.viewDidSetAnchor=function(t,e,r){},e}(Wl),$l=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this,e)||this;return r._canvas=r.createCanvas(),r._renderer=void 0,r}return _(e,t),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerRenderer",{get:function(){var t=this.parentView;return Hl.is(t)?t.renderer:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){var t=this._renderer;return void 0===t&&(t=this.createRenderer(),this._renderer=t),t},enumerable:!0,configurable:!0}),e.prototype.setRenderer=function(t){"string"==typeof t&&(t=this.createRenderer(t)),this._renderer=t,this.resetRenderer()},e.prototype.createRenderer=function(t){if(void 0===t&&(t="canvas"),"canvas"===t){if(e=this._canvas.getContext("2d"))return new Fp(e,this.pixelRatio);throw new Error("Failed to create canvas rendering context")}if("webgl"===t){var e;if(e=this._canvas.getContext("webgl"))return new Lp(e,this.pixelRatio);throw new Error("Failed to create webgl rendering context")}throw new Error("Failed to create "+t+" renderer")},e.prototype.doUpdate=function(t,e){var r=this.layerViewContext(e);this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(r),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.onRender=function(t){this.clearCanvas()},e.prototype.didUpdateChildViews=function(e){t.prototype.didUpdateChildViews.call(this,e),this.copyLayerImage(e)},e.prototype.childViewContext=function(t,e){return e},e.prototype.layerViewContext=function(t){var e=Object.create(t);return e.layerRenderer=t.renderer,e.renderer=this.renderer,e},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return _a.identity()},enumerable:!0,configurable:!0}),e.prototype.willSetBounds=function(e){var r=t.prototype.willSetBounds.call(this,e);r instanceof uo&&(e=r);var i=Math.round(e.xMin),n=Math.round(e.yMin),o=Math.round(e.xMax),s=Math.round(e.yMax);return new uo(i,n,o,s)},e.prototype.onSetBounds=function(t,e){t.equals(e)||(this.resizeCanvas(this._canvas,t),this.resetRenderer(),this.requireUpdate(el.NeedsLayout))},e.prototype.layoutChildView=function(t){if(Hl.is(t)){var e=this._bounds,r=this._anchor,i=e.x,n=e.y;if(0!==e.x||0!==e.y){var o=e.width,s=e.height;e=new uo(0,0,o,s)}0===i&&0===n||(r=new no(r.x-i,r.y-n)),t.setBounds(e),t.setAnchor(r)}},e.prototype.hitTest=function(t,e,r){var i=this.layerViewContext(r),n=this._bounds;t-=n.x,e-=n.y;for(var o=null,s=this._childViews,u=s.length-1;u>=0;u-=1){var a=s[u];if(Hl.is(a)&&a.bounds.contains(t,e)&&null!==(o=a.hitTest(t,e,i)))break}return o},e.prototype.createCanvas=function(){return document.createElement("canvas")},e.prototype.resizeCanvas=function(t,e){var r=Math.floor(e.width),i=Math.floor(e.height),n=this.pixelRatio;t.width=r*n,t.height=i*n,t.style.width=r+"px",t.style.height=i+"px"},e.prototype.clearCanvas=function(){var t=this.renderer;if(t instanceof Fp){var e=this._bounds;t.context.clearRect(0,0,e.width,e.height)}else if(t instanceof Lp){var r=t.context;r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)}},e.prototype.resetRenderer=function(){var t=this.renderer;if(t instanceof Fp){var e=this.pixelRatio;t.context.setTransform(e,0,0,e,0,0)}else if(t instanceof Lp){var r=this._bounds;t.context.viewport(0,0,r.width,r.height)}},e.prototype.copyLayerImage=function(t){var e=t.layerRenderer,r=t.renderer;if(e instanceof Fp&&r instanceof Fp){var i=this._bounds,n=this.pixelRatio,o=e.context.getImageData(0,0,i.width*n,i.height*n);r.context.putImageData(o,i.x*n,i.y*n)}},e}(Zl);el.Layer=$l;var Jl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(Ql),tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.appendChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.appendChildNode(t)},e.prototype.prependChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.prependChildNode(t)},e.prototype.insertChildNode=function(t,e){var r=this._view;if(!r)throw new Error("no view");r.insertChildNode(t,e)},e.prototype.viewWillInsertChildNode=function(t,e,r){},e.prototype.viewDidInsertChildNode=function(t,e,r){},e.prototype.removeChildNode=function(t){var e=this._view;if(!e)throw new Error("no view");e.removeChildNode(t)},e.prototype.viewWillRemoveChildNode=function(t,e){},e.prototype.viewDidRemoveChildNode=function(t,e){},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e}(Wl),ec=function(t){function e(e,r){return void 0===r&&(r=null),t.call(this,e,r)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e}(fl);el.Text=ec;var rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(tc),ic=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.isVisible=function(){var t=this._view;return!!t&&t.isVisible()},e.prototype.viewWillSetAttribute=function(t,e,r){},e.prototype.viewDidSetAttribute=function(t,e,r){},e.prototype.viewWillSetStyle=function(t,e,r,i){},e.prototype.viewDidSetStyle=function(t,e,r,i){},e}(tc),nc=function(t){function e(e,r){return void 0===r&&(r=null),t.call(this,e,r)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.append=function(t,r){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,r)),this.appendChildView(t),t},e.prototype.prepend=function(t,r){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,r)),this.prependChildView(t),t},e.prototype.insert=function(t,r,i){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,i)),this.insertChild(t,r),t},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return this.transform()||_a.identity()},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,r){return this._node.addEventListener(t,e,r),this},e.prototype.off=function(t,e,r){return this._node.removeEventListener(t,e,r),this},e.prototype.font=function(t,e,r){if(void 0===t){var i=this.fontStyle(),n=this.fontVariant(),o=this.fontWeight(),s=this.fontStretch(),u=this.fontSize(),a=this.lineHeight(),h=this.fontFamily();return null!=h?da.from(i,n,o,s,u,a,h):void 0}return null!==(t=null!==t?da.fromAny(t):null)&&null===t.style()||this.fontStyle(null!==t?t.style():null,e,r),null!==t&&null===t.variant()||this.fontVariant(null!==t?t.variant():null,e,r),null!==t&&null===t.weight()||this.fontWeight(null!==t?t.weight():null,e,r),null!==t&&null===t.stretch()||this.fontStretch(null!==t?t.stretch():null,e,r),null!==t&&null===t.size()||this.fontSize(null!==t?t.size():null,e,r),null!==t&&null===t.height()||this.lineHeight(null!==t?t.height():null,e,r),this.fontFamily(null!==t?t.family():null,e,r),this},e.create=function(t){if("string"==typeof t)return"canvas"===t?new el.Canvas(document.createElement(t)):new e(document.createElementNS(e.NS,t));if("function"==typeof t)return new t(document.createElementNS(e.NS,t.tag));throw new TypeError(""+t)},e.tag="svg",e.NS="http://www.w3.org/2000/svg",m([yl("alignment-baseline",String)],e.prototype,"alignmentBaseline",void 0),m([yl("clip-path",String)],e.prototype,"clipPath",void 0),m([yl("cursor",String)],e.prototype,"cursor",void 0),m([yl("cx",Number)],e.prototype,"cx",void 0),m([yl("cy",Number)],e.prototype,"cy",void 0),m([yl("d",String)],e.prototype,"d",void 0),m([yl("dx",[Number,String])],e.prototype,"dx",void 0),m([yl("dy",[Number,String])],e.prototype,"dy",void 0),m([yl("edgeMode",String)],e.prototype,"edgeMode",void 0),m([yl("fill",[ta,String])],e.prototype,"fill",void 0),m([yl("fill-rule",String)],e.prototype,"fillRuke",void 0),m([yl("height",Hu)],e.prototype,"height",void 0),m([yl("in",String)],e.prototype,"in",void 0),m([yl("in2",String)],e.prototype,"in2",void 0),m([yl("mode",String)],e.prototype,"mode",void 0),m([yl("opacity",Number)],e.prototype,"opacity",void 0),m([yl("points",String)],e.prototype,"points",void 0),m([yl("preserveAspectRatio",Boolean)],e.prototype,"preserveAspectRatio",void 0),m([yl("r",Number)],e.prototype,"r",void 0),m([yl("result",String)],e.prototype,"result",void 0),m([yl("stdDeviation",String)],e.prototype,"stdDeviation",void 0),m([yl("stroke",[ta,String])],e.prototype,"stroke",void 0),m([yl("stroke-dasharray",String)],e.prototype,"strokeDasharray",void 0),m([yl("stroke-width",Number)],e.prototype,"strokeWidth",void 0),m([yl("text-anchor",String)],e.prototype,"textAnchor",void 0),m([Al("touch-action",String)],e.prototype,"touchAction",void 0),m([yl("transform",_a)],e.prototype,"transform",void 0),m([yl("type",String)],e.prototype,"type",void 0),m([yl("values",String)],e.prototype,"values",void 0),m([yl("viewBox",String)],e.prototype,"viewBox",void 0),m([yl("width",Hu)],e.prototype,"width",void 0),m([yl("x",Number)],e.prototype,"x",void 0),m([yl("x1",Number)],e.prototype,"x1",void 0),m([yl("x2",Number)],e.prototype,"x2",void 0),m([yl("y",Number)],e.prototype,"y",void 0),m([yl("y1",Number)],e.prototype,"y1",void 0),m([yl("y2",Number)],e.prototype,"y2",void 0),m([Al("font-family",ca)],e.prototype,"fontFamily",void 0),m([Al("font-size",[Hu,String])],e.prototype,"fontSize",void 0),m([Al("font-stretch",String)],e.prototype,"fontStretch",void 0),m([Al("font-style",String)],e.prototype,"fontStyle",void 0),m([Al("font-variant",String)],e.prototype,"fontVariant",void 0),m([Al("font-weight",String)],e.prototype,"fontWeight",void 0),m([Al("line-height",la)],e.prototype,"lineHeight",void 0),e}(dl);el.Svg=nc;var oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(ic),sc=function(t){function e(e,r){return void 0===r&&(r=null),t.call(this,e,r)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.append=function(t,r){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,r)),this.appendChildView(t),t},e.prototype.prepend=function(t,r){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,r)),this.prependChildView(t),t},e.prototype.insert=function(t,r,i){return"string"==typeof t&&(t=e.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,i)),this.insertChild(t,r),t},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return this.transform()||_a.identity()},enumerable:!0,configurable:!0}),e.prototype.variable=function(t,e,r){return void 0===e&&(e=0),r=void 0===r?Zp.Strong:Zp.fromAny(r),new Qp(this,t,e,r)},e.prototype.constraint=function(t,e,r,i){"number"==typeof t&&(t=Bp.constant(t)),"number"==typeof r&&(r=Bp.constant(r));var n=r?t.minus(r):t;return i=void 0===i?Zp.Required:Zp.fromAny(i),new $p(this,n,e,i)},Object.defineProperty(e.prototype,"variables",{get:function(){return void 0===this._variables&&(this._variables=[]),this._variables},enumerable:!0,configurable:!0}),e.prototype.hasVariable=function(t){return void 0!==this._variables&&this._variables.indexOf(t)>=0},e.prototype.addVariable=function(t){void 0===this._variables&&(this._variables=[]),this._variables.indexOf(t)<0&&(this._variables.push(t),this.activateVariable(t))},e.prototype.activateVariable=function(t){var e=this.appView;Ul.is(e)&&(e.activateVariable(t),this.requireUpdate(el.NeedsLayout))},e.prototype.removeVariable=function(t){if(void 0!==this._variables){var e=this._variables.indexOf(t);e>=0&&(this.deactivateVariable(t),this._variables.splice(e,1))}},e.prototype.deactivateVariable=function(t){var e=this.appView;Ul.is(e)&&(e.deactivateVariable(t),this.requireUpdate(el.NeedsLayout))},e.prototype.setVariable=function(t,e){var r=this.appView;Ul.is(r)&&r.setVariable(t,e)},Object.defineProperty(e.prototype,"constraints",{get:function(){return void 0===this._constraints&&(this._constraints=[]),this._constraints},enumerable:!0,configurable:!0}),e.prototype.hasConstraint=function(t){return void 0!==this._constraints&&this._constraints.indexOf(t)>=0},e.prototype.addConstraint=function(t){void 0===this._constraints&&(this._constraints=[]),this._constraints.indexOf(t)<0&&(this._constraints.push(t),this.activateConstraint(t))},e.prototype.activateConstraint=function(t){var e=this.appView;Ul.is(e)&&(e.activateConstraint(t),this.requireUpdate(el.NeedsLayout))},e.prototype.removeConstraint=function(t){if(void 0!==this._constraints){var e=this._constraints.indexOf(t);e>=0&&(this._constraints.splice(e,1),this.deactivateConstraint(t))}},e.prototype.deactivateConstraint=function(t){var e=this.appView;Ul.is(e)&&(e.deactivateConstraint(t),this.requireUpdate(el.NeedsLayout))},e.prototype.activateLayout=function(){var t,e=this._variables,r=this._constraints;if((void 0!==e||void 0!==r)&&(t=this.appView,Ul.is(t))){for(var i=0,n=void 0!==e?e.length:0;i<n;i+=1){var o=e[i];o instanceof zl&&(t.activateVariable(o),this.requireUpdate(el.NeedsLayout))}for(i=0,n=void 0!==r?r.length:0;i<n;i+=1)t.activateConstraint(r[i]),this.requireUpdate(el.NeedsLayout)}},e.prototype.deactivateLayout=function(){var t,e=this._variables,r=this._constraints;if((void 0!==e||void 0!==r)&&(t=this.appView,Ul.is(t))){for(var i=0,n=void 0!==r?r.length:0;i<n;i+=1)t.deactivateConstraint(r[i]),this.requireUpdate(el.NeedsLayout);for(i=0,n=void 0!==e?e.length:0;i<n;i+=1)t.deactivateVariable(e[i]),this.requireUpdate(el.NeedsLayout)}},e.prototype.didMount=function(){t.prototype.didMount.call(this),this.activateLayout()},e.prototype.willUnmount=function(){this.deactivateLayout(),t.prototype.willUnmount.call(this)},e.prototype.didLayout=function(e){this.updateLayoutStates(),this.updateVariables(),t.prototype.didLayout.call(this,e)},e.prototype.updateLayoutStates=function(){this.hasOwnProperty("topAnchor")&&this.topAnchor.updateState(),this.hasOwnProperty("rightAnchor")&&this.rightAnchor.updateState(),this.hasOwnProperty("bottomAnchor")&&this.bottomAnchor.updateState(),this.hasOwnProperty("leftAnchor")&&this.leftAnchor.updateState(),this.hasOwnProperty("widthAnchor")&&this.widthAnchor.updateState(),this.hasOwnProperty("heightAnchor")&&this.heightAnchor.updateState(),this.hasOwnProperty("centerXAnchor")&&this.centerXAnchor.updateState(),this.hasOwnProperty("centerYAnchor")&&this.centerYAnchor.updateState()},e.prototype.updateVariables=function(){var t=this.appView;Ll.is(t)&&t.updateVariables()},e.prototype.on=function(t,e,r){return this._node.addEventListener(t,e,r),this},e.prototype.off=function(t,e,r){return this._node.removeEventListener(t,e,r),this},e.prototype.borderColor=function(t,e,r){if(void 0===t){var i=this.borderTopColor(),n=this.borderRightColor(),o=this.borderBottomColor(),s=this.borderLeftColor();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.borderTopColor(t[0],e,r),t.length>=2&&this.borderRightColor(t[1],e,r),t.length>=3&&this.borderBottomColor(t[2],e,r),t.length>=4&&this.borderLeftColor(t[3],e,r)):(this.borderTopColor(t,e,r),this.borderRightColor(t,e,r),this.borderBottomColor(t,e,r),this.borderLeftColor(t,e,r)),this},e.prototype.borderRadius=function(t,e,r){if(void 0===t){var i=this.borderTopLeftRadius(),n=this.borderTopRightRadius(),o=this.borderBottomRightRadius(),s=this.borderBottomLeftRadius();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.borderTopLeftRadius(t[0],e,r),t.length>=2&&this.borderTopRightRadius(t[1],e,r),t.length>=3&&this.borderBottomRightRadius(t[2],e,r),t.length>=4&&this.borderBottomLeftRadius(t[3],e,r)):(this.borderTopLeftRadius(t,e,r),this.borderTopRightRadius(t,e,r),this.borderBottomRightRadius(t,e,r),this.borderBottomLeftRadius(t,e,r)),this},e.prototype.borderStyle=function(t,e,r){if(void 0===t){var i=this.borderTopStyle(),n=this.borderRightStyle(),o=this.borderBottomStyle(),s=this.borderLeftStyle();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.borderTopStyle(t[0],e,r),t.length>=2&&this.borderRightStyle(t[1],e,r),t.length>=3&&this.borderBottomStyle(t[2],e,r),t.length>=4&&this.borderLeftStyle(t[3],e,r)):(this.borderTopStyle(t,e,r),this.borderRightStyle(t,e,r),this.borderBottomStyle(t,e,r),this.borderLeftStyle(t,e,r)),this},e.prototype.borderWidth=function(t,e,r){if(void 0===t){var i=this.borderTopWidth(),n=this.borderRightWidth(),o=this.borderBottomWidth(),s=this.borderLeftWidth();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.borderTopWidth(t[0],e,r),t.length>=2&&this.borderRightWidth(t[1],e,r),t.length>=3&&this.borderBottomWidth(t[2],e,r),t.length>=4&&this.borderLeftWidth(t[3],e,r)):(this.borderTopWidth(t,e,r),this.borderRightWidth(t,e,r),this.borderBottomWidth(t,e,r),this.borderLeftWidth(t,e,r)),this},e.prototype.font=function(t,e,r){if(void 0===t){var i=this.fontStyle(),n=this.fontVariant(),o=this.fontWeight(),s=this.fontStretch(),u=this.fontSize(),a=this.lineHeight(),h=this.fontFamily();return null!=h?da.from(i,n,o,s,u,a,h):void 0}return null!==(t=null!==t?da.fromAny(t):null)&&null===t.style()||this.fontStyle(null!==t?t.style():null,e,r),null!==t&&null===t.variant()||this.fontVariant(null!==t?t.variant():null,e,r),null!==t&&null===t.weight()||this.fontWeight(null!==t?t.weight():null,e,r),null!==t&&null===t.stretch()||this.fontStretch(null!==t?t.stretch():null,e,r),null!==t&&null===t.size()||this.fontSize(null!==t?t.size():null,e,r),null!==t&&null===t.height()||this.lineHeight(null!==t?t.height():null,e,r),this.fontFamily(null!==t?t.family():null,e,r),this},e.prototype.margin=function(t,e,r){if(void 0===t){var i=this.marginTop(),n=this.marginRight(),o=this.marginBottom(),s=this.marginLeft();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.marginTop(t[0],e,r),t.length>=2&&this.marginRight(t[1],e,r),t.length>=3&&this.marginBottom(t[2],e,r),t.length>=4&&this.marginLeft(t[3],e,r)):(this.marginTop(t,e,r),this.marginRight(t,e,r),this.marginBottom(t,e,r),this.marginLeft(t,e,r)),this},e.prototype.padding=function(t,e,r){if(void 0===t){var i=this.paddingTop(),n=this.paddingRight(),o=this.paddingBottom(),s=this.paddingLeft();return f.equal(i,n)&&f.equal(n,o)&&f.equal(o,s)?i:[i,n,o,s]}return Array.isArray(t)?(t.length>=1&&this.paddingTop(t[0],e,r),t.length>=2&&this.paddingRight(t[1],e,r),t.length>=3&&this.paddingBottom(t[2],e,r),t.length>=4&&this.paddingLeft(t[3],e,r)):(this.paddingTop(t,e,r),this.paddingRight(t,e,r),this.paddingBottom(t,e,r),this.paddingLeft(t,e,r)),this},e.create=function(t){if("string"==typeof t)return"svg"===t?new el.Svg(document.createElementNS(el.Svg.NS,t)):"canvas"===t?new el.Canvas(document.createElement(t)):new e(document.createElement(t));if("function"==typeof t)return new t(document.createElement(t.tag));throw new TypeError(""+t)},e.tag="div",m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect().top-e.top;return t!==r&&this.requireUpdate(el.NeedsLayout),r},set:function(t){this.top.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"topAnchor",void 0),m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect(),i=e.right+r.right;return t!==i&&this.requireUpdate(el.NeedsLayout),i},set:function(t){this.right.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"rightAnchor",void 0),m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect(),i=e.bottom+r.bottom;return t!==i&&this.requireUpdate(el.NeedsLayout),i},set:function(t){this.bottom.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"bottomAnchor",void 0),m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect().left-e.left;return t!==r&&this.requireUpdate(el.NeedsLayout),r},set:function(t){this.left.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"leftAnchor",void 0),m([zl({get:function(t){var e=this._node.getBoundingClientRect().width;return t!==e&&this.requireUpdate(el.NeedsLayout),e},set:function(t){this.width.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"widthAnchor",void 0),m([zl({get:function(t){var e=this._node.getBoundingClientRect().height;return t!==e&&this.requireUpdate(el.NeedsLayout),e},set:function(t){this.height.setState(Hu.px(t)),this.requireUpdate(el.NeedsLayout)},strength:"strong"})],e.prototype,"heightAnchor",void 0),m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect(),i=r.left+.5*r.width-e.left;return t!==i&&this.requireUpdate(el.NeedsLayout),i},set:function(t){var e=this.hasOwnProperty("rightAnchor")?this.rightAnchor:void 0,r=this.hasOwnProperty("leftAnchor")?this.leftAnchor:void 0,i=this.hasOwnProperty("widthAnchor")?this.widthAnchor:void 0;r&&r.enabled()?(this.width.setState(Hu.px(2*(t-r.value))),this.requireUpdate(el.NeedsLayout)):e&&e.enabled()?(this.width.setState(Hu.px(2*(e.value-t))),this.requireUpdate(el.NeedsLayout)):i&&i.enabled()&&(this.left.setState(Hu.px(t-.5*i.value)),this.requireUpdate(el.NeedsLayout))},strength:"strong"})],e.prototype,"centerXAnchor",void 0),m([zl({get:function(t){var e=this._node.offsetParent.getBoundingClientRect(),r=this._node.getBoundingClientRect(),i=r.top+.5*r.height-e.top;return t!==i&&this.requireUpdate(el.NeedsLayout),i},set:function(t){var e=this.hasOwnProperty("topAnchor")?this.topAnchor:void 0,r=this.hasOwnProperty("bottomAnchor")?this.bottomAnchor:void 0,i=this.hasOwnProperty("heightAnchor")?this.heightAnchor:void 0;e&&e.enabled()?(this.height.setState(Hu.px(2*(t-e.value))),this.requireUpdate(el.NeedsLayout)):r&&r.enabled()?(this.height.setState(Hu.px(2*(r.value-t))),this.requireUpdate(el.NeedsLayout)):i&&i.enabled()&&(this.top.setState(Hu.px(t-.5*i.value)),this.requireUpdate(el.NeedsLayout))},strength:"strong"})],e.prototype,"centerYAnchor",void 0),m([yl("autocomplete",String)],e.prototype,"autocomplete",void 0),m([yl("checked",Boolean)],e.prototype,"checked",void 0),m([yl("colspan",Number)],e.prototype,"colspan",void 0),m([yl("disabled",Boolean)],e.prototype,"disabled",void 0),m([yl("placeholder",String)],e.prototype,"placeholder",void 0),m([yl("rowspan",Number)],e.prototype,"rowspan",void 0),m([yl("selected",Boolean)],e.prototype,"selected",void 0),m([yl("title",String)],e.prototype,"title",void 0),m([yl("type",String)],e.prototype,"type",void 0),m([yl("value",String)],e.prototype,"value",void 0),m([Al("align-content",String)],e.prototype,"alignContent",void 0),m([Al("align-items",String)],e.prototype,"alignItems",void 0),m([Al("align-self",String)],e.prototype,"alignSelf",void 0),m([Al("appearance",String)],e.prototype,"appearance",void 0),m([Al(["backdrop-filter","-webkit-backdrop-filter"],String)],e.prototype,"backdropFilter",void 0),m([Al("background-color",ta)],e.prototype,"backgroundColor",void 0),m([Al("border-collapse",String)],e.prototype,"borderCollapse",void 0),m([Al("border-top-color",[ta,String])],e.prototype,"borderTopColor",void 0),m([Al("border-right-color",[ta,String])],e.prototype,"borderRightColor",void 0),m([Al("border-bottom-color",[ta,String])],e.prototype,"borderBottomColor",void 0),m([Al("border-left-color",[ta,String])],e.prototype,"borderLeftColor",void 0),m([Al("border-top-left-radius",Hu)],e.prototype,"borderTopLeftRadius",void 0),m([Al("border-top-right-radius",Hu)],e.prototype,"borderTopRightRadius",void 0),m([Al("border-bottom-right-radius",Hu)],e.prototype,"borderBottomRightRadius",void 0),m([Al("border-bottom-left-radius",Hu)],e.prototype,"borderBottomLeftRadius",void 0),m([Al("border-spacing",String)],e.prototype,"borderSpacing",void 0),m([Al("border-top-style",String)],e.prototype,"borderTopStyle",void 0),m([Al("border-right-style",String)],e.prototype,"borderRightStyle",void 0),m([Al("border-bottom-style",String)],e.prototype,"borderBottomStyle",void 0),m([Al("border-left-style",String)],e.prototype,"borderLeftStyle",void 0),m([Al("border-top-width",[Hu,String])],e.prototype,"borderTopWidth",void 0),m([Al("border-right-width",[Hu,String])],e.prototype,"borderRightWidth",void 0),m([Al("border-bottom-width",[Hu,String])],e.prototype,"borderBottomWidth",void 0),m([Al("border-left-width",[Hu,String])],e.prototype,"borderLeftWidth",void 0),m([Al("bottom",[Hu,String])],e.prototype,"bottom",void 0),m([Al("box-shadow",xp)],e.prototype,"boxShadow",void 0),m([Al("box-sizing",String)],e.prototype,"boxSizing",void 0),m([Al("color",[ta,String])],e.prototype,"color",void 0),m([Al("cursor",String)],e.prototype,"cursor",void 0),m([Al("display",String)],e.prototype,"display",void 0),m([Al("filter",String)],e.prototype,"filter",void 0),m([Al("flex-basis",[Hu,String])],e.prototype,"flexBasis",void 0),m([Al("flex-direction",String)],e.prototype,"flexDirection",void 0),m([Al("flex-grow",Number)],e.prototype,"flexGrow",void 0),m([Al("flex-shrink",Number)],e.prototype,"flexShrink",void 0),m([Al("flex-wrap",String)],e.prototype,"flexWrap",void 0),m([Al("font-family",ca)],e.prototype,"fontFamily",void 0),m([Al("font-size",[Hu,String])],e.prototype,"fontSize",void 0),m([Al("font-stretch",String)],e.prototype,"fontStretch",void 0),m([Al("font-style",String)],e.prototype,"fontStyle",void 0),m([Al("font-variant",String)],e.prototype,"fontVariant",void 0),m([Al("font-weight",String)],e.prototype,"fontWeight",void 0),m([Al("height",[Hu,String])],e.prototype,"height",void 0),m([Al("justify-content",String)],e.prototype,"justifyContent",void 0),m([Al("left",[Hu,String])],e.prototype,"left",void 0),m([Al("line-height",la)],e.prototype,"lineHeight",void 0),m([Al("margin-top",[Hu,String])],e.prototype,"marginTop",void 0),m([Al("margin-right",[Hu,String])],e.prototype,"marginRight",void 0),m([Al("margin-bottom",[Hu,String])],e.prototype,"marginBottom",void 0),m([Al("margin-left",[Hu,String])],e.prototype,"marginLeft",void 0),m([Al("max-height",[Hu,String])],e.prototype,"maxHeight",void 0),m([Al("max-width",[Hu,String])],e.prototype,"maxWidth",void 0),m([Al("min-height",[Hu,String])],e.prototype,"minHeight",void 0),m([Al("min-width",[Hu,String])],e.prototype,"minWidth",void 0),m([Al("opacity",Number)],e.prototype,"opacity",void 0),m([Al("order",Number)],e.prototype,"order",void 0),m([Al("outline-color",[ta,String])],e.prototype,"outlineColor",void 0),m([Al("outline-style",String)],e.prototype,"outlineStyle",void 0),m([Al("outline-width",[Hu,String])],e.prototype,"outlineWidth",void 0),m([Al("overflow",String)],e.prototype,"overflow",void 0),m([Al("overflow-x",String)],e.prototype,"overflowX",void 0),m([Al("overflow-y",String)],e.prototype,"overflowY",void 0),m([Al("padding-top",Hu)],e.prototype,"paddingTop",void 0),m([Al("padding-right",Hu)],e.prototype,"paddingRight",void 0),m([Al("padding-bottom",Hu)],e.prototype,"paddingBottom",void 0),m([Al("padding-left",Hu)],e.prototype,"paddingLeft",void 0),m([Al("pointer-events",String)],e.prototype,"pointerEvents",void 0),m([Al("position",String)],e.prototype,"position",void 0),m([Al("right",[Hu,String])],e.prototype,"right",void 0),m([Al("text-align",String)],e.prototype,"textAlign",void 0),m([Al("text-decoration-color",[ta,String])],e.prototype,"textDecorationColor",void 0),m([Al("text-decoration-line",String)],e.prototype,"textDecorationLine",void 0),m([Al("text-decoration-style",String)],e.prototype,"textDecorationStyle",void 0),m([Al("text-overflow",String)],e.prototype,"textOverflow",void 0),m([Al("text-transform",String)],e.prototype,"textTransform",void 0),m([Al("top",[Hu,String])],e.prototype,"top",void 0),m([Al("touch-action",String)],e.prototype,"touchAction",void 0),m([Al("transform",_a)],e.prototype,"transform",void 0),m([Al(["user-select","-webkit-user-select","-moz-user-select","-ms-user-select"],String)],e.prototype,"userSelect",void 0),m([Al("vertical-align",[Hu,String])],e.prototype,"verticalAlign",void 0),m([Al("visibility",String)],e.prototype,"visibility",void 0),m([Al("white-space",String)],e.prototype,"whiteSpace",void 0),m([Al("width",[Hu,String])],e.prototype,"width",void 0),m([Al("z-index",[Number,String])],e.prototype,"zIndex",void 0),e}(dl);el.Html=sc;var uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e}(ic),ac=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,e,r)||this;return i.onClick=i.onClick.bind(i),i.onDblClick=i.onDblClick.bind(i),i.onContextMenu=i.onContextMenu.bind(i),i.onMouseDown=i.onMouseDown.bind(i),i.onMouseMove=i.onMouseMove.bind(i),i.onMouseUp=i.onMouseUp.bind(i),i.onWheel=i.onWheel.bind(i),i.onTouchStart=i.onTouchStart.bind(i),i.onTouchMove=i.onTouchMove.bind(i),i.onTouchCancel=i.onTouchCancel.bind(i),i.onTouchEnd=i.onTouchEnd.bind(i),i._eventSurface=i._node,i._renderedViews=[],i._renderer=void 0,i._bounds=uo.empty(),i._anchor=no.origin(),i._clientX=0,i._clientY=0,i._screenX=0,i._screenY=0,i._hoverView=null,i._touches={},i}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0}),e.prototype.initNode=function(t){t.style.position="absolute"},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvasView",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childViews",{get:function(){for(var t=this._node.childNodes,e=[],r=0,i=t.length;r<i;r+=1){var n=t[r].view;n&&e.push(n)}return e.push.apply(e,this._renderedViews),e},enumerable:!0,configurable:!0}),e.prototype.getChildView=function(t){for(var e=this._renderedViews,r=e.length-1;r>=0;r-=1){var i=e[r];if(i.key()===t)return i}var n=this._node.childNodes;for(r=n.length-1;r>=0;r-=1){var o=n[r].view;if(o&&o.key()===t)return o}return null},e.prototype.setChildView=function(e,r){return Hl.is(r)?this.setRenderedView(e,r):t.prototype.setChildView.call(this,e,r)},e.prototype.setRenderedView=function(t,e){if(!Hl.is(e))throw new TypeError(""+e);for(var r=null,i=null,n=this._renderedViews,o=n.length-1;o>=0;){var s=n[o];if(s.key()===t){r=s,i=n[o+1]||null,this.willRemoveChildView(s),s.setParentView(null),n.splice(o,1),this.onRemoveChildView(s),this.didRemoveChildView(s);break}o-=1}return e&&(e.key(t),this.willInsertChildView(e,i),o>=0?n.splice(o,0,e):n.push(e),e.setParentView(this),this.onInsertChildView(e,i),this.didInsertChildView(e,i)),r},Object.defineProperty(e.prototype,"renderedViews",{get:function(){return this._renderedViews},enumerable:!0,configurable:!0}),e.prototype.append=function(t,e){return"string"==typeof t&&(t=sc.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,e)),this.appendChildView(t),t},e.prototype.appendChildView=function(e){Hl.is(e)?this.appendRenderedView(e):t.prototype.appendChildView.call(this,e)},e.prototype.appendRenderedView=function(t){this.willInsertChildView(t,null),this._renderedViews.push(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null)},e.prototype.prepend=function(t,e){return"string"==typeof t&&(t=sc.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,e)),this.prependChildView(t),t},e.prototype.prependChildView=function(e){Hl.is(e)?this.prependRenderedView(e):t.prototype.prependChildView.call(this,e)},e.prototype.prependRenderedView=function(t){this.willInsertChildView(t,null),this._renderedViews.unshift(t),t.setParentView(this),this.onInsertChildView(t,null),this.didInsertChildView(t,null)},e.prototype.insert=function(t,e,r){return"string"==typeof t&&(t=sc.create(t)),t instanceof Node&&(t=el.fromNode(t)),"function"==typeof t&&(t=el.create(t,r)),this.insertChild(t,e),t},e.prototype.insertChildView=function(e,r){Hl.is(e)&&Hl.is(r)?this.insertRenderedView(e,r):t.prototype.insertChildView.call(this,e,r)},e.prototype.insertRenderedView=function(t,e){if(null!==e&&!Hl.is(e))throw new TypeError(""+e);if(null!==e&&e.parentView!==this)throw new TypeError(""+e);var r=this._renderedViews;this.willInsertChildView(t,e);var i=e?r.indexOf(e):-1;i>=0?r.splice(i,0,t):r.push(t),t.setParentView(this),this.onInsertChildView(t,e),this.didInsertChildView(t,e)},e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r),Hl.is(e)&&(this.setChildViewBounds(e,this._bounds),this.setChildViewAnchor(e,this._anchor))},e.prototype.removeChildView=function(e){Hl.is(e)?this.removeRenderedView(e):t.prototype.removeChildView.call(this,e)},e.prototype.removeRenderedView=function(t){if(t.parentView!==this)throw new TypeError(""+t);var e=this._renderedViews;this.willRemoveChildView(t),t.setParentView(null);var r=e.indexOf(t);r>=0&&e.splice(r,1),this.onRemoveChildView(t),this.didRemoveChildView(t)},e.prototype.removeAll=function(){t.prototype.removeAll.call(this);for(var e=this._renderedViews;;){var r=e.length;if(!(r>0))break;var i=e[r-1];this.willRemoveChildView(i),i.setParentView(null),e.pop(),this.onRemoveChildView(i),this.didRemoveChildView(i)}},Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){var t=this._renderer;return void 0===t&&(t=this.createRenderer(),this._renderer=t),t},enumerable:!0,configurable:!0}),e.prototype.setRenderer=function(t){"string"==typeof t&&(t=this.createRenderer(t)),this._renderer=t,this.resetRenderer()},e.prototype.createRenderer=function(t){if(void 0===t&&(t="canvas"),"canvas"===t){if(e=this._node.getContext("2d"))return new Fp(e,this.pixelRatio);throw new Error("Failed to create canvas rendering context")}if("webgl"===t){var e;if(e=this._node.getContext("webgl"))return new Lp(e,this.pixelRatio);throw new Error("Failed to create webgl rendering context")}throw new Error("Failed to create "+t+" renderer")},e.prototype.requireUpdate=function(t,e){void 0===e&&(e=!1),this.requestUpdate(t,e)},e.prototype.requestUpdate=function(t,e){var r=this.updateFlags,i=r|t;if(0!==(i&~r)){this.setUpdateFlags(i);var n=this.parentView;n&&n.requestUpdate(t,e)}},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout|~el.UpdateFlagsMask))&&(t|=el.NeedsRender),t},e.prototype.doUpdate=function(t,e){var r=this.canvasViewContext(e);this._updateFlags=this._updateFlags&(el.NeedsCompute|el.NeedsAnimate|el.NeedsLayout|el.NeedsScroll|el.NeedsRender),this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(r),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.doLayout=function(t){this.parentView&&(this.resizeCanvas(this._node),this.resetRenderer(),this.willLayout(t),this.onLayout(t),this.didLayout(t))},e.prototype.doRender=function(t){this.parentView&&(this.willRender(t),this.onRender(t),this.didRender(t))},e.prototype.willRender=function(t){this.willObserve((function(e){e.viewWillRender&&e.viewWillRender(t,this)}))},e.prototype.onRender=function(t){this.clearCanvas()},e.prototype.didRender=function(t){this.didObserve((function(e){e.viewDidRender&&e.viewDidRender(t,this)}))},Object.defineProperty(e.prototype,"hidden",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.setHidden=function(t){},Object.defineProperty(e.prototype,"culled",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.setCulled=function(t){},Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),e.prototype.setBounds=function(t){var e=this.willSetBounds(t);void 0!==e&&(t=e);var r=this._bounds;this._bounds=t,this.onSetBounds(t,r);for(var i=this._renderedViews,n=0,o=i.length;n<o;n+=1)this.setChildViewBounds(i[n],t);this.didSetBounds(t,r)},e.prototype.willSetBounds=function(t){var e=this._viewController;if(e){var r=e.viewWillSetBounds(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetBounds&&s.viewWillSetBounds(t,this)}},e.prototype.onSetBounds=function(t,e){},e.prototype.didSetBounds=function(t,e){this.didObserve((function(r){r.viewDidSetBounds&&r.viewDidSetBounds(t,e,this)}))},e.prototype.setChildViewBounds=function(t,e){t.setBounds(e)},Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},enumerable:!0,configurable:!0}),e.prototype.setAnchor=function(t){var e=this.willSetAnchor(t);void 0!==e&&(t=e);var r=this._anchor;this._anchor=t,this.onSetAnchor(t,r);for(var i=this._renderedViews,n=0,o=i.length;n<o;n+=1)this.setChildViewAnchor(i[n],t);this.didSetAnchor(t,r)},e.prototype.willSetAnchor=function(t){var e=this._viewController;if(e){var r=e.viewWillSetAnchor(t,this);void 0!==r&&(t=r)}for(var i=this._viewObservers,n=0,o=i.length;n<o;n+=1){var s=i[n];s.viewWillSetAnchor&&s.viewWillSetAnchor(t,this)}},e.prototype.onSetAnchor=function(t,e){},e.prototype.didSetAnchor=function(t,e){this.didObserve((function(r){r.viewDidSetAnchor&&r.viewDidSetAnchor(t,e,this)}))},e.prototype.setChildViewAnchor=function(t,e){t.setAnchor(e)},e.prototype.onMount=function(){this.addEventListeners(this._eventSurface)},e.prototype.onUnmount=function(){this.removeEventListeners(this._eventSurface),t.prototype.onUnmount.call(this)},e.prototype.doMountChildViews=function(){for(var t=this._node.childNodes,e=0;e<t.length;e+=1){var r=t[e].view;r&&r.cascadeMount()}var i=this._renderedViews;for(e=0;e<i.length;e+=1){i[e].cascadeMount()}},e.prototype.doUnmountChildViews=function(){for(var t=this._node.childNodes,e=0;e<t.length;e+=1){var r=t[e].view;r&&r.cascadeUnmount()}var i=this._renderedViews;for(e=0;e<i.length;e+=1){i[e].cascadeUnmount()}},e.prototype.didUpdate=function(e){t.prototype.didUpdate.call(this,e),this.detectMouseHover()},e.prototype.onLayout=function(e){t.prototype.onLayout.call(this,e),this.layoutChildViews(e)},e.prototype.layoutChildViews=function(t){for(var e=this._renderedViews,r=0;r<e.length;r+=1){var i=e[r];this.layoutChildView(i,t)}},e.prototype.layoutChildView=function(t,e){Hl.is(t)&&(t.setBounds(this._bounds),t.setAnchor(this._anchor))},e.prototype.doUpdateChildViews=function(t,e){this.willUpdateChildViews(e);for(var r=this._node.childNodes,i=0;i<r.length;i+=1){var n=r[i].view;if(n){var o=this.childViewContext(n,e);n.cascadeUpdate(t,o)}}var s=this._renderedViews;for(i=0;i<s.length;i+=1){var u=s[i],a=this.childViewContext(u,e);u.cascadeUpdate(t,a)}this.didUpdateChildViews(e)},e.prototype.childViewContext=function(t,e){return e},e.prototype.canvasViewContext=function(t){return void 0===t&&(t=this.appView.appViewContext()),{updateTime:t.updateTime,viewport:t.viewport,viewIdiom:t.viewIdiom,renderer:this.renderer}},Object.defineProperty(e.prototype,"hitBounds",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(t,e,r){void 0===r&&(r=this.canvasViewContext());for(var i=null,n=this._renderedViews,o=n.length-1;o>=0;o-=1){var s=n[o];if(!s.hidden&&!s.culled)if((s.hitBounds||s.bounds).contains(t,e)&&null!==(i=s.hitTest(t,e,r)))break}return i},Object.defineProperty(e.prototype,"eventSurface",{get:function(){return this._eventSurface},enumerable:!0,configurable:!0}),e.prototype.setEventSurface=function(t){void 0===t&&(t=this._node),this._eventSurface!==t&&(this.removeEventListeners(this._eventSurface),this._eventSurface=t,this.addEventListeners(this._eventSurface))},e.prototype.handleEvent=function(t){},e.prototype.bubbleEvent=function(t){return this.handleEvent(t),this},e.prototype.addEventListeners=function(t){t.addEventListener("click",this.onClick),t.addEventListener("dblclick",this.onDblClick),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("wheel",this.onWheel,{passive:!0}),t.addEventListener("touchstart",this.onTouchStart,{passive:!0}),t.addEventListener("touchmove",this.onTouchMove,{passive:!0}),t.addEventListener("touchcancel",this.onTouchCancel),t.addEventListener("touchend",this.onTouchEnd)},e.prototype.removeEventListeners=function(t){t.removeEventListener("click",this.onClick),t.removeEventListener("dblclick",this.onDblClick),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("wheel",this.onWheel),t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchcancel",this.onTouchCancel),t.removeEventListener("touchend",this.onTouchEnd)},e.prototype.fireEvent=function(t,e,r){var i=this.clientBounds;if(i.contains(e,r)){var n=e-i.x,o=r-i.y,s=this.hitTest(n,o);if(s)return t.targetView=s,s.bubbleEvent(t),s}return null},e.prototype.fireMouseEvent=function(t){return this.fireEvent(t,t.clientX,t.clientY)},e.prototype.onClick=function(t){this.fireMouseEvent(t)},e.prototype.onDblClick=function(t){this.fireMouseEvent(t)},e.prototype.onContextMenu=function(t){this.fireMouseEvent(t)},e.prototype.onMouseDown=function(t){this.fireMouseEvent(t)},e.prototype.onMouseMove=function(t){this._clientX=t.clientX,this._clientY=t.clientY,this._screenX=t.screenX,this._screenY=t.screenY;var e=this._hoverView,r=this.fireMouseEvent(t);r!==this._hoverView&&this.onMouseHoverChange(r,e)},e.prototype.onMouseUp=function(t){this.fireMouseEvent(t)},e.prototype.onWheel=function(t){this.fireMouseEvent(t)},e.prototype.onMouseHoverChange=function(t,e){var r={clientX:this._clientX,clientY:this._clientY,screenX:this._screenX,screenY:this._screenY,bubbles:!0};if(e){var i=new MouseEvent("mouseout",r);i.targetView=e,i.relatedTargetView=t,e.bubbleEvent(i)}if(this._hoverView=t,t){var n=new MouseEvent("mouseover",r);n.targetView=t,n.relatedTargetView=e,t.bubbleEvent(n)}},e.prototype.detectMouseHover=function(){var t=this.clientBounds;if(t.contains(this._clientX,this._clientY)){var e=this._clientX-t.x,r=this._clientY-t.y,i=this._hoverView,n=this.hitTest(e,r);n!==i&&this.onMouseHoverChange(n,i)}},e.prototype.fireTouchEvent=function(t,e,r){for(var i=e.changedTouches,n=function(n,o){var s,u=i[n],a=u.targetView;if(a&&r.indexOf(a)<0){var h=new TouchEvent(t,{changedTouches:i,targetTouches:e.targetTouches,touches:e.touches,bubbles:!0});h.targetView=a;for(var p=[u],l=n+1;l<o;l+=1){var c=i[l];c.targetView===a&&p.push(c)}document.createTouchList,h.targetViewTouches=(s=document).createTouchList.apply(s,p),a.bubbleEvent(h),r.push(a)}},o=0,s=i.length;o<s;o+=1)n(o,s)},e.prototype.onTouchStart=function(t){for(var e=this.clientBounds,r=t.changedTouches,i=0,n=r.length;i<n;i+=1){var o=r[i],s=o.clientX,u=o.clientY;if(e.contains(s,u)){var a=s-e.x,h=u-e.y,p=this.hitTest(a,h);p&&(o.targetView=p)}this._touches[o.identifier]=o}this.fireTouchEvent("touchstart",t,[])},e.prototype.onTouchMove=function(t){for(var e=t.changedTouches,r=0,i=e.length;r<i;r+=1){var n=e[r],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchmove",t,[])},e.prototype.onTouchCancel=function(t){for(var e=t.changedTouches,r=e.length,i=0;i<r;i+=1){var n=e[i],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchcancel",t,[]);for(i=0;i<r;i+=1){n=e[i];delete this._touches[n.identifier]}},e.prototype.onTouchEnd=function(t){for(var e=t.changedTouches,r=e.length,i=0;i<r;i+=1){var n=e[i],o=this._touches[n.identifier];o&&(n.targetView=o.targetView)}this.fireTouchEvent("touchend",t,[]);for(i=0;i<r;i+=1){n=e[i];delete this._touches[n.identifier]}},e.prototype.resizeCanvas=function(t){var e,r,i,n=t.parentNode;if(n instanceof HTMLElement){var o=void 0;do{if((o=n.getBoundingClientRect()).width&&o.height)break;n=n.parentNode}while(n instanceof HTMLElement);e=Math.floor(o.width),r=Math.floor(o.height),i=this.pixelRatio,t.width=e*i,t.height=r*i,t.style.width=e+"px",t.style.height=r+"px"}else e=Math.floor(t.width),r=Math.floor(t.height),i=1;this.setBounds(new uo(0,0,e,r)),this.setAnchor(new no(e/2,r/2))},e.prototype.clearCanvas=function(){var t=this.renderer;if(t instanceof Fp){var e=this._bounds;t.context.clearRect(0,0,e.width,e.height)}else if(t instanceof Lp){var r=t.context;r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)}},e.prototype.resetRenderer=function(){var t=this.renderer;if(t instanceof Fp){var e=this.pixelRatio;t.context.setTransform(e,0,0,e,0,0)}else if(t instanceof Lp){var r=this._bounds;t.context.viewport(0,0,r.width,r.height)}},e.tag="canvas",e}(sc);el.Canvas=ac;var hc,pc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t=this._view;return t?t.node:null},enumerable:!0,configurable:!0}),e.prototype.viewWillUpdate=function(t,e){},e.prototype.viewDidUpdate=function(t,e){},e.prototype.viewWillCompute=function(t,e){},e.prototype.viewDidCompute=function(t,e){},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e.prototype.viewWillLayout=function(t,e){},e.prototype.viewDidLayout=function(t,e){},e.prototype.viewWillScroll=function(t,e){},e.prototype.viewDidScroll=function(t,e){},e.prototype.viewWillRender=function(t,e){},e.prototype.viewDidRender=function(t,e){},e.prototype.viewWillUpdateChildViews=function(t,e){},e.prototype.viewDidUpdateChildViews=function(t,e){},Object.defineProperty(e.prototype,"hidden",{get:function(){var t=this._view;return!!t&&t.hidden},enumerable:!0,configurable:!0}),e.prototype.viewWillSetHidden=function(t,e){},e.prototype.viewDidSetHidden=function(t,e){},e.prototype.viewWillCull=function(t){},e.prototype.viewDidCull=function(t){},Object.defineProperty(e.prototype,"culled",{get:function(){var t=this._view;return!!t&&t.culled},enumerable:!0,configurable:!0}),e.prototype.viewWillSetCulled=function(t,e){},e.prototype.viewDidSetCulled=function(t,e){},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this._view;return t?t.bounds:uo.empty()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetBounds=function(t,e){},e.prototype.viewDidSetBounds=function(t,e,r){},Object.defineProperty(e.prototype,"anchor",{get:function(){var t=this._view;return t?t.anchor:no.origin()},enumerable:!0,configurable:!0}),e.prototype.viewWillSetAnchor=function(t,e){},e.prototype.viewDidSetAnchor=function(t,e,r){},e}(uc),lc=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,e,r)||this;return i.performUpdate=i.performUpdate.bind(i),i.throttleResize=i.throttleResize.bind(i),i.throttleScroll=i.throttleScroll.bind(i),i.debounceReorientation=i.debounceReorientation.bind(i),i.doReorientation=i.doReorientation.bind(i),i.onClick=i.onClick.bind(i),i._popovers=[],i._viewport=null,i._viewIdiom=null,i._solver=null,i._updateTime=0,i._updateFrame=0,i._updateTimer=0,i._updateDelay=16,i._reorientationTimer=0,i.initApp(),i}return _(e,t),e.prototype.initApp=function(){this.isRootView()&&this.isMounted()&&this.onRootMount()},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appView",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.isRootView=function(){for(var t=this._node;;){var e=t.parentNode;if(!e)break;if(e.view instanceof el)return!1;t=e}return!0},Object.defineProperty(e.prototype,"popovers",{get:function(){return this._popovers},enumerable:!0,configurable:!0}),e.prototype.togglePopover=function(t,e){var r=t.popoverState;"hidden"===r||"hiding"===r?this.showPopover(t,e):"shown"!==r&&"showing"!==r||this.hidePopover(t)},e.prototype.showPopover=function(t,e){void 0===e&&(e={}),this.willShowPopover(t,e),e&&!e.multi&&this.hidePopovers(),this._popovers.indexOf(t)<0&&this._popovers.push(t);var r=t.popoverView;r&&!r.isMounted()&&this.insertPopoverView(r),this.onShowPopover(t,e),t.showPopover(!0),this.didShowPopover(t,e)},e.prototype.insertPopoverView=function(t){this.appendChildView(t),t.cascadeUpdate(el.NeedsLayout,this.appViewContext())},e.prototype.willShowPopover=function(t,e){this.willObserve((function(r){r.viewWillShowPopover&&r.viewWillShowPopover(t,e,this)}))},e.prototype.onShowPopover=function(t,e){},e.prototype.didShowPopover=function(t,e){this.didObserve((function(r){r.viewDidShowPopover&&r.viewDidShowPopover(t,e,this)}))},e.prototype.hidePopover=function(t){var e=this._popovers,r=e.indexOf(t);r>=0&&(this.willHidePopover(t),e.splice(r,1),this.onHidePopover(t),t.hidePopover(!0),this.didHidePopover(t))},e.prototype.willHidePopover=function(t){this.willObserve((function(e){e.viewWillHidePopover&&e.viewWillHidePopover(t,this)}))},e.prototype.onHidePopover=function(t){},e.prototype.didHidePopover=function(t){this.didObserve((function(e){e.viewDidHidePopover&&e.viewDidHidePopover(t,this)}))},e.prototype.hidePopovers=function(){for(var t=this._popovers;t.length;){var e=t[0];this.willHidePopover(e),t.shift(),this.onHidePopover(e),e.hidePopover(!0),this.didHidePopover(e)}},Object.defineProperty(e.prototype,"solver",{get:function(){return this._solver||null},enumerable:!0,configurable:!0}),e.prototype.activateVariable=function(t){null===this._solver&&(this._solver=new Nl(this)),this._solver.addVariable(t)},e.prototype.deactivateVariable=function(t){null!==this._solver&&this._solver.removeVariable(t)},e.prototype.setVariable=function(t,e){null!==this._solver&&this._solver.setVariable(t,e)},e.prototype.activateConstraint=function(t){null===this._solver&&(this._solver=new Nl(this)),this._solver.addConstraint(t)},e.prototype.deactivateConstraint=function(t){null!==this._solver&&this._solver.removeConstraint(t)},Object.defineProperty(e.prototype,"viewport",{get:function(){var t=this._viewport;return null===t&&(t=this.appViewport(),this._viewport=t),t},enumerable:!0,configurable:!0}),e.prototype.appViewport=function(){var t=0,e=0,r=0,i=0,n=document.documentElement.style.width,o=document.documentElement.style.height;document.documentElement.style.width="100%",document.documentElement.style.height="100%";var s=document.createElement("div");s.style.setProperty("position","fixed"),s.style.setProperty("top","0"),s.style.setProperty("right","0"),s.style.setProperty("width",window.innerWidth===document.documentElement.offsetWidth?"100%":"100vw"),s.style.setProperty("height",window.innerHeight===document.documentElement.offsetHeight?"100%":"100vh"),s.style.setProperty("box-sizing","border-box"),s.style.setProperty("padding-top","env(safe-area-inset-top)"),s.style.setProperty("padding-right","env(safe-area-inset-right)"),s.style.setProperty("padding-bottom","env(safe-area-inset-bottom)"),s.style.setProperty("padding-left","env(safe-area-inset-left)"),s.style.setProperty("overflow","hidden"),s.style.setProperty("visibility","hidden"),document.body.appendChild(s);var u=window.getComputedStyle(s),a=parseFloat(u.getPropertyValue("width")),h=parseFloat(u.getPropertyValue("height"));"undefined"!=typeof CSS&&"function"==typeof CSS.supports&&CSS.supports("padding-top: env(safe-area-inset-top)")&&(t=parseFloat(u.getPropertyValue("padding-top")),e=parseFloat(u.getPropertyValue("padding-right")),r=parseFloat(u.getPropertyValue("padding-bottom")),i=parseFloat(u.getPropertyValue("padding-left"))),document.body.removeChild(s),document.documentElement.style.width=n,document.documentElement.style.height=o;var p={insetTop:t,insetRight:e,insetBottom:r,insetLeft:i},l=screen.msOrientation||screen.mozOrientation||(screen.orientation||{}).type;if(!l)switch(window.orientation){case 0:l="portrait-primary";break;case 180:l="portrait-secondary";break;case-90:l="landscape-primary";break;case 90:l="landscape-secondary";break;default:l="landscape-primary"}return{width:a,height:h,safeArea:p,orientation:l}},Object.defineProperty(e.prototype,"viewIdiom",{get:function(){var t=this._viewIdiom;return null===t&&(t=this.appViewIdiom(),this._viewIdiom=t),t},enumerable:!0,configurable:!0}),e.prototype.appViewIdiom=function(){return"unspecified"},e.prototype.appViewContext=function(){return{updateTime:performance.now(),viewport:this.viewport,viewIdiom:this.viewIdiom}},Object.defineProperty(e.prototype,"updateTime",{get:function(){return this._updateTime},enumerable:!0,configurable:!0}),e.prototype.requestUpdate=function(t,e){e?(this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=0),this._updateFrame||(this._updateFrame=requestAnimationFrame(this.performUpdate),this._updateDelay=16)):this._updateFrame||this._updateTimer||(16===this._updateDelay?this._updateFrame=requestAnimationFrame(this.performUpdate):this._updateTimer=setTimeout(this.performUpdate,this._updateDelay))},e.prototype.performUpdate=function(){this._updateFrame&&(cancelAnimationFrame(this._updateFrame),this._updateFrame=0),this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=0);var t=this.appViewContext(),e=t.updateTime,r=e-this._updateTime;if(this._updateDelay>16&&r<this._updateDelay)this._updateTimer=setTimeout(this.performUpdate,this._updateDelay-r);else{this._updateTime=e;var i=this.updateFlags;i=this.needsUpdate(i,t),this.doUpdate(i,t);var n=performance.now();this._updateDelay=Math.min(n-e>this._updateDelay?2*this._updateDelay:16,166),16!==this._updateDelay&&(this._updateFrame?(cancelAnimationFrame(this._updateFrame),this._updateFrame=0,this._updateTimer=setTimeout(this.performUpdate,this._updateDelay)):this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=setTimeout(this.performUpdate,this._updateDelay)))}},e.prototype.cascadeUpdate=function(t,e){},e.prototype.doUpdate=function(t,e){this.willUpdate(e),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(e)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(e)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(e)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(e)),this.onUpdate(e),this.doUpdateChildViews(t,e),this.didUpdate(e)},e.prototype.updateLayoutStates=function(){t.prototype.updateLayoutStates.call(this),this.hasOwnProperty("safeAreaInsetTop")&&this.safeAreaInsetTop.updateState(),this.hasOwnProperty("safeAreaInsetRight")&&this.safeAreaInsetRight.updateState(),this.hasOwnProperty("safeAreaInsetBottom")&&this.safeAreaInsetBottom.updateState(),this.hasOwnProperty("safeAreaInsetLeft")&&this.safeAreaInsetLeft.updateState()},e.prototype.updateVariables=function(){null!==this._solver&&this._solver.updateVariables()},e.prototype.onRootMount=function(){this.isRootView()&&this.isMounted()&&this.cascadeMount()},e.prototype.onMount=function(){t.prototype.onMount.call(this),"undefined"!=typeof window&&(window.addEventListener("resize",this.throttleResize),window.addEventListener("scroll",this.throttleScroll,{passive:!0}),window.addEventListener("orientationchange",this.debounceReorientation),this.on("click",this.onClick))},e.prototype.onUnmount=function(){this._updateFrame&&(cancelAnimationFrame(this._updateFrame),this._updateFrame=0),this._updateTimer&&(clearTimeout(this._updateTimer),this._updateTimer=0),this._reorientationTimer&&(clearTimeout(this._reorientationTimer),this._reorientationTimer=0),"undefined"!=typeof window&&(window.removeEventListener("resize",this.throttleResize),window.removeEventListener("scroll",this.throttleScroll),window.removeEventListener("orientationchange",this.debounceReorientation),this.off("click",this.onClick)),t.prototype.onUnmount.call(this)},e.prototype.throttleLayout=function(){this.requireUpdate(el.NeedsLayout)},e.prototype.throttleResize=function(){this._viewport=null,this._viewIdiom=null,this.requireUpdate(el.NeedsLayout)},e.prototype.throttleScroll=function(){this.requireUpdate(el.NeedsScroll)},e.prototype.debounceReorientation=function(){this._reorientationTimer&&(clearTimeout(this._reorientationTimer),this._reorientationTimer=0),this._reorientationTimer=setTimeout(this.doReorientation,500)},e.prototype.doReorientation=function(){this._reorientationTimer&&(clearTimeout(this._reorientationTimer),this._reorientationTimer=0),this.throttleResize()},e.prototype.didAddConstraint=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didRemoveConstraint=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didAddVariable=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didRemoveVariable=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.onClick=function(t){this.onFallthroughClick(t)},e.prototype.onFallthroughClick=function(t){this.hidePopovers()},m([zl({get:function(t){var e=this.viewport.safeArea.insetTop;return t!==e&&this.requireUpdate(el.NeedsLayout),e},strength:"strong"})],e.prototype,"safeAreaInsetTop",void 0),m([zl({get:function(t){var e=this.viewport.safeArea.insetRight;return t!==e&&this.requireUpdate(el.NeedsLayout),e},strength:"strong"})],e.prototype,"safeAreaInsetRight",void 0),m([zl({get:function(t){var e=this.viewport.safeArea.insetBottom;return t!==e&&this.requireUpdate(el.NeedsLayout),e},strength:"strong"})],e.prototype,"safeAreaInsetBottom",void 0),m([zl({get:function(t){var e=this.viewport.safeArea.insetLeft;return t!==e&&this.requireUpdate(el.NeedsLayout),e},strength:"strong"})],e.prototype,"safeAreaInsetLeft",void 0),e}(sc),cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"popovers",{get:function(){var t=this._view;return t?t.popovers:[]},enumerable:!0,configurable:!0}),e.prototype.viewWillShowPopover=function(t,e,r){},e.prototype.viewDidShowPopover=function(t,e,r){},e.prototype.viewWillHidePopover=function(t,e){},e.prototype.viewDidHidePopover=function(t,e){},e}(uc),fc=function(t){function e(e,r){void 0===e&&(e=document.createElement("div")),void 0===r&&(r=null);var i=t.call(this,e,r)||this;i.arrowWidth.setState(Hu.fromAny(10)),i.arrowHeight.setState(Hu.fromAny(8)),i._source=null,i._sourceBounds=null,i._popoverState="shown",i._placement=["top","bottom","right","left"],i._placementBounds=null,i._popoverTransition=tp.duration(250,$h.cubicOut);var n=i.createArrow();if(n){var o=el.fromNode(n).key("arrow");i.prependChildView(o)}return i}return _(e,t),e.prototype.createArrow=function(){var t=document.createElement("div");return t.setAttribute("class","popover-arrow"),t.style.setProperty("display","none"),t.style.setProperty("position","absolute"),t.style.setProperty("width","0"),t.style.setProperty("height","0"),t},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.setSource=function(t){this._source!==t&&(this.willSetSource(t),null!==this._source&&this.isMounted()&&this._source.removeViewObserver(this),this._source=t,this.onSetSource(t),null!==this._source&&this.isMounted()&&this._source.addViewObserver(this),this.didSetSource(t))},e.prototype.willSetSource=function(t){this.willObserve((function(e){e.popoverWillSetSource&&e.popoverWillSetSource(t,this)}))},e.prototype.onSetSource=function(t){this.requireUpdate(el.NeedsLayout)},e.prototype.didSetSource=function(t){this.didObserve((function(e){e.popoverDidSetSource&&e.popoverDidSetSource(t,this)}))},Object.defineProperty(e.prototype,"popoverState",{get:function(){return this._popoverState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverView",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.togglePopover=function(t){"hidden"===this._popoverState||"hiding"===this._popoverState?this.showPopover(t):"shown"!==this._popoverState&&"showing"!==this._popoverState||this.hidePopover(t)},e.prototype.showPopover=function(t){if("hidden"===this._popoverState||"hiding"===this._popoverState){void 0===t||!0===t?t=this._popoverTransition||void 0:t&&(t=tp.fromAny(t)),this.willShow();var e=this.place();t?(t=t.onEnd(this.didShow.bind(this)),"above"===e?(this.opacity.setState(void 0),void 0===this.marginTop.value&&this.marginTop(-this._node.offsetHeight),this.marginTop(0,t)):"below"===e?(this.opacity.setState(void 0),void 0===this.marginTop.value&&this.marginTop(this._node.offsetHeight),this.marginTop(0,t)):(this.marginTop.setState(void 0),void 0===this.opacity.value&&this.opacity(0),this.opacity(1,t))):this.didShow()}},e.prototype.willShow=function(){this.willObserve((function(t){t.popoverWillShow&&t.popoverWillShow(this)})),this.visibility("visible"),this._popoverState="showing"},e.prototype.didShow=function(){this._popoverState="shown",this.pointerEvents("auto"),this.marginTop.setState(void 0),this.opacity.setState(void 0),this.didObserve((function(t){t.popoverDidShow&&t.popoverDidShow(this)}))},e.prototype.hidePopover=function(t){if("shown"===this._popoverState||"showing"===this._popoverState){void 0===t||!0===t?t=this._popoverTransition||void 0:t&&(t=tp.fromAny(t)),this.willHide();var e=this.place();t?(t=t.onEnd(this.didHide.bind(this)),"above"===e?(this.opacity.setState(void 0),void 0===this.marginTop.value&&this.marginTop(0),this.marginTop(-this._node.offsetHeight,t)):"below"===e?(this.opacity.setState(void 0),void 0===this.marginTop.value&&this.marginTop(0),this.marginTop(this._node.offsetHeight,t)):(this.marginTop.setState(void 0),void 0===this.opacity.value&&this.opacity(1),this.opacity(0,t))):this.didHide()}},e.prototype.willHide=function(){this.willObserve((function(t){t.popoverWillHide&&t.popoverWillHide(this)})),this.pointerEvents("none"),this._popoverState="hiding"},e.prototype.didHide=function(){this._popoverState="hidden",this.visibility("hidden"),this.marginTop.setState(void 0),this.opacity.setState(void 0),this.didObserve((function(t){t.popoverDidHide&&t.popoverDidHide(this)}))},e.prototype.placement=function(t){if(void 0===t)return this._placement;if(!f.equalArray(this._placement,t)){this._placement.length=0;for(var e=0,r=t.length;e<r;e+=1)this._placement.push(t[e]);this.place()}return this},e.prototype.placementBounds=function(t){return void 0===t?this._placementBounds:(f.equal(this._placementBounds,t)||(this._placementBounds=t,this.place()),this)},e.prototype.popoverTransition=function(t){return void 0===t?this._popoverTransition:(this._popoverTransition=null!==t?tp.fromAny(t):null,this)},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsScroll))&&(t|=el.NeedsLayout),t},e.prototype.didMount=function(){this._source&&this._source.addViewObserver(this),t.prototype.didMount.call(this)},e.prototype.willUnmount=function(){t.prototype.willUnmount.call(this),this._source&&this._source.removeViewObserver(this)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.arrowWidth.onFrame(e),this.arrowHeight.onFrame(e)},e.prototype.onLayout=function(t){this.place()},e.prototype.place=function(){var t=this._source,e=this._sourceBounds,r=t?t.popoverBounds:null;if(r&&this._placement.length&&!r.equals(e)){var i=this.placePopover(t,r),n=this.getChildView("arrow");return n instanceof sc&&this.placeArrow(t,r,n,i),i}return"none"},e.prototype.placePopover=function(t,e){var r=this._node,i=r.offsetParent;if(!i)return"none";for(var n,o=Hu.fromAny(r.style.getPropertyValue("width")||r.offsetWidth).pxValue(),s=Hu.fromAny(r.style.getPropertyValue("height")||r.offsetHeight).pxValue(),u=i.getBoundingClientRect(),a=u.left,h=u.top,p=e.left-window.pageXOffset-a,l=e.right-window.pageXOffset-a,c=e.top-window.pageYOffset-h,f=e.bottom-window.pageYOffset-h,d=e.width,y=e.height,v=p+d/2,_=c+y/2,m=this._placementBounds,w=(m?m.left:0)-a,g=(m?m.right:window.innerWidth)-a,b=(m?m.top:0)-h,x=(m?m.bottom:window.innerHeight)-h,C=p-w,S=g-p-d,A=c-b,k=x-c-y,E=this.arrowHeight.value.pxValue(),O=0;O<this._placement.length;O+=1){if("above"===(P=this._placement[O])||"below"===P||"over"===P){n=P;break}if("top"===P&&s+E<=A){n=P;break}if("bottom"===P&&s+E<=k){n=P;break}if("left"===P&&o+E<=C){n=P;break}if("right"===P&&o+E<=S){n=P;break}}if(void 0===n){n="none";O=0;for(var V=this._placement.length;O<V;O+=1){var P;if("top"===(P=this._placement[O])&&A>=k){n=P;break}if("bottom"===P&&k>=A){n=P;break}if("left"===P&&C>=S){n=P;break}if("right"===P&&S>=C){n=P;break}}}var D,M,T=Hu.fromAny(r.style.getPropertyValue("max-width")||0).pxValue(),R=Hu.fromAny(r.style.getPropertyValue("max-height")||0).pxValue(),I=T,F=R,L=r.offsetLeft,U=r.offsetTop;return"above"===n?(L=w,U=b,D=(m?m.width:window.innerWidth)-g,I=Math.max(0,g-w),F=Math.max(0,x-b)):"below"===n?(L=w,U=x-s,D=g-(m?m.width:window.innerWidth),I=Math.max(0,g-w),F=Math.max(0,x-b)):"over"===n?(L=w,U=b,D=g-(m?m.width:window.innerWidth),M=x-(m?m.height:window.innerHeight),I=Math.max(0,g-w),F=Math.max(0,x-b)):"top"===n?(L=v-o/2<=w?w:v+o/2>=g?g-o:v-o/2,U=Math.max(b,c-(s+E)),I=Math.max(0,g-w),F=Math.max(0,f-b)):"bottom"===n?(L=v-o/2<=w?w:v+o/2>=g?g-o:v-o/2,U=Math.max(b,f+E),I=Math.max(0,g-w),F=Math.max(0,x-c)):"left"===n?(L=Math.max(w,p-(o+E)),U=_-s/2<=b?b:_+s/2>=x?x-s:_-s/2,I=Math.max(0,l-w),F=Math.max(0,x-b)):"right"===n&&(L=Math.max(w,l+E),U=_-s/2<=b?b:_+s/2>=x?x-s:_-s/2,I=Math.max(0,g-p),F=Math.max(0,x-b)),"none"===n||L===r.offsetLeft&&U===r.offsetTop&&I===T&&F===R||(this.willPlacePopover(n),r.style.setProperty("position","absolute"),r.style.setProperty("left",L+"px"),void 0!==D?r.style.setProperty("right",D+"px"):r.style.removeProperty("right"),r.style.setProperty("top",U+"px"),void 0!==M?r.style.setProperty("bottom",M+"px"):r.style.removeProperty("bottom"),r.style.setProperty("max-width",I+"px"),r.style.setProperty("max-height",F+"px"),this.onPlacePopover(n),this.didPlacePopover(n)),n},e.prototype.willPlacePopover=function(t){this.willObserve((function(e){e.popoverWillPlace&&e.popoverWillPlace(t,this)}))},e.prototype.onPlacePopover=function(t){},e.prototype.didPlacePopover=function(t){this.didObserve((function(e){e.popoverDidPlace&&e.popoverDidPlace(t,this)}))},e.prototype.placeArrow=function(t,e,r,i){var n=this._node,o=n.offsetParent;if(o){var s=r._node,u=o.getBoundingClientRect(),a=u.left,h=u.top,p=e.left-window.pageXOffset-a,l=e.top-window.pageYOffset-h,c=p+e.width/2,f=l+e.height/2,d=n.offsetLeft,y=d+n.offsetWidth,v=n.offsetTop,_=v+n.offsetHeight,m=this.backgroundColor()||ta.transparent(),w=this.borderRadius(),g=w instanceof Hu?w.pxValue():0,b=this.arrowWidth.value.pxValue(),x=this.arrowHeight.value.pxValue(),C=d+g+b/2,S=y-g-b/2,A=v+g+b/2,k=_-g-b/2;s.style.removeProperty("top"),s.style.removeProperty("right"),s.style.removeProperty("bottom"),s.style.removeProperty("left"),s.style.removeProperty("border-left-width"),s.style.removeProperty("border-left-style"),s.style.removeProperty("border-left-color"),s.style.removeProperty("border-right-width"),s.style.removeProperty("border-right-style"),s.style.removeProperty("border-right-color"),s.style.removeProperty("border-top-width"),s.style.removeProperty("border-top-style"),s.style.removeProperty("border-top-color"),s.style.removeProperty("border-bottom-width"),s.style.removeProperty("border-bottom-style"),s.style.removeProperty("border-bottom-color"),"none"===i||"above"===i||"below"===i||"over"===i?s.style.setProperty("display","none"):v-x>=f&&C<=c&&c<=S?(s.style.setProperty("display","block"),s.style.setProperty("top",-x+"px"),s.style.setProperty("left",c-d-b/2+"px"),s.style.setProperty("border-left-width",b/2+"px"),s.style.setProperty("border-left-style","solid"),s.style.setProperty("border-left-color","transparent"),s.style.setProperty("border-right-width",b/2+"px"),s.style.setProperty("border-right-style","solid"),s.style.setProperty("border-right-color","transparent"),s.style.setProperty("border-bottom-width",x+"px"),s.style.setProperty("border-bottom-style","solid"),s.style.setProperty("border-bottom-color",m.toString())):_+x<=f&&C<=c&&c<=S?(s.style.setProperty("display","block"),s.style.setProperty("bottom",-x+"px"),s.style.setProperty("left",c-d-b/2+"px"),s.style.setProperty("border-left-width",b/2+"px"),s.style.setProperty("border-left-style","solid"),s.style.setProperty("border-left-color","transparent"),s.style.setProperty("border-right-width",b/2+"px"),s.style.setProperty("border-right-style","solid"),s.style.setProperty("border-right-color","transparent"),s.style.setProperty("border-top-width",x+"px"),s.style.setProperty("border-top-style","solid"),s.style.setProperty("border-top-color",m.toString())):d-x>=c&&A<=f&&f<=k?(s.style.setProperty("display","block"),s.style.setProperty("left",-x+"px"),s.style.setProperty("top",f-v-b/2+"px"),s.style.setProperty("border-top-width",b/2+"px"),s.style.setProperty("border-top-style","solid"),s.style.setProperty("border-top-color","transparent"),s.style.setProperty("border-bottom-width",b/2+"px"),s.style.setProperty("border-bottom-style","solid"),s.style.setProperty("border-bottom-color","transparent"),s.style.setProperty("border-right-width",x+"px"),s.style.setProperty("border-right-style","solid"),s.style.setProperty("border-right-color",m.toString())):y+x<=c&&A<=f&&f<=k?(s.style.setProperty("display","block"),s.style.setProperty("right",-x+"px"),s.style.setProperty("top",f-v-b/2+"px"),s.style.setProperty("border-top-width",b/2+"px"),s.style.setProperty("border-top-style","solid"),s.style.setProperty("border-top-color","transparent"),s.style.setProperty("border-bottom-width",b/2+"px"),s.style.setProperty("border-bottom-style","solid"),s.style.setProperty("border-bottom-color","transparent"),s.style.setProperty("border-left-width",x+"px"),s.style.setProperty("border-left-style","solid"),s.style.setProperty("border-left-color",m.toString())):s.style.setProperty("display","none")}},e.prototype.viewDidMount=function(t){this.place()},e.prototype.viewDidUnmount=function(t){this.place()},e.prototype.viewDidLayout=function(t,e){this.place()},e.prototype.viewDidScroll=function(t,e){this.place()},e.prototype.viewWillSetAttribute=function(t,e,r){this.place()},e.prototype.viewDidSetAttribute=function(t,e,r){this.place()},e.prototype.viewWillSetStyle=function(t,e,r,i){this.place()},e.prototype.viewDidSetStyle=function(t,e,r,i){this.place()},e.prototype.viewDidSetAnchor=function(t,e,r){this.place()},m([rl(Hu)],e.prototype,"arrowWidth",void 0),m([rl(Hu)],e.prototype,"arrowHeight",void 0),e}(sc),dc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"source",{get:function(){var t=this._view;return t?t.source:null},enumerable:!0,configurable:!0}),e.prototype.popoverWillSetSource=function(t,e){},e.prototype.popoverDidSetSource=function(t,e){},e.prototype.popoverWillPlace=function(t,e){},e.prototype.popoverDidPlace=function(t,e){},e.prototype.popoverWillShow=function(t){},e.prototype.popoverDidShow=function(t){},e.prototype.popoverWillHide=function(t){},e.prototype.popoverDidHide=function(t){},e}(uc),yc=function(){function t(t,e,r,i){this._x=t,this._y=e,this._width=r,this._height=i}return t.prototype.x=function(t){return void 0===t?this._x:(t=Hu.fromAny(t),this._x.equals(t)?this:this.copy(t,this._y,this._width,this._height))},t.prototype.y=function(t){return void 0===t?this._y:(t=Hu.fromAny(t),this._y.equals(t)?this:this.copy(this._x,t,this._width,this._height))},t.prototype.width=function(t){return void 0===t?this._width:(t=Hu.fromAny(t),this._width.equals(t)?this:this.copy(this._x,this._y,t,this._height))},t.prototype.height=function(t){return void 0===t?this._height:(t=Hu.fromAny(t),this._height.equals(t)?this:this.copy(this._x,this._y,this._width,t))},t.prototype.render=function(t,e,r){if(void 0===t){var i=new Rp;return this.draw(i,e,r),i.toString()}t instanceof Ip&&this.draw(t.context,e,r)},t.prototype.draw=function(t,e,r){this.renderRect(t,e,r)},t.prototype.renderRect=function(t,e,r){var i,n;void 0!==r?(i=r.x,n=r.y):(i=0,n=0),t.rect(i+this._x.pxValue(),n+this._y.pxValue(),this._width.pxValue(),this._height.pxValue())},t.prototype.copy=function(e,r,i,n){return new t(e,r,i,n)},t.prototype.toAny=function(){return{x:this._x,y:this._y,width:this._width,height:this._height}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._x.equals(e._x)&&this._y.equals(e._y)&&this._width.equals(e._width)&&this._height.equals(e._height))},t.prototype.debug=function(t){t=t.write("Rect").write(46).write("from").write(40).debug(this._x).write(", ").debug(this._y).write(", ").debug(this._width).write(", ").debug(this._height).write(41)},t.prototype.toString=function(){return J.debug(this)},t.from=function(e,r,i,n){return new t(e=Hu.fromAny(e),r=Hu.fromAny(r),i=Hu.fromAny(i),n=Hu.fromAny(n))},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.x,e.y,e.width,e.height);throw new TypeError(""+e)},t}(),vc=function(t){function e(e,r,i,n){void 0===e&&(e=Hu.zero()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Hu.zero()),void 0===n&&(n=Hu.zero());var o=t.call(this)||this;return o.x.setState(e),o.y.setState(r),o.width.setState(i),o.height.setState(n),o}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new yc(this.x.value,this.y.value,this.width.value,this.height.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new yc(this.x.state,this.y.state,this.width.state,this.height.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){t instanceof yc&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.x&&this.x(t.x,e),void 0!==t.y&&this.y(t.y,e),void 0!==t.width&&this.width(t.width,e),void 0!==t.height&&this.height(t.height,e),void 0!==t.fill&&this.fill(t.fill,e),void 0!==t.stroke&&this.stroke(t.stroke,e),void 0!==t.strokeWidth&&this.strokeWidth(t.strokeWidth,e),void 0!==t.hidden&&this.setHidden(t.hidden),void 0!==t.culled&&this.setCulled(t.culled)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.x.onFrame(e),this.y.onFrame(e),this.width.onFrame(e),this.height.onFrame(e),this.fill.onFrame(e),this.stroke.onFrame(e),this.strokeWidth.onFrame(e)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderRect(r),r.restore()}},e.prototype.renderRect=function(t){t.beginPath(),t.rect(this.x.value.pxValue(),this.y.value.pxValue(),this.width.value.pxValue(),this.height.value.pxValue());var e=this.fill.value;e&&(t.fillStyle=e.toString(),t.fill());var r=this.stroke.value;if(r){var i=this.strokeWidth.value;if(i){var n=this._bounds,o=Math.min(n.width,n.height);t.lineWidth=i.pxValue(o)}t.strokeStyle=r.toString(),t.stroke()}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestRect(e,r,s),s.restore()}}return n},e.prototype.hitTestRect=function(t,e,r){if(r.beginPath(),r.rect(this.x.value.pxValue(),this.y.value.pxValue(),this.width.value.pxValue(),this.height.value.pxValue()),this.fill.value&&r.isPointInPath(t,e))return this;if(this.stroke.value){var i=this.strokeWidth.value;if(i){var n=this._bounds,o=Math.min(n.width,n.height);if(r.lineWidth=i.pxValue(o),r.isPointInStroke(t,e))return this}}return null},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof yc)return new e(t.x(),t.y(),t.width(),t.height());if("object"==typeof t&&t){var r=new e;return r.setState(t),r}throw new TypeError(""+t)},m([rl(Hu)],e.prototype,"x",void 0),m([rl(Hu)],e.prototype,"y",void 0),m([rl(Hu)],e.prototype,"width",void 0),m([rl(Hu)],e.prototype,"height",void 0),m([rl(ta,{inherit:!0})],e.prototype,"fill",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Zl),_c=Math.PI,mc=2*_c,wc=function(){function t(t,e,r,i,n,o,s){this._innerRadius=t,this._outerRadius=e,this._startAngle=r,this._sweepAngle=i,this._padAngle=n,this._padRadius=o,this._cornerRadius=s}return t.prototype.innerRadius=function(t){return void 0===t?this._innerRadius:(t=Hu.fromAny(t),this._innerRadius.equals(t)?this:this.copy(t,this._outerRadius,this._startAngle,this._sweepAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.outerRadius=function(t){return void 0===t?this._outerRadius:(t=Hu.fromAny(t),this._outerRadius.equals(t)?this:this.copy(this._innerRadius,t,this._startAngle,this._sweepAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.startAngle=function(t){return void 0===t?this._startAngle:(t=Nu.fromAny(t),this._startAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,t,this._sweepAngle,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.sweepAngle=function(t){return void 0===t?this._sweepAngle:(t=Nu.fromAny(t),this._sweepAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,t,this._padAngle,this._padRadius,this._cornerRadius))},t.prototype.padAngle=function(t){return void 0===t?this._padAngle:(t=Nu.fromAny(t),this._padAngle.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._sweepAngle,t,this._padRadius,this._cornerRadius))},t.prototype.padRadius=function(t){return void 0===t?this._padRadius:(t=null!==t?Hu.fromAny(t):null,f.equal(this._padRadius,t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._sweepAngle,this._padAngle,t,this._cornerRadius))},t.prototype.cornerRadius=function(t){return void 0===t?this._cornerRadius:(t=Hu.fromAny(t),this._cornerRadius.equals(t)?this:this.copy(this._innerRadius,this._outerRadius,this._startAngle,this._sweepAngle,this._padAngle,this._padRadius,t))},t.prototype.render=function(t,e,r){if(void 0===t){var i=new Rp;return this.draw(i,e,r),i.toString()}t instanceof Ip&&this.draw(t.context,e,r)},t.prototype.draw=function(t,e,r){this.renderArc(t,e,r)},t.prototype.renderArc=function(e,r,i){var n,o,s;void 0!==i?(n=i.x,o=i.y):(n=0,o=0),void 0!==r&&(s=Math.min(r.width,r.height));var u=this._innerRadius.pxValue(s),a=this._outerRadius.pxValue(s),h=this._startAngle.radValue(),p=this._sweepAngle.radValue(),l=h+p,c=p>=0;if(a<u){var f=a;a=u,u=f}if(a>1e-12)if(p>mc-1e-12)e.moveTo(n+a*Math.cos(h),o+a*Math.sin(h)),e.arc(n,o,a,h,l,!c),u>1e-12&&(e.moveTo(n+u*Math.cos(l),o+u*Math.sin(l)),e.arc(n,o,u,l,h,c));else{var d=h,y=l,v=h,_=l,m=p,w=p,g=this._padAngle.radValue()/2,b=+(g>1e-12)&&(null!==this._padRadius?this._padRadius.pxValue(s):Math.sqrt(u*u+a*a)),x=Math.min(Math.abs(a-u)/2,this._cornerRadius.pxValue(s)),C=x,S=x;if(b>1e-12){var A=Math.asin(b/u*Math.sin(g)),k=Math.asin(b/a*Math.sin(g));(m-=2*A)>1e-12?(v+=A*=c?1:-1,_-=A):(m=0,v=_=(h+l)/2),(w-=2*k)>1e-12?(d+=k*=c?1:-1,y-=k):(w=0,d=y=(h+l)/2)}var E=void 0,O=void 0,V=a*Math.cos(d),P=a*Math.sin(d),D=u*Math.cos(_),M=u*Math.sin(_),T=void 0,R=void 0;if(x>1e-12&&(T=a*Math.cos(y),R=a*Math.sin(y),E=u*Math.cos(v),O=u*Math.sin(v),p<_c)){var I=m>1e-12?t.intersect(V,P,E,O,T,R,D,M):[D,M],F=V-I[0],L=P-I[1],U=T-I[0],N=R-I[1],z=1/Math.sin(.5*Math.acos((F*U+L*N)/(Math.sqrt(F*F+L*L)*Math.sqrt(U*U+N*N)))),j=Math.sqrt(I[0]*I[0]+I[1]*I[1]);C=Math.min(x,(u-j)/(z-1)),S=Math.min(x,(a-j)/(z+1))}if(w>1e-12)if(S>1e-12){var W=t.cornerTangents(E,O,V,P,a,S,c),q=t.cornerTangents(T,R,D,M,a,S,c);e.moveTo(n+W.cx+W.x01,o+W.cy+W.y01),S<x?e.arc(n+W.cx,o+W.cy,S,Math.atan2(W.y01,W.x01),Math.atan2(q.y01,q.x01),!c):(e.arc(n+W.cx,o+W.cy,S,Math.atan2(W.y01,W.x01),Math.atan2(W.y11,W.x11),!c),e.arc(n,o,a,Math.atan2(W.cy+W.y11,W.cx+W.x11),Math.atan2(q.cy+q.y11,q.cx+q.x11),!c),e.arc(n+q.cx,o+q.cy,S,Math.atan2(q.y11,q.x11),Math.atan2(q.y01,q.x01),!c))}else e.moveTo(n+V,o+P),e.arc(n,o,a,d,y,!c);else e.moveTo(n+V,o+P);if(u>1e-12&&m>1e-12)if(C>1e-12){W=t.cornerTangents(D,M,T,R,u,-C,c),q=t.cornerTangents(V,P,E,O,u,-C,c);e.lineTo(n+W.cx+W.x01,o+W.cy+W.y01),C<x?e.arc(n+W.cx,o+W.cy,C,Math.atan2(W.y01,W.x01),Math.atan2(q.y01,q.x01),!c):(e.arc(n+W.cx,o+W.cy,C,Math.atan2(W.y01,W.x01),Math.atan2(W.y11,W.x11),!c),e.arc(n,o,u,Math.atan2(W.cy+W.y11,W.cx+W.x11),Math.atan2(q.cy+q.y11,q.cx+q.x11),c),e.arc(n+q.cx,o+q.cy,C,Math.atan2(q.y11,q.x11),Math.atan2(q.y01,q.x01),!c))}else e.arc(n,o,u,_,v,c);else e.lineTo(n+D,o+M)}else e.moveTo(n,o);e.closePath()},t.prototype.copy=function(e,r,i,n,o,s,u){return new t(e,r,i,n,o,s,u)},t.prototype.toAny=function(){return{innerRadius:this._innerRadius,outerRadius:this._outerRadius,startAngle:this._startAngle,sweepAngle:this._sweepAngle,padAngle:this._padAngle,padRadius:this._padRadius,cornerRadius:this._cornerRadius}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._innerRadius.equals(e._innerRadius)&&this._outerRadius.equals(e._outerRadius)&&this._startAngle.equals(e._startAngle)&&this._sweepAngle.equals(e._sweepAngle)&&this._padAngle.equals(e._padAngle)&&f.equal(this._padRadius,e._padRadius)&&this._cornerRadius.equals(e._cornerRadius))},t.prototype.debug=function(t){t=t.write("Arc").write(46).write("from").write(40).write(41),this._innerRadius.isDefined()&&(t=t.write(46).write("innerRadius").write(40).debug(this._innerRadius).write(41)),this._outerRadius.isDefined()&&(t=t.write(46).write("outerRadius").write(40).debug(this._outerRadius).write(41)),this._startAngle.isDefined()&&(t=t.write(46).write("startAngle").write(40).debug(this._startAngle).write(41)),this._sweepAngle.isDefined()&&(t=t.write(46).write("sweepAngle").write(40).debug(this._sweepAngle).write(41)),this._padAngle.isDefined()&&(t=t.write(46).write("padAngle").write(40).debug(this._padAngle).write(41)),null!==this._padRadius&&(t=t.write(46).write("padRadius").write(40).debug(this._padRadius).write(41)),this._cornerRadius.isDefined()&&(t=t.write(46).write("cornerRadius").write(40).debug(this._cornerRadius).write(41))},t.prototype.toString=function(){return J.debug(this)},t.from=function(e,r,i,n,o,s,u){return void 0===e&&(e=Hu.zero()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Nu.zero()),void 0===n&&(n=Nu.zero()),void 0===o&&(o=Nu.zero()),void 0===s&&(s=null),void 0===u&&(u=Hu.zero()),new t(e=Hu.fromAny(e),r=Hu.fromAny(r),i=Nu.fromAny(i),n=Nu.fromAny(n),o=Nu.fromAny(o),s=null!==s?Hu.fromAny(s):null,u=Hu.fromAny(u))},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.innerRadius,e.outerRadius,e.startAngle,e.sweepAngle,e.padAngle,e.padRadius,e.cornerRadius);throw new TypeError(""+e)},t.intersect=function(t,e,r,i,n,o,s,u){var a=r-t,h=i-e,p=s-n,l=u-o,c=(p*(e-o)-l*(t-n))/(l*a-p*h);return[t+c*a,e+c*h]},t.cornerTangents=function(t,e,r,i,n,o,s){var u=t-r,a=e-i,h=(s?o:-o)/Math.sqrt(u*u+a*a),p=h*a,l=-h*u,c=t+p,f=e+l,d=r+p,y=i+l,v=(c+d)/2,_=(f+y)/2,m=d-c,w=y-f,g=m*m+w*w,b=n-o,x=c*y-d*f,C=(w<0?-1:1)*Math.sqrt(Math.max(0,b*b*g-x*x)),S=(x*w-m*C)/g,A=(-x*m-w*C)/g,k=(x*w+m*C)/g,E=(-x*m+w*C)/g,O=S-v,V=A-_,P=k-v,D=E-_;return O*O+V*V>P*P+D*D&&(S=k,A=E),{cx:S,cy:A,x01:-p,y01:-l,x11:S*(n/b-1),y11:A*(n/b-1)}},t}(),gc=function(t){function e(e,r,i,n,o,s,u){void 0===e&&(e=Hu.zero()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Nu.zero()),void 0===n&&(n=Nu.zero()),void 0===o&&(o=Nu.zero()),void 0===s&&(s=null),void 0===u&&(u=Hu.zero());var a=t.call(this)||this;return a.innerRadius.setState(e),a.outerRadius.setState(r),a.startAngle.setState(i),a.sweepAngle.setState(n),a.padAngle.setState(o),a.padRadius.setState(s),a.cornerRadius.setState(u),a}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new wc(this.innerRadius.value,this.outerRadius.value,this.startAngle.value,this.sweepAngle.value,this.padAngle.value,this.padRadius.value,this.cornerRadius.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new wc(this.innerRadius.state,this.outerRadius.state,this.startAngle.state,this.sweepAngle.state,this.padAngle.state,this.padRadius.state,this.cornerRadius.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){t instanceof wc&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.innerRadius&&this.innerRadius(t.innerRadius,e),void 0!==t.outerRadius&&this.outerRadius(t.outerRadius,e),void 0!==t.startAngle&&this.startAngle(t.startAngle,e),void 0!==t.sweepAngle&&this.sweepAngle(t.sweepAngle,e),void 0!==t.padAngle&&this.padAngle(t.padAngle,e),void 0!==t.padRadius&&this.padRadius(t.padRadius,e),void 0!==t.cornerRadius&&this.cornerRadius(t.cornerRadius,e),void 0!==t.fill&&this.fill(t.fill,e),void 0!==t.stroke&&this.stroke(t.stroke,e),void 0!==t.strokeWidth&&this.strokeWidth(t.strokeWidth,e),void 0!==t.hidden&&this.setHidden(t.hidden),void 0!==t.culled&&this.setCulled(t.culled)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.startAngle.onFrame(e),this.sweepAngle.onFrame(e),this.padAngle.onFrame(e),this.padRadius.onFrame(e),this.cornerRadius.onFrame(e),this.fill.onFrame(e),this.stroke.onFrame(e),this.strokeWidth.onFrame(e)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderArc(e.context),r.restore()}},e.prototype.renderArc=function(t){var e=this._bounds;this.value.draw(t,e,this._anchor);var r=this.fill.value;r&&(t.fillStyle=r.toString(),t.fill());var i=this.stroke.value;if(i){var n=this.strokeWidth.value;if(n){var o=Math.min(e.width,e.height);t.lineWidth=n.pxValue(o)}t.strokeStyle=i.toString(),t.stroke()}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestArc(e,r,s),s.restore()}}return n},e.prototype.hitTestArc=function(t,e,r){r.beginPath();var i=this._bounds;if(this.value.draw(r,i,this._anchor),this.fill.value&&r.isPointInPath(t,e))return this;if(this.stroke.value){var n=this.strokeWidth.value;if(n){var o=Math.min(i.width,i.height);if(r.lineWidth=n.pxValue(o),r.isPointInStroke(t,e))return this}}return null},e.from=function(t,r,i,n,o,s,u,a,h,p){void 0===t&&(t=Hu.zero()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Nu.zero()),void 0===n&&(n=Nu.zero()),void 0===o&&(o=Nu.zero()),void 0===s&&(s=null),void 0===u&&(u=Hu.zero());var l=new e(t=Hu.fromAny(t),r=Hu.fromAny(r),i=Nu.fromAny(i),n=Nu.fromAny(n),o=Nu.fromAny(o),s=null!==s?Hu.fromAny(s):null,u=Hu.fromAny(u));return void 0!==a&&l.fill(a),void 0!==h&&l.stroke(h),void 0!==p&&l.strokeWidth(p),l},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof wc)return new e(t.innerRadius(),t.outerRadius(),t.startAngle(),t.sweepAngle(),t.padAngle(),t.padRadius(),t.cornerRadius());if("object"==typeof t&&t){var r=new e;return r.setState(t),r}throw new TypeError(""+t)},m([rl(Hu)],e.prototype,"innerRadius",void 0),m([rl(Hu)],e.prototype,"outerRadius",void 0),m([rl(Nu)],e.prototype,"startAngle",void 0),m([rl(Nu)],e.prototype,"sweepAngle",void 0),m([rl(Nu)],e.prototype,"padAngle",void 0),m([rl(Hu)],e.prototype,"padRadius",void 0),m([rl(Hu)],e.prototype,"cornerRadius",void 0),m([rl(ta,{inherit:!0})],e.prototype,"fill",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Zl),bc=function(){function t(t,e,r,i,n){this._text=t,this._font=e,this._textAlign=r,this._textBaseline=i,this._textColor=n}return t.prototype.text=function(t){return void 0===t?this._text:this._text===t?this:this.copy(t,this._font,this._textAlign,this._textBaseline,this._textColor)},t.prototype.font=function(t){return void 0===t?this._font:(t=null!==t?da.fromAny(t):null,this._font===t?this:this.copy(this._text,t,this._textAlign,this._textBaseline,this._textColor))},t.prototype.textAlign=function(t){return void 0===t?this._textAlign:this._textAlign===t?this:this.copy(this._text,this._font,t,this._textBaseline,this._textColor)},t.prototype.textBaseline=function(t){return void 0===t?this._textBaseline:this._textBaseline===t?this:this.copy(this._text,this._font,this._textAlign,t,this._textColor)},t.prototype.textColor=function(t){return void 0===t?this._textColor:(t=null!==t?ta.fromAny(t):null,this._textColor===t?this:this.copy(this._text,this._font,this._textAlign,this._textBaseline,t))},t.prototype.render=function(t,e,r){t instanceof Fp&&this.draw(t.context,e,r)},t.prototype.draw=function(t,e,r){this.renderText(t,e,r)},t.prototype.renderText=function(t,e,r){t.save(),null!==this._font&&(t.font=this._font.toString()),null!==this._textAlign&&(t.textAlign=this._textAlign),null!==this._textBaseline&&(t.textBaseline=this._textBaseline),null!==this._textColor&&(t.fillStyle=this._textColor.toString()),t.fillText(this._text,r.x,r.y),t.restore()},t.prototype.copy=function(e,r,i,n,o){return new t(e,r,i,n,o)},t.prototype.toAny=function(){var t={text:this._text};return null!==this._font&&(t.font=this._font),null!==this._font&&(t.font=this._font),null!==this._textAlign&&(t.textAlign=this._textAlign),null!==this._textBaseline&&(t.textBaseline=this._textBaseline),null!==this._textColor&&(t.textColor=this._textColor),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._text===e._text&&f.equal(this._font,e._font)&&this._textAlign===e._textAlign&&this._textBaseline===e._textBaseline&&f.equal(this._textColor,e._textColor))},t.prototype.debug=function(t){t=t.write("TextRun").write(46).write("from").write(40).debug(this._text).write(41),null!==this._font&&(t=t.write(46).write("font").write(40).debug(this._font).write(41)),null!==this._textAlign&&(t=t.write(46).write("textAlign").write(40).debug(this._textAlign).write(41)),null!==this._textBaseline&&(t=t.write(46).write("textBaseline").write(40).debug(this._textBaseline).write(41)),null!==this._textColor&&(t=t.write(46).write("textColor").write(40).debug(this._textColor).write(41))},t.prototype.toString=function(){return J.debug(this)},t.from=function(e,r,i,n,o){return void 0===r&&(r=null),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),new t(e,r=null!==r?da.fromAny(r):null,i,n,o=null!==o?ta.fromAny(o):null)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&e)return t.from(e.text,e.font,e.textAlign,e.textBaseline,e.textColor);if("string"==typeof e)return t.from(e);throw new TypeError(""+e)},t}(),xc=function(t){function e(e){void 0===e&&(e="");var r=t.call(this)||this;return r.text.setState(e),r}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new bc(this.text.value,this.font.value,this.textAlign.value,this.textBaseline.value,this.textColor.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new bc(this.text.state,this.font.state,this.textAlign.state,this.textBaseline.state,this.textColor.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){"string"==typeof t?this.text(t,e):(t instanceof bc&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.text&&this.text(t.text,e),void 0!==t.font&&this.font(t.font,e),void 0!==t.textAlign&&this.textAlign(t.textAlign,e),void 0!==t.textBaseline&&this.textBaseline(t.textBaseline,e),void 0!==t.textColor&&this.textColor(t.textColor,e),void 0!==t.hidden&&this.setHidden(t.hidden),void 0!==t.culled&&this.setCulled(t.culled))},e.prototype.onAnimate=function(t){var e=t.updateTime;this.text.onFrame(e),this.font.onFrame(e),this.textAlign.onFrame(e),this.textBaseline.onFrame(e),this.textColor.onFrame(e)},e.prototype.onRender=function(t){var e=t.renderer;e instanceof Fp&&this.renderText(e.context)},e.prototype.renderText=function(t){t.save();var e=this._anchor,r=this.font.value;r&&(t.font=r.toString());var i=this.textAlign.value;i&&(t.textAlign=i);var n=this.textBaseline.value;n&&(t.textBaseline=n);var o=this.textColor.value;o&&(t.fillStyle=o.toString()),t.fillText(this.text.value,e.x,e.y),t.restore()},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;return r.setState(t),r}if("string"==typeof t)return new e(t);throw new TypeError(""+t)},m([rl(String)],e.prototype,"text",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(String,{inherit:!0})],e.prototype,"textAlign",void 0),m([rl(String,{inherit:!0})],e.prototype,"textBaseline",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),Cc=Math.cos(Math.PI/4),Sc=Math.sin(Math.PI/4),Ac=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.points=r.points,i.originalEvent=r.originalEvent||null,i}return _(e,t),e}(pp),kc=function(){function t(t,e){this.multitouch=t,this.identifier=e,this.path=[],this.t=NaN,this.cx=NaN,this.cy=NaN,this.vx=NaN,this.vy=NaN,this.ax=NaN,this.ay=NaN,this.dx=NaN,this.dy=NaN}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.moveTo=function(t,e,r){for(this.path.push({t:t,cx:e,cy:r});this.path.length>1&&t-this.path[0].t>this.multitouch._hysteresis;)this.path.splice(0,1);this.update()},t.prototype.update=function(){var t=this.path[0],e=this.path[this.path.length-1];if(e&&e!==t){var r=e.t-t.t,i=void 0,n=void 0;if(r){var o=(i=(e.cx-t.cx)/r)*i+(n=(e.cy-t.cy)/r)*n,s=this.multitouch._velocityMax;if(s*s<o){var u=Math.sqrt(o);i=i*s/u,n=n*s/u}}else i=0,n=0;this.t=e.t,this.dx=e.cx-this.cx,this.dy=e.cy-this.cy,this.cx=e.cx,this.cy=e.cy,this.vx=i,this.vy=n}else t&&(this.t=t.t,this.dx=t.cx-this.cx,this.dy=t.cy-this.cy,this.cx=t.cx,this.cy=t.cy,this.vx=0,this.vy=0)},t}(),Ec=function(){function t(t,e,r,i,n,o,s,u,a){this.multitouch=t,this.identifier=e,this.t=r,this.cx=i,this.cy=n,this.vx=o,this.vy=s,this.ax=u,this.ay=a,this.dx=0,this.dy=0}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.translate=function(t,e){this.cx+=t,this.cy+=e},t.prototype.update=function(t){var e=t-this.t;if(e){var r=this.vx+this.ax*e,i=void 0;r<0==this.vx<0?i=this.cx+this.vx*e+this.ax*e*e*.5:(i=this.cx-this.vx*this.vx/(2*this.ax),r=0,this.ax=0);var n=this.vy+this.ay*e,o=void 0;n<0==this.vy<0?o=this.cy+this.vy*e+this.ay*e*e*.5:(o=this.cy-this.vy*this.vy/(2*this.ay),n=0,this.ay=0),this.dx=i-this.cx,this.dy=o-this.cy,this.cx=i,this.cy=o,this.vx=r,this.vy=n,this.t=t}},t}(),Oc=function(){function t(){this._surface=null,this._tracks={},this._trackCount=0,this._ghosts={},this._ghostCount=0,this._ghostFrame=0,this._hysteresis=67,this._acceleration=.00175,this._velocityMax=1.75,this._distanceMin=10,this.onGhostFrame=this.onGhostFrame.bind(this)}return t.prototype.surface=function(t){return void 0===t?this._surface:(this._surface&&this.detach(this._surface),this._surface=t,this)},t.prototype.target=function(){for(var t=this._surface;t;){if(t instanceof dl)return t;t=t.parentView}return null},t.prototype.hysteresis=function(t){return void 0===t?this._hysteresis:(this._hysteresis=t,this)},t.prototype.acceleration=function(t){return void 0===t?this._acceleration:(this._acceleration=t,this)},t.prototype.velocityMax=function(t){return void 0===t?this._velocityMax:(this._velocityMax=t,this)},t.prototype.distanceMin=function(t){return void 0===t?this._distanceMin:(this._distanceMin=t,this)},t.prototype.wheel=function(t){return void 0!==t&&this},t.prototype.points=function(){var t=[];for(var e in this._tracks)t.push(this._tracks[e]);for(var e in this._ghosts)t.push(this._ghosts[e]);return t},t.prototype.interrupt=function(t){this._ghostFrame&&(cancelAnimationFrame(this._ghostFrame),this._ghostFrame=0),this._ghostCount&&(this._ghosts={},this._ghostCount=0,this._trackCount?this.multitouchChange(t):this.multitouchEnd(t))},t.prototype.zoom=function(t,e,r,i){if(r){var n=Date.now(),o=this._acceleration,s=o*Cc,u=o*Sc,a=this._velocityMax,h=.5*a*Cc,p=.5*a*Sc,l=4*h*h/s,c=4*p*p/u,f=this._ghosts.zoom0,d=this._ghosts.zoom1;if(f&&d){var y=Math.abs(d.cx-f.cx)/2,v=Math.abs(d.cy-f.cy)/2,_=n-f.t,m=(r=Math.min(Math.max(-a*_,r),a*_))*y*Cc/l,w=r*v*Sc/c;s=s*y/l,u=u*v/c,_>0&&(f.t=n,f.cx+=m,f.cy+=w,f.vx=m/_,f.vy=w/_,f.ax=f.vx<0?s:f.vx>0?-s:0,f.ay=f.vy<0?u:f.vy>0?-u:0,f.dx=m,f.dy=w,d.t=n,d.cx-=m,d.cy-=w,d.vx=-m/_,d.vy=-w/_,d.ax=d.vx<0?s:d.vx>0?-s:0,d.ay=d.vy<0?u:d.vy>0?-u:0,d.dx=-m,d.dy=-w)}else this.interrupt(i),this.multitouchStart(i),r<0?(f=new Ec(this,"zoom0",n,t-l,e-c,-h,-p,s,u),d=new Ec(this,"zoom1",n,t+l,e+c,h,p,-s,-u)):(f=new Ec(this,"zoom0",n,t-l,e-c,h,p,-s,-u),d=new Ec(this,"zoom1",n,t+l,e+c,-h,-p,s,u)),this._ghosts.zoom0=f,this._ghostCount+=1,this._ghosts.zoom1=d,this._ghostCount+=1;this.multitouchChange(i),this._ghostFrame&&cancelAnimationFrame(this._ghostFrame),this._ghostFrame=requestAnimationFrame(this.onGhostFrame)}},t.prototype.updateVelocity=function(t,e){var r=e[0],i=e[1],n=0;if(r&&i){n=2;var o=Math.abs(i.cx-r.cx),s=Math.abs(i.cy-r.cy);r instanceof Ec&&r.update(t),i instanceof Ec&&i.update(t);var u=Math.abs(i.cx-r.cx)/o,a=Math.abs(i.cy-r.cy)/s;r.vx*=u,r.vy*=a,r.ax*=u,r.ay*=a,i.vx*=u,i.vy*=a,i.ax*=u,i.ay*=a}for(;n<e.length;){var h=e[n];h instanceof Ec&&h.update(t),n+=1}},t.prototype.spreadVelocity=function(t){for(var e in this._ghosts){var r=this._ghosts[e];t.vx<0==r.vx<0?(t.vx=(t.vx+r.vx)/2,r.vx=(t.vx+r.vx)/2):(t.vx=(t.vx-r.vx)/2,r.vx=(r.vx-t.vx)/2),t.vy<0==r.vy<0?(t.vy=(t.vy+r.vy)/2,r.vy=(t.vy+r.vy)/2):(t.vy=(t.vy-r.vy)/2,r.vy=(r.vy-t.vy)/2)}},t.prototype.coast=function(t){if(t.vx||t.vy){this.spreadVelocity(t);var e=Math.atan2(Math.abs(t.vy),Math.abs(t.vx)),r=this._acceleration,i=(t.vx<0?r:t.vx>0?-r:0)*Math.cos(e),n=(t.vy<0?r:t.vy>0?-r:0)*Math.sin(e);if(i||n){var o=new Ec(this,t.identifier,t.t,t.cx,t.cy,t.vx,t.vy,i,n);this._ghosts[o.identifier]=o,this._ghostCount+=1,this._ghostFrame||(this._ghostFrame=requestAnimationFrame(this.onGhostFrame))}}},t.prototype.translate=function(t,e){for(var r in t=t||0,e=e||0,this._ghosts)this._ghosts[r].translate(t,e)},t.prototype.interpolate=function(t){for(var e in this._tracks)this._tracks[e].update();for(var e in this.updateVelocity(t,this.points()),this.multitouchChange(null),this._ghosts){(r=this._ghosts[e]).ax||r.ay||(this._ghostCount-=1)}for(var e in this._trackCount||this._ghostCount?this._ghostCount&&!this._ghostFrame&&(this._ghostFrame=requestAnimationFrame(this.onGhostFrame)):this.multitouchEnd(null),this._ghosts){var r;(r=this._ghosts[e]).ax||r.ay||delete this._ghosts[e]}},t.prototype.onGhostFrame=function(t){this._ghostFrame=0,this.interpolate(Date.now())},t.prototype.multitouchStart=function(t){var e=new Ac("multitouchstart",{bubbles:!0,cancelable:!0,composed:!0,points:this.points(),originalEvent:t});this._surface.dispatchEvent(e)},t.prototype.multitouchChange=function(t){var e=new Ac("multitouchchange",{bubbles:!0,cancelable:!0,composed:!0,points:this.points(),originalEvent:t});this._surface.dispatchEvent(e)},t.prototype.multitouchCancel=function(t){var e=new Ac("multitouchcancel",{bubbles:!0,cancelable:!0,composed:!0,points:this.points(),originalEvent:t});this._surface.dispatchEvent(e)},t.prototype.multitouchEnd=function(t){var e=new Ac("multitouchend",{bubbles:!0,cancelable:!0,composed:!0,points:this.points(),originalEvent:t});this._surface.dispatchEvent(e)},t.prototype.trackStart=function(t,e,r,i){this.interrupt(i);var n=new kc(this,t);if(this._tracks[t]=n,n.moveTo(Date.now(),e,r),this._trackCount+=1,1===this._trackCount){var o=this.target();o&&this.startTracking(o)}this.trackDidStart(n,this._surface,i)},t.prototype.trackMove=function(t,e,r,i){var n=this._tracks[t];n&&(n.moveTo(Date.now(),e,r),this.trackDidMove(n,this._surface,i))},t.prototype.trackCancel=function(t,e,r,i){var n=this._tracks[t];if(n){if(this._trackCount-=1,n.update(),this.trackDidCancel(n,this._surface,i),0===this._trackCount){var o=this.target();o&&this.endTracking(o)}delete this._tracks[t]}},t.prototype.trackEnd=function(t,e,r,i){var n=this._tracks[t];if(n){if(this._trackCount-=1,n.update(),this.trackDidEnd(n,this._surface,i),0===this._trackCount){var o=this.target();o&&this.endTracking(o)}delete this._tracks[t]}},t.prototype.trackDidStart=function(t,e,r){1===this._trackCount&&this.multitouchStart(r)},t.prototype.trackDidMove=function(t,e,r){this.translate(t.dx,t.dy),this.interpolate(Date.now())},t.prototype.trackDidCancel=function(t,e,r){this._trackCount||this._ghostCount||this.multitouchCancel(r)},t.prototype.trackDidEnd=function(t,e,r){this.coast(t),this._trackCount||this._ghostCount||this.multitouchEnd(r)},t.create=function(){return"undefined"!=typeof PointerEvent?new Vc:"undefined"!=typeof TouchEvent?new Pc:new Dc},t}(),Vc=function(t){function e(){var e=t.call(this)||this;return e.onPointerDown=e.onPointerDown.bind(e),e.onPointerMove=e.onPointerMove.bind(e),e.onPointerCancel=e.onPointerCancel.bind(e),e.onPointerUp=e.onPointerUp.bind(e),e.onWheel=e.onWheel.bind(e),e._wheel=!0,e}return _(e,t),e.prototype.wheel=function(t){if(void 0===t)return this._wheel;if(this._wheel!==t){this._wheel=t;var e=this.target();e&&(t?e.on("wheel",this.onWheel):e.off("wheel",this.onWheel))}return this},e.prototype.attach=function(t){var e=this.target();e&&(e.on("pointerdown",this.onPointerDown,{passive:!0}),this._wheel&&e.on("wheel",this.onWheel))},e.prototype.detach=function(t){var e=this.target();e&&(e.off("pointerdown",this.onPointerDown),e.off("wheel",this.onWheel))},e.prototype.startTracking=function(t){var e=this.target();e&&(e.on("pointermove",this.onPointerMove),e.on("pointercancel",this.onPointerCancel),e.on("pointerup",this.onPointerUp))},e.prototype.endTracking=function(t){var e=this.target();e&&(e.off("pointermove",this.onPointerMove),e.off("pointercancel",this.onPointerCancel),e.off("pointerup",this.onPointerUp))},e.prototype.onPointerDown=function(t){this.trackStart(""+t.pointerId,t.clientX,t.clientY,t);var e=this.target();e&&e.node.setPointerCapture&&e.node.setPointerCapture(t.pointerId)},e.prototype.onPointerMove=function(t){this.trackMove(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onPointerCancel=function(t){this.trackCancel(""+t.pointerId,t.clientX,t.clientY,t);var e=this.target();e&&e.node.releasePointerCapture&&e.node.releasePointerCapture(t.pointerId)},e.prototype.onPointerUp=function(t){this.trackEnd(""+t.pointerId,t.clientX,t.clientY,t);var e=this.target();e&&e.node.releasePointerCapture&&e.node.releasePointerCapture(t.pointerId)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY,t)},e}(Oc),Pc=function(t){function e(){var e=t.call(this)||this;return e.onTouchStart=e.onTouchStart.bind(e),e.onTouchMove=e.onTouchMove.bind(e),e.onTouchCancel=e.onTouchCancel.bind(e),e.onTouchEnd=e.onTouchEnd.bind(e),e}return _(e,t),e.prototype.attach=function(t){var e=this.target();e&&e.on("touchstart",this.onTouchStart,{passive:!0})},e.prototype.detach=function(t){var e=this.target();e&&e.off("touchstart",this.onTouchStart)},e.prototype.startTracking=function(t){var e=this.target();e&&(e.on("touchmove",this.onTouchMove,{passive:!0}),e.on("touchcancel",this.onTouchCancel),e.on("touchend",this.onTouchEnd))},e.prototype.endTracking=function(t){var e=this.target();e&&(e.off("touchmove",this.onTouchMove),e.off("touchcancel",this.onTouchCancel),e.off("touchend",this.onTouchEnd))},e.prototype.onTouchStart=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var r=t.changedTouches[e];this.trackStart(""+r.identifier,r.clientX,r.clientY,t)}(t.changedTouches.length>1||this._trackCount>1)&&t.preventDefault()},e.prototype.onTouchMove=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var r=t.changedTouches[e];this.trackMove(""+r.identifier,r.clientX,r.clientY,t)}},e.prototype.onTouchCancel=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var r=t.changedTouches[e];this.trackCancel(""+r.identifier,r.clientX,r.clientY,t)}},e.prototype.onTouchEnd=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var r=t.changedTouches[e];this.trackEnd(""+r.identifier,r.clientX,r.clientY,t)}},e}(Oc),Dc=function(t){function e(){var e=t.call(this)||this;return e.onMouseDown=e.onMouseDown.bind(e),e.onMouseMove=e.onMouseMove.bind(e),e.onMouseUp=e.onMouseUp.bind(e),e.onWheel=e.onWheel.bind(e),e._wheel=!0,e}return _(e,t),e.prototype.wheel=function(t){if(void 0===t)return this._wheel;if(this._wheel!==t){this._wheel=t;var e=this.target();e&&(t?e.on("wheel",this.onWheel):e.off("wheel",this.onWheel))}return this},e.prototype.attach=function(t){var e=this.target();e&&(e.on("mousedown",this.onMouseDown),this._wheel&&e.on("wheel",this.onWheel))},e.prototype.detach=function(t){var e=this.target();e&&(e.off("mousedown",this.onMouseDown),e.off("wheel",this.onWheel))},e.prototype.startTracking=function(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},e.prototype.endTracking=function(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},e.prototype.onMouseDown=function(t){this.trackStart("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseMove=function(t){this.trackMove("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseUp=function(t){this.trackEnd("mouse",t.clientX,t.clientY,t)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.deltaY,t)},e}(Oc),Mc=function(t){function e(e,r){var i=t.call(this,e,r)||this;return i.gesture=r.gesture,i.multitouch=r.multitouch,i.ruler=r.ruler,i.scale=r.scale,i.originalEvent=r.originalEvent||null,i}return _(e,t),e}(pp),Tc=function(){function t(){this._multitouch=null,this._ruler=null,this._scale=null,this._xMin=null,this._xMax=null,this._zMin=null,this._zMax=null,this._points=[],this.onMultitouchStart=this.onMultitouchStart.bind(this),this.onMultitouchChange=this.onMultitouchChange.bind(this),this.onMultitouchCancel=this.onMultitouchCancel.bind(this),this.onMultitouchEnd=this.onMultitouchEnd.bind(this)}return t.prototype.multitouch=function(t){return void 0===t?this._multitouch:(this._multitouch&&this.detach(this._multitouch),this._multitouch=t,this)},t.prototype.hysteresis=function(t){return void 0===t?this._multitouch.hysteresis():(this._multitouch.hysteresis(t),this)},t.prototype.acceleration=function(t){return void 0===t?this._multitouch.acceleration():(this._multitouch.acceleration(t),this)},t.prototype.velocityMax=function(t){return void 0===t?this._multitouch.velocityMax():(this._multitouch.velocityMax(t),this)},t.prototype.distanceMin=function(t){return void 0===t?this._multitouch.distanceMin():(this._multitouch.distanceMin(t),this)},t.prototype.wheel=function(t){return void 0===t?this._multitouch.wheel():(this._multitouch.wheel(t),this)},t.prototype.ruler=function(t){return void 0===t?this._ruler:(this._ruler=t,this)},t.prototype.scale=function(t){if(void 0===t)return this._scale;var e=this._scale;return this._scale=t,null===e&&this.zoomBounds(!0),this},t.prototype.domainMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},t.prototype.domainMax=function(t){return void 0===t?this._xMax:(this._xMax=t,this)},t.prototype.domainBounds=function(t,e){return void 0===t?[this._xMin,this._xMax]:void 0===e?(t=t,this._xMin=t[0],this._xMax=t[1],this):(this._xMin=t,this._xMax=e,this)},t.prototype.zoomMin=function(t){return void 0===t?this._zMin:(this._zMin=t,this)},t.prototype.zoomMax=function(t){return void 0===t?this._zMax:(this._zMax=t,this)},t.prototype.zoomBounds=function(t,e){return void 0===t?[this._zMin,this._zMax]:void 0===e?("boolean"==typeof t?this._scale instanceof gh?(this._zMin=1e6,this._zMax=.001):this._scale instanceof bh&&(this._zMin=864e5,this._zMax=1):(t=t,this._zMin=t[0],this._zMax=t[1]),this):(this._zMin=t,this._zMax=e,this)},t.prototype.attach=function(t){var e=this._multitouch&&this._multitouch.surface();e&&(e.on("multitouchstart",this.onMultitouchStart),e.on("multitouchchange",this.onMultitouchChange),e.on("multitouchcancel",this.onMultitouchCancel),e.on("multitouchend",this.onMultitouchEnd))},t.prototype.detach=function(t){var e=this._multitouch&&this._multitouch.surface();e&&(e.off("multitouchstart",this.onMultitouchStart),e.off("multitouchchange",this.onMultitouchChange),e.off("multitouchcancel",this.onMultitouchCancel),e.off("multitouchend",this.onMultitouchEnd))},t.prototype.createPoint=function(t){var e=this.coords(t.cx,t.cy);return{identifier:t.identifier,domainCoord:e.domainCoord,rangeCoord:e.rangeCoord}},t.prototype.updatePoint=function(t,e){e.rangeCoord=this.rangeCoord(t.cx,t.cy)},t.prototype.updatePoints=function(t){var e=this._points;t:for(var r=0;r<t.length;r+=1){for(var i=t[r],n=0;n<e.length;n+=1){var o=e[n];if(f.equal(i.identifier,o.identifier)){this.updatePoint(i,o);continue t}}var s=this.createPoint(i);e.push(s)}var u=0;t:for(;u<e.length;){for(s=e[u],r=0;r<t.length;r+=1){i=t[r];if(f.equal(s.identifier,i.identifier)){u+=1;continue t}}e.splice(u,1)}},t.prototype.clampScale=function(){var t=null!==this._xMin?this._xMin:void 0,e=null!==this._xMax?this._xMax:void 0,r=null!==this._zMin?this._zMin:void 0,i=null!==this._zMax?this._zMax:void 0,n=this._scale;if(this._scale=n.clampDomain(t,e,r,i),this._scale!==n){for(var o=0;o<this._points.length;o+=1){var s=this._points[o];s.domainCoord=this._scale.unscale(s.rangeCoord)}return!0}return!1},t.prototype.rescale=function(){var t=this._points[0],e=this._points[1],r=this._scale;if(t&&e){var i=t.domainCoord,n=t.rangeCoord,o=e.domainCoord,s=e.rangeCoord;this._scale=r.solveDomain(i,n,o,s),this.clampScale()}else if(t){i=t.domainCoord,n=t.rangeCoord;this._scale=r.solveDomain(i,n),this.clampScale()}return!r.equals(this._scale)},t.prototype.onMultitouchStart=function(t){this.scaleStart(t)},t.prototype.onMultitouchChange=function(t){this.updatePoints(t.points),this.rescale()&&this.scaleChange(t)},t.prototype.onMultitouchCancel=function(t){this.scaleCancel(t)},t.prototype.onMultitouchEnd=function(t){this.scaleEnd(t)},t.prototype.scaleStart=function(t){var e=new Mc("scalestart",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale,originalEvent:t});this._ruler.dispatchEvent(e)},t.prototype.scaleChange=function(t){var e=new Mc("scalechange",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale,originalEvent:t});this._ruler.dispatchEvent(e)},t.prototype.scaleCancel=function(t){var e=new Mc("scalecancel",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale,originalEvent:t});this._ruler.dispatchEvent(e),this._points.length=0},t.prototype.scaleEnd=function(t){var e=new Mc("scaleend",{bubbles:!0,cancelable:!0,composed:!0,gesture:this,multitouch:this._multitouch,ruler:this._ruler,scale:this._scale,originalEvent:t});this._ruler.dispatchEvent(e),this._points.length=0},t.horizontal=function(){return new Rc},t.vertical=function(){return new Ic},t}(),Rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.coords=function(t,e){for(var r=this._ruler,i=Hl.is(r)?r.bounds.x:0;;){if(r instanceof dl){var n=t-r.node.getBoundingClientRect().left-i;return{domainCoord:this._scale.unscale(n),rangeCoord:n}}if(!r)break;r=r.parentView}throw new Error(""+this._ruler)},e.prototype.rangeCoord=function(t,e){for(var r=this._ruler,i=Hl.is(r)?r.bounds.x:0;;){if(r instanceof dl)return t-r.node.getBoundingClientRect().left-i;if(!r)break;r=r.parentView}throw new Error(""+this._ruler)},e.prototype.isParallel=function(t,e,r,i){return Math.abs(r-t)>=Math.abs(i-e)},e}(Tc),Ic=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.coords=function(t,e){for(var r=this._ruler,i=Hl.is(r)?r.bounds.y:0;;){if(r instanceof dl){var n=e-r.node.getBoundingClientRect().top-i;return{domainCoord:this._scale.unscale(n),rangeCoord:n}}if(!r)break;r=r.parentView}throw new Error(""+this._ruler)},e.prototype.rangeCoord=function(t,e){for(var r=this._ruler,i=Hl.is(r)?r.bounds.y:0;;){if(r instanceof dl)return e-r.node.getBoundingClientRect().top-i;if(!r)break;r=r.parentView}throw new Error(""+this._ruler)},e.prototype.isParallel=function(t,e,r,i){return Math.abs(i-e)>=Math.abs(r-t)},e}(Tc),Fc=function(t){function e(){var e=t.call(this)||this;return e.value.setState(0),e.total.setState(1),e._arrangement="auto",e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.label=function(t){return void 0===t?this.getChildView("label"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("label",t),this)},e.prototype.legend=function(t){return void 0===t?this.getChildView("legend"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("legend",t),this)},e.prototype.arrangement=function(t){return void 0===t?this._arrangement:(this._arrangement=t,this)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.value.onFrame(e),this.total.onFrame(e),this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.startAngle.onFrame(e),this.sweepAngle.onFrame(e),this.cornerRadius.onFrame(e),this.dialColor.onFrame(e),this.meterColor.onFrame(e),this.labelPadding.onFrame(e),this.tickAlign.onFrame(e),this.tickRadius.onFrame(e),this.tickLength.onFrame(e),this.tickWidth.onFrame(e),this.tickPadding.onFrame(e),this.tickColor.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.layoutChildView=function(t,e){Hl.is(t)&&t.setBounds(this._bounds)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderDial(r,this._bounds,this._anchor),r.restore(),this.renderTick(r,this._bounds,this._anchor)}},e.prototype.renderDial=function(t,e,r){var i=Math.min(e.width,e.height),n=this.innerRadius.value.pxValue(i),o=this.outerRadius.value.pxValue(i),s=this.startAngle.value.radValue(),u=this.sweepAngle.value.radValue(),a=this.cornerRadius.value.pxValue(o-n),h=new wc(Hu.px(n),Hu.px(o),Nu.rad(s),Nu.rad(u),Nu.zero(),null,Hu.px(a)),p=h.sweepAngle(u*this.value.value/(this.total.value||1));t.beginPath();var l=this.dialColor.value;t.fillStyle=l.toString(),h.draw(t,e,r),t.fill(),t.clip(),t.beginPath();var c=this.meterColor.value;t.fillStyle=c.toString(),p.draw(t,e,r),t.fill();var f=this.label();if(Hl.is(f)){var d=(n+o)/2,y=d*Math.cos(s+1e-12),v=d*Math.sin(s+1e-12),_=void 0;_=y>=0?v>=0?"start":"end":v<0?"end":"start";var m=s-Math.PI/2,w=this.labelPadding.value.pxValue(o-n),g=w*Math.cos(m),b=w*Math.sin(m),x=new no(r.x+y+g,r.y+v+b);f.setAnchor(x),Yl.is(f)&&(f.textAlign(_),f.textBaseline("middle"))}},e.prototype.renderTick=function(t,e,r){var i=this.legend();if(Hl.is(i)&&!i.hidden){var n=e.width,o=e.height,s=Math.min(n,o),u=r.x,a=r.y,h=this.startAngle.value.radValue()+this.sweepAngle.value.radValue()*this.value.value/(this.total.value||1)*this.tickAlign.value,p=this.outerRadius.value.pxValue(s),l=this.tickRadius.value.pxValue(s),c=this.tickLength.value.pxValue(n),f=p*Math.cos(h+1e-12),d=p*Math.sin(h+1e-12),y=l*Math.cos(h+1e-12),v=l*Math.sin(h+1e-12),_=0;t.beginPath();var m=this.tickColor.value;t.strokeStyle=m.toString(),t.lineWidth=this.tickWidth.value.pxValue(s),t.moveTo(u+f,a+d),t.lineTo(u+y,a+v),c&&(y>=0?(t.lineTo(u+c,a+v),_=c-y):y<0&&(t.lineTo(u-c,a+v),_=c+y)),t.stroke();var w=void 0,g=void 0;y>=0?(w=_,g="end"):(w=-_,g="start");var b=new no(u+y+w,a+v-this.tickPadding.value.pxValue(s));i.setAnchor(b),Yl.is(i)&&(Gl.is(i)&&i.fill(m),i.textAlign(g),i.textBaseline("alphabetic"))}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestDial(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestDial=function(t,e,r,i,n){var o=Math.min(i.width,i.height),s=this.innerRadius.value.pxValue(o),u=this.outerRadius.value.pxValue(o),a=this.startAngle.value.radValue(),h=this.sweepAngle.value.radValue(),p=this.cornerRadius.value.pxValue(u-s),l=new wc(Hu.px(s),Hu.px(u),Nu.rad(a),Nu.rad(h),Nu.zero(),null,Hu.px(p));return r.beginPath(),l.draw(r,i,n),r.isPointInPath(t,e)?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;return void 0!==t.key&&r.key(t.key),void 0!==t.value&&r.value(t.value),void 0!==t.total&&r.total(t.total),void 0!==t.innerRadius&&r.innerRadius(t.innerRadius),void 0!==t.outerRadius&&r.outerRadius(t.outerRadius),void 0!==t.startAngle&&r.startAngle(t.startAngle),void 0!==t.sweepAngle&&r.sweepAngle(t.sweepAngle),void 0!==t.cornerRadius&&r.cornerRadius(t.cornerRadius),void 0!==t.dialColor&&r.dialColor(t.dialColor),void 0!==t.meterColor&&r.meterColor(t.meterColor),void 0!==t.labelPadding&&r.labelPadding(t.labelPadding),void 0!==t.tickAlign&&r.tickAlign(t.tickAlign),void 0!==t.tickRadius&&r.tickRadius(t.tickRadius),void 0!==t.tickLength&&r.tickLength(t.tickLength),void 0!==t.tickWidth&&r.tickWidth(t.tickWidth),void 0!==t.tickPadding&&r.tickPadding(t.tickPadding),void 0!==t.tickColor&&r.tickColor(t.tickColor),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.arrangement&&r.arrangement(t.arrangement),void 0!==t.label&&r.label(t.label),void 0!==t.legend&&r.legend(t.legend),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Number)],e.prototype,"value",void 0),m([rl(Number)],e.prototype,"total",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"innerRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"outerRadius",void 0),m([rl(Nu,{inherit:!0})],e.prototype,"startAngle",void 0),m([rl(Nu,{inherit:!0})],e.prototype,"sweepAngle",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"cornerRadius",void 0),m([rl(ta,{inherit:!0})],e.prototype,"dialColor",void 0),m([rl(ta,{inherit:!0})],e.prototype,"meterColor",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"labelPadding",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickAlign",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickLength",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickWidth",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickPadding",void 0),m([rl(ta,{inherit:!0})],e.prototype,"tickColor",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),Lc=function(t){function e(){var e=t.call(this)||this;return e.limit.setState(0),e.innerRadius.setState(Hu.pct(30)),e.outerRadius.setState(Hu.pct(40)),e.startAngle.setState(Nu.rad(-Math.PI/2)),e.sweepAngle.setState(Nu.rad(2*Math.PI)),e.cornerRadius.setState(Hu.pct(50)),e.dialSpacing.setState(Hu.px(1)),e.dialColor.setState(ta.transparent()),e.meterColor.setState(ta.black()),e.labelPadding.setState(Hu.pct(25)),e.tickAlign.setState(.5),e.tickRadius.setState(Hu.pct(45)),e.tickLength.setState(Hu.pct(50)),e.tickWidth.setState(Hu.px(1)),e.tickPadding.setState(Hu.px(1)),e.tickColor.setState(ta.black()),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.title=function(t){return void 0===t?this.getChildView("title"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("title",t),this)},e.prototype.addDial=function(t){t=Fc.fromAny(t),this.appendChildView(t)},e.prototype.needsUpdate=function(t,e){return 0!=(t&el.NeedsAnimate)&&(t|=el.NeedsLayout),0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t|=el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime;this.limit.onFrame(e),this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.startAngle.onFrame(e),this.sweepAngle.onFrame(e),this.cornerRadius.onFrame(e),this.dialSpacing.onFrame(e),this.dialColor.onFrame(e),this.meterColor.onFrame(e),this.labelPadding.onFrame(e),this.tickAlign.onFrame(e),this.tickRadius.onFrame(e),this.tickLength.onFrame(e),this.tickWidth.onFrame(e),this.tickPadding.onFrame(e),this.tickColor.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e);for(var r=this._childViews,i=0;i<r.length;i+=1){var n=r[i];n instanceof Fc&&(n.onAnimate(t),n.setUpdateFlags(n.updateFlags&~el.NeedsAnimate))}},e.prototype.onLayout=function(e){t.prototype.onLayout.call(this,e),this.layoutGauge()},e.prototype.layoutGauge=function(){var t,e,r,i,n=this._bounds,o=Math.min(n.width,n.height),s=this._childViews,u=s.length,a=this.limit.value,h=this.innerRadius.value,p=this.outerRadius.value,l=this.startAngle.value,c=this.sweepAngle.value,f=this.dialSpacing.value;if(h&&p){for(var d=0,y=0;y<u;y+=1){(v=s[y])instanceof Fc&&"auto"===v._arrangement&&(d+=1)}t=h.pxValue(o),e=p.pxValue(o),r=f?f.pxValue(o):0,i=d>1?(e-t-r*(d-1))/d:e-t}for(y=0;y<u;y+=1){var v;if((v=s[y])instanceof Fc&&"auto"===v._arrangement){if(a&&isFinite(a)){var _=v.total();_&&v.total(Math.max(_,a))}h&&p&&(v.innerRadius(Hu.px(t)).outerRadius(Hu.px(t+i)),t=t+i+r),l&&v.startAngle(l),c&&v.sweepAngle(c)}}var m=this.title();Yl.is(m)&&(m.textAlign("center"),m.textBaseline("middle"))},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.limit&&r.limit(t.limit),void 0!==t.innerRadius&&r.innerRadius(t.innerRadius),void 0!==t.outerRadius&&r.outerRadius(t.outerRadius),void 0!==t.startAngle&&r.startAngle(t.startAngle),void 0!==t.sweepAngle&&r.sweepAngle(t.sweepAngle),void 0!==t.cornerRadius&&r.cornerRadius(t.cornerRadius),void 0!==t.dialSpacing&&r.dialSpacing(t.dialSpacing),void 0!==t.dialColor&&r.dialColor(t.dialColor),void 0!==t.meterColor&&r.meterColor(t.meterColor),void 0!==t.labelPadding&&r.labelPadding(t.labelPadding),void 0!==t.tickAlign&&r.tickAlign(t.tickAlign),void 0!==t.tickRadius&&r.tickRadius(t.tickRadius),void 0!==t.tickLength&&r.tickLength(t.tickLength),void 0!==t.tickWidth&&r.tickWidth(t.tickWidth),void 0!==t.tickPadding&&r.tickPadding(t.tickPadding),void 0!==t.tickColor&&r.tickColor(t.tickColor),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.title&&r.title(t.title);var i=t.dials;if(i)for(var n=0,o=i.length;n<o;n+=1)r.addDial(i[n]);return void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Number)],e.prototype,"limit",void 0),m([rl(Hu)],e.prototype,"innerRadius",void 0),m([rl(Hu)],e.prototype,"outerRadius",void 0),m([rl(Nu)],e.prototype,"startAngle",void 0),m([rl(Nu)],e.prototype,"sweepAngle",void 0),m([rl(Hu)],e.prototype,"cornerRadius",void 0),m([rl(Hu)],e.prototype,"dialSpacing",void 0),m([rl(ta)],e.prototype,"dialColor",void 0),m([rl(ta)],e.prototype,"meterColor",void 0),m([rl(Hu)],e.prototype,"labelPadding",void 0),m([rl(Number)],e.prototype,"tickAlign",void 0),m([rl(Hu)],e.prototype,"tickRadius",void 0),m([rl(Hu)],e.prototype,"tickLength",void 0),m([rl(Hu)],e.prototype,"tickWidth",void 0),m([rl(Hu)],e.prototype,"tickPadding",void 0),m([rl(ta)],e.prototype,"tickColor",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),Uc=function(t){function e(){var e=t.call(this)||this;return e.value.setState(0),e._total=1,e.phaseAngle.setState(Nu.zero()),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.total=function(t){return void 0===t?this._total:(this._total=t,this)},e.prototype.label=function(t){return void 0===t?this.getChildView("label"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("label",t),this)},e.prototype.legend=function(t){return void 0===t?this.getChildView("legend"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("legend",t),this)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.value.onFrame(e),this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.phaseAngle.onFrame(e),this.padAngle.onFrame(e),this.padRadius.onFrame(e),this.cornerRadius.onFrame(e),this.labelRadius.onFrame(e),this.sliceColor.onFrame(e),this.tickAlign.onFrame(e),this.tickRadius.onFrame(e),this.tickLength.onFrame(e),this.tickWidth.onFrame(e),this.tickPadding.onFrame(e),this.tickColor.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.layoutChildView=function(t){Hl.is(t)&&t.setBounds(this._bounds)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderSlice(r,this._bounds,this._anchor),this.renderTick(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderSlice=function(t,e,r){var i=Math.min(e.width,e.height),n=this.innerRadius.value.pxValue(i),o=this.outerRadius.value.pxValue(i),s=this.phaseAngle.value.radValue(),u=2*Math.PI*this.value.value/(this._total||1),a=this.padAngle.value,h=this.padRadius.value||null,p=this.cornerRadius.value.pxValue(o-n),l=new wc(Hu.px(n),Hu.px(o),Nu.rad(s),Nu.rad(u),a,h,Hu.px(p));t.beginPath();var c=this.sliceColor.value;t.fillStyle=c.toString(),l.draw(t,e,r),t.fill();var f=this.label();if(Hl.is(f)){var d=s+u/2,y=n+this.labelRadius.value.pxValue(o-n),v=y*Math.cos(d),_=y*Math.sin(d),m=new no(r.x+v,r.y+_);f.setAnchor(m),Yl.is(f)&&(f.textAlign("center"),f.textBaseline("middle"))}},e.prototype.renderTick=function(t,e,r){var i=this.legend();if(Hl.is(i)&&!i.hidden){var n=e.width,o=e.height,s=Math.min(n,o),u=r.x,a=r.y,h=this.phaseAngle.value.radValue()+Math.min(2*Math.PI*this.value.value/(this._total||1),2*Math.PI)*this.tickAlign.value,p=this.outerRadius.value.pxValue(s),l=this.tickRadius.value.pxValue(s),c=this.tickLength.value.pxValue(n),f=p*Math.cos(h+1e-12),d=p*Math.sin(h+1e-12),y=l*Math.cos(h+1e-12),v=l*Math.sin(h+1e-12),_=0;t.beginPath();var m=this.tickColor.value;t.strokeStyle=m.toString(),t.lineWidth=this.tickWidth.value.pxValue(s),t.moveTo(u+f,a+d),t.lineTo(u+y,a+v),c&&(y>=0?(t.lineTo(u+c,a+v),_=c-y):y<0&&(t.lineTo(u-c,a+v),_=c+y)),t.stroke();var w=void 0,g=void 0;y>=0?(w=_,g="end"):(w=-_,g="start");var b=new no(u+y+w,a+v-this.tickPadding.value.pxValue(s));i.setAnchor(b),Yl.is(i)&&(Gl.is(i)&&i.fill(m),i.textAlign(g),i.textBaseline("alphabetic"))}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestSlice(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestSlice=function(t,e,r,i,n){var o=Math.min(i.width,i.height),s=this.innerRadius.value.pxValue(o),u=this.outerRadius.value.pxValue(o),a=this.phaseAngle.value.radValue(),h=2*Math.PI*this.value.value/(this._total||1),p=this.padAngle.value,l=this.padRadius.value||null,c=this.cornerRadius.value.pxValue(u-s),f=new wc(Hu.px(s),Hu.px(u),Nu.rad(a),Nu.rad(h),p,l,Hu.px(c));return r.beginPath(),f.draw(r,i,n),r.isPointInPath(t,e)?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;return void 0!==t.key&&r.key(t.key),void 0!==t.value&&r.value(t.value),void 0!==t.total&&r.total(t.total),void 0!==t.innerRadius&&r.innerRadius(t.innerRadius),void 0!==t.outerRadius&&r.outerRadius(t.outerRadius),void 0!==t.phaseAngle&&r.phaseAngle(t.phaseAngle),void 0!==t.padAngle&&r.padAngle(t.padAngle),void 0!==t.padRadius&&r.padRadius(t.padRadius),void 0!==t.cornerRadius&&r.cornerRadius(t.cornerRadius),void 0!==t.labelRadius&&r.labelRadius(t.labelRadius),void 0!==t.sliceColor&&r.sliceColor(t.sliceColor),void 0!==t.tickAlign&&r.tickAlign(t.tickAlign),void 0!==t.tickRadius&&r.tickRadius(t.tickRadius),void 0!==t.tickLength&&r.tickLength(t.tickLength),void 0!==t.tickWidth&&r.tickWidth(t.tickWidth),void 0!==t.tickPadding&&r.tickPadding(t.tickPadding),void 0!==t.tickColor&&r.tickColor(t.tickColor),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.label&&r.label(t.label),void 0!==t.legend&&r.legend(t.legend),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Number)],e.prototype,"value",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"innerRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"outerRadius",void 0),m([rl(Nu)],e.prototype,"phaseAngle",void 0),m([rl(Nu,{inherit:!0})],e.prototype,"padAngle",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"padRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"cornerRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"labelRadius",void 0),m([rl(ta,{inherit:!0})],e.prototype,"sliceColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickAlign",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickRadius",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickLength",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickWidth",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"tickPadding",void 0),m([rl(ta,{inherit:!0})],e.prototype,"tickColor",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),Nc=function(t){function e(){var e=t.call(this)||this;return e.limit.setState(0),e.baseAngle.setState(Nu.rad(-Math.PI/2)),e.innerRadius.setState(Hu.pct(3)),e.outerRadius.setState(Hu.pct(25)),e.padAngle.setState(Nu.deg(2)),e.padRadius.setState(null),e.cornerRadius.setState(Hu.zero()),e.labelRadius.setState(Hu.pct(50)),e.sliceColor.setState(ta.black()),e.tickAlign.setState(.5),e.tickRadius.setState(Hu.pct(30)),e.tickLength.setState(Hu.pct(50)),e.tickWidth.setState(Hu.px(1)),e.tickPadding.setState(Hu.px(1)),e.tickColor.setState(ta.black()),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.title=function(t){return void 0===t?this.getChildView("title"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("title",t),this)},e.prototype.addSlice=function(t){t=Uc.fromAny(t),this.appendChildView(t)},e.prototype.needsUpdate=function(t,e){return 0!=(t&el.NeedsAnimate)&&(t|=el.NeedsLayout),0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t|=el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime;this.limit.onFrame(e),this.baseAngle.onFrame(e),this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.padAngle.onFrame(e),this.padRadius.onFrame(e),this.cornerRadius.onFrame(e),this.labelRadius.onFrame(e),this.sliceColor.onFrame(e),this.tickAlign.onFrame(e),this.tickRadius.onFrame(e),this.tickLength.onFrame(e),this.tickWidth.onFrame(e),this.tickPadding.onFrame(e),this.tickColor.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e);for(var r=this._childViews,i=0;i<r.length;i+=1){var n=r[i];n instanceof Uc&&(n.onAnimate(t),n.setUpdateFlags(n.updateFlags&~el.NeedsAnimate))}},e.prototype.onLayout=function(e){t.prototype.onLayout.call(this,e),this.layoutPie()},e.prototype.layoutPie=function(){for(var t=this._childViews,e=t.length,r=0,i=0;i<e;i+=1){if((s=t[i])instanceof Uc){var n=s.value.value;isFinite(n)&&(r+=n)}}r=Math.max(r,this.limit.value);var o=this.baseAngle.value;for(i=0;i<e;i+=1){var s;if((s=t[i])instanceof Uc){s.total(r).phaseAngle(o);n=s.value.value;isFinite(n)&&(o=o.plus(Nu.rad(2*Math.PI*n/(r||1))))}}var u=this.title();Yl.is(u)&&(u.textAlign("center"),u.textBaseline("middle"))},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.limit&&r.limit(t.limit),void 0!==t.baseAngle&&r.baseAngle(t.baseAngle),void 0!==t.innerRadius&&r.innerRadius(t.innerRadius),void 0!==t.outerRadius&&r.outerRadius(t.outerRadius),void 0!==t.padAngle&&r.padAngle(t.padAngle),void 0!==t.padRadius&&r.padRadius(t.padRadius),void 0!==t.cornerRadius&&r.cornerRadius(t.cornerRadius),void 0!==t.labelRadius&&r.labelRadius(t.labelRadius),void 0!==t.sliceColor&&r.sliceColor(t.sliceColor),void 0!==t.tickAlign&&r.tickAlign(t.tickAlign),void 0!==t.tickRadius&&r.tickRadius(t.tickRadius),void 0!==t.tickLength&&r.tickLength(t.tickLength),void 0!==t.tickWidth&&r.tickWidth(t.tickWidth),void 0!==t.tickPadding&&r.tickPadding(t.tickPadding),void 0!==t.tickColor&&r.tickColor(t.tickColor),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.title&&r.title(t.title);var i=t.slices;if(i)for(var n=0,o=i.length;n<o;n+=1)r.addSlice(i[n]);return void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Number)],e.prototype,"limit",void 0),m([rl(Nu)],e.prototype,"baseAngle",void 0),m([rl(Hu)],e.prototype,"innerRadius",void 0),m([rl(Hu)],e.prototype,"outerRadius",void 0),m([rl(Nu)],e.prototype,"padAngle",void 0),m([rl(Hu)],e.prototype,"padRadius",void 0),m([rl(Hu)],e.prototype,"cornerRadius",void 0),m([rl(Hu)],e.prototype,"labelRadius",void 0),m([rl(ta)],e.prototype,"sliceColor",void 0),m([rl(Number)],e.prototype,"tickAlign",void 0),m([rl(Hu)],e.prototype,"tickRadius",void 0),m([rl(Hu)],e.prototype,"tickLength",void 0),m([rl(Hu)],e.prototype,"tickWidth",void 0),m([rl(Hu)],e.prototype,"tickPadding",void 0),m([rl(ta)],e.prototype,"tickColor",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl);(hc=t.TickState||(t.TickState={}))[hc.Excluded=0]="Excluded",hc[hc.Entering=1]="Entering",hc[hc.Included=2]="Included",hc[hc.Leaving=3]="Leaving";var zc=function(t){function e(r){var i=t.call(this)||this;return i._value=r,i._coord=0,i._coord0=NaN,i._state=0,i._preserve=!0,i.opacity.setState(1),i.opacity.interpolate=e.interpolateOpacity,i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coord",{get:function(){return this._coord},enumerable:!0,configurable:!0}),e.prototype.setCoord=function(t){this._coord=t},e.prototype.tickLabel=function(t){return void 0===t?this.getChildView("tickLabel"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("tickLabel",t),this)},e.prototype.preserve=function(t){return void 0===t?this._preserve:(this._preserve=t,this)},e.prototype.fadeIn=function(t){0!==this._state&&3!==this._state||(this.opacity.setState(1,t),this._state=1)},e.prototype.fadeOut=function(t){1!==this._state&&2!==this._state||(this.opacity.setState(0,t),this._state=3)},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime;this.opacity.onFrame(e),this.tickMarkColor.onFrame(e),this.tickMarkWidth.onFrame(e),this.tickMarkLength.onFrame(e),this.tickLabelPadding.onFrame(e),this.gridLineColor.onFrame(e),this.gridLineWidth.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onLayout=function(t){var e=this.tickLabel();Hl.is(e)&&this.layoutTickLabel(e,this._bounds,this._anchor)},e.prototype.willUpdate=function(e){t.prototype.willUpdate.call(this,e);var r=e.renderer;r instanceof Fp&&r.context.save()},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.globalAlpha=this.opacity.value;var i=this._bounds,n=this._anchor;this.renderTick(r,i,n)}},e.prototype.didUpdate=function(e){var r=e.renderer;r instanceof Fp&&r.context.restore();t.prototype.didUpdate.call(this,e)},e.prototype.layoutChildView=function(e,r){"tickLabel"===e.key()&&Hl.is(e)?this.layoutTickLabel(e,this._bounds,this._anchor):t.prototype.layoutChildView.call(this,e,r)},e.top=function(t){return new e.Top(t)},e.right=function(t){return new e.Right(t)},e.bottom=function(t){return new e.Bottom(t)},e.left=function(t){return new e.Left(t)},e.from=function(t,r){if("top"===t)return e.top(r);if("right"===t)return e.right(r);if("bottom"===t)return e.bottom(r);if("left"===t)return e.left(r);throw new TypeError(t)},e.fromAny=function(t,r){if(t instanceof e)return t;if(t&&"object"==typeof t){if(t.orientation&&(r=t.orientation),!r)throw new TypeError;var i=e.from(r,t.value);return void 0!==t.key&&i.key(t.key),void 0!==t.tickMarkColor&&i.tickMarkColor(t.tickMarkColor),void 0!==t.tickMarkWidth&&i.tickMarkWidth(t.tickMarkWidth),void 0!==t.tickMarkLength&&i.tickMarkLength(t.tickMarkLength),void 0!==t.tickLabelPadding&&i.tickLabelPadding(t.tickLabelPadding),void 0!==t.gridLineColor&&i.gridLineColor(t.gridLineColor),void 0!==t.gridLineWidth&&i.gridLineWidth(t.gridLineWidth),void 0!==t.font&&i.font(t.font),void 0!==t.textColor&&i.textColor(t.textColor),void 0!==t.tickLabel&&i.tickLabel(t.tickLabel),void 0!==t.hidden&&i.setHidden(t.hidden),void 0!==t.culled&&i.setCulled(t.culled),i}throw new TypeError(""+t)},e.interpolateOpacity=function(t){var e=this._view,r=e._coord;isNaN(e._coord0)&&(e._coord0=r);var i=e._parentView._tickSpacing/2,n=Math.min(Math.abs(r-e._coord0)/i,1),o=this._interpolator.interpolate(Math.max(t,n));return 1!==t&&1!==n||(this._tweenState=3),0===o&&3===e._state?(e._state=0,e._coord0=NaN,setTimeout(e.remove.bind(e))):1===o&&1===e._state&&(e._state=2,e._coord0=NaN),o},m([rl(Number)],e.prototype,"opacity",void 0),m([rl(ta,{inherit:!0})],e.prototype,"tickMarkColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickMarkWidth",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickMarkLength",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickLabelPadding",void 0),m([rl(ta,{inherit:!0})],e.prototype,"gridLineColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"gridLineWidth",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),jc=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"top"},enumerable:!0,configurable:!0}),e.prototype.layoutTickLabel=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y)-this.tickMarkLength.value-this.tickLabelPadding.value,o=new no(i,n);t.setAnchor(o),Yl.is(t)&&(t.textAlign("center"),t.textBaseline("bottom"))},e.prototype.renderTick=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=n-this.tickMarkLength.value;t.beginPath(),t.strokeStyle=this.tickMarkColor.value.toString(),t.lineWidth=this.tickMarkWidth.value,t.moveTo(i,n),t.lineTo(i,o),t.stroke();var s=this.gridLineWidth.value;s&&e.xMin<i&&i<e.xMax&&(t.beginPath(),t.strokeStyle=this.gridLineColor.value.toString(),t.lineWidth=s,t.moveTo(i,n),t.lineTo(i,e.yMax),t.stroke())},e}(zc);zc.Top=jc;var Wc=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"right"},enumerable:!0,configurable:!0}),e.prototype.layoutTickLabel=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=i+this.tickMarkLength.value+this.tickLabelPadding.value,s=new no(o,n);t.setAnchor(s),Yl.is(t)&&(t.textAlign("left"),t.textBaseline("middle"))},e.prototype.renderTick=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=i+this.tickMarkLength.value;t.beginPath(),t.strokeStyle=this.tickMarkColor.value.toString(),t.lineWidth=this.tickMarkWidth.value,t.moveTo(i,n),t.lineTo(o,n),t.stroke();var s=this.gridLineWidth.value;s&&e.yMin<n&&n<e.yMax&&(t.beginPath(),t.strokeStyle=this.gridLineColor.value.toString(),t.lineWidth=s,t.moveTo(i,n),t.lineTo(e.xMin,n),t.stroke())},e}(zc);zc.Right=Wc;var qc=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"bottom"},enumerable:!0,configurable:!0}),e.prototype.layoutTickLabel=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y)+this.tickMarkLength.value+this.tickLabelPadding.value,o=new no(i,n);t.setAnchor(o),Yl.is(t)&&(t.textAlign("center"),t.textBaseline("top"))},e.prototype.renderTick=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=n+this.tickMarkLength.value;t.beginPath(),t.strokeStyle=this.tickMarkColor.value.toString(),t.lineWidth=this.tickMarkWidth.value,t.moveTo(i,n),t.lineTo(i,o),t.stroke();var s=this.gridLineWidth.value;s&&e.xMin<i&&i<e.xMax&&(t.beginPath(),t.strokeStyle=this.gridLineColor.value.toString(),t.lineWidth=s,t.moveTo(i,n),t.lineTo(i,e.yMin),t.stroke())},e}(zc);zc.Bottom=qc;var Bc=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"left"},enumerable:!0,configurable:!0}),e.prototype.layoutTickLabel=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=i-this.tickMarkLength.value-this.tickLabelPadding.value,s=new no(o,n);t.setAnchor(s),Yl.is(t)&&(t.textAlign("right"),t.textBaseline("middle"))},e.prototype.renderTick=function(t,e,r){var i=Math.round(r.x),n=Math.round(r.y),o=i-this.tickMarkLength.value;t.beginPath(),t.strokeStyle=this.tickMarkColor.value.toString(),t.lineWidth=this.tickMarkWidth.value,t.moveTo(i,n),t.lineTo(o,n),t.stroke();var s=this.gridLineWidth.value;s&&e.yMin<n&&n<e.yMax&&(t.beginPath(),t.strokeStyle=this.gridLineColor.value.toString(),t.lineWidth=s,t.moveTo(i,n),t.lineTo(e.xMax,n),t.stroke())},e}(zc);zc.Left=Bc;var Kc=Math.sqrt(50),Hc=Math.sqrt(10),Gc=Math.sqrt(2),Xc=36e5,Yc=24*Xc,Zc=(new jt).set(1e3,Ko.second()).set(5e3,Ko.second(5)).set(15e3,Ko.second(15)).set(3e4,Ko.second(30)).set(6e4,Ko.minute(1)).set(3e5,Ko.minute(5)).set(9e5,Ko.minute(15)).set(18e5,Ko.minute(30)).set(Xc,Ko.hour()).set(3*Xc,Ko.hour(3)).set(6*Xc,Ko.hour(6)).set(12*Xc,Ko.hour(12)).set(Yc,Ko.day()).set(2*Yc,Ko.day(2)).set(6048e5,Ko.week()).set(2592e6,Ko.month()).set(7776e6,Ko.month(3)).set(31536e6,Ko.year()),Qc=vo.pattern(".%L"),$c=vo.pattern(":%S"),Jc=vo.pattern("%I:%M"),tf=vo.pattern("%I %p"),ef=vo.pattern("%a %d"),rf=vo.pattern("%b %d"),nf=vo.pattern("%B"),of=vo.pattern("%Y"),sf=function(){function t(){}return t.prototype.format=function(t){return""+t},t.fromScale=function(t,e){if(void 0===e&&(e=10),t instanceof bh){var r=t.domain();return new af(r[0],r[1],e)}r=t.domain();return new uf(r[0],r[1],e)},t.step=function(t,e){var r=Math.abs(t)/e,i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),n=r/i;return n>=Kc?i*=10:n>=Hc?i*=5:n>=Gc&&(i*=2),t<0?-i:i},t}(),uf=function(t){function e(e,r,i){var n=t.call(this)||this;return n.x0=e,n.dx=r-n.x0,n.n=Math.max(0,i),n}return _(e,t),e.prototype.count=function(t){return void 0===t?this.n:(this.n=Math.max(0,t),this)},e.prototype.domain=function(t,e){return void 0===t?[this.x0,this.x0+this.dx]:void 0===e?(this.x0=t[0],this.dx=t[1]-this.x0,this):(this.x0=t,this.dx=e-this.x0,this)},e.prototype.generate=function(){var t,r;this.dx<0?t=(r=this.x0)+this.dx:r=(t=this.x0)+this.dx;var i,n=e.interval(r-t,this.n);if(0===n||!isFinite(n))return[];if(n>0){t=Math.ceil(t/n),r=Math.floor(r/n);var o=Math.ceil(r-t+1);i=new Array(o);for(var s=0;s<o;s+=1)i[s]=(t+s)*n}else{t=Math.floor(t*n),r=Math.ceil(r*n);o=Math.ceil(t-r+1);i=new Array(o);for(s=0;s<o;s+=1)i[s]=(t-s)/n}return this.dx<0&&i.reverse(),i},e.interval=function(t,e){void 0===e&&(e=10);var r=t/e,i=Math.floor(Math.log(r)/Math.LN10),n=Math.pow(10,i),o=r/n,s=o>=Kc?10:o>=Hc?5:o>=Gc?2:1;return i>=0?n*s:-Math.pow(10,-i)/s},e}(sf),af=function(t){function e(e,r,i,n){var o=t.call(this)||this;return e=lo.fromAny(e),r=lo.fromAny(r),o.t0=e.time(),o.dt=r.time()-o.t0,o.zone=n||e.zone(),o.n=Math.max(0,i),o}return _(e,t),e.prototype.count=function(t){return void 0===t?this.n:(this.n=Math.max(0,t),this)},e.prototype.domain=function(t,e){return void 0===t?[new lo(this.t0,this.zone),new lo(this.t0+this.dt,this.zone)]:(void 0===e?(e=t[1],t=t[0]):t=t,t=lo.fromAny(t),e=lo.fromAny(e),this.t0=t.time(),this.dt=e.time()-this.t0,this)},e.prototype.generate=function(t){var r,i;this.dt<0?r=(i=this.t0)+this.dt:i=(r=this.t0)+this.dt,void 0===t&&(t=this.n);var n=(t=e.interval(i-r,t)).range(new lo(r,this.zone),new lo(i+1,this.zone));return this.dt<0&&n.reverse(),n},e.prototype.format=function(t){return Ko.second().floor(t)<t?Qc.format(t):Ko.minute().floor(t)<t?$c.format(t):Ko.hour().floor(t)<t?Jc.format(t):Ko.day().floor(t)<t?tf.format(t):Ko.month().floor(t)<t?Ko.week().floor(t)<t?ef.format(t):rf.format(t):Ko.year().floor(t)<t?nf.format(t):of.format(t)},e.interval=function(t,e){if(void 0===e&&(e=10),"number"==typeof e){var r=Math.abs(t)/e,i=Zc.nextKey(r);if(void 0===i){var n=sf.step(t/31536e6,e);e=Ko.year(n)}else if(i>1e3)e=r/Zc.previousKey(r)<i/r?Zc.previousValue(r):Zc.nextValue(r);else{n=Math.max(1,sf.step(t,e));e=Ko.millisecond(n)}}return e},e}(sf),hf=function(t){function e(e){var r=t.call(this)||this;return r._ticks=new jt,r._tickGenerator=sf.fromScale(e),r._tickSpacing=80,r._tickTransition=tp.duration(200),r.scale.setState(e),r}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.getTick=function(t){return this._ticks.get(t)},e.prototype.insertTick=function(t){t=zc.fromAny(t,this.orientation),this.insertChildView(t,this._ticks.nextValue(t.value)||null)},e.prototype.removeTick=function(t){var e=this._ticks.get(t);e&&(e.remove(),this._ticks.delete(t))},e.prototype.domain=function(t,e,r){var i=this.scale.value;return void 0===t?i.domain():((i=i.domain(t,e)).equals(this.scale.state)||this.scale.setState(i,r),this)},e.prototype.range=function(t,e,r){var i=this.scale.value;return void 0===t?i.range():((i=i.range(t,e)).equals(this.scale.state)||this.scale.setState(i,r),this)},e.prototype.tickGenerator=function(t){return void 0===t?this._tickGenerator:(this._tickGenerator=t,this)},e.prototype.tickSpacing=function(t){return void 0===t?this._tickSpacing:(this._tickSpacing=t,this)},e.prototype.tickTransition=function(t){return void 0===t?this._tickTransition:(t=null!==t?tp.fromAny(t):null,this._tickTransition=t,this)},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.willUpdate=function(e){t.prototype.willUpdate.call(this,e);var r=e.renderer;r instanceof Fp&&r.context.save()},e.prototype.didUpdate=function(e){var r=e.renderer;if(r instanceof Fp){var i=r.context,n=this._bounds,o=this._anchor;this.renderDomain(i,n,o),i.restore()}t.prototype.didUpdate.call(this,e)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.scale.onFrame(e),this.domainColor.onFrame(e),this.domainWidth.onFrame(e),this.domainSerif.onFrame(e),this.tickMarkColor.onFrame(e),this.tickMarkWidth.onFrame(e),this.tickMarkLength.onFrame(e),this.tickLabelPadding.onFrame(e),this.gridLineColor.onFrame(e),this.gridLineWidth.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onLayout=function(t){this._tickGenerator&&(this.generateTicks(this._tickGenerator),this.layoutTicks(this._bounds,this._anchor))},e.prototype.generateTicks=function(t){var e=this.scale.value;if(this._tickSpacing){var r=e.range(),i=r[0],n=r[1],o=Math.abs(n-i),s=Math.max(1,Math.floor(o/this._tickSpacing));t.count(s)}t.domain(e.domain());var u=this._ticks.clone(),a=t.generate(),h=0;for(s=a.length;h<s;h+=1){var p=a[h],l=u.get(p);if(l)u.delete(p),l.fadeIn(this._tickTransition||void 0);else{var c=this.createTickView(p);c&&(this.insertTick(c),c.opacity._value=0,c.opacity._state=0,c.fadeIn(this._tickTransition||void 0))}}u.forEach((function(t,e){e._preserve||e.fadeOut(this._tickTransition||void 0)}),this)},e.prototype.createTickView=function(t){var e,r=this._viewController;if(r&&(e=r.createTickView(t)),void 0===e&&(e=zc.from(this.orientation,t)),e){var i=this.createTickLabel(t,e);null!==i&&(e.tickLabel(i),e._preserve=!1)}return e},e.prototype.createTickLabel=function(t,e){var r,i=this._viewController;return i&&(r=i.createTickLabel(t,e)),void 0===r&&(r=this._tickGenerator?this._tickGenerator.format(t):""+t),"string"==typeof r&&(r=this.formatTickLabel(r,e)),r},e.prototype.formatTickLabel=function(t,e){var r=this._viewController;return r?r.formatTickLabel(t,e):t},e.prototype.layoutTicks=function(t,e){for(var r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];o instanceof zc&&this.layoutTick(o,t,e)}},e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r),e instanceof zc&&this._ticks.set(e.value,e)},e.prototype.onRemoveChildView=function(t){t instanceof zc&&this._ticks.delete(t.value)},e.prototype.layoutChildView=function(e,r){e instanceof zc?this.layoutTick(e,this._bounds,this._anchor):t.prototype.layoutChildView.call(this,e,r)},e.top=function(t){return t=e.scale(t),new e.Top(t)},e.right=function(t){return t=e.scale(t),new e.Right(t)},e.bottom=function(t){return t=e.scale(t),new e.Bottom(t)},e.left=function(t){return t=e.scale(t),new e.Left(t)},e.from=function(t,r){if("top"===t)return e.top(r);if("right"===t)return e.right(r);if("bottom"===t)return e.bottom(r);if("left"===t)return e.left(r);throw new TypeError(t)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=e.from(t.orientation,t.scale);void 0!==t.key&&r.key(t.key);var i=t.ticks,n=t.tickGenerator?t.tickGenerator:i?null:void 0;if(void 0!==n&&r.tickGenerator(n),i)for(var o=0,s=i.length;o<s;o+=1)r.insertTick(i[o]);return void 0!==t.tickSpacing&&r.tickSpacing(t.tickSpacing),void 0!==t.tickTransition&&r.tickTransition(t.tickTransition),void 0!==t.domainColor&&r.domainColor(t.domainColor),void 0!==t.domainWidth&&r.domainWidth(t.domainWidth),void 0!==t.domainSerif&&r.domainSerif(t.domainSerif),void 0!==t.tickMarkColor&&r.tickMarkColor(t.tickMarkColor),void 0!==t.tickMarkWidth&&r.tickMarkWidth(t.tickMarkWidth),void 0!==t.tickMarkLength&&r.tickMarkLength(t.tickMarkLength),void 0!==t.tickLabelPadding&&r.tickLabelPadding(t.tickLabelPadding),void 0!==t.gridLineColor&&r.gridLineColor(t.gridLineColor),void 0!==t.gridLineWidth&&r.gridLineWidth(t.gridLineWidth),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},e.scale=function(t){if(t instanceof wh)return t;if("string"==typeof t){if("linear"===t)return new gh(0,1,new Ia(0,0));if("time"===t){var e=lo.current(),r=e.day(e.day()-1);return new bh(r,e,new Ia(0,0))}var i=t.split("..."),n=Ap.parse(i[0]),o=Ap.parse(i[1]);if("number"==typeof n&&"number"==typeof o)return new gh(n,o,new Ia(0,0));if(n instanceof lo&&o instanceof lo)return new bh(n,o,new Ia(0,0))}throw new TypeError(t)},m([rl(Object)],e.prototype,"scale",void 0),m([rl(ta,{inherit:!0})],e.prototype,"domainColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"domainWidth",void 0),m([rl(Number,{inherit:!0})],e.prototype,"domainSerif",void 0),m([rl(ta,{inherit:!0})],e.prototype,"tickMarkColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickMarkWidth",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickMarkLength",void 0),m([rl(Number,{inherit:!0})],e.prototype,"tickLabelPadding",void 0),m([rl(ta,{inherit:!0})],e.prototype,"gridLineColor",void 0),m([rl(Number,{inherit:!0})],e.prototype,"gridLineWidth",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),pf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){var t=this._view;return t?t.orientation:void 0},enumerable:!0,configurable:!0}),e.prototype.createTickView=function(t){},e.prototype.createTickLabel=function(t,e){},e.prototype.formatTickLabel=function(t,e){return t},e}(Ql),lf=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"top"},enumerable:!0,configurable:!0}),e.prototype.renderDomain=function(t,e,r){var i=r.x,n=r.y,o=this.scale.value.range(),s=o[0],u=o[1],a=this.domainSerif.value;t.beginPath(),t.strokeStyle=this.domainColor.value.toString(),t.lineWidth=this.domainWidth.value,a?(t.moveTo(i+s,n-a),t.lineTo(i+s,n),t.lineTo(i+u,n),t.lineTo(i+u,n-a)):(t.moveTo(i+s,n),t.lineTo(i+u,n)),t.stroke()},e.prototype.layoutTick=function(t,e,r){var i=this.scale.value.scale(t.value),n=r.x+i,o=r.y,s=new no(n,o);t.setBounds(e),t.setAnchor(s),t.setCoord(i)},e}(hf);hf.Top=lf;var cf=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"right"},enumerable:!0,configurable:!0}),e.prototype.renderDomain=function(t,e,r){var i=r.x,n=r.y,o=this.scale.value.range(),s=o[0],u=o[1],a=this.domainSerif.value;t.beginPath(),t.strokeStyle=this.domainColor.value.toString(),t.lineWidth=this.domainWidth.value,a?(t.moveTo(i+a,n+s),t.lineTo(i,n+s),t.lineTo(i,n+u),t.lineTo(i+a,n+u)):(t.moveTo(i,n+s),t.lineTo(i,n+u)),t.stroke()},e.prototype.layoutTick=function(t,e,r){var i=this.scale.value.scale(t.value),n=r.x,o=r.y+i,s=new no(n,o);t.setBounds(e),t.setAnchor(s),t.setCoord(i)},e}(hf);hf.Right=cf;var ff=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"bottom"},enumerable:!0,configurable:!0}),e.prototype.renderDomain=function(t,e,r){var i=r.x,n=r.y,o=this.scale.value.range(),s=o[0],u=o[1],a=this.domainSerif.value;t.beginPath(),t.strokeStyle=this.domainColor.value.toString(),t.lineWidth=this.domainWidth.value,a?(t.moveTo(i+s,n+a),t.lineTo(i+s,n),t.lineTo(i+u,n),t.lineTo(i+u,n+a)):(t.moveTo(i+s,n),t.lineTo(i+u,n)),t.stroke()},e.prototype.layoutTick=function(t,e,r){var i=this.scale.value.scale(t.value),n=r.x+i,o=r.y,s=new no(n,o);t.setBounds(e),t.setAnchor(s),t.setCoord(i)},e}(hf);hf.Bottom=ff;var df=function(t){function e(e){return t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"left"},enumerable:!0,configurable:!0}),e.prototype.renderDomain=function(t,e,r){var i=r.x,n=r.y,o=this.scale.value.range(),s=o[0],u=o[1],a=this.domainSerif.value;t.beginPath(),t.strokeStyle=this.domainColor.value.toString(),t.lineWidth=this.domainWidth.value,a?(t.moveTo(i-a,n+s),t.lineTo(i,n+s),t.lineTo(i,n+u),t.lineTo(i-a,n+u)):(t.moveTo(i,n+s),t.lineTo(i,n+u)),t.stroke()},e.prototype.layoutTick=function(t,e,r){var i=this.scale.value.scale(t.value),n=r.x,o=r.y+i,s=new no(n,o);t.setBounds(e),t.setAnchor(s),t.setCoord(i)},e}(hf);hf.Left=df;var yf=function(t){function e(e,r,i){var n=t.call(this,i)||this;return n.x.setState(e),n.y.setState(r),n._y2Coord=null,n._hitRadius=5,n._category=null,n._labelPlacement="auto",n}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xCoord",{get:function(){return this._anchor.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yCoord",{get:function(){return this._anchor.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y2Coord",{get:function(){return this._y2Coord},enumerable:!0,configurable:!0}),e.prototype.hitRadius=function(t){return void 0===t?this._hitRadius:(this._hitRadius=t,this)},e.prototype.category=function(t){return void 0===t?this._category:(this._category=t,this)},e.prototype.label=function(t){return void 0===t?this.getChildView("label"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("label",t),this)},e.prototype.labelPlacement=function(t){return void 0===t?this._labelPlacement:(this._labelPlacement=t,this)},e.prototype.setState=function(t,e){void 0!==t.key&&this.key(t.key),void 0!==t.y2&&this.y2(t.y2,e),void 0!==t.r&&this.r(t.r,e),void 0!==t.hitRadius&&this.hitRadius(t.hitRadius),void 0!==t.category&&this.category(t.category),void 0!==t.color&&this.color(t.color,e),void 0!==t.opacity&&this.opacity(t.opacity,e),void 0!==t.labelPadding&&this.labelPadding(t.labelPadding,e),void 0!==t.labelPlacement&&this.labelPlacement(t.labelPlacement),void 0!==t.font&&this.font(t.font,e),void 0!==t.textColor&&this.textColor(t.textColor,e),void 0!==t.label&&this.label(t.label),void 0!==t.hidden&&this.setHidden(t.hidden),void 0!==t.culled&&this.setCulled(t.culled)},e.prototype.isGradientStop=function(){return!!this.color.value||"number"==typeof this.opacity.value},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime;this.x.onFrame(e),this.y.onFrame(e),this.y2.onFrame(e),this.r.onFrame(e),this.color.onFrame(e),this.opacity.onFrame(e),this.labelPadding.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onLayout=function(t){var e=this.label();Hl.is(e)&&this.layoutLabel(e,this._bounds,this._anchor)},e.prototype.layoutLabel=function(t,e,r){var i=this._labelPlacement;if("above"!==i&&"below"!==i&&"middle"!==i){var n=this._category;i="increasing"===n||"maxima"===n?"above":"decreasing"===n||"minima"===n?"below":"above"}var o=this.labelPadding.value,s=o?o.pxValue(Math.min(e.width,e.height)):0,u=r.x,a=r.y;"above"===i?a-=s:"below"===i&&(a+=s);var h=new no(u,a);t.setAnchor(h),Yl.is(t)&&(t.textAlign("center"),"above"===i?t.textBaseline("bottom"):"below"===i?t.textBaseline("top"):"middle"===i&&t.textBaseline("middle"))},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context,u=this._bounds,a=this._anchor;n=this.hitTestDatum(e,r,s,u,a)}}return n},e.prototype.hitTestDatum=function(t,e,r,i,n){var o=this._hitRadius,s=this.r.value;if(s){var u=this.bounds,a=Math.min(u.width,u.height);o=Math.max(o,s.pxValue(a))}var h=n.x-t,p=n.y-e;return h*h+p*p<o*o?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e(t.x,t.y,t.key);return r.setState(t),r}throw new TypeError(""+t)},m([rl(Object)],e.prototype,"x",void 0),m([rl(Object)],e.prototype,"y",void 0),m([rl(Object)],e.prototype,"y2",void 0),m([rl(Hu)],e.prototype,"r",void 0),m([rl(ta)],e.prototype,"color",void 0),m([rl(Number)],e.prototype,"opacity",void 0),m([rl(Hu)],e.prototype,"labelPadding",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),vf=function(t){function e(){var e=t.call(this)||this;return e._xAxis=null,e._yAxis=null,e._xDomain=[null,null],e._xRange=[1/0,-1/0],e._yDomain=[null,null],e._yRange=[1/0,-1/0],e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.xAxis=function(t){return void 0===t?this._xAxis:(this._xAxis=t,this)},e.prototype.yAxis=function(t){return void 0===t?this._yAxis:(this._yAxis=t,this)},e.prototype.xDomain=function(){return this._xDomain},e.prototype.xRange=function(){return this._xRange},e.prototype.yDomain=function(){return this._yDomain},e.prototype.yRange=function(){return this._yRange},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime;this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onLayout=function(t){this._xAxis&&this._yAxis&&this.layoutData(this._xAxis.scale.value,this._yAxis.scale.value,this._bounds,this._anchor)},e.prototype.layoutData=function(t,e,r,i){for(var n,o,s,u,a,h,p,l,c,d=this._childViews,y=0,v=d.length;y<v;y+=1){var _=d[y];if(_ instanceof yf){var m=_.x.value,w=_.y.value,g=t.scale(m),b=e.scale(w),x=new no(i.x+g,i.y+b);_.setBounds(r),_.setAnchor(x),n?(f.compare(m,o)<0?o=m:f.compare(m,s)>0&&(s=m),g<u?u=g:g>a&&(a=g),f.compare(w,h)<0?h=w:f.compare(w,p)>0&&(p=w),b<l?l=b:b>c&&(c=b)):(o=m,s=m,u=g,a=g,h=w,p=w,l=b,c=b),n=_}}if(n){var C=!1;this._xDomain[0]!==o&&(this._xDomain[0]=o,C=!0),this._xDomain[1]!==s&&(this._xDomain[1]=s,C=!0),this._xRange[0]!==u&&(this._xRange[0]=u,C=!0),this._xRange[1]!==a&&(this._xRange[1]=a,C=!0),this._yDomain[0]!==h&&(this._yDomain[0]=h,C=!0),this._yDomain[1]!==p&&(this._yDomain[1]=p,C=!0),this._yRange[0]!==l&&(this._yRange[0]=l,C=!0),this._yRange[1]!==c&&(this._yRange[1]=c,C=!0),C&&this.requireUpdate(el.NeedsLayout)}},e.prototype.willUpdate=function(e){t.prototype.willUpdate.call(this,e);var r=e.renderer;if(r instanceof Fp){var i=r.context;i.save(),this.clipPlot(i,this._bounds)}},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context,i=this._bounds,n=this._anchor;this.renderPlot(r,i,n)}},e.prototype.didUpdate=function(e){var r=e.renderer;r instanceof Fp&&r.context.restore();t.prototype.didUpdate.call(this,e)},e.prototype.clipPlot=function(t,e){t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip()},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t){if("bubble"===t)return new e.Bubble;if("line"===t)return new e.Line;if("area"===t)return new e.Area}else if("object"==typeof t&&t){var r=t.type;if("bubble"===r)return e.Bubble.fromAny(t);if("line"===r)return e.Line.fromAny(t);if("area"===r)return e.Area.fromAny(t)}throw new TypeError(""+t)},m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),_f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"type",{get:function(){var t=this._view;return t?t.type:void 0},enumerable:!0,configurable:!0}),e.prototype.xAxis=function(){var t=this._view;return t?t.xAxis():null},e.prototype.yAxis=function(){var t=this._view;return t?t.yAxis():null},e}(Ql),mf=function(t){function e(){var e=t.call(this)||this;return e.radius.setState(Hu.px(5)),e.fill.setState(ta.black()),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"bubble"},enumerable:!0,configurable:!0}),e.prototype.getDatum=function(t){var e=this.getChildView(t);return e instanceof yf?e:void 0},e.prototype.insertDatum=function(t){return t=yf.fromAny(t),this.appendChildView(t),t},e.prototype.insertData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=arguments.length;r<i;r+=1)this.insertDatum(arguments[r])},e.prototype.removeDatum=function(t){var e=this.getChildView(t);return e instanceof yf?(e.remove(),e):null},e.prototype.onAnimate=function(e){var r=e.updateTime;this.radius.onFrame(r),this.fill.onFrame(r),this.stroke.onFrame(r),this.strokeWidth.onFrame(r),t.prototype.onAnimate.call(this,e)},e.prototype.renderPlot=function(t,e,r){for(var i=Math.min(e.width,e.height),n=this.radius.value,o=this.fill.value,s=this.stroke.value,u=this.strokeWidth.value,a=this._childViews,h=0,p=a.length;h<p;h+=1){var l=a[h];if(l instanceof yf){t.beginPath();var c=l.r.value||n;t.arc(l.xCoord,l.yCoord,c.pxValue(i),0,2*Math.PI);var f=l.color.value||o;if(f){var d=l.opacity.value;"number"==typeof d&&(f=f.alpha(d)),t.fillStyle=f.toString(),t.fill()}s&&(u&&(t.lineWidth=u.pxValue(i)),t.strokeStyle=s.toString(),t.stroke())}}},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof vf);else if("object"==typeof t&&t){t=t;var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.xAxis&&r.xAxis(t.xAxis),void 0!==t.yAxis&&r.yAxis(t.yAxis);var i=t.data;if(i)for(var n=0,o=i.length;n<o;n+=1)r.insertDatum(i[n]);return void 0!==t.radius&&r.radius(t.radius),void 0!==t.fill&&r.fill(t.fill),void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Hu)],e.prototype,"radius",void 0),m([rl(ta)],e.prototype,"fill",void 0),m([rl(ta)],e.prototype,"stroke",void 0),m([rl(Hu)],e.prototype,"strokeWidth",void 0),e}(vf);vf.Bubble=mf;var wf=function(t){function e(){var e=t.call(this)||this;return e._data=new jt,e._hitMode="domain",e._gradientStops=0,e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.getDatum=function(t){return this._data.get(t)},e.prototype.insertDatum=function(t){return t=yf.fromAny(t),this.insertChildView(t,this._data.nextValue(t.x.state)||null),t},e.prototype.insertData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,i=arguments.length;r<i;r+=1)this.insertDatum(arguments[r])},e.prototype.removeDatum=function(t){var e=this._data.get(t);return e?(e.remove(),this._data.delete(t),e):null},e.prototype.layoutData=function(t,e,r,i){var n,o,s,u,a,h,p,l,c,d,y,v,_=0;if(this._data.forEach((function(r,m){var w=m.y.value,g=t.scale(r),b=e.scale(w),x=new no(i.x+g,i.y+b);m.setAnchor(x);var C=m.y2.value,S=null!=C?e.scale(C):null;if(m._y2Coord=null!==S?i.y+S:null,m.isGradientStop()&&(_+=1),o){var A=void 0;A=n?f.compare(s,u)<0&&f.compare(u,w)>0?"maxima":f.compare(s,u)>0&&f.compare(u,w)<0?"minima":f.compare(s,u)<0&&f.compare(u,w)<0?"increasing":f.compare(s,u)>0&&f.compare(u,w)>0?"decreasing":"flat":f.compare(u,w)<0?"increasing":f.compare(u,w)>0?"decreasing":"flat",o.category(A),f.compare(w,c)<0?c=w:f.compare(w,d)>0&&(d=w),null!=C&&(f.compare(C,c)<0?c=C:f.compare(C,d)>0&&(d=C)),b<y?y=b:b>v&&(v=b)}else a=r,p=g,c=w,d=w,y=b,v=b;n=o,o=m,s=u,u=w,h=r,l=g}),this),o){var m=void 0;m=n?f.compare(s,u)<0?"increasing":f.compare(s,u)>0?"decreasing":"flat":"flat",o.category(m);var w=!1;this._xDomain[0]!==a&&(this._xDomain[0]=a,w=!0),this._xDomain[1]!==h&&(this._xDomain[1]=h,w=!0),this._xRange[0]!==p&&(this._xRange[0]=p,w=!0),this._xRange[1]!==l&&(this._xRange[1]=l,w=!0),this._yDomain[0]!==c&&(this._yDomain[0]=c,w=!0),this._yDomain[1]!==d&&(this._yDomain[1]=d,w=!0),this._yRange[0]!==y&&(this._yRange[0]=y,w=!0),this._yRange[1]!==v&&(this._yRange[1]=v,w=!0),w&&this.requireUpdate(el.NeedsLayout)}this._gradientStops=_},e.prototype.hitMode=function(t){return void 0===t?this._hitMode:(this._hitMode=t,this)},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n&&"none"!==this._hitMode){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n="domain"===this._hitMode?this.hitTestData(e,r,o):this.hitTestGraph(e,r,o),s.restore()}}return n},e.prototype.hitTestData=function(t,e,r){if(this._xAxis){var i=this._xAxis.scale.state.unscale(t/r.pixelRatio-this._anchor.x),n=this._data.previousValue(i),o=this._data.nextValue(i),s=void 0!==n?+i-+n.x.state:NaN,u=void 0!==o?+o.x.state-+i:NaN;if(s<=u)return n;if(s>u)return o;if(void 0!==n)return n;if(void 0!==o)return o}return null},e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r),e instanceof yf&&this._data.set(e.x.state,e)},e.prototype.onRemoveChildView=function(e){e instanceof yf&&this._data.delete(e.x.state),t.prototype.onRemoveChildView.call(this,e)},e.fromAny=function(t){return vf.fromAny(t)},e}(vf),gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"type",{get:function(){var t=this._view;return t?t.type:void 0},enumerable:!0,configurable:!0}),e}(_f),bf=function(t){function e(){var e=t.call(this)||this;return e.stroke.setState(ta.black()),e.strokeWidth.setState(Hu.px(1)),e._hitWidth=5,e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"line"},enumerable:!0,configurable:!0}),e.prototype.hitWidth=function(t){return void 0===t?this._hitWidth:(this._hitWidth=t,this)},e.prototype.onAnimate=function(e){var r=e.updateTime;this.stroke.onFrame(r),this.strokeWidth.onFrame(r),t.prototype.onAnimate.call(this,e)},e.prototype.renderPlot=function(t,e,r){var i,n,o,s,u=this._data,a=u.size,h=this.stroke.value,p=this.strokeWidth.value.pxValue(Math.min(e.width,e.height)),l=this._gradientStops;if(a>0){var c=u.firstValue(),f=u.lastValue();n=c.xCoord,o=f.xCoord,s=o-n,l&&(i=t.createLinearGradient(n,0,o,0))}else n=NaN,o=NaN,s=NaN;t.beginPath();var d=0;u.forEach((function(e,r){var o=r.xCoord,u=r.yCoord;if(0===d?t.moveTo(o,u):t.lineTo(o,u),i&&r.isGradientStop()){var a=r.color.value||h,p=r.opacity.value;"number"==typeof p&&(a=a.alpha(p));var l=(o-n)/(s||1);i.addColorStop(l,a.toString())}d+=1}),this),t.strokeStyle=i||h.toString(),t.lineWidth=p,t.stroke()},e.prototype.hitTestGraph=function(t,e,r){var i=r.context,n=this._hitWidth,o=this.strokeWidth.value;if(o){var s=this.bounds,u=Math.min(s.width,s.height);n=Math.max(n,o.pxValue(u))}i.beginPath();var a=0;if(this._data.forEach((function(t,e){var r=e.xCoord,n=e.yCoord;0===a?i.moveTo(r,n):i.lineTo(r,n),a+=1}),this),i.lineWidth=n,i.isPointInStroke(t,e)){if("graph"===this._hitMode)return this;if("data"===this._hitMode)return this.hitTestData(t,e,r)}return null},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof wf);else if("object"==typeof t&&t){t=t;var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.xAxis&&r.xAxis(t.xAxis),void 0!==t.yAxis&&r.yAxis(t.yAxis);var i=t.data;if(i)for(var n=0,o=i.length;n<o;n+=1)r.insertDatum(i[n]);return void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth),void 0!==t.hitWidth&&r.hitWidth(t.hitWidth),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(ta)],e.prototype,"stroke",void 0),m([rl(Hu)],e.prototype,"strokeWidth",void 0),e}(wf);vf.Line=bf;var xf=function(t){function e(){var e=t.call(this)||this;return e.fill.setState(ta.black()),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"area"},enumerable:!0,configurable:!0}),e.prototype.onAnimate=function(e){var r=e.updateTime;this.fill.onFrame(r),t.prototype.onAnimate.call(this,e)},e.prototype.renderPlot=function(t,e,r){var i,n,o,s,u=this._data,a=u.size,h=this.fill.value,p=this._gradientStops;if(t.beginPath(),a>0){var l=u.firstValue(),c=u.lastValue();if(n=l.xCoord,s=(o=c.xCoord)-n,t.moveTo(l.xCoord,l.yCoord),p&&(i=t.createLinearGradient(n,0,o,0),l.isGradientStop())){var f=l.color.value||h;"number"==typeof(v=l.opacity.value)&&(f=f.alpha(v)),i.addColorStop(0,f.toString())}}else n=NaN,o=NaN,s=NaN;var d=u.values();for(d.next();d.hasNext();){var y=d.next().value;if(t.lineTo(y.xCoord,y.yCoord),i&&y.isGradientStop()){var v;f=y.color.value||h;"number"==typeof(v=y.opacity.value)&&(f=f.alpha(v));var _=(y.xCoord-n)/(s||1);i.addColorStop(_,f.toString())}}for(;d.hasPrevious();){y=d.previous().value;t.lineTo(y.xCoord,y.y2Coord)}a>0&&t.closePath(),t.fillStyle=i||h.toString(),t.fill()},e.prototype.hitTestGraph=function(t,e,r){var i=r.context,n=this._data,o=n.size;i.beginPath();var s=n.values();if(s.hasNext()){var u=s.next().value;i.moveTo(u.xCoord,u.yCoord)}for(;s.hasNext();){u=s.next().value;i.lineTo(u.xCoord,u.yCoord)}for(;s.hasPrevious();){u=s.previous().value;i.lineTo(u.xCoord,u.y2Coord)}if(o>0&&i.closePath(),i.isPointInPath(t,e)){if("graph"===this._hitMode)return this;if("data"===this._hitMode)return this.hitTestData(t,e,r)}return null},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof wf);else if("object"==typeof t&&t){t=t;var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.xAxis&&r.xAxis(t.xAxis),void 0!==t.yAxis&&r.yAxis(t.yAxis);var i=t.data;if(i)for(var n=0,o=i.length;n<o;n+=1)r.insertDatum(i[n]);return void 0!==t.fill&&r.fill(t.fill),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(ta)],e.prototype,"fill",void 0),e}(wf);vf.Area=xf;var Cf=function(t){function e(){var e=t.call(this)||this;return e.onScaleStart=e.onScaleStart.bind(e),e.onScaleChange=e.onScaleChange.bind(e),e.onScaleCancel=e.onScaleCancel.bind(e),e.onScaleEnd=e.onScaleEnd.bind(e),e._fitTopDomain=!0,e._fitRightDomain=!0,e._fitBottomDomain=!0,e._fitLeftDomain=!0,e._trackTopDomain=!0,e._trackRightDomain=!0,e._trackBottomDomain=!0,e._trackLeftDomain=!0,e._topDomainBounds=[!0,!0],e._rightDomainBounds=[!0,!0],e._bottomDomainBounds=[!0,!0],e._leftDomainBounds=[!0,!0],e._topDomainPadding=[null,null],e._rightDomainPadding=[null,null],e._bottomDomainPadding=[null,null],e._leftDomainPadding=[null,null],e._multitouch=null,e._topGesture=null,e._rightGesture=null,e._bottomGesture=null,e._leftGesture=null,e._rescaleTransition=null,e.topGutter.setState(Hu.px(20)),e.rightGutter.setState(Hu.px(40)),e.bottomGutter.setState(Hu.px(20)),e.leftGutter.setState(Hu.px(40)),e.domainColor.setState(ta.black()),e.domainWidth.setState(1),e.domainSerif.setState(6),e.tickMarkColor.setState(ta.black()),e.tickMarkWidth.setState(1),e.tickMarkLength.setState(6),e.tickLabelPadding.setState(2),e.gridLineColor.setState(ta.transparent()),e.gridLineWidth.setState(0),e.setChildView("surface",new Zl),e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.surface=function(t){if(void 0===t){var e=this.getChildView("surface");return Hl.is(e)?e:null}return this.setChildView("surface",t),this},e.prototype.topAxis=function(t){if(void 0===t){var e=this.getChildView("topAxis");return e instanceof hf?e:null}return"string"==typeof t?t=hf.top(t):null!==t&&(t=hf.fromAny(t)),this.setChildView("topAxis",t),this},e.prototype.rightAxis=function(t){if(void 0===t){var e=this.getChildView("rightAxis");return e instanceof hf?e:null}return"string"==typeof t?t=hf.right(t):null!==t&&(t=hf.fromAny(t)),this.setChildView("rightAxis",t),this},e.prototype.bottomAxis=function(t){if(void 0===t){var e=this.getChildView("bottomAxis");return e instanceof hf?e:null}return"string"==typeof t?t=hf.bottom(t):null!==t&&(t=hf.fromAny(t)),this.setChildView("bottomAxis",t),this},e.prototype.leftAxis=function(t){if(void 0===t){var e=this.getChildView("leftAxis");return e instanceof hf?e:null}return"string"==typeof t?t=hf.left(t):null!==t&&(t=hf.fromAny(t)),this.setChildView("leftAxis",t),this},e.prototype.addPlot=function(t){t=vf.fromAny(t),this.appendChildView(t)},e.prototype.multitouch=function(t){return void 0===t?this._multitouch:(!0===t?t=Oc.create():!1===t&&(t=null),this._multitouch&&this._multitouch.surface(null),this._multitouch=t,this._multitouch&&this._multitouch.surface(this.surface()),this)},e.prototype.topGesture=function(t){return void 0===t?this._topGesture:(!0===t?t=Tc.horizontal():!1===t&&(t=null),this._topGesture&&this._topGesture.multitouch(null).ruler(null).scale(null),this._topGesture=t,this._topGesture&&(this._multitouch||this.multitouch(!0),this._topGesture.multitouch(this._multitouch).ruler(this.surface()).scale(this.topAxis().scale.value),this._multitouch&&this.isMounted()&&this._topGesture.attach(this._multitouch),this.reboundTop()),this)},e.prototype.rightGesture=function(t){return void 0===t?this._rightGesture:(!0===t?t=Tc.vertical():!1===t&&(t=null),this._rightGesture&&this._rightGesture.multitouch(null).ruler(null).scale(null),this._rightGesture=t,this._rightGesture&&(this._multitouch||this.multitouch(!0),this._rightGesture.multitouch(this._multitouch).ruler(this.surface()).scale(this.rightAxis().scale.value),this._multitouch&&this.isMounted()&&this._rightGesture.attach(this._multitouch),this.reboundRight()),this)},e.prototype.bottomGesture=function(t){return void 0===t?this._bottomGesture:(!0===t?t=Tc.horizontal():!1===t&&(t=null),this._bottomGesture&&this._bottomGesture.multitouch(null).ruler(null).scale(null),this._bottomGesture=t,this._bottomGesture&&(this._multitouch||this.multitouch(!0),this._bottomGesture.multitouch(this._multitouch).ruler(this.surface()).scale(this.bottomAxis().scale.value),this._multitouch&&this.isMounted()&&this._bottomGesture.attach(this._multitouch),this.reboundBottom()),this)},e.prototype.leftGesture=function(t){return void 0===t?this._leftGesture:(!0===t?t=Tc.vertical():!1===t&&(t=null),this._leftGesture&&this._leftGesture.multitouch(null).ruler(null).scale(null),this._leftGesture=t,this._leftGesture&&(this._multitouch||this.multitouch(!0),this._leftGesture.multitouch(this._multitouch).ruler(this.surface()).scale(this.leftAxis().scale.value),this._multitouch&&this.isMounted()&&this._leftGesture.attach(this._multitouch),this.reboundLeft()),this)},e.prototype.rescaleTransition=function(t){return void 0===t?this._rescaleTransition:(t=null!==t?tp.fromAny(t):null,this._rescaleTransition=t,this)},e.prototype.fitTopDomain=function(t){return void 0===t?this._fitTopDomain:(!this._fitTopDomain&&t&&this.requireUpdate(el.NeedsLayout),this._fitTopDomain=t,this)},e.prototype.fitRightDomain=function(t){return void 0===t?this._fitRightDomain:(!this._fitRightDomain&&t&&this.requireUpdate(el.NeedsLayout),this._fitRightDomain=t,this)},e.prototype.fitBottomDomain=function(t){return void 0===t?this._fitBottomDomain:(!this._fitBottomDomain&&t&&this.requireUpdate(el.NeedsLayout),this._fitBottomDomain=t,this)},e.prototype.fitLeftDomain=function(t){return void 0===t?this._fitLeftDomain:(!this._fitLeftDomain&&t&&this.requireUpdate(el.NeedsLayout),this._fitLeftDomain=t,this)},e.prototype.topDomainBounds=function(t){return void 0===t?this._topDomainBounds:(this._topDomainBounds[0]=t[0],this._topDomainBounds[1]=t[1],this.reboundTop(),this)},e.prototype.rightDomainBounds=function(t){return void 0===t?this._rightDomainBounds:(this._rightDomainBounds[0]=t[0],this._rightDomainBounds[1]=t[1],this.reboundRight(),this)},e.prototype.bottomDomainBounds=function(t){return void 0===t?this._bottomDomainBounds:(this._bottomDomainBounds[0]=t[0],this._bottomDomainBounds[1]=t[1],this.reboundBottom(),this)},e.prototype.leftDomainBounds=function(t){return void 0===t?this._leftDomainBounds:(this._leftDomainBounds[0]=t[0],this._leftDomainBounds[1]=t[1],this.reboundLeft(),this)},e.prototype.topDomainPadding=function(t){return void 0===t?this._topDomainPadding:(this._topDomainPadding[0]=t[0],this._topDomainPadding[1]=t[1],this.requireUpdate(el.NeedsLayout),this)},e.prototype.rightDomainPadding=function(t){return void 0===t?this._rightDomainPadding:(this._rightDomainPadding[0]=t[0],this._rightDomainPadding[1]=t[1],this.requireUpdate(el.NeedsLayout),this)},e.prototype.bottomDomainPadding=function(t){return void 0===t?this._bottomDomainPadding:(this._bottomDomainPadding[0]=t[0],this._bottomDomainPadding[1]=t[1],this.requireUpdate(el.NeedsLayout),this)},e.prototype.leftDomainPadding=function(t){return void 0===t?this._leftDomainPadding:(this._leftDomainPadding[0]=t[0],this._leftDomainPadding[1]=t[1],this.requireUpdate(el.NeedsLayout),this)},e.prototype.topDomain=function(){for(var t=[null,null],e=this.topAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.xAxis()===e){var s=o.xDomain();(null===t[0]||null!==s[0]&&f.compare(t[0],s[0])>0)&&(t[0]=s[0]),(null===t[1]||null!==s[1]&&f.compare(t[1],s[1])<0)&&(t[1]=s[1])}}return t},e.prototype.rightDomain=function(){for(var t=[null,null],e=this.rightAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.yAxis()===e){var s=o.yDomain();(null===t[0]||null!==s[0]&&f.compare(t[0],s[0])>0)&&(t[0]=s[0]),(null===t[1]||null!==s[1]&&f.compare(t[1],s[1])<0)&&(t[1]=s[1])}}return t},e.prototype.bottomDomain=function(){for(var t=[null,null],e=this.bottomAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.xAxis()===e){var s=o.xDomain();(null===t[0]||null!==s[0]&&f.compare(t[0],s[0])>0)&&(t[0]=s[0]),(null===t[1]||null!==s[1]&&f.compare(t[1],s[1])<0)&&(t[1]=s[1])}}return t},e.prototype.leftDomain=function(){for(var t=[null,null],e=this.leftAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.yAxis()===e){var s=o.yDomain();(null===t[0]||null!==s[0]&&f.compare(t[0],s[0])>0)&&(t[0]=s[0]),(null===t[1]||null!==s[1]&&f.compare(t[1],s[1])<0)&&(t[1]=s[1])}}return t},e.prototype.topDomainPadded=function(){var t=this.topDomain(),e=t[0],r=t[1],i=this._topDomainPadding,n=i[0],o=i[1];return null!==e&&null!==n&&(e=+e-+n),null!==r&&null!==o&&(r=+r+ +o),[e,r]},e.prototype.rightDomainPadded=function(){var t=this.rightDomain(),e=t[0],r=t[1],i=this._topDomainPadding,n=i[0],o=i[1];return null!==e&&null!==n&&(e=+e-+n),null!==r&&null!==o&&(r=+r+ +o),[e,r]},e.prototype.bottomDomainPadded=function(){var t=this.bottomDomain(),e=t[0],r=t[1],i=this._bottomDomainPadding,n=i[0],o=i[1];return null!==e&&null!==n&&(e=+e-+n),null!==r&&null!==o&&(r=+r+ +o),[e,r]},e.prototype.leftDomainPadded=function(){var t=this.leftDomain(),e=t[0],r=t[1],i=this._leftDomainPadding,n=i[0],o=i[1];return null!==e&&null!==n&&(e=+e-+n),null!==r&&null!==o&&(r=+r+ +o),[e,r]},e.prototype.topRange=function(){for(var t=[1/0,-1/0],e=this.topAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.xAxis()===e){var s=o.xRange();t[0]=Math.min(t[0],s[0]),t[1]=Math.max(t[1],s[1])}}return t},e.prototype.rightRange=function(){for(var t=[1/0,-1/0],e=this.rightAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.yAxis()===e){var s=o.yRange();t[0]=Math.min(t[0],s[0]),t[1]=Math.max(t[1],s[1])}}return t},e.prototype.bottomRange=function(){for(var t=[1/0,-1/0],e=this.bottomAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.xAxis()===e){var s=o.xRange();t[0]=Math.min(t[0],s[0]),t[1]=Math.max(t[1],s[1])}}return t},e.prototype.leftRange=function(){for(var t=[1/0,-1/0],e=this.leftAxis(),r=this._childViews,i=0,n=r.length;i<n;i+=1){var o=r[i];if(o instanceof vf&&o.yAxis()===e){var s=o.yRange();t[0]=Math.min(t[0],s[0]),t[1]=Math.max(t[1],s[1])}}return t},e.prototype.onMount=function(){this._multitouch&&(this._multitouch.attach(this),this._topGesture&&this._topGesture.attach(this._multitouch),this._rightGesture&&this._rightGesture.attach(this._multitouch),this._bottomGesture&&this._bottomGesture.attach(this._multitouch),this._leftGesture&&this._leftGesture.attach(this._multitouch)),this.on("scalestart",this.onScaleStart),this.on("scalechange",this.onScaleChange),this.on("scalecancel",this.onScaleCancel),this.on("scaleend",this.onScaleEnd)},e.prototype.onUnmount=function(){this.off("scalestart",this.onScaleStart),this.off("scalechange",this.onScaleChange),this.off("scalecancel",this.onScaleCancel),this.off("scaleend",this.onScaleEnd),this._multitouch&&(this._topGesture&&this._topGesture.detach(this._multitouch),this._rightGesture&&this._rightGesture.detach(this._multitouch),this._bottomGesture&&this._bottomGesture.detach(this._multitouch),this._leftGesture&&this._leftGesture.detach(this._multitouch),this._multitouch.detach(this))},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.didUpdate=function(e){t.prototype.didUpdate.call(this,e),this.autoscale(),this.rebound()},e.prototype.onAnimate=function(t){var e=t.updateTime;this.topGutter.onFrame(e),this.rightGutter.onFrame(e),this.bottomGutter.onFrame(e),this.leftGutter.onFrame(e),this.domainColor.onFrame(e),this.domainWidth.onFrame(e),this.domainSerif.onFrame(e),this.tickMarkColor.onFrame(e),this.tickMarkWidth.onFrame(e),this.tickMarkLength.onFrame(e),this.tickLabelPadding.onFrame(e),this.gridLineColor.onFrame(e),this.gridLineWidth.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onLayout=function(t){this._topGesture&&this._topGesture.scale(this.topAxis().scale.value),this._rightGesture&&this._rightGesture.scale(this.rightAxis().scale.value),this._bottomGesture&&this._bottomGesture.scale(this.bottomAxis().scale.value),this._leftGesture&&this._leftGesture.scale(this.leftAxis().scale.value),this.layoutChildViews(t)},e.prototype.layoutChildView=function(e,r){var i=e.key();"surface"===i&&Hl.is(e)?this.layoutSurface(e,this._bounds):e instanceof hf?"topAxis"===i?this.layoutTopAxis(e,this._bounds):"rightAxis"===i?this.layoutRightAxis(e,this._bounds):"bottomAxis"===i?this.layoutBottomAxis(e,this._bounds):"leftAxis"===i&&this.layoutLeftAxis(e,this._bounds):e instanceof vf?this.layoutPlot(e,this._bounds):t.prototype.layoutChildView.call(this,e,r)},e.prototype.layoutSurface=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=e.xMin+o,u=e.yMin+r,a=e.xMax-i,h=e.yMax-n,p=(s+a)/2,l=(u+h)/2;t.setBounds(new uo(s,u,a,h)),t.setAnchor(new no(p,l))},e.prototype.layoutAxes=function(t){for(var e=this._childViews,r=0,i=e.length;r<i;r+=1){var n=e[r];if(n instanceof hf){var o=n.key();"topAxis"===o?this.layoutTopAxis(n,t):"rightAxis"===o?this.layoutRightAxis(n,t):"bottomAxis"===o?this.layoutBottomAxis(n,t):"leftAxis"===o&&this.layoutLeftAxis(n,t)}}},e.prototype.layoutTopAxis=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=e.xMin+o,u=e.yMin+r,a=s,h=e.yMin,p=e.xMax-i,l=e.yMax-n;t.setBounds(new uo(a,h,p,l)),t.setAnchor(new no(s,u)),t.range(0,p-a)},e.prototype.layoutRightAxis=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=Math.max(e.xMin+o,e.xMax-i),u=e.yMin+r,a=e.xMin+o,h=u,p=e.xMax,l=e.yMax-n;t.setBounds(new uo(a,h,p,l)),t.setAnchor(new no(s,u)),t.range(l-h,0)},e.prototype.layoutBottomAxis=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=e.xMin+o,u=Math.max(e.yMin+r,e.yMax-n),a=s,h=e.yMin+r,p=e.xMax-i,l=e.yMax;t.setBounds(new uo(a,h,p,l)),t.setAnchor(new no(s,u)),t.range(0,p-a)},e.prototype.layoutLeftAxis=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=e.xMin+o,u=e.yMin+r,a=e.xMin,h=u,p=e.xMax-i,l=e.yMax-n;t.setBounds(new uo(a,h,p,l)),t.setAnchor(new no(s,u)),t.range(l-h,0)},e.prototype.layoutPlot=function(t,e){var r=this.topGutter.value.pxValue(e.height),i=this.rightGutter.value.pxValue(e.width),n=this.bottomGutter.value.pxValue(e.height),o=this.leftGutter.value.pxValue(e.width),s=e.xMin+o,u=e.yMin+r,a=e.xMax-i,h=e.yMax-n,p=s,l=u;t.setBounds(new uo(s,u,a,h)),t.setAnchor(new no(p,l))},e.prototype.onInsertPlot=function(t){if(!t.xAxis()||!t.yAxis())for(var e=this._childViews,r=0,i=e.length;r<i;r+=1){var n=e[r];if(n instanceof hf){var o=n.key();"topAxis"!==o||t.xAxis()?"rightAxis"!==o||t.yAxis()?"bottomAxis"!==o||t.xAxis()?"leftAxis"!==o||t.yAxis()||t.yAxis(n):t.xAxis(n):t.yAxis(n):t.xAxis(n)}}},e.prototype.onRemovePlot=function(t){},e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r);var i=e.key();if("surface"===i&&Hl.is(e))this.layoutSurface(e,this._bounds);else if(e instanceof hf){if("topAxis"===i)return void this.layoutTopAxis(e,this._bounds);if("rightAxis"===i)return void this.layoutRightAxis(e,this._bounds);if("bottomAxis"===i)return void this.layoutBottomAxis(e,this._bounds);if("leftAxis"===i)return void this.layoutLeftAxis(e,this._bounds)}else e instanceof vf&&(this.onInsertPlot(e),this.layoutPlot(e,this._bounds))},e.prototype.onRemoveChildView=function(t){t instanceof vf&&this.onRemovePlot(t)},e.prototype.autoscale=function(t){void 0===t&&(t=this._rescaleTransition||void 0),this.autoscaleTop(t),this.autoscaleRight(t),this.autoscaleBottom(t),this.autoscaleLeft(t)},e.prototype.autoscaleTop=function(t){if(this._fitTopDomain&&this._trackTopDomain){var e=this.topAxis();if(e){void 0===t&&(t=this._rescaleTransition||void 0);var r=this.topDomainPadded(),i=r[0],n=r[1];null!==i&&null!==n&&e.domain(i,n,t)}}},e.prototype.autoscaleRight=function(t){if(this._fitRightDomain&&this._trackRightDomain){var e=this.rightAxis();if(e){void 0===t&&(t=this._rescaleTransition||void 0);var r=this.rightDomainPadded(),i=r[0],n=r[1];null!==i&&null!==n&&e.domain(i,n,t)}}},e.prototype.autoscaleBottom=function(t){if(this._fitBottomDomain&&this._trackBottomDomain){var e=this.bottomAxis();if(e){void 0===t&&(t=this._rescaleTransition||void 0);var r=this.bottomDomainPadded(),i=r[0],n=r[1];null!==i&&null!==n&&e.domain(i,n,t)}}},e.prototype.autoscaleLeft=function(t){if(this._fitLeftDomain&&this._trackLeftDomain){var e=this.leftAxis();if(e){void 0===t&&(t=this._rescaleTransition||void 0);var r=this.leftDomainPadded(),i=r[0],n=r[1];null!==i&&null!==n&&e.domain(i,n,t)}}},e.prototype.rebound=function(){this.reboundTop(),this.reboundRight(),this.reboundBottom(),this.reboundLeft()},e.prototype.reboundTop=function(){var t=this._topGesture;if(t){var e=this.topDomainPadded(),r=e[0],i=e[1];if(null!==r&&null!==i){var n=this._topDomainBounds,o=n[0],s=n[1];"boolean"!=typeof o&&(r=+r-+o),"boolean"!=typeof s&&(i=+i+ +s),t.domainBounds("boolean"!=typeof o||o?r:null,"boolean"!=typeof s||s?i:null)}}},e.prototype.reboundRight=function(){var t=this._rightGesture;if(t){var e=this.rightDomainPadded(),r=e[0],i=e[1];if(null!==r&&null!==i){var n=this._rightDomainBounds,o=n[0],s=n[1];"boolean"!=typeof o&&(r=+r-+o),"boolean"!=typeof s&&(i=+i+ +s),t.domainBounds("boolean"!=typeof o||o?r:null,"boolean"!=typeof s||s?i:null)}}},e.prototype.reboundBottom=function(){var t=this._bottomGesture;if(t){var e=this.bottomDomainPadded(),r=e[0],i=e[1];if(null!==r&&null!==i){var n=this._bottomDomainBounds,o=n[0],s=n[1];"boolean"!=typeof o&&(r=+r-+o),"boolean"!=typeof s&&(i=+i+ +s),t.domainBounds("boolean"!=typeof o||o?r:null,"boolean"!=typeof s||s?i:null)}}},e.prototype.reboundLeft=function(){var t=this._leftGesture;if(t){var e=this.leftDomainPadded(),r=e[0],i=e[1];if(null!==r&&null!==i){var n=this._leftDomainBounds,o=n[0],s=n[1];"boolean"!=typeof o&&(r=+r-+o),"boolean"!=typeof s&&(i=+i+ +s),t.domainBounds("boolean"!=typeof o||o?r:null,"boolean"!=typeof s||s?i:null)}}},e.prototype.retrackTop=function(){var t=this._topGesture;if(t){var e=t.scale().domain(),r=e[0],i=e[1],n=t.domainMin(),o=t.domainMax();if(null!==r&&null!==i&&null!=n&&null!==o){var s=f.compare(r,i);(s<0&&f.compare(r,n)<=0&&f.compare(i,o)>=0||s>0&&f.compare(i,n)<=0&&f.compare(r,o)>=0)&&(this._trackTopDomain=!0)}}},e.prototype.retrackRight=function(){var t=this._rightGesture;if(t){var e=t.scale().domain(),r=e[0],i=e[1],n=t.domainMin(),o=t.domainMax();if(null!==r&&null!==i&&null!=n&&null!==o){var s=f.compare(r,i);(s<0&&f.compare(r,n)<=0&&f.compare(i,o)>=0||s>0&&f.compare(i,n)<=0&&f.compare(r,o)>=0)&&(this._trackRightDomain=!0)}}},e.prototype.retrackBottom=function(){var t=this._bottomGesture;if(t){var e=t.scale().domain(),r=e[0],i=e[1],n=t.domainMin(),o=t.domainMax();if(null!==r&&null!==i&&null!=n&&null!==o){var s=f.compare(r,i);(s<0&&f.compare(r,n)<=0&&f.compare(i,o)>=0||s>0&&f.compare(i,n)<=0&&f.compare(r,o)>=0)&&(this._trackBottomDomain=!0)}}},e.prototype.retrackLeft=function(){var t=this._leftGesture;if(t){var e=t.scale().domain(),r=e[0],i=e[1],n=t.domainMin(),o=t.domainMax();if(null!==r&&null!==i&&null!=n&&null!==o){var s=f.compare(r,i);(s<0&&f.compare(r,n)<=0&&f.compare(i,o)>=0||s>0&&f.compare(i,n)<=0&&f.compare(r,o)>=0)&&(this._trackLeftDomain=!0)}}},e.prototype.onScaleStart=function(t){if(t.gesture===this._topGesture){var e=this.topAxis();e&&(e.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this._trackTopDomain=!1}else if(t.gesture===this._rightGesture){var r=this.rightAxis();r&&(r.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this._trackRightDomain=!1}else if(t.gesture===this._bottomGesture){var i=this.bottomAxis();i&&(i.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this._trackBottomDomain=!1}else if(t.gesture===this._leftGesture){var n=this.leftAxis();n&&(n.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this._trackLeftDomain=!1}},e.prototype.onScaleChange=function(t){if(t.gesture===this._topGesture){var e=this.topAxis();e&&(e.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout))}else if(t.gesture===this._rightGesture){var r=this.rightAxis();r&&(r.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout))}else if(t.gesture===this._bottomGesture){var i=this.bottomAxis();i&&(i.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout))}else if(t.gesture===this._leftGesture){var n=this.leftAxis();n&&(n.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout))}},e.prototype.onScaleCancel=function(t){this.onScaleEnd(t)},e.prototype.onScaleEnd=function(t){if(t.gesture===this._topGesture){var e=this.topAxis();e&&(e.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this.retrackTop()}else if(t.gesture===this._rightGesture){var r=this.rightAxis();r&&(r.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this.retrackRight()}else if(t.gesture===this._bottomGesture){var i=this.bottomAxis();i&&(i.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this.retrackBottom()}else if(t.gesture===this._leftGesture){var n=this.leftAxis();n&&(n.domain(t.scale.domain()),this.requireUpdate(el.NeedsLayout)),this.retrackLeft()}},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.bottomAxis&&r.bottomAxis(t.bottomAxis),void 0!==t.leftAxis&&r.leftAxis(t.leftAxis),void 0!==t.topAxis&&r.topAxis(t.topAxis),void 0!==t.rightAxis&&r.rightAxis(t.rightAxis);var i=t.plots;if(i)for(var n=0,o=i.length;n<o;n+=1)r.addPlot(i[n]);return void 0!==t.fitTopDomain&&r.fitTopDomain(t.fitTopDomain),void 0!==t.fitRightDomain&&r.fitRightDomain(t.fitRightDomain),void 0!==t.fitBottomDomain&&r.fitBottomDomain(t.fitBottomDomain),void 0!==t.fitLeftDomain&&r.fitLeftDomain(t.fitLeftDomain),void 0!==t.topDomainBounds&&r.topDomainBounds(t.topDomainBounds),void 0!==t.rightDomainBounds&&r.rightDomainBounds(t.rightDomainBounds),void 0!==t.bottomDomainBounds&&r.bottomDomainBounds(t.bottomDomainBounds),void 0!==t.leftDomainBounds&&r.leftDomainBounds(t.leftDomainBounds),void 0!==t.topDomainPadding&&r.topDomainPadding(t.topDomainPadding),void 0!==t.rightDomainPadding&&r.rightDomainPadding(t.rightDomainPadding),void 0!==t.bottomDomainPadding&&r.bottomDomainPadding(t.bottomDomainPadding),void 0!==t.leftDomainPadding&&r.leftDomainPadding(t.leftDomainPadding),void 0!==t.multitouch&&r.multitouch(t.multitouch),void 0!==t.topGesture&&r.topGesture(t.topGesture),void 0!==t.rightGesture&&r.rightGesture(t.rightGesture),void 0!==t.bottomGesture&&r.bottomGesture(t.bottomGesture),void 0!==t.leftGesture&&r.leftGesture(t.leftGesture),void 0!==t.rescaleTransition&&r.rescaleTransition(t.rescaleTransition),void 0!==t.topGutter&&r.topGutter(t.topGutter),void 0!==t.rightGutter&&r.rightGutter(t.rightGutter),void 0!==t.bottomGutter&&r.bottomGutter(t.bottomGutter),void 0!==t.leftGutter&&r.leftGutter(t.leftGutter),void 0!==t.domainColor&&r.domainColor(t.domainColor),void 0!==t.domainWidth&&r.domainWidth(t.domainWidth),void 0!==t.domainSerif&&r.domainSerif(t.domainSerif),void 0!==t.tickMarkColor&&r.tickMarkColor(t.tickMarkColor),void 0!==t.tickMarkWidth&&r.tickMarkWidth(t.tickMarkWidth),void 0!==t.tickMarkLength&&r.tickMarkLength(t.tickMarkLength),void 0!==t.tickLabelPadding&&r.tickLabelPadding(t.tickLabelPadding),void 0!==t.gridLineColor&&r.gridLineColor(t.gridLineColor),void 0!==t.gridLineWidth&&r.gridLineWidth(t.gridLineWidth),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Hu)],e.prototype,"topGutter",void 0),m([rl(Hu)],e.prototype,"rightGutter",void 0),m([rl(Hu)],e.prototype,"bottomGutter",void 0),m([rl(Hu)],e.prototype,"leftGutter",void 0),m([rl(ta)],e.prototype,"domainColor",void 0),m([rl(Number)],e.prototype,"domainWidth",void 0),m([rl(Number)],e.prototype,"domainSerif",void 0),m([rl(ta)],e.prototype,"tickMarkColor",void 0),m([rl(Number)],e.prototype,"tickMarkWidth",void 0),m([rl(Number)],e.prototype,"tickMarkLength",void 0),m([rl(Number)],e.prototype,"tickLabelPadding",void 0),m([rl(ta)],e.prototype,"gridLineColor",void 0),m([rl(Number)],e.prototype,"gridLineWidth",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Zl),Sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.topAxis=function(){var t=this._view;return t?t.topAxis():null},e.prototype.rightAxis=function(){var t=this._view;return t?t.rightAxis():null},e.prototype.bottomAxis=function(){var t=this._view;return t?t.bottomAxis():null},e.prototype.leftAxis=function(){var t=this._view;return t?t.leftAxis():null},e}(Ql),Af=function(){function t(t,e){this._lng=t,this._lat=e}return Object.defineProperty(t.prototype,"lng",{get:function(){return this._lng},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lat",{get:function(){return this._lat},enumerable:!0,configurable:!0}),t.prototype.toAny=function(){return{lng:this._lng,lat:this._lat}},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._lng===e._lng&&this._lat===e._lat)},t.prototype.debug=function(t){t=t.write("LngLat").write(46).write("from").write(40).debug(this._lng).write(", ").debug(this._lat).write(41)},t.prototype.toString=function(){return J.debug(this)},t.origin=function(){return t._origin||(t._origin=new t(0,0)),t._origin},t.from=function(e,r){return new t(e,r)},t.fromAny=function(e){if(e instanceof t)return e;if(e&&"object"==typeof e){var r=void 0,i=void 0;return Array.isArray(e)?(r=e[0],i=e[1]):(r=e.lng,i=e.lat),t.from(r,i)}throw new TypeError(""+e)},t}(),kf=function(t){function e(e,r){var i=t.call(this)||this;return void 0!==e&&(e=Af.fromAny(e)),void 0!==r&&(r=Af.fromAny(r)),e||r?r?e||(e=r):r=e:r=e=Af.origin(),i.x0=e.lng,i.dx=r.lng-i.x0,i.y0=e.lat,i.dy=r.lat-i.y0,i}return _(e,t),e.prototype.interpolate=function(t){var e=this.x0+this.dx*t,r=this.y0+this.dy*t;return new Af(e,r)},e.prototype.deinterpolate=function(t){var e=(t=Af.fromAny(t)).lng-this.x0,r=t.lat-this.y0,i=e*this.dx+r*this.dy,n=Math.sqrt(e*e+r*r);return n?i/n:n},e.prototype.range=function(t,r){return void 0===t?[this.interpolate(0),this.interpolate(1)]:void 0===r?new e((t=t)[0],t[1]):new e(t,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.y0===t.y0&&this.dy===t.dy)},e.lngLat=function(t,r){return new e(t,r)},e}(Ta);Ta.lngLat=kf.lngLat;var Ef=Ta.from;Ta.from=function(t,e){return t instanceof Af||e instanceof Af?Ta.lngLat(t,e):Ef(t,e)};var Of={_identity:void 0,identity:function(){return Of._identity||(Of._identity=new Vf),Of._identity},is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.project&&"function"==typeof e.unproject}return!1}},Vf=function(){function t(){}return Object.defineProperty(t.prototype,"bounds",{get:function(){return[Af.origin(),Af.origin()]},enumerable:!0,configurable:!0}),t.prototype.project=function(t,e){var r,i;if("number"==typeof t)r=t,i=e;else{var n=Af.fromAny(t);r=n.lng,i=n.lat}return new no(r,i)},t.prototype.unproject=function(t,e){var r,i;if("number"==typeof t)r=t,i=e;else{var n=no.fromAny(t);r=n.x,i=n.y}return new Af(r,i)},t}(),Pf={NeedsProject:256,is:function(t){if("object"==typeof t&&t){var e=t;return Hl.is(e)&&"function"==typeof e.doProject}return!1}},Df=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this,e)||this;return r._hitBounds=null,r}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){var t=this.parentView;return Pf.is(t)?t.projection:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){var t=this.parentView;return Pf.is(t)?t.zoom:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heading",{get:function(){var t=this.parentView;return Pf.is(t)?t.heading:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){var t=this.parentView;return Pf.is(t)?t.tilt:0},enumerable:!0,configurable:!0}),e.prototype.needsUpdate=function(t,e){return 0!=(t&Pf.NeedsProject)&&(t=t|el.NeedsAnimate|el.NeedsLayout),0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t|=el.NeedsRender),t},e.prototype.doUpdate=function(t,e){this.willUpdate(e),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(e)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(e)),0!=((t|this._updateFlags)&Pf.NeedsProject)&&(this._updateFlags=this._updateFlags&~Pf.NeedsProject,this.doProject(e)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(e)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(e)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(e)),this.onUpdate(e),this.doUpdateChildViews(t,e),this.didUpdate(e)},e.prototype.doProject=function(t){this.parentView&&(this.willProject(t),this.onProject(t),this.didProject(t))},e.prototype.willProject=function(t){this.willObserve((function(e){e.viewWillProject&&e.viewWillProject(t,this)}))},e.prototype.onProject=function(t){},e.prototype.didProject=function(t){this.didObserve((function(e){e.viewDidProject&&e.viewDidProject(t,this)}))},e.prototype.layoutChildView=function(t,e){Hl.is(t)&&t.setBounds(this._bounds)},e.prototype.childViewContext=function(t,e){return e},Object.defineProperty(e.prototype,"hitBounds",{get:function(){return this._hitBounds},enumerable:!0,configurable:!0}),e.prototype.computeHitBounds=function(){for(var t=null,e=this._childViews,r=0,i=e.length;r<i;r+=1){var n=e[r];if(Hl.is(n)){var o=n.hitBounds;o&&(t=t?t.union(o):o)}}this._hitBounds=t},e.prototype.cullHitBounds=function(){var t=this._hitBounds;if(null!==t){var e=!this._bounds.intersects(t);this.setCulled(e)}},e}(Zl),Mf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),Object.defineProperty(e.prototype,"projection",{get:function(){var t=this._view;return t?t.projection:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){var t=this._view;return t?t.zoom:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heading",{get:function(){var t=this._view;return t?t.heading:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){var t=this._view;return t?t.tilt:0},enumerable:!0,configurable:!0}),e.prototype.viewWillUpdate=function(t,e){},e.prototype.viewDidUpdate=function(t,e){},e.prototype.viewWillCompute=function(t,e){},e.prototype.viewDidCompute=function(t,e){},e.prototype.viewWillAnimate=function(t,e){},e.prototype.viewDidAnimate=function(t,e){},e.prototype.viewWillProject=function(t,e){},e.prototype.viewDidProject=function(t,e){},e.prototype.viewWillLayout=function(t,e){},e.prototype.viewDidLayout=function(t,e){},e.prototype.viewWillScroll=function(t,e){},e.prototype.viewDidScroll=function(t,e){},e.prototype.viewWillRender=function(t,e){},e.prototype.viewDidRender=function(t,e){},e.prototype.viewWillUpdateChildViews=function(t,e){},e.prototype.viewDidUpdateChildViews=function(t,e){},e}(Ql),Tf=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this,e)||this;return r._canvas=r.createCanvas(),r._renderer=void 0,r}return _(e,t),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio||1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layerRenderer",{get:function(){var t=this.parentView;return Hl.is(t)?t.renderer:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){var t=this._renderer;return void 0===t&&(t=this.createRenderer(),this._renderer=t),t},enumerable:!0,configurable:!0}),e.prototype.setRenderer=function(t){"string"==typeof t&&(t=this.createRenderer(t)),this._renderer=t,this.resetRenderer()},e.prototype.createRenderer=function(t){if(void 0===t&&(t="canvas"),"canvas"===t){if(e=this._canvas.getContext("2d"))return new Fp(e,this.pixelRatio);throw new Error("Failed to create canvas rendering context")}if("webgl"===t){var e;if(e=this._canvas.getContext("webgl"))return new Lp(e,this.pixelRatio);throw new Error("Failed to create webgl rendering context")}throw new Error("Failed to create "+t+" renderer")},e.prototype.doUpdate=function(t,e){var r=this.layerViewContext(e);this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&Pf.NeedsProject)&&(this._updateFlags=this._updateFlags&~Pf.NeedsProject,this.doProject(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(r),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.onRender=function(t){this.clearCanvas()},e.prototype.didUpdateChildViews=function(e){t.prototype.didUpdateChildViews.call(this,e),this.copyLayerImage(e)},e.prototype.childViewContext=function(t,e){return e},e.prototype.layerViewContext=function(t){var e=Object.create(t);return e.layerRenderer=t.renderer,e.renderer=this.renderer,e},Object.defineProperty(e.prototype,"parentTransform",{get:function(){return _a.identity()},enumerable:!0,configurable:!0}),e.prototype.willSetBounds=function(e){var r=t.prototype.willSetBounds.call(this,e);r instanceof uo&&(e=r);var i=Math.round(e.xMin),n=Math.round(e.yMin),o=Math.round(e.xMax),s=Math.round(e.yMax);return new uo(i,n,o,s)},e.prototype.onSetBounds=function(t,e){t.equals(e)||(this.resizeCanvas(this._canvas,t),this.resetRenderer(),this.requireUpdate(el.NeedsLayout))},e.prototype.layoutChildView=function(t){if(Hl.is(t)){var e=this._bounds,r=this._anchor,i=e.x,n=e.y;if(0!==e.x||0!==e.y){var o=e.width,s=e.height;e=new uo(0,0,o,s)}0===i&&0===n||(r=new no(r.x-i,r.y-n)),t.setBounds(e),t.setAnchor(r)}},e.prototype.hitTest=function(t,e,r){var i=this.layerViewContext(r),n=this._bounds;t-=n.x,e-=n.y;for(var o=null,s=this._childViews,u=s.length-1;u>=0;u-=1){var a=s[u];if(Hl.is(a)&&a.bounds.contains(t,e)&&null!==(o=a.hitTest(t,e,i)))break}return o},e.prototype.createCanvas=function(){return document.createElement("canvas")},e.prototype.resizeCanvas=function(t,e){var r=Math.floor(e.width),i=Math.floor(e.height),n=this.pixelRatio;t.width=r*n,t.height=i*n,t.style.width=r+"px",t.style.height=i+"px"},e.prototype.clearCanvas=function(){var t=this.renderer;if(t instanceof Fp){var e=this._bounds;t.context.clearRect(0,0,e.width,e.height)}else if(t instanceof Lp){var r=t.context;r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)}},e.prototype.resetRenderer=function(){var t=this.renderer;if(t instanceof Fp){var e=this.pixelRatio;t.context.setTransform(e,0,0,e,0,0)}else if(t instanceof Lp){var r=this._bounds;t.context.viewport(0,0,r.width,r.height)}},e.prototype.copyLayerImage=function(t){var e=t.layerRenderer,r=t.renderer;if(e instanceof Fp&&r instanceof Fp){var i=this._bounds,n=this.pixelRatio,o=e.context.getImageData(0,0,i.width*n,i.height*n);r.context.putImageData(o,i.x*n,i.y*n)}},e}(Df),Rf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(Mf),If=function(t){function e(e,r){void 0===e&&(e=Af.origin());var i=t.call(this,r)||this;return i.coord.setState(e),i._hitRadius=5,i._labelPlacement="auto",i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lng",{get:function(){return this.coord.value.lng},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lat",{get:function(){return this.coord.value.lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._anchor.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._anchor.y},enumerable:!0,configurable:!0}),e.prototype.hitRadius=function(t){return void 0===t?this._hitRadius:(this._hitRadius=t,this)},e.prototype.label=function(t){return void 0===t?this.getChildView("label"):(null===t||t instanceof el||(t=xc.fromAny(t)),this.setChildView("label",t),this)},e.prototype.labelPlacement=function(t){return void 0===t?this._labelPlacement:(this._labelPlacement=t,this)},e.prototype.isGradientStop=function(){return!!this.color.value||"number"==typeof this.opacity.value},e.prototype.needsUpdate=function(t,e){return 0!=(t&(el.NeedsAnimate|el.NeedsLayout))&&(t=t|el.NeedsAnimate|el.NeedsLayout|el.NeedsRender),t},e.prototype.onAnimate=function(t){var e=t.updateTime,r=this.coord.value;this.coord.onFrame(e);var i=this.coord.value;this.r.onFrame(e),this.color.onFrame(e),this.opacity.onFrame(e),this.labelPadding.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e),f.equal(r,i)||this.requireUpdate(Pf.NeedsProject)},e.prototype.onProject=function(t){var e=t.projection.project(this.coord.value);this._hitBounds=new uo(e.x,e.y,e.x,e.y),this.setAnchor(e)},e.prototype.onLayout=function(t){var e=this._bounds,r=this._anchor,i=!isFinite(r.x)||isFinite(r.y)||!e.intersectsPoint(r),n=this.label();Hl.is(n)&&this.layoutLabel(n,this._bounds,this._anchor),this.setCulled(i),this.layoutChildViews(t)},e.prototype.layoutLabel=function(t,e,r){var i=this._labelPlacement,n=this.labelPadding.value.pxValue(Math.min(e.width,e.height)),o=r.x,s=r.y;"top"===i?s-=n:"bottom"===i&&(s+=n);var u=new no(o,s);t.setAnchor(u),Yl.is(t)&&(t.textAlign("center"),t.textBaseline("bottom"))},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;n=this.hitTestPoint(e,r,s,this._bounds,this._anchor)}}return n},e.prototype.hitTestPoint=function(t,e,r,i,n){var o=this._hitRadius,s=this.r.value;if(s){var u=this.bounds,a=Math.min(u.width,u.height);o=Math.max(o,s.pxValue(a))}var h=n.x-t,p=n.y-e;return h*h+p*p<o*o?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e(Af.fromAny(t.coord),t.key);return void 0!==t.r&&r.r(t.r),void 0!==t.hitRadius&&r.hitRadius(t.hitRadius),void 0!==t.color&&r.color(t.color),void 0!==t.opacity&&r.opacity(t.opacity),void 0!==t.labelPadding&&r.labelPadding(t.labelPadding),void 0!==t.labelPlacement&&r.labelPlacement(t.labelPlacement),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor),void 0!==t.label&&r.label(t.label),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Af)],e.prototype,"coord",void 0),m([rl(Hu)],e.prototype,"r",void 0),m([rl(ta)],e.prototype,"color",void 0),m([rl(Number)],e.prototype,"opacity",void 0),m([rl(Hu)],e.prototype,"labelPadding",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Df),Ff=function(t){function e(e,r){void 0===e&&(e=Af.origin()),void 0===r&&(r=Hu.zero());var i=t.call(this)||this;return i.center.setState(e),i.radius.setState(r),i._point=no.origin(),i._hitRadius=0,i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.hitRadius=function(t){return void 0===t?this._hitRadius:(this._hitRadius=t,this)},e.prototype.onAnimate=function(t){var e=t.updateTime,r=this.center.value;this.center.onFrame(e);var i=this.center.value;this.radius.onFrame(e),this.fill.onFrame(e),this.stroke.onFrame(e),this.strokeWidth.onFrame(e),r!==i&&this.requireUpdate(Pf.NeedsProject)},e.prototype.onProject=function(t){var e=t.projection,r=this._bounds,i=e.project(this.center.value);this._point=i;var n=Math.min(r.width,r.height),o=this.radius.value.pxValue(n),s=Math.max(this._hitRadius,o);this._hitBounds=new uo(i.x-s,i.y-s,i.x+s,i.y+s)},e.prototype.onLayout=function(t){var e=this._bounds,r=this._point,i=Math.min(e.width,e.height),n=this.radius.value.pxValue(i),o=!isFinite(r.x)||!isFinite(r.y)||!isFinite(n)||!e.intersectsCircle(new so(r.x,r.y,n));this.setCulled(o),this.layoutChildViews(t)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderCircle(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderCircle=function(t,e,r){var i=Math.min(e.width,e.height);t.beginPath();var n=this.radius.value.pxValue(i);t.arc(this._point.x,this._point.y,n,0,2*Math.PI);var o=this.fill.value;o&&(t.fillStyle=o.toString(),t.fill());var s=this.stroke.value;if(s){var u=this.strokeWidth.value;u&&(t.lineWidth=u.pxValue(i)),t.strokeStyle=s.toString(),t.stroke()}},Object.defineProperty(e.prototype,"popoverBounds",{get:function(){var t=this.pageTransform.inverse(),e=this._hitBounds;if(null!==e)return e.transform(t);var r=this._point.transform(t),i=Math.round(r.x),n=Math.round(r.y);return new uo(i,n,i,n)},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;n=this.hitTestCircle(e,r,s,this._bounds,this._anchor,o.pixelRatio)}}return n},e.prototype.hitTestCircle=function(t,e,r,i,n,o){var s=Math.min(i.width,i.height),u=this.radius.value.pxValue(s);if(this.fill.value){var a=Math.max(this._hitRadius,u),h=this._point.x-t,p=this._point.y-e;if(h*h+p*p<a*a)return this}var l=this.strokeWidth.value;if(this.stroke.value&&l){if(t*=o,e*=o,r.save(),r.beginPath(),r.arc(this._point.x,this._point.y,u,0,2*Math.PI),r.lineWidth=l.pxValue(s),r.isPointInStroke(t,e))return r.restore(),this;r.restore()}return null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;return void 0!==t.key&&r.key(t.key),void 0!==t.center&&r.center(t.center),void 0!==t.radius&&r.radius(t.radius),void 0!==t.hitRadius&&r.hitRadius(t.hitRadius),void 0!==t.fill&&r.fill(t.fill),void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Af)],e.prototype,"center",void 0),m([rl(Hu)],e.prototype,"radius",void 0),m([rl(ta,{inherit:!0})],e.prototype,"fill",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Df),Lf=function(t){function e(e,r,i,n,o,s,u,a){void 0===e&&(e=Af.origin()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Hu.zero()),void 0===n&&(n=Nu.zero()),void 0===o&&(o=Nu.zero()),void 0===s&&(s=Nu.zero()),void 0===u&&(u=null),void 0===a&&(a=Hu.zero());var h=t.call(this)||this;return h.center.setState(e),h.innerRadius.setState(r),h.outerRadius.setState(i),h.startAngle.setState(n),h.sweepAngle.setState(o),h.padAngle.setState(s),h.padRadius.setState(u),h.cornerRadius.setState(a),h}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return new wc(this.innerRadius.value,this.outerRadius.value,this.startAngle.value,this.sweepAngle.value,this.padAngle.value,this.padRadius.value,this.cornerRadius.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return new wc(this.innerRadius.state,this.outerRadius.state,this.startAngle.state,this.sweepAngle.state,this.padAngle.state,this.padRadius.state,this.cornerRadius.state)},enumerable:!0,configurable:!0}),e.prototype.setState=function(t,e){t instanceof wc&&(t=t.toAny()),void 0!==t.key&&this.key(t.key),void 0!==t.center&&this.center(t.center,e),void 0!==t.innerRadius&&this.innerRadius(t.innerRadius,e),void 0!==t.outerRadius&&this.outerRadius(t.outerRadius,e),void 0!==t.startAngle&&this.startAngle(t.startAngle,e),void 0!==t.sweepAngle&&this.sweepAngle(t.sweepAngle,e),void 0!==t.padAngle&&this.padAngle(t.padAngle,e),void 0!==t.padRadius&&this.padRadius(t.padRadius,e),void 0!==t.cornerRadius&&this.cornerRadius(t.cornerRadius,e),void 0!==t.fill&&this.fill(t.fill,e),void 0!==t.stroke&&this.stroke(t.stroke,e),void 0!==t.strokeWidth&&this.strokeWidth(t.strokeWidth,e),void 0!==t.hidden&&this.setHidden(t.hidden),void 0!==t.culled&&this.setCulled(t.culled)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.innerRadius.onFrame(e),this.outerRadius.onFrame(e),this.startAngle.onFrame(e),this.sweepAngle.onFrame(e),this.padAngle.onFrame(e),this.padRadius.onFrame(e),this.cornerRadius.onFrame(e),this.fill.onFrame(e),this.stroke.onFrame(e),this.strokeWidth.onFrame(e)},e.prototype.onProject=function(t){var e=t.projection,r=this._bounds,i=e.project(this.center.value),n=Math.min(r.width,r.height),o=this.outerRadius.value.pxValue(n);this._hitBounds=new uo(i.x-o,i.y-o,i.x+o,i.y+o),this.setAnchor(i)},e.prototype.onLayout=function(t){var e=this._bounds,r=this._anchor,i=Math.min(e.width,e.height),n=this.outerRadius.value.pxValue(i),o=!isFinite(r.x)||!isFinite(r.y)||!isFinite(n)||!e.intersectsCircle(new so(r.x,r.y,n));this.setCulled(o),this.layoutChildViews(t)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderArc(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderArc=function(t,e,r){this.value.draw(t,e,r);var i=this.fill.value;i&&(t.fillStyle=i.toString(),t.fill());var n=this.stroke.value;if(n){var o=this.strokeWidth.value;if(o){var s=Math.min(e.width,e.height);t.lineWidth=o.pxValue(s)}t.strokeStyle=n.toString(),t.stroke()}},Object.defineProperty(e.prototype,"popoverBounds",{get:function(){var t,e=this._bounds,r=this._anchor;e&&(t=Math.min(e.width,e.height));var i=this.pageTransform.inverse(),n=r.transform(i),o=(this.innerRadius.value.pxValue(t)+this.outerRadius.value.pxValue(t))/2,s=this.startAngle.value.radValue()+this.sweepAngle.value.radValue()/2,u=n.x+o*Math.cos(s),a=n.y+o*Math.sin(s);return new uo(u,a,u,a)},enumerable:!0,configurable:!0}),e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestArc(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestArc=function(t,e,r,i,n){var o=this.value;if(r.beginPath(),o.draw(r,i,n),this.fill.value&&r.isPointInPath(t,e))return this;if(this.stroke.value){var s=this.strokeWidth.value;if(s){var u=Math.min(i.width,i.height);if(r.lineWidth=s.pxValue(u),r.isPointInStroke(t,e))return this}}return null},e.from=function(t,r,i,n,o,s,u,a,h,p,l){void 0===t&&(t=Af.origin()),void 0===r&&(r=Hu.zero()),void 0===i&&(i=Hu.zero()),void 0===n&&(n=Nu.zero()),void 0===o&&(o=Nu.zero()),void 0===s&&(s=Nu.zero()),void 0===u&&(u=null),void 0===a&&(a=Hu.zero());var c=new e(t=Af.fromAny(t),r=Hu.fromAny(r),i=Hu.fromAny(i),n=Nu.fromAny(n),o=Nu.fromAny(o),s=Nu.fromAny(s),u=null!==u?Hu.fromAny(u):null,a=Hu.fromAny(a));return void 0!==h&&c.fill(h),void 0!==p&&c.stroke(p),void 0!==l&&c.strokeWidth(l),c},e.fromAny=function(t){if(t instanceof e)return t;if(t instanceof wc)return new e(Af.origin(),t.innerRadius(),t.outerRadius(),t.startAngle(),t.sweepAngle(),t.padAngle(),t.padRadius(),t.cornerRadius());if("object"==typeof t&&t){var r=new e;return r.setState(t),r}throw new TypeError(""+t)},m([rl(Af)],e.prototype,"center",void 0),m([rl(Hu)],e.prototype,"innerRadius",void 0),m([rl(Hu)],e.prototype,"outerRadius",void 0),m([rl(Nu)],e.prototype,"startAngle",void 0),m([rl(Nu)],e.prototype,"sweepAngle",void 0),m([rl(Nu)],e.prototype,"padAngle",void 0),m([rl(Hu)],e.prototype,"padRadius",void 0),m([rl(Hu)],e.prototype,"cornerRadius",void 0),m([rl(ta,{inherit:!0})],e.prototype,"fill",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Df),Uf=function(t){function e(e,r){void 0===e&&(e=Af.origin()),void 0===r&&(r=Af.origin());var i=t.call(this)||this;return i.start.setState(e),i.end.setState(r),i._startPoint=no.origin(),i._endPoint=no.origin(),i._hitWidth=0,i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.hitWidth=function(t){return void 0===t?this._hitWidth:(this._hitWidth=t,this)},e.prototype.onAnimate=function(t){var e=t.updateTime,r=this.start.value;this.start.onFrame(e);var i=this.start.value,n=this.end.value;this.end.onFrame(e);var o=this.end.value;this.stroke.onFrame(e),this.strokeWidth.onFrame(e),f.equal(r,i)&&f.equal(n,o)||this.requireUpdate(Pf.NeedsProject)},e.prototype.onProject=function(t){var e=t.projection,r=e.project(this.start.value),i=e.project(this.end.value),n=new no((r.x+i.x)/2,(r.y+i.y)/2);this._startPoint=r,this._endPoint=i,this._hitBounds=new uo(Math.min(r.x,i.x),Math.min(r.y,i.y),Math.max(r.x,i.x),Math.max(r.y,i.y)),this.setAnchor(n)},e.prototype.onLayout=function(t){var e=this._bounds,r=this._startPoint,i=this._endPoint,n=!isFinite(r.x)||isFinite(r.y)||!isFinite(i.x)||!isFinite(i.y)||!e.intersectsSegment(new oo(r.x,r.y,i.x,i.y));this.setCulled(n),this.layoutChildViews(t)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderLine(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderLine=function(t,e,r){var i=this.stroke.value;if(i){var n=this.strokeWidth.value;if(n){var o=this._startPoint,s=this._endPoint;t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(s.x,s.y);var u=Math.min(e.width,e.height);t.lineWidth=n.pxValue(u),t.strokeStyle=i.toString(),t.stroke()}}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestLine(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestLine=function(t,e,r,i,n){var o=this._startPoint,s=this._endPoint,u=this._hitWidth,a=this.strokeWidth.value;if(a){var h=Math.min(i.width,i.height);u=Math.max(u,a.pxValue(h))}return r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(s.x,s.y),r.lineWidth=u,r.isPointInStroke(t,e)?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;return void 0!==t.key&&r.key(t.key),void 0!==t.start&&r.start(t.start),void 0!==t.end&&r.end(t.end),void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth),void 0!==t.hitWidth&&r.hitWidth(t.hitWidth),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(Af)],e.prototype,"start",void 0),m([rl(Af)],e.prototype,"end",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Df),Nf=function(t){function e(){var e=t.call(this)||this;return e.stroke.setState(ta.black()),e.strokeWidth.setState(Hu.px(1)),e._gradientStops=0,e._hitWidth=5,e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"points",{get:function(){for(var t=[],e=this._childViews,r=0,i=e.length;r<i;r+=1){var n=e[r];n instanceof If&&t.push(n)}return t},enumerable:!0,configurable:!0}),e.prototype.appendPoint=function(t){return t=If.fromAny(t),this.appendChildView(t),this.requireUpdate(el.NeedsAnimate|Pf.NeedsProject),t},e.prototype.setPoint=function(t,e){return e=If.fromAny(e),this.setChildView(t,e),this.requireUpdate(el.NeedsAnimate|Pf.NeedsProject),e},e.prototype.hitWidth=function(t){return void 0===t?this._hitWidth:(this._hitWidth=t,this)},e.prototype.onAnimate=function(t){var e=t.updateTime;this.stroke.onFrame(e),this.strokeWidth.onFrame(e),this.font.onFrame(e),this.textColor.onFrame(e)},e.prototype.onProject=function(t){for(var e=t.projection,r=this._childViews,i=r.length,n=0,o=0,s=0,u=0,a=null,h=!1,p=1/0,l=1/0,c=-1/0,f=-1/0,d=0;d<i;d+=1){var y=r[d];if(y instanceof If){var v=y.coord.value,_=e.project(v);n+=1,o+=_.x,s+=_.y,h=h||!isFinite(_.x)||!isFinite(_.y),p=Math.min(p,_.x),l=Math.min(l,_.y),c=Math.max(_.x,c),f=Math.max(_.y,f),y.isGradientStop()&&(u+=1)}}n>0&&(o/=n,s/=n,h||(a=new uo(p,l,c,f))),this._gradientStops=u,this._hitBounds=a,this.setAnchor(new no(o,s))},e.prototype.onLayout=function(t){var e=this._hitBounds;if(null!==e){var r=!this._bounds.intersects(e);this.setCulled(r)}else this.setCulled(!0);this.layoutChildViews(t)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this._gradientStops?this.renderPolylineGradient(r,this._bounds,this._anchor):this.renderPolylineStroke(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderPolylineStroke=function(t,e,r){var i=this._childViews,n=this.stroke.value,o=this.strokeWidth.value.pxValue(Math.min(e.width,e.height));t.beginPath();for(var s=0,u=0,a=i.length;u<a;u+=1){var h=i[u];if(h instanceof If){var p=h.x,l=h.y;0===s?t.moveTo(p,l):t.lineTo(p,l),s+=1}}t.strokeStyle=n.toString(),t.lineWidth=o,t.stroke()},e.prototype.renderPolylineGradient=function(t,e,r){for(var i,n=this._childViews,o=this.stroke.value,s=this.strokeWidth.value.pxValue(Math.min(e.width,e.height)),u=0,a=n.length;u<a;u+=1){var h=n[u];if(h instanceof If){if(void 0!==i){var p=i.x,l=i.y,c=h.x,f=h.y,d=t.createLinearGradient(p,l,c,f),y=i.color.value||o,v=i.opacity.value;"number"==typeof v&&(y=y.alpha(v)),d.addColorStop(0,y.toString()),y=h.color.value||o,"number"==typeof(v=h.opacity.value)&&(y=y.alpha(v)),d.addColorStop(1,y.toString()),t.beginPath(),t.moveTo(p,l),t.lineTo(c,f),t.strokeStyle=d,t.lineWidth=s,t.stroke()}i=h}}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestPolyline(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestPolyline=function(t,e,r,i,n){var o=this._hitWidth,s=this.strokeWidth.value;if(s){var u=this.bounds,a=Math.min(u.width,u.height);o=Math.max(o,s.pxValue(a))}r.beginPath();for(var h=0,p=this._childViews.length;h<p;h+=1){var l=this._childViews[h];if(l instanceof If){var c=l.x,f=l.y;0===h?r.moveTo(c,f):r.lineTo(c,f)}}return r.lineWidth=o,r.isPointInStroke(t,e)?this:null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth),void 0!==t.hitWidth&&r.hitWidth(t.hitWidth),void 0!==t.font&&r.font(t.font),void 0!==t.textColor&&r.textColor(t.textColor);var i=t.points;if(void 0!==i)for(var n=0,o=i.length;n<o;n+=1)r.appendPoint(i[n]);return r}throw new TypeError(""+t)},m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),m([rl(da,{inherit:!0})],e.prototype,"font",void 0),m([rl(ta,{inherit:!0})],e.prototype,"textColor",void 0),e}(Df),zf=function(t){function e(){var e=t.call(this)||this;return e._coords=[],e._points=[],e._animateCoords=!1,e._clipViewport=!0,e}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coords",{get:function(){return this._coords},enumerable:!0,configurable:!0}),e.prototype.setCoords=function(t,e){for(var r=0,i=Math.min(this._coords.length,t.length);r<i;r+=1){var n=Af.fromAny(t[r]);this._coords[r].setState(n,e)}for(i=t.length;r<i;r+=1){n=Af.fromAny(t[r]);this._coords.push(new il(Af,this,n)),this._points.push(no.origin()),this.requireUpdate(el.NeedsAnimate|Pf.NeedsProject)}this._coords.length=t.length},Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!0,configurable:!0}),e.prototype.appendCoord=function(t){t=Af.fromAny(t),this._coords.push(new il(Af,this,t)),this._points.push(no.origin()),this.requireUpdate(el.NeedsAnimate|Pf.NeedsProject)},e.prototype.insertCoord=function(t,e){e=Af.fromAny(e),this._coords.splice(t,0,new il(Af,this,e)),this._points.splice(t,0,no.origin()),this.requireUpdate(el.NeedsAnimate|Pf.NeedsProject)},e.prototype.removeCoord=function(t){this._coords.splice(t,1),this._points.splice(t,1)},e.prototype.animateCoords=function(t){return void 0===t?this._animateCoords:(this._animateCoords=t,this)},e.prototype.clipViewport=function(t){return void 0===t?this._clipViewport:(this._clipViewport=t,this)},e.prototype.onAnimate=function(t){var e=t.updateTime,r=!1;if(this._animateCoords)for(var i=this._coords,n=0,o=i.length;n<o;n+=1){var s=i[n],u=s.value;s.onFrame(e);var a=s.value;f.equal(u,a)||(r=!0)}this.fill.onFrame(e),this.stroke.onFrame(e),this.strokeWidth.onFrame(e),r&&this.requireUpdate(Pf.NeedsProject)},e.prototype.onProject=function(t){var e=t.projection,r=this._coords,i=this._points,n=r.length,o=0,s=0,u=null;if(n>0){for(var a=!1,h=1/0,p=1/0,l=-1/0,c=-1/0,f=0;f<n;f+=1){var d=r[f].value,y=e.project(d);i[f]=y,o+=y.x,s+=y.y,a=a||!isFinite(y.x)||!isFinite(y.y),h=Math.min(h,y.x),p=Math.min(p,y.y),l=Math.max(y.x,l),c=Math.max(y.y,c)}o/=n,s/=n,a||(u=new uo(h,p,l,c))}this._hitBounds=u,this.setAnchor(new no(o,s))},e.prototype.onLayout=function(t){var e=this._hitBounds;if(null!==e){var r=this._bounds,i=!(!this._clipViewport||r.xMin-4*r.width<=e.xMin&&e.xMax<=r.xMax+4*r.width&&r.yMin-4*r.height<=e.yMin&&e.yMax<=r.yMax+4*r.height)||!r.intersects(e);this.setCulled(i)}else this.setCulled(!0);this.layoutChildViews(t)},e.prototype.onRender=function(t){var e=t.renderer;if(e instanceof Fp){var r=e.context;r.save(),this.renderPolygon(r,this._bounds,this._anchor),r.restore()}},e.prototype.renderPolygon=function(t,e,r){var i=this._points,n=i.length;if(n>0){t.beginPath();var o=i[0];t.moveTo(o.x,o.y);for(var s=1;s<n;s+=1){var u=i[s];t.lineTo(u.x,u.y)}t.closePath();var a=this.fill.value;a&&(t.fillStyle=a.toString(),t.fill());var h=this.stroke.value;if(h){var p=this.strokeWidth.value;if(p){var l=Math.min(e.width,e.height);t.lineWidth=p.pxValue(l),t.strokeStyle=h.toString(),t.stroke()}}}},e.prototype.hitTest=function(e,r,i){var n=t.prototype.hitTest.call(this,e,r,i);if(null===n){var o=i.renderer;if(o instanceof Fp){var s=o.context;s.save(),e*=o.pixelRatio,r*=o.pixelRatio,n=this.hitTestPolygon(e,r,s,this._bounds,this._anchor),s.restore()}}return n},e.prototype.hitTestPolygon=function(t,e,r,i,n){var o=this._points,s=o.length;if(s>0){r.beginPath();var u=o[0];r.moveTo(u.x,u.y);for(var a=1;a<s;a+=1){var h=o[a];r.lineTo(h.x,h.y)}if(r.closePath(),this.fill.value&&r.isPointInPath(t,e))return this;if(this.stroke.value){var p=this.strokeWidth.value;if(p){var l=Math.min(i.width,i.height);if(r.lineWidth=p.pxValue(l),r.isPointInStroke(t,e))return this}}}return null},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&t){var r=new e;void 0!==t.key&&r.key(t.key),void 0!==t.fill&&r.fill(t.fill),void 0!==t.stroke&&r.stroke(t.stroke),void 0!==t.strokeWidth&&r.strokeWidth(t.strokeWidth);var i=t.coords;if(void 0!==i)for(var n=0,o=i.length;n<o;n+=1)r.appendCoord(i[n]);return void 0!==t.animateCoords&&r.animateCoords(t.animateCoords),void 0!==t.hidden&&r.setHidden(t.hidden),void 0!==t.culled&&r.setCulled(t.culled),r}throw new TypeError(""+t)},m([rl(ta,{inherit:!0})],e.prototype,"fill",void 0),m([rl(ta,{inherit:!0})],e.prototype,"stroke",void 0),m([rl(Hu,{inherit:!0})],e.prototype,"strokeWidth",void 0),e}(Df),jf=function(){function t(t){this._map=t}return Object.defineProperty(t.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){var t=this._map.getBounds();return[new Af(t.getWest(),t.getSouth()),new Af(t.getEast(),t.getNorth())]},enumerable:!0,configurable:!0}),t.prototype.project=function(t,r){var i;i="number"==typeof t?new e.LngLat(t,r):t;var n=this._map.project(i),o=n.x,s=n.y;return new no(o,s)},t.prototype.unproject=function(t,r){var i;i="number"==typeof t?new e.Point(t,r):Array.isArray(t)?t:new e.Point(t.x,t.y);var n=this._map.unproject(i),o=n.lng,s=n.lat;return new Af(o,s)},t}(),Wf=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,r)||this;return i.onMapRender=i.onMapRender.bind(i),i._map=e,i._projection=new jf(i._map),i._zoom=e.getZoom(),i._heading=e.getBearing(),i._tilt=e.getPitch(),i.initMap(i._map),i}return _(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.initMap=function(t){t.on("render",this.onMapRender)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){return this._projection.project.apply(this._projection,arguments)},e.prototype.unproject=function(t,e){return this._projection.unproject.apply(this._projection,arguments)},Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),e.prototype.setProjection=function(t){this.willSetProjection(t),this._projection=t,this.onSetProjection(t),this.didSetProjection(t)},e.prototype.willSetProjection=function(t){this.willObserve((function(e){e.viewWillSetProjection&&e.viewWillSetProjection(t,this)}))},e.prototype.onSetProjection=function(t){this.requireUpdate(Pf.NeedsProject,!0)},e.prototype.didSetProjection=function(t){this.didObserve((function(e){e.viewDidSetProjection&&e.viewDidSetProjection(t,this)}))},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),e.prototype.setZoom=function(t){if(this._zoom!==t){this.willSetZoom(t);var e=this._zoom;this._zoom=t,this.onSetZoom(t,e),this.didSetZoom(t,e)}},e.prototype.willSetZoom=function(t){this.didObserve((function(e){e.viewWillSetZoom&&e.viewWillSetZoom(t,this)}))},e.prototype.onSetZoom=function(t,e){},e.prototype.didSetZoom=function(t,e){this.didObserve((function(r){r.viewDidSetZoom&&r.viewDidSetZoom(t,e,this)}))},Object.defineProperty(e.prototype,"heading",{get:function(){return this._heading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){return this._tilt},enumerable:!0,configurable:!0}),e.prototype.doUpdate=function(t,e){var r=this.mapViewContext(e);this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&Pf.NeedsProject)&&(this._updateFlags=this._updateFlags&~Pf.NeedsProject,this.doProject(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(e),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.childViewContext=function(t,e){return e},e.prototype.mapViewContext=function(t){var e=Object.create(t);return e.projection=this._projection,e.zoom=this._zoom,e.heading=this._heading,e.tilt=this._tilt,e},e.prototype.onMapRender=function(){this._heading=this._map.getBearing(),this._tilt=this._map.getPitch(),this.setZoom(this._map.getZoom()),this.setProjection(this._projection)},e.prototype.overlayCanvas=function(){if(this._parentView)return this.canvasView;var t=this._map;el.fromNode(t.getContainer());var e=el.fromNode(t.getCanvasContainer()).append("canvas");return e.append(this),e},e}(Df),qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.viewWillSetProjection=function(t,e){},e.prototype.viewDidSetProjection=function(t,e){},e.prototype.viewWillSetZoom=function(t,e){},e.prototype.viewDidSetZoom=function(t,e,r){},e}(Mf),Bf=function(){function t(t){this._mapView=t}return Object.defineProperty(t.prototype,"map",{get:function(){return this._mapView._map},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){var t=this._mapView._map.getBounds(),e=t.getSouthWest(),r=t.getNorthEast();return[new Af(e.lng(),e.lat()),new Af(r.lng(),r.lat())]},enumerable:!0,configurable:!0}),t.prototype.project=function(t,e){var r;r="number"==typeof t?new google.maps.LatLng(e,t):Array.isArray(t)?new google.maps.LatLng(t[1],t[0]):new google.maps.LatLng(t.lat,t.lng);var i=this._mapView._overlay.getProjection().fromLatLngToContainerPixel(r);return new no(i.x,i.y)},t.prototype.unproject=function(t,e){var r;r="number"==typeof t?new google.maps.Point(t,e):Array.isArray(t)?new google.maps.Point(t[0],t[1]):new google.maps.Point(t.x,t.y);var i=this._mapView._overlay.getProjection().fromContainerPixelToLatLng(r);return new Af(i.lng(),i.lat())},t}(),Kf=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,r)||this;return i.onMapRender=i.onMapRender.bind(i),i._map=e,i._projection=new Bf(i),i._overlay=null,i._zoom=e.getZoom(),i._heading=e.getHeading(),i._tilt=e.getTilt(),i.initMap(e),i}return _(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.initMap=function(t){},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){return this._projection.project.apply(this._projection,arguments)},e.prototype.unproject=function(t,e){return this._projection.unproject.apply(this._projection,arguments)},Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),e.prototype.setProjection=function(t){this.willSetProjection(t),this._projection=t,this.onSetProjection(t),this.didSetProjection(t)},e.prototype.willSetProjection=function(t){this.willObserve((function(e){e.viewWillSetProjection&&e.viewWillSetProjection(t,this)}))},e.prototype.onSetProjection=function(t){this.requireUpdate(Pf.NeedsProject,!0)},e.prototype.didSetProjection=function(t){this.didObserve((function(e){e.viewDidSetProjection&&e.viewDidSetProjection(t,this)}))},Object.defineProperty(e.prototype,"overlay",{get:function(){return this._overlay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),e.prototype.setZoom=function(t){var e=this._zoom;e!==t&&(this.willSetZoom(t),this._zoom=t,this.onSetZoom(t,e),this.didSetZoom(t,e))},e.prototype.willSetZoom=function(t){this.didObserve((function(e){e.viewWillSetZoom&&e.viewWillSetZoom(t,this)}))},e.prototype.onSetZoom=function(t,e){},e.prototype.didSetZoom=function(t,e){this.didObserve((function(r){r.viewDidSetZoom&&r.viewDidSetZoom(t,e,this)}))},Object.defineProperty(e.prototype,"heading",{get:function(){return this._heading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){return this._tilt},enumerable:!0,configurable:!0}),e.prototype.doUpdate=function(t,e){var r=this.mapViewContext(e);this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&Pf.NeedsProject)&&(this._updateFlags=this._updateFlags&~Pf.NeedsProject,this.doProject(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(e),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.childViewContext=function(t,e){return e},e.prototype.mapViewContext=function(t){var e=Object.create(t);return e.projection=this._projection,e.zoom=this._zoom,e.heading=this._heading,e.tilt=this._tilt,e},e.prototype.onMapRender=function(){this._heading=this._map.getHeading(),this._tilt=this._map.getTilt(),this.setZoom(this._map.getZoom()),this.setProjection(this._projection)},e.prototype.overlayCanvas=function(){if(this._parentView)return this.canvasView;var t=new(function(t){function r(e){var r=t.call(this)||this;return r._mapView=e,r._canvasView=null,r}return _(r,t),r.prototype.onAdd=function(){var t=this.getPanes(),r=e.materializeAncestors(t.overlayMouseTarget).parentView.parentView;this._canvasView=r.append("canvas"),this._canvasView.append(this._mapView)},r.prototype.onRemove=function(){this._canvasView&&(this._canvasView.remove(),this._canvasView=null)},r.prototype.draw=function(){this._mapView.onMapRender()},r}(google.maps.OverlayView))(this);return t.setMap(this._map),this._overlay=t,t._canvasView},e.materializeAncestors=function(t){var r=t.parentNode;return r instanceof HTMLElement&&!r.view&&e.materializeAncestors(r),el.fromNode(t)},e}(Df),Hf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.viewWillSetProjection=function(t,e){},e.prototype.viewDidSetProjection=function(t,e){},e.prototype.viewWillSetZoom=function(t,e){},e.prototype.viewDidSetZoom=function(t,e,r){},e}(Mf),Gf=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.willSetProjection=function(t){this.willObserve((function(e){e.viewWillSetProjection&&e.viewWillSetProjection(t,this)}))},e.prototype.onSetProjection=function(t){this.requireUpdate(Pf.NeedsProject,!0)},e.prototype.didSetProjection=function(t){this.didObserve((function(e){e.viewDidSetProjection&&e.viewDidSetProjection(t,this)}))},e.prototype.willSetZoom=function(t){this.didObserve((function(e){e.viewWillSetZoom&&e.viewWillSetZoom(t,this)}))},e.prototype.onSetZoom=function(t,e){},e.prototype.didSetZoom=function(t,e){this.didObserve((function(r){r.viewDidSetZoom&&r.viewDidSetZoom(t,e,this)}))},e.prototype.doUpdate=function(t,e){var r=this.mapViewContext(e);this.willUpdate(r),0!=((t|this._updateFlags)&el.NeedsCompute)&&(this._updateFlags=this._updateFlags&~el.NeedsCompute,this.doCompute(r)),0!=((t|this._updateFlags)&el.NeedsAnimate)&&(this._updateFlags=this._updateFlags&~el.NeedsAnimate,this.doAnimate(r)),0!=((t|this._updateFlags)&Pf.NeedsProject)&&(this._updateFlags=this._updateFlags&~Pf.NeedsProject,this.doProject(r)),0!=((t|this._updateFlags)&el.NeedsLayout)&&(this._updateFlags=this._updateFlags&~el.NeedsLayout,this.doLayout(r)),0!=((t|this._updateFlags)&el.NeedsScroll)&&(this._updateFlags=this._updateFlags&~el.NeedsScroll,this.doScroll(r)),0!=((t|this._updateFlags)&el.NeedsRender)&&(this._updateFlags=this._updateFlags&~el.NeedsRender,this.doRender(r)),this.onUpdate(e),this.doUpdateChildViews(t,r),this.didUpdate(r)},e.prototype.childViewContext=function(t,e){return e},e.prototype.mapViewContext=function(t){var e=Object.create(t);return e.projection=this.projection,e.zoom=this.zoom,e.heading=this.heading,e.tilt=this.tilt,e},e}(Df),Xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.viewWillSetProjection=function(t,e){},e.prototype.viewDidSetProjection=function(t,e){},e.prototype.viewWillSetZoom=function(t,e){},e.prototype.viewDidSetZoom=function(t,e,r){},e}(Mf),Yf=function(){function t(t){this._map=t}return Object.defineProperty(t.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){var t=this._map.extent;return[new Af(t.xmin,t.ymin),new Af(t.xmax,t.ymax)]},enumerable:!0,configurable:!0}),t.prototype.project=function(t,e){var r;r="number"==typeof t?{x:t,y:e,spatialReference:{wkid:4326}}:Array.isArray(t)?{x:t[0],y:t[1],spatialReference:{wkid:4326}}:{x:t.lng,y:t.lat,spatialReference:{wkid:4326}};var i=this._map.toScreen(r);return new no(i.x,i.y)},t.prototype.unproject=function(t,e){var r;r="number"==typeof t?{x:t,y:e}:Array.isArray(t)?{x:t[0],y:t[1]}:t;var i=this._map.toMap(r);return new Af(i.longitude,i.latitude)},t}(),Zf=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,r)||this;return i.onMapRender=i.onMapRender.bind(i),i._map=e,i._projection=new Yf(i._map),i._zoom=e.zoom,i._heading=e.rotation,i.initMap(i._map),i}return _(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.initMap=function(t){t.watch("extent",this.onMapRender)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){return this._projection.project.apply(this._projection,arguments)},e.prototype.unproject=function(t,e){return this._projection.unproject.apply(this._projection,arguments)},Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),e.prototype.setProjection=function(t){this.willSetProjection(t),this._projection=t,this.onSetProjection(t),this.didSetProjection(t)},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),e.prototype.setZoom=function(t){var e=this._zoom;e!==t&&(this.willSetZoom(t),this._zoom=t,this.onSetZoom(t,e),this.didSetZoom(t,e))},Object.defineProperty(e.prototype,"heading",{get:function(){return this._heading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.onMapRender=function(){this._heading=this._map.rotation,this.setZoom(this._map.zoom),this.setProjection(this._projection)},e.prototype.overlayCanvas=function(){if(this._parentView)return this.canvasView;var t=this._map,e=el.fromNode(t.container),r=el.fromNode(e.node.querySelector(".esri-view-root")),i=el.fromNode(r.node.querySelector(".esri-overlay-surface")).append("canvas");return i.setEventSurface(r.node),i.append(this),i},e}(Gf),Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.viewWillSetProjection=function(t,e){},e.prototype.viewDidSetProjection=function(t,e){},e}(Xf),$f=function(){function t(t){this._map=t}return Object.defineProperty(t.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){var t=this._map.extent;return[new Af(t.xmin,t.ymin),new Af(t.xmax,t.ymax)]},enumerable:!0,configurable:!0}),t.prototype.project=function(t,e){var r;r="number"==typeof t?{x:t,y:e,spatialReference:{wkid:4326}}:Array.isArray(t)?{x:t[0],y:t[1],spatialReference:{wkid:4326}}:{x:t.lng,y:t.lat,spatialReference:{wkid:4326}};var i=this._map.toScreen(r);return new no(i.x,i.y)},t.prototype.unproject=function(t,e){var r;r="number"==typeof t?{x:t,y:e}:Array.isArray(t)?{x:t[0],y:t[1]}:t;var i=this._map.toMap(r);return new Af(i.longitude,i.latitude)},t}(),Jf=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,r)||this;return i.onMapRender=i.onMapRender.bind(i),i._map=e,i._projection=new $f(i._map),i._zoom=e.zoom,i._heading=e.camera.heading,i._tilt=e.camera.tilt,i.initMap(i._map),i}return _(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.initMap=function(t){t.watch("extent",this.onMapRender)},Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.project=function(t,e){return this._projection.project.apply(this._projection,arguments)},e.prototype.unproject=function(t,e){return this._projection.unproject.apply(this._projection,arguments)},Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),e.prototype.setProjection=function(t){this.willSetProjection(t),this._projection=t,this.onSetProjection(t),this.didSetProjection(t)},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),e.prototype.setZoom=function(t){var e=this._zoom;e!==t&&(this.willSetZoom(t),this._zoom=t,this.onSetZoom(t,e),this.didSetZoom(t,e))},Object.defineProperty(e.prototype,"heading",{get:function(){return this._heading},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilt",{get:function(){return this._tilt},enumerable:!0,configurable:!0}),e.prototype.onMapRender=function(){this._heading=this._map.camera.heading,this._tilt=this._map.camera.tilt,this.setZoom(this._map.zoom),this.setProjection(this._projection)},e.prototype.overlayCanvas=function(){if(this._parentView)return this.canvasView;var t=this._map,e=el.fromNode(t.container),r=el.fromNode(e.node.querySelector(".esri-view-root")),i=el.fromNode(r.node.querySelector(".esri-view-surface")).append("canvas");return i.append(this),i},e}(Gf),td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.viewWillSetProjection=function(t,e){},e.prototype.viewDidSetProjection=function(t,e){},e}(Xf),ed=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,e,r)||this;return i.onToggleClick=i.onToggleClick.bind(i),i._visibleClass="navbar-visible",i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toggleView",{get:function(){return this.getChildView("toggle")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"menuView",{get:function(){return this.getChildView("menu")||this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleClass",{get:function(){return this._visibleClass},set:function(t){this._visibleClass=t},enumerable:!0,configurable:!0}),e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r),"toggle"===e.key()&&this.onInsertToggleView(e)},e.prototype.onRemoveChildView=function(e){"toggle"===e.key()&&this.onRemoveToggleView(e),t.prototype.onRemoveChildView.call(this,e)},e.prototype.onInsertToggleView=function(t){t.on("click",this.onToggleClick)},e.prototype.onRemoveToggleView=function(t){t.off("click",this.onToggleClick)},e.prototype.onToggleClick=function(t){var e=this.menuView;if(e){var r=e.node.classList;r.contains(this._visibleClass)?r.remove(this._visibleClass):r.add(this._visibleClass)}},e}(sc),rd=function(t){function e(e,r){void 0===r&&(r=null);var i=t.call(this,e,r)||this;return i.onToggleClick=i.onToggleClick.bind(i),i._visibleClass="dropdown-visible",i}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toggleView",{get:function(){return this.getChildView("toggle")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"menuView",{get:function(){return this.getChildView("menu")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleClass",{get:function(){return this._visibleClass},set:function(t){this._visibleClass=t},enumerable:!0,configurable:!0}),e.prototype.onInsertChildView=function(e,r){t.prototype.onInsertChildView.call(this,e,r),"toggle"===e.key()&&this.onInsertToggleView(e)},e.prototype.onRemoveChildView=function(e){"toggle"===e.key()&&this.onRemoveToggleView(e),t.prototype.onRemoveChildView.call(this,e)},e.prototype.onInsertToggleView=function(t){t.on("click",this.onToggleClick)},e.prototype.onRemoveToggleView=function(t){t.off("click",this.onToggleClick)},e.prototype.onToggleClick=function(t){var e=this.menuView;if(e){var r=e.node.classList;if(r.contains(this._visibleClass))r.remove(this._visibleClass);else{var i=this.appView;i&&i.showPopover(this)}t.stopPropagation(),t.preventDefault()}},Object.defineProperty(e.prototype,"popoverState",{get:function(){var t=this.menuView;if(t&&t.node.classList.contains(this._visibleClass))return"shown";return"hidden"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popoverView",{get:function(){return this.menuView},enumerable:!0,configurable:!0}),e.prototype.showPopover=function(t){var e=this.menuView;e&&e.node.classList.add(this._visibleClass)},e.prototype.hidePopover=function(t){var e=this.menuView;e&&e.node.classList.remove(this._visibleClass);var r=this.appView;r&&r.hidePopover(this)},e}(sc),id=function(t){function e(e,r){return void 0===r&&(r=null),t.call(this,e,r)||this}return _(e,t),Object.defineProperty(e.prototype,"viewController",{get:function(){return this._viewController},enumerable:!0,configurable:!0}),e.prototype.materializeTree=function(t){void 0===t&&(t=this);for(var e=t.node.childNodes,r=0;r<e.length;r+=1){var i=e[r],n=this.materializeNode(t,i);n&&this.materializeTree(n)}},e.prototype.materializeNode=function(t,e){return e.view?e.view:e instanceof Element?this.materializeElement(t,e):e instanceof Text?this.materializeText(t,e):void 0},e.prototype.materializeElement=function(t,r){var i,n=r.getAttribute("swim-view");if(n){var o=e.eval(n);if("function"!=typeof o)throw new TypeError(n);i=o}i||(i=r instanceof HTMLElement?sc:r instanceof SVGElement?nc:dl);var s=new i(r),u=r.getAttribute("slot");return u&&s.key(u),e.bindController(s),t.injectChildView(s,null),s},e.prototype.materializeText=function(t,e){},e.boot=function(){var t=[];if("undefined"!=typeof document)for(var r=document.querySelectorAll("[swim-webapp]"),i=0;i<r.length;i+=1){var n=r[i];if(n instanceof HTMLElement){var o=e.bootElement(n);t.push(o)}}return t},e.bootElement=function(t){var r,i=t.getAttribute("swim-webapp");if(i){var n=e.eval(i);if("function"!=typeof n)throw new TypeError(i);r=n}r||(r=e);var o=new r(t),s=t.getAttribute("slot");return s&&o.key(s),e.bindController(o),o.requireUpdate(0,!0),o.materializeTree(),o},e.bindController=function(t){var r=t.node.getAttribute("swim-controller");if(r){var i=e.eval(r);if("function"!=typeof i)throw new TypeError(r);var n=new i;t.setViewController(n)}},e.eval=function(t){for(var e="undefined"!=typeof window?window:void 0,r=t.split("."),i=0,n=r.length;e&&"object"==typeof e&&i<n;i+=1){e=e[r[i]]}return e},e}(lc),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(cc);"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",(function(t){id.boot()})),t.Absent=xe,t.AbsentInterpolator=fh,t.AbstractInlet=Ir,t.AbstractInoutlet=Lr,t.AbstractMapInlet=Nr,t.AbstractMapInletMapOutlet=qr,t.AbstractMapInletOutlet=Wr,t.AbstractMapInoutlet=jr,t.AbstractMapOutlet=zr,t.AbstractOutlet=Fr,t.AbstractRecordOutlet=gi,t.AbstractRecordStreamlet=xi,t.AbstractStreamlet=vi,t.AffineTransform=Ca,t.AffineTransformInterpolator=eh,t.AffineTransformParser=Va,t.AndOperator=Ve,t.AndOutlet=Mi,t.Angle=Nu,t.AngleForm=Ku,t.AngleInterpolator=qa,t.AngleMemberAnimator=al,t.AngleParser=Bu,t.AnimatedView=Kl,t.Animator=ip,t.AnyForm=Cr,t.AnyMemberAnimator=il,t.AppView=ql,t.Arc=wc,t.ArcView=gc,t.AreaGraphView=xf,t.ArrayInterpolator=dh,t.AssertException=C,t.Attr=ie,t.AttrInterpolator=nh,t.AttributeAnimator=yl,t.AttributeString=Vp,t.AuthRequest=Qs,t.AuthedResponse=$s,t.AxisView=hf,t.AxisViewController=pf,t.BTree=jt,t.BTreeContext=zt,t.BTreeLeaf=qt,t.BTreeNode=Bt,t.BTreeNodeCursor=Kt,t.BTreePage=Wt,t.Base10=pt,t.Base10IntegerWriter=Ot,t.Base10NumberParser=kt,t.Base16=xt,t.Base16IntegerWriter=Dt,t.Base16Parser=Vt,t.Base16Writer=Pt,t.Base64=Mt,t.Base64Parser=It,t.Base64Writer=Ft,t.BaseRef=xu,t.Binary=bt,t.BinaryOperator=Ae,t.BinaryOperatorInterpolator=ph,t.BinaryOutlet=Oi,t.BitwiseAndOperator=Me,t.BitwiseAndOutlet=Ii,t.BitwiseNotOperator=Ke,t.BitwiseNotOutlet=Xi,t.BitwiseOrOperator=Pe,t.BitwiseOrOutlet=Ti,t.BitwiseXorOperator=De,t.BitwiseXorOutlet=Ri,t.Bool=ve,t.BooleanAttributeAnimator=_l,t.BooleanForm=xr,t.BooleanMemberAnimator=sl,t.BottomAxisView=ff,t.BottomTickView=qc,t.BoxR2=uo,t.BoxR2Interpolator=za,t.BoxShadow=xp,t.BoxShadowForm=Sp,t.BoxShadowParser=Cp,t.BoxShadowStyleAnimator=Tl,t.BridgeFunc=sr,t.BubblePlotView=mf,t.CanvasRenderer=Fp,t.CanvasView=ac,t.CanvasViewController=pc,t.ChartView=Cf,t.ChartViewController=Sf,t.ChildAnimator=op,t.ChildrenSelector=er,t.CircleR2=so,t.CircleR2Interpolator=ja,t.Color=ta,t.ColorAttributeAnimator=gl,t.ColorChannel=ia,t.ColorChannelParser=na,t.ColorForm=ha,t.ColorInterpolator=Ka,t.ColorMemberAnimator=pl,t.ColorOrStringAttributeAnimator=Sl,t.ColorOrStringStyleAnimator=Fl,t.ColorParser=aa,t.ColorStyleAnimator=Vl,t.CommandMessage=Bs,t.ConditionalOperator=Ee,t.ConditionalOperatorInterpolator=hh,t.ConditionalOutlet=Pi,t.Constrain=Bp,t.ConstrainBinding=Qp,t.ConstrainConstant=Xp,t.ConstrainProduct=Gp,t.ConstrainSum=Kp,t.ConstrainTerm=Hp,t.ConstrainVariable=Yp,t.Constraint=$p,t.ConstraintDummy=jp,t.ConstraintError=Wp,t.ConstraintInvalid=qp,t.ConstraintMap=Up,t.ConstraintSlack=zp,t.ConstraintSolver=tl,t.ConstraintStrength=Zp,t.ConstraintSymbol=Np,t.ContinuousScale=wh,t.Cursor=y,t.CursorArray=x,t.CursorEmpty=g,t.CursorUnary=b,t.CustomEvent=pp,t.Data=ce,t.Dataflow=$i,t.DateTime=lo,t.DateTimeForm=fo,t.DateTimeFormat=vo,t.DateTimeInterpolator=Wa,t.DateTimeLocale=po,t.DateTimeParser=co,t.DateTimeSpecifiers=yo,t.DatumView=yf,t.DayInterval=$o,t.DayOfMonthFormat=bo,t.DayOfMonthParser=Io,t.DeauthRequest=Js,t.DeauthedResponse=tu,t.DegAngle=zu,t.DescendantsSelector=rr,t.Diagnostic=lt,t.DialView=Fc,t.DivideOperator=We,t.DivideOutlet=Ki,t.Downlink=su,t.DownlinkModel=ou,t.DownlinkRecord=vu,t.DownlinkReifier=gu,t.DownlinkStreamlet=bu,t.DropdownView=rd,t.Ease=$h,t.EaseForm=Jh,t.ElementView=dl,t.ElementViewController=ic,t.EmLength=Xu,t.Envelope=Ns,t.EqOperator=Ie,t.EqOutlet=Ui,t.EsriMapView=Zf,t.EsriMapViewController=Qf,t.EsriMapViewProjection=Yf,t.EsriSceneView=Jf,t.EsriSceneViewController=td,t.EsriSceneViewProjection=$f,t.EsriView=Gf,t.EsriViewController=Xf,t.EventDownlink=hu,t.EventDownlinkModel=au,t.EventMessage=qs,t.Expression=_e,t.Extant=be,t.Field=Jt,t.FillView=Gl,t.FilterFieldsCombinator=Jr,t.FilterFieldsOperator=$r,t.FilterInterval=Go,t.FilterSelector=ir,t.Font=da,t.FontFamily=ca,t.FontFamilyParser=fa,t.FontFamilyStyleAnimator=Dl,t.FontForm=va,t.FontMemberAnimator=ll,t.FontParser=ya,t.FontSize=pa,t.Form=Se,t.FormException=Ce,t.Format=J,t.FrameAnimator=np,t.FromAny=d,t.Func=ge,t.GaugeView=Lc,t.GeOperator=Le,t.GeOutlet=zi,t.GetAttrSelector=Qe,t.GetItemSelector=$e,t.GetOutlet=Ei,t.GetSelector=Ze,t.GoogleMapProjection=Bf,t.GoogleMapView=Kf,t.GoogleMapViewController=Hf,t.GradAngle=Wu,t.GraphView=wf,t.GraphViewController=gf,t.GraphicsView=Zl,t.GraphicsViewController=Ql,t.GtOperator=Ue,t.GtOutlet=ji,t.HashGenCacheMap=k,t.HashGenCacheSet=O,t.HexColorParser=oa,t.HorizontalScaleGesture=Rc,t.Host=ru,t.HostAddressed=zs,t.HostRef=Au,t.Hour12Format=Ao,t.Hour12Parser=No,t.Hour24Format=So,t.Hour24Parser=Uo,t.HourInterval=Jo,t.HslColor=ra,t.HslColorInterpolator=Xa,t.HslColorParser=ua,t.HtmlAppView=lc,t.HtmlAppViewController=cc,t.HtmlView=sc,t.HtmlViewController=uc,t.IdentityColorInterpolator=Ha,t.IdentitySelector=Ye,t.IdentityShapeInterpolator=La,t.IdentityTransform=ma,t.IdentityTransformInterpolator=Za,t.In=function(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),vi.decorateInlet.bind(void 0,t);vi.decorateInlet({},t,e)},t.Inlet=Vr,t.InletDescriptor=fi,t.Inout=mi,t.Input=z,t.InputBuffer=et,t.InputException=T,t.InputSettings=tt,t.Interpolator=Ta,t.InterpolatorForm=_h,t.InterpolatorInterpolator=yh,t.InterpolatorMap=vh,t.Interpreter=re,t.InterpreterException=te,t.InterpreterSettings=ee,t.InvokeOperator=Xe,t.InvokeOperatorInterpolator=ch,t.InvokeOutlet=Qi,t.Item=$t,t.ItemForm=Sr,t.KeyOutlet=Ur,t.KeysCursor=Lt,t.KeysSelector=Je,t.LambdaFunc=or,t.LaneAddressed=js,t.LaneRef=Cu,t.LayerView=$l,t.LayerViewController=Jl,t.LayoutAnchor=zl,t.LayoutManager=Ul,t.LayoutScope=Ll,t.LayoutSolver=Nl,t.LayoutView=Bl,t.LeOperator=Re,t.LeOutlet=Li,t.LeftAxisView=df,t.LeftTickView=Bc,t.Length=Hu,t.LengthAttributeAnimator=wl,t.LengthForm=Ju,t.LengthInterpolator=Ba,t.LengthMemberAnimator=hl,t.LengthOrStringAttributeAnimator=Cl,t.LengthOrStringStyleAnimator=Il,t.LengthParser=$u,t.LengthStyleAnimator=Ol,t.LineGraphView=bf,t.LineHeight=la,t.LineHeightStyleAnimator=Pl,t.LinearScale=gh,t.LinearScaleInterpolator=Ah,t.LinkAddressed=Ws,t.LinkRequest=Ks,t.LinkedResponse=Hs,t.ListDownlink=lu,t.ListDownlinkModel=pu,t.ListDownlinkRecord=_u,t.LiteralSelector=nr,t.LngLat=Af,t.LngLatInterpolator=kf,t.LtOperator=Te,t.LtOutlet=Fi,t.MapArcView=Lf,t.MapCircleView=Ff,t.MapDownlink=fu,t.MapDownlinkModel=cu,t.MapDownlinkRecord=mu,t.MapFieldValuesCombinator=ii,t.MapFieldValuesOperator=ri,t.MapGraphicsView=Df,t.MapGraphicsViewController=Mf,t.MapInlet=Dr,t.MapInput=Xr,t.MapLayerView=Tf,t.MapLayerViewController=Rf,t.MapLineView=Uf,t.MapOutlet=Mr,t.MapOutput=Yr,t.MapPointView=If,t.MapPolygonView=zf,t.MapPolylineView=Nf,t.MapProjection=Of,t.MapValueCombinator=ei,t.MapValueOperator=ti,t.MapView=Pf,t.MapboxProjection=jf,t.MapboxView=Wf,t.MapboxViewController=qf,t.Mark=D,t.MathModule=ur,t.MemberAnimator=rl,t.MemoizeMapCombinator=Qr,t.MemoizeValueCombinator=Zr,t.MillisecondFormat=Vo,t.MillisecondInterval=rs,t.MillisecondParser=qo,t.MillisecondsInterval=is,t.MinusOperator=ze,t.MinusOutlet=qi,t.MinuteFormat=Eo,t.MinuteInterval=ts,t.MinuteParser=jo,t.ModuloOperator=qe,t.ModuloOutlet=Hi,t.MonthFormat=wo,t.MonthInterval=Zo,t.MonthOfYearFormat=mo,t.MonthOfYearParser=Mo,t.MonthParser=To,t.Multitouch=Oc,t.MultitouchEvent=Ac,t.MultitouchGhost=Ec,t.MultitouchMouse=Dc,t.MultitouchPointer=Vc,t.MultitouchTouch=Pc,t.MultitouchTrack=kc,t.Murmur3=c,t.NativeOrder=i,t.NavbarView=ed,t.NeOperator=Fe,t.NeOutlet=Ni,t.NegativeOperator=He,t.NegativeOutlet=Yi,t.NodeCursor=Nt,t.NodeRef=Su,t.NodeView=fl,t.NodeViewController=tc,t.NotOperator=Be,t.NotOutlet=Gi,t.Num=ye,t.NumInterpolator=ah,t.NumberAttributeAnimator=ml,t.NumberForm=br,t.NumberInterpolator=Ia,t.NumberMemberAnimator=ul,t.NumberOrStringAttributeAnimator=xl,t.NumberOrStringStyleAnimator=Rl,t.NumberStyleAnimator=El,t.NumberTickGenerator=uf,t.ObjectMemberAnimator=nl,t.Objects=f,t.Operator=me,t.OrOperator=Oe,t.OrOutlet=Di,t.Out=_i,t.Outlet=Pr,t.OutletDescriptor=di,t.OutletInlet=Br,t.OutletMapInlet=Kr,t.Output=F,t.OutputBuffer=ot,t.OutputException=I,t.OutputSettings=R,t.OutputStyle=ht,t.Parser=ft,t.ParserException=ct,t.PathContext=Rp,t.PathRenderer=Ip,t.PatternFormat=Po,t.PatternParser=Bo,t.PctLength=Zu,t.PeriodFormat=ko,t.PeriodParser=zo,t.PieView=Nc,t.PlotView=vf,t.PlotViewController=_f,t.PlusOperator=Ne,t.PlusOutlet=Wi,t.PointR2=no,t.PointR2Interpolator=Ua,t.Popover={is:function(t){if("object"==typeof t&&t){var e=t;return void 0!==e.popoverState&&void 0!==e.popoverView&&"function"==typeof e.showPopover&&"function"==typeof e.hidePopover}return!1}},t.PopoverView=fc,t.PopoverViewController=dc,t.PositiveOperator=Ge,t.PositiveOutlet=Zi,t.PropertyAnimator=hp,t.PxLength=Gu,t.R2Shape=ro,t.RadAngle=ju,t.Random=u,t.Recon=to,t.ReconParser=On,t.ReconStructureParser=Vn,t.ReconStructureWriter=Jn,t.ReconWriter=$n,t.Record=ae,t.RecordFieldUpdater=Ci,t.RecordInterpolator=uh,t.RecordMap=he,t.RecordMapView=pe,t.RecordModel=Ai,t.RecordOutlet=wi,t.RecordScope=ki,t.RecordStreamlet=bi,t.Rect=yc,t.RectView=vc,t.ReduceFieldsCombinator=oi,t.ReduceFieldsOperator=ni,t.Reifier=Si,t.RemLength=Yu,t.RemoteHost=iu,t.RenderedView=Hl,t.Renderer=Dp,t.ResizeObserver=cp,t.RgbColor=ea,t.RgbColorInterpolator=Ga,t.RgbColorParser=sa,t.RightAxisView=cf,t.RightTickView=Wc,t.RotateTransform=ba,t.RotateTransformInterpolator=Ja,t.RotateTransformParser=Ea,t.STree=Gt,t.STreeContext=Ht,t.STreeLeaf=Yt,t.STreeNode=Zt,t.STreeNodeCursor=Qt,t.STreePage=Xt,t.Scale=mh,t.ScaleForm=xh,t.ScaleGesture=Tc,t.ScaleGestureEvent=Mc,t.ScaleInterpolator=Ch,t.ScaleTransform=ga,t.ScaleTransformInterpolator=$a,t.ScaleTransformParser=ka,t.SecondFormat=Oo,t.SecondInterval=es,t.SecondParser=Wo,t.SegmentR2=oo,t.SegmentR2Interpolator=Na,t.Selector=we,t.Severity=A,t.Shape=eo,t.ShapeInterpolator=Fa,t.ShortMonthFormat=go,t.ShortMonthParser=Ro,t.ShortWeekdayFormat=Co,t.ShortWeekdayParser=Lo,t.SkewTransform=xa,t.SkewTransformInterpolator=th,t.SkewTransformParser=Oa,t.SliceView=Uc,t.Slot=ne,t.SlotInterpolator=oh,t.Span=M,t.StepInterpolator=Ra,t.Streamlet={is:function(t){if("object"==typeof t&&t){var e=t;return"function"==typeof e.streamletScope&&"function"==typeof e.setStreamletScope&&"function"==typeof e.streamletContext&&"function"==typeof e.setStreamletContext}return!1}},t.StreamletException=Tr,t.StreamletInlet=pi,t.StreamletInoutlet=ci,t.StreamletOutlet=li,t.StreamletScope=Rr,t.StringAttributeAnimator=vl,t.StringForm=gr,t.StringMemberAnimator=ol,t.StringStyleAnimator=kl,t.StrokeView=Xl,t.StructureInterpolator=ih,t.StyleAnimator=Al,t.StyleString=Pp,t.StyleValue=Ap,t.StyleValueForm=Op,t.StyleValueParser=Ep,t.SvgView=nc,t.SvgViewController=oc,t.SyncRequest=Gs,t.SyncedResponse=Xs,t.Tag=P,t.TagForm=mr,t.Text=de,t.TextRun=bc,t.TextRunView=xc,t.TextView=ec,t.TextViewController=rc,t.TickGenerator=sf,t.TickView=zc,t.TimeInterval=Ko,t.TimeScale=bh,t.TimeScaleInterpolator=kh,t.TimeTickGenerator=af,t.TimeZone=ao,t.TimeZoneForm=ho,t.TimesOperator=je,t.TimesOutlet=Bi,t.ToAny={is:function(t){return!("object"!=typeof t||!t)&&"function"==typeof t.toAny}},t.TopAxisView=lf,t.TopTickView=jc,t.Transform=_a,t.TransformAttributeAnimator=bl,t.TransformForm=Ma,t.TransformInterpolator=Ya,t.TransformList=Sa,t.TransformListInterpolator=rh,t.TransformListParser=Pa,t.TransformMemberAnimator=cl,t.TransformParser=Da,t.TransformStyleAnimator=Ml,t.Transition=tp,t.TransitionForm=ep,t.TranslateTransform=wa,t.TranslateTransformInterpolator=Qa,t.TranslateTransformParser=Aa,t.TurnAngle=qu,t.TweenAnimator=sp,t.TweenChildAnimator=ap,t.TweenFrameAnimator=up,t.TypesetView=Yl,t.UnaryOperator=ke,t.UnaryOperatorInterpolator=lh,t.UnaryOutlet=Vi,t.Unicode=$,t.UnitForm=wr,t.UnitTimeInterval=Ho,t.UnitlessLength=Qu,t.UnlinkRequest=Ys,t.UnlinkedResponse=Zs,t.Uri=os,t.UriAbsoluteParser=ks,t.UriAuthority=us,t.UriAuthorityParser=Os,t.UriCache=Us,t.UriException=ns,t.UriForm=Ls,t.UriFragment=Ss,t.UriFragmentParser=Fs,t.UriHost=hs,t.UriHostAddressParser=Ds,t.UriHostIPv4=ls,t.UriHostIPv6=cs,t.UriHostLiteralParser=Ms,t.UriHostName=ps,t.UriHostParser=Ps,t.UriHostUndefined=fs,t.UriParser=As,t.UriPath=ys,t.UriPathBuilder=ws,t.UriPathEmpty=ms,t.UriPathParser=Rs,t.UriPathSegment=vs,t.UriPathSlash=_s,t.UriPort=ds,t.UriPortParser=Ts,t.UriQuery=gs,t.UriQueryBuilder=Cs,t.UriQueryParam=bs,t.UriQueryParser=Is,t.UriQueryUndefined=xs,t.UriScheme=ss,t.UriSchemeParser=Es,t.UriUser=as,t.UriUserParser=Vs,t.Utf8=At,t.UtfErrorMode=vt,t.Value=se,t.ValueBuilder=oe,t.ValueCursor=Er,t.ValueDownlink=yu,t.ValueDownlinkModel=du,t.ValueDownlinkRecord=wu,t.ValueEntryCursor=Or,t.ValueForm=Ar,t.ValueInput=Hr,t.ValueInterpolator=sh,t.ValueOutput=Gr,t.ValuesCursor=Ut,t.ValuesSelector=tr,t.VectorR2=io,t.VerticalScaleGesture=Ic,t.View=el,t.ViewController=Wl,t.ViewScope=jl,t.WarpClient=ku,t.WatchFieldsCombinator=hi,t.WatchFieldsOperator=ai,t.WatchValueCombinator=ui,t.WatchValueOperator=si,t.WebAppView=id,t.WebAppViewController=nd,t.WebGLRenderer=Lp,t.WebSocketHost=nu,t.WeekInterval=Qo,t.WeekdayFormat=xo,t.WeekdayParser=Fo,t.Writer=G,t.WriterException=H,t.YearFormat=_o,t.YearInterval=Xo,t.YearParser=Do,t.YearsInterval=Yo,t.assert=S,t.authenticate=Lu,t.client=Eu,t.command=Uu,t.downlink=Pu,t.downlinkList=Du,t.downlinkMap=Mu,t.downlinkValue=Tu,t.hostRef=Ru,t.isOnline=Ou,t.keepOnline=Vu,t.laneRef=Fu,t.nodeRef=Iu,Object.defineProperty(t,"__esModule",{value:!0})}));
	</script>
	<script src="assets/js/index.js"></script>

	<script>
		window.page = null;

		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function() {
				navigator.serviceWorker.register('/sw.js').then(function(registration) {
				// Registration was successful
				console.log('ServiceWorker registration successful with scope: ', registration.scope);
				}, function(err) {
				// registration failed :(
				console.log('ServiceWorker registration failed: ', err);
				});
			});
		}		

		function start() {
			window.page = new PlantPage(`warp://${window.location.host}`);
			window.page.initialize();
		}
	</script>
</head>
<!-- body -->

<body class="page" onload="start()">
	<header class="statusHeader" id="mainHeader">
		<svg width="156px" height="68px" viewBox="0 0 156 68"><polygon fill="#008ac5" points="38.262415 60.577147 45.7497674 67.9446512 41.4336392 66.3395349"></polygon><polygon fill="#004868" points="30.6320304 56.7525259 35.7395349 55.9824716 41.4304178 66.3390957"></polygon><polygon fill="#1db0ef" points="45.8577521 43.5549215 35.7395349 55.9813953 30.895331 54.807418"></polygon><polygon fill="#008ac5" points="45.8604651 43.5549215 41.760398 48.5902277 50.5169298 42.7788873"></polygon><polygon fill="#008ac5" points="26.3271825 57.4036063 35.7395349 55.9813953 19.2251161 51.7639132"></polygon><polygon fill="#008ac5" points="21.8522892 56.6610604 26.3302326 57.4059108 24.8674419 60.4330233"></polygon><polygon fill="#46c7ff" points="25.8602519 50.1512126 21.9749543 52.4673682 26.296682 53.5765239"></polygon><polygon fill="#004868" points="8.22304588 54.4 26.3302326 57.4046512 10.7431892 45.0311035"></polygon><polygon fill="#008ac5" points="13.8293387 33.5634807 4.10372093 35.5972093 8.22325581 54.4"></polygon><polygon fill="#004868" points="8.22099482 54.4011969 0.0941817913 35.6005706 4.10375191 35.6005706"></polygon><polygon fill="#004a6a" points="29.0049687 26.1913296 29.4164365 29.8907151 13.8293023 33.5651163 4.10372093 35.5972093"></polygon><polygon fill="#46c7ff" points="29.0062121 26.1911555 4.10372093 35.5972093 18.5813833 12.4933152"></polygon><polygon fill="#008ac5" points="11.2792478 19.5948645 18.5832775 12.4930233 4.10372093 35.5972093"></polygon><polygon fill="#0076a9" points="0.0976972893 35.6005706 11.6715695 18.9158345 4.10403655 35.6005706"></polygon><polygon fill="#46c7ff" points="24.2487055 31.1058385 29.4139535 29.8876265 26.2195349 45.5916279"></polygon><polygon fill="#004868" points="34.5718675 26.2202296 36.2830885 37.7346648 31.9099624 28.1109897"></polygon><polygon fill="#00557a" points="29.0034364 26.1884581 42.3712871 20.6741037 29.4139535 29.8883721"></polygon><polygon fill="#008ac5" points="26.68 13.7746077 29.0062121 26.1911555 18.5813953 12.4930233"></polygon><polygon fill="#004868" points="11.6715695 2.42510699 18.5775948 12.4930233 11.083087 19.8858773"></polygon><polygon fill="#46c7ff" points="9.61188076 0 26.6831512 13.7746077 18.5788496 12.4908901"></polygon><path fill="#0076a9" d="M26.6778731,13.7746077 L38.8232486,18.8943879 L37.5870837,22.6477526 L29.0035088,26.187907 L26.6778731,13.7746077 Z M35.3244186,20.5976744 C35.7065226,20.5976744 36.0162791,20.2879179 36.0162791,19.905814 C36.0162791,19.52371 35.7065226,19.2139535 35.3244186,19.2139535 C34.9423146,19.2139535 34.6325581,19.52371 34.6325581,19.905814 C34.6325581,20.2879179 34.9423146,20.5976744 35.3244186,20.5976744 Z"></path><polygon fill="#46c7ff" points="38.8232558 18.9003694 64.0007929 11.9315264 37.5863839 22.647813"></polygon><text fill="#ffffff" style="font-family: Orbitron; font-size: 32px;"><tspan x="58" y="42">swim</tspan></text></svg>			
		&nbsp;&nbsp;&nbsp;Plant Monitor
	</header>
	<main class="main" id="main">
		<div class="plantListColumn">
			<h4>Plant List</h4>
			<div class="plantListColumns">
				<div>Plant Name</div>
				<div style="text-align: center;">Alerts</div>
			</div>
			<div id="plantListingDiv">

			</div>

		</div>
        <div class="gauge">
            <h4 class="plantHeader">
				<div id="plantNameHeader">Plant</div>			
			</h4>
            <div style="width: 100%; height: calc(100% - 31px);" id="soilGauge">
            
			</div>
			<div class="plantButtons">
				<input type="button" value="Set Alert Threshold" onclick="page.changeThreshold()">
			</div>

        </div>

        <div class="chartsSection">
			<div>
            	<h4 class="chartHeader">
					<div>
						Light Level 
						<span id="lightValue">0</span>
					</div>
					<div onclick="page.changeThreshold('light')">
						Threshold
						<span id="lightThreshold">0</span>
					</div>
				</h4>
            	<div class="chartRow" id="lightChart"></div>
			</div>

			<div>
				<h4 class="chartHeader">
					<div>
						Soil Moisture Level 
						<span id="soilValue">0</span>
					</div>
					<div onclick="page.changeThreshold('soil')">
						Threshold
						<span id="soilThreshold">0</span>
					</div>
				</h4>
				<div class="chartRow" id="soilChart"></div>
			</div>
			
			<div>
            	<h4 class="chartHeader">
					<div>
						Temperature 
						<span id="tempAvgValue">0</span>
					</div>
					<div onclick="page.changeThreshold('tempAvg')">
						Threshold
						<span id="tempAvgThreshold">0</span>
					</div>
				</h4>
				<div class="chartRow" id="tempAvgChart"></div>
			</div>

			<div>
            	<h4 class="chartHeader">
					<div>
						Humidity 
						<span id="humidityValue">0</span>
					</div>
					<div onclick="page.changeThreshold('humidity')">
						Threshold
						<span id="humidityThreshold">0</span>
					</div>
				</h4>
				<div class="chartRow" id="humidityChart"></div>
			</div>

		</div>
		
	</main>
	<!-- /main -->

</body>

</html>